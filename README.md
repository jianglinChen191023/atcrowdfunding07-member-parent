- [åå…­ ä¼šå‘˜ç³»ç»Ÿ-æ­å»ºç¯å¢ƒ](#åå…­-ä¼šå‘˜ç³»ç»Ÿ-æ­å»ºç¯å¢ƒ)
    - [1. å°šç­¹ç½‘ä¼šå‘˜ç³»ç»Ÿæ€»ç›®æ ‡](#1-å°šç­¹ç½‘ä¼šå‘˜ç³»ç»Ÿæ€»ç›®æ ‡)
    - [2. ä¼šå‘˜ç³»ç»Ÿæ¶æ„](#2-ä¼šå‘˜ç³»ç»Ÿæ¶æ„)
        - [2.1 æ¶æ„å›¾](#21-æ¶æ„å›¾)
        - [2.2 éœ€è¦åˆ›å»ºçš„å·¥ç¨‹](#22-éœ€è¦åˆ›å»ºçš„å·¥ç¨‹)
            - [2.2.1 åˆ›å»ºçˆ¶å·¥ç¨‹](#221-åˆ›å»ºçˆ¶å·¥ç¨‹)
            - [2.2.2 åˆ›å»ºå­å·¥ç¨‹æ¨¡å—](#222-åˆ›å»ºå­å·¥ç¨‹æ¨¡å—)
            - [2.2.3 ç¡®ä¿ `github` ä¸Šé¡¹ç›®ç»“æ„çš„å®Œæ•´](#223-ç¡®ä¿-github-ä¸Šé¡¹ç›®ç»“æ„çš„å®Œæ•´)
            - [2.2.4 åˆ é™¤çˆ¶é¡¹ç›®ä¸‹çš„ `src` ç›®å½•](#224-åˆ é™¤çˆ¶é¡¹ç›®ä¸‹çš„-src-ç›®å½•)
    - [3. çˆ¶å·¥ç¨‹ç¯å¢ƒ](#3-çˆ¶å·¥ç¨‹ç¯å¢ƒ)
    - [4. `Eureka` å·¥ç¨‹](#4-eureka-å·¥ç¨‹)
        - [4.1 ä¾èµ–](#41-ä¾èµ–)
        - [4.2 ä¸»å¯åŠ¨ç±»](#42-ä¸»å¯åŠ¨ç±»)
        - [4.3 é…ç½®](#43-é…ç½®)
    - [5. `Entity` å·¥ç¨‹](#5-entity-å·¥ç¨‹)
        - [5.1 å®ä½“ç±»çš„è¿›ä¸€æ­¥ç»†åˆ†](#51-å®ä½“ç±»çš„è¿›ä¸€æ­¥ç»†åˆ†)
            - [5.1.1 `VO`](#511-vo)
            - [5.1.2 `PO`](#512-po)
            - [5.1.3 `DO`](#513-do)
            - [5.1.4 `DTO`](#514-dto)
        - [5.2 åˆ›å»ºåŒ…](#52-åˆ›å»ºåŒ…)
        - [5.3 `Lombok`](#53-lombok)
            - [5.3.1 `lombok` åŸç†](#531-lombok-åŸç†)
            - [5.3.2 `Lombok` ä¾èµ–](#532-lombok-ä¾èµ–)
    - [5. `MySQL` å·¥ç¨‹](#5-mysql-å·¥ç¨‹)
        - [5.1 ä¾èµ–](#51-ä¾èµ–)
        - [5.2 ä¸»å¯åŠ¨ç±»](#52-ä¸»å¯åŠ¨ç±»)
        - [5.3 é…ç½®](#53-é…ç½®)
        - [5.4 æµ‹è¯•ç±»](#54-æµ‹è¯•ç±»)
            - [5.4.1 æµ‹è¯• `connection`](#541-æµ‹è¯•-connection)
            - [5.4.2 æµ‹è¯• `Mapper`](#542-æµ‹è¯•-mapper)
    - [6. `Api` å·¥ç¨‹](#6-api-å·¥ç¨‹)
        - [6.1 ä¾èµ–](#61-ä¾èµ–)
        - [6.2 æ¥å£](#62-æ¥å£)
        - [6.3 `MySQL`å·¥ç¨‹å¯¹å¤–æš´éœ²æœåŠ¡](#63-mysqlå·¥ç¨‹å¯¹å¤–æš´éœ²æœåŠ¡)
            - [6.3.1 `Hnadler` ä»£ç ](#631-hnadler-ä»£ç )
            - [6.3.2 `Service` æ¥å£](#632-service-æ¥å£)
            - [6.3.3 `Service` ç±»çš„ä»£ç ](#633-service-ç±»çš„ä»£ç )
    - [7. `Redis` å·¥ç¨‹](#7-redis-å·¥ç¨‹)
        - [7.1 `Linux` è‡ªåŠ¨å®‰è£… `Redis`](#71-linux-è‡ªåŠ¨å®‰è£…-redis)
        - [7.2 Reids å‘½ä»¤åˆ—è¡¨](#72-reids-å‘½ä»¤åˆ—è¡¨)
            - [7.2.1 æŸ¥çœ‹ `Redis`](#721-æŸ¥çœ‹-redis)
        - [7.3 å·¥ç¨‹ä¾èµ–](#73-å·¥ç¨‹ä¾èµ–)
        - [7.4 ä¸»å¯åŠ¨ç±»](#74-ä¸»å¯åŠ¨ç±»)
        - [7.5 æ–°å»º `application.yml` é…ç½®](#75-æ–°å»º-applicationyml-é…ç½®)
        - [7.6 æµ‹è¯•ç±»](#76-æµ‹è¯•ç±»)
    - [8. `Redis` å·¥ç¨‹å¯¹å¤–æš´éœ²æœåŠ¡](#8-redis-å·¥ç¨‹å¯¹å¤–æš´éœ²æœåŠ¡)
        - [8.1 `API` å·¥ç¨‹](#81-api-å·¥ç¨‹)
            - [8.1.1 æ–°å»º `RedisRemoteService`æ¥å£](#811-æ–°å»º-redisremoteserviceæ¥å£)
        - [8.2 `Redis` å·¥ç¨‹](#82-redis-å·¥ç¨‹)
            - [8.2.1 å¯¹å¤–æš´éœ²æœåŠ¡ è¿½åŠ ä¾èµ–](#821-å¯¹å¤–æš´éœ²æœåŠ¡-è¿½åŠ ä¾èµ–)
            - [8.2.2 è¿½åŠ  `RedisTest` æµ‹è¯•æ–¹æ³•](#822-è¿½åŠ -redistest-æµ‹è¯•æ–¹æ³•)
            - [8.2.3 æ–°å»º `handler` åŒ…, æ–°å»º `RedisHandler` ç±»](#823-æ–°å»º-handler-åŒ…-æ–°å»º-redishandler-ç±»)
    - [9. `authentication` ä¼šå‘˜ä¸­å¿ƒå·¥ç¨‹](#9-authentication-ä¼šå‘˜ä¸­å¿ƒå·¥ç¨‹)
        - [9.1 ä¾èµ–](#91-ä¾èµ–)
        - [9.2 æ–°å»º `CrowdMainClass` ä¸»å¯åŠ¨ç±»](#92-æ–°å»º-crowdmainclass-ä¸»å¯åŠ¨ç±»)
        - [9.3 æ–°å»º `application.yml` é…ç½®](#93-æ–°å»º-applicationyml-é…ç½®)
            - [9.3.1 æ–°å»ºåŒ… `templates`ã€`static`](#931-æ–°å»ºåŒ…-templatesstatic)
        - [9.4 æ–°å»º `PortalHandler` ç±»](#94-æ–°å»º-portalhandler-ç±»)
        - [9.5 æ–°å»º `portal.html` é¦–é¡µ](#95-æ–°å»º-portalhtml-é¦–é¡µ)
        - [9.6 `static` èµ„æº](#96-static-èµ„æº)
    - [10. `Zuul` ç½‘å…³é¡¹ç›®](#10-zuul-ç½‘å…³é¡¹ç›®)
        - [10.1 ä¾èµ–](#101-ä¾èµ–)
        - [10.2 æ–°å»º `CrowdMainClass` ä¸»å¯åŠ¨ç±»](#102-æ–°å»º-crowdmainclass-ä¸»å¯åŠ¨ç±»)
        - [10.3 æ–°å»º `application.yml` é…ç½®](#103-æ–°å»º-applicationyml-é…ç½®)
    - [11. å…³äºç¬¬ä¸€æ¬¡è¯·æ±‚è¶…æ—¶](#11-å…³äºç¬¬ä¸€æ¬¡è¯·æ±‚è¶…æ—¶)

- [åä¸ƒ ä¼šå‘˜æ³¨å†Œ](#åä¸ƒ-ä¼šå‘˜æ³¨å†Œ)
    - [1. è°ƒç”¨ç¬¬ä¸‰æ–¹çŸ­ä¿¡æ¥å£](#1-è°ƒç”¨ç¬¬ä¸‰æ–¹çŸ­ä¿¡æ¥å£)
        - [1.1 è¿½åŠ ä¾èµ–ã€`common`å·¥ç¨‹ã€‘](#11-è¿½åŠ ä¾èµ–commonå·¥ç¨‹)
        - [1.2 æ–°å»º `HttpUtils` ç±»ã€`common`å·¥ç¨‹ã€‘](#12-æ–°å»º-httputils-ç±»commonå·¥ç¨‹)
        - [1.3 æ–°å»º `CrowdTest` æµ‹è¯•ç±»ã€`auth` å·¥ç¨‹ã€‘](#13-æ–°å»º-crowdtest-æµ‹è¯•ç±»auth-å·¥ç¨‹)
            - [1.3.1 å‰ç½®: è¿½åŠ ä¾èµ–](#131-å‰ç½®-è¿½åŠ ä¾èµ–)
        - [1.4 `CrowdUtil` è¿½åŠ æ–¹æ³•ã€`common`å·¥ç¨‹ã€‘](#14-crowdutil-è¿½åŠ æ–¹æ³•commonå·¥ç¨‹)
    - [2. å‘é€éªŒè¯ç ã€`auth` å·¥ç¨‹ã€‘](#2-å‘é€éªŒè¯ç auth-å·¥ç¨‹)
        - [2.1 é…ç½®è·³è½¬è·¯å¾„å’Œå¯¹åº”çš„é¡µé¢](#21-é…ç½®è·³è½¬è·¯å¾„å’Œå¯¹åº”çš„é¡µé¢)
            - [2.1.1 æ–°å»º `CrowdWebMvcConfig` ç±»](#211-æ–°å»º-crowdwebmvcconfig-ç±»)
        - [2.2 ä¿®æ”¹ä»£ç  `portal.html`](#22-ä¿®æ”¹ä»£ç -portalhtml)
        - [2.3 æ–°å»º `member-reg.html` æ³¨å†Œé¡µé¢](#23-æ–°å»º-member-reghtml-æ³¨å†Œé¡µé¢)
            - [2.3.1 æ·»åŠ  `layer`åˆ° `static` ä¸‹ ğŸ“layer.zip](#231-æ·»åŠ -layeråˆ°-static-ä¸‹-layerzip)
        - [2.4 è¿½åŠ ä¾èµ–](#24-è¿½åŠ ä¾èµ–)
        - [2.5 æ–°å»º `ShortMessageProperties` ç±»](#25-æ–°å»º-shortmessageproperties-ç±»)
        - [2.6 è¿½åŠ é…ç½®](#26-è¿½åŠ é…ç½®)
        - [2.7 æ–°å»º `MemberHandler` å‘é€çŸ­ä¿¡](#27-æ–°å»º-memberhandler-å‘é€çŸ­ä¿¡)
        - [2.8 è¿½åŠ ä»£ç  `CrowdConstant`ã€`common`ã€‘](#28-è¿½åŠ ä»£ç -crowdconstantcommon)
    - [3. æ‰§è¡Œæ³¨å†Œæµç¨‹](#3-æ‰§è¡Œæ³¨å†Œæµç¨‹)
        - [3.1 è¿½åŠ ä»£ç  `MySQLRemoteService`ã€`API` å·¥ç¨‹ã€‘](#31-è¿½åŠ ä»£ç -mysqlremoteserviceapi-å·¥ç¨‹)
        - [3.2 `MySQL` é¡¹ç›®](#32-mysql-é¡¹ç›®)
            - [3.2.1 è¿½åŠ ä»£ç  `MemberProviderHandler`](#321-è¿½åŠ ä»£ç -memberproviderhandler)
            - [3.2.2 è¿½åŠ ä»£ç  `MemberService`](#322-è¿½åŠ ä»£ç -memberservice)
            - [3.2.3 è¿½åŠ ä»£ç  `MemberServiceImpl`](#323-è¿½åŠ ä»£ç -memberserviceimpl)
        - [3.3 æµ‹è¯• `http://localhost:2000/save/member/remote`](#33-æµ‹è¯•-httplocalhost2000savememberremote)
        - [3.4 `Entity` å·¥ç¨‹](#34-entity-å·¥ç¨‹)
            - [3.4.1 æ–°å»º `MemberVO` å°è£…è¡¨å•æ•°æ®](#341-æ–°å»º-membervo-å°è£…è¡¨å•æ•°æ®)
        - [3.5 `Auth` é¡¹ç›®](#35-auth-é¡¹ç›®)
            - [3.5.1 è¿½åŠ ä»£ç  `MemberHandler`](#351-è¿½åŠ ä»£ç -memberhandler)
            - [3.5.2 ç™»å½•é¡µé¢ `member-login.html`](#352-ç™»å½•é¡µé¢-member-loginhtml)
        - [3.6 `Common` å·¥ç¨‹](#36-common-å·¥ç¨‹)
            - [3.6.1 è¿½åŠ ä»£ç  `CrowdContant`](#361-è¿½åŠ ä»£ç -crowdcontant)

- [åå…« ä¼šå‘˜ç™»å½•](#åå…«-ä¼šå‘˜ç™»å½•)
    - [1. ç™»å½•æµç¨‹](#1-ç™»å½•æµç¨‹)
        - [1.1 `Entity`](#11-entity)
            - [1.1.1 æ–°å»º `MemberLoginVO`](#111-æ–°å»º-memberloginvo)
        - [1.2 `Auth` å·¥ç¨‹](#12-auth-å·¥ç¨‹)
            - [1.2.1 ä¿®æ”¹ä»£ç  `member-login.html`](#121-ä¿®æ”¹ä»£ç -member-loginhtml)
            - [1.2.2 è¿½åŠ ä»£ç  `MemberHandler`](#122-è¿½åŠ ä»£ç -memberhandler)
            - [1.2.3 è¿½åŠ ä»£ç  `CrowdWebMvcConfig` è®¾ç½®è·³è½¬é¡µé¢](#123-è¿½åŠ ä»£ç -crowdwebmvcconfig-è®¾ç½®è·³è½¬é¡µé¢)
            - [1.2.4 æ–°å»ºé¡µé¢ `member-conter.html`](#124-æ–°å»ºé¡µé¢-member-conterhtml)
    - [2. ä¼šå‘˜é€€å‡ºç™»å½•](#2-ä¼šå‘˜é€€å‡ºç™»å½•)
        - [2.1 `auth` å·¥ç¨‹](#21-auth-å·¥ç¨‹)
            - [2.1.1 ä¿®æ”¹ä»£ç `member-conter.html`](#211-ä¿®æ”¹ä»£ç member-conterhtml)
            - [2.1.2 è¿½åŠ ä»£ç  `MemberHandler`](#212-è¿½åŠ ä»£ç -memberhandler)
    - [3. çŸ¥è¯†ç‚¹: Session å…±äº«, è§£å†³ Session ä¸äº’é€šçš„é—®é¢˜](#3-çŸ¥è¯†ç‚¹-session-å…±äº«-è§£å†³-session-ä¸äº’é€šçš„é—®é¢˜)
        - [3.1 ä¼šè¯æ§åˆ¶å›é¡¾](#31-ä¼šè¯æ§åˆ¶å›é¡¾)
            - [3.1.1 Cookie çš„å·¥ä½œæœºåˆ¶](#311-cookie-çš„å·¥ä½œæœºåˆ¶)
            - [3.1.2 Session çš„å·¥ä½œæœºåˆ¶](#312-session-çš„å·¥ä½œæœºåˆ¶)
        - [3.2 è§£å†³æ–¹æ¡ˆæ¢ç´¢](#32-è§£å†³æ–¹æ¡ˆæ¢ç´¢)
            - [3.2.1 Session åŒæ­¥](#321-session-åŒæ­¥)
            - [3.2.2 å°† `Session` æ•°æ®å­˜å‚¨åœ¨ `Cookie` ä¸­](#322-å°†-session-æ•°æ®å­˜å‚¨åœ¨-cookie-ä¸­)
            - [3.2.3 åå‘ä»£ç† `hash` ä¸€è‡´æ€§](#323-åå‘ä»£ç†-hash-ä¸€è‡´æ€§)
            - [3.2.4 åç«¯ç»Ÿä¸€å­˜å‚¨ Session æ•°æ®](#324-åç«¯ç»Ÿä¸€å­˜å‚¨-session-æ•°æ®)
        - [3.3 `SpringSession` ä½¿ç”¨](#33-springsession-ä½¿ç”¨)
            - [3.3.1 å…±åŒä»£ç ](#331-å…±åŒä»£ç )
                - [3.3.1.1 å¼•å…¥ä¾èµ–](#3311-å¼•å…¥ä¾èµ–)
                - [3.3.1.2 æ–°å»º `MainClass` ä¸»å¯åŠ¨ç±»](#3312-æ–°å»º-mainclass-ä¸»å¯åŠ¨ç±»)
                - [3.3.1.3 æ–°å»º `application.yml` é…ç½®](#3313-æ–°å»º-applicationyml-é…ç½®)
            - [3.3.2 `pro18-spring-session-a`](#332-pro18-spring-session-a)
                - [3.3.2.1 æ–°å»º `HelloHandler` ç±»](#3321-æ–°å»º-hellohandler-ç±»)
            - [3.3.3 `pro18-spring-session-b`](#333-pro18-spring-session-b)
                - [3.3.3.1 æ–°å»º`HelloHandler`ç±»](#3331-æ–°å»ºhellohandlerç±»)
        - [3.4 `SpringSession` åŸºæœ¬åŸç†](#34-springsession-åŸºæœ¬åŸç†)
            - [3.4.1 `SpringSession` éœ€è¦å®Œæˆçš„ä»»åŠ¡](#341-springsession-éœ€è¦å®Œæˆçš„ä»»åŠ¡)
            - [3.4.2 `SessionRepositoryFilter`](#342-sessionrepositoryfilter)
    - [4. æ˜Ÿå›¾/æ¶æ„å›¾](#4-æ˜Ÿå›¾æ¶æ„å›¾)
    - [5. ç™»å½•æ£€æŸ¥](#5-ç™»å½•æ£€æŸ¥)
        - [5.1 ä»£ç : è®¾ç½® `Session` å…±äº«](#51-ä»£ç -è®¾ç½®-session-å…±äº«)
            - [5.1.1 `zuulã€auth` å·¥ç¨‹](#511-zuulauth-å·¥ç¨‹)
        - [5.2 ä»£ç : å‡†å¤‡ä¸éœ€è¦ç™»å½•æ£€æŸ¥çš„èµ„æº](#52-ä»£ç -å‡†å¤‡ä¸éœ€è¦ç™»å½•æ£€æŸ¥çš„èµ„æº)
            - [5.2.1 æ–°å»º `AccessPassResources` ç±»](#521-æ–°å»º-accesspassresources-ç±»)
        - [5.3 ä»£ç : `zuul` å·¥ç¨‹](#53-ä»£ç -zuul-å·¥ç¨‹)
            - [5.3.1 æ–°å»º `CrowdAccessFilter` ç±»](#531-æ–°å»º-crowdaccessfilter-ç±»)
            - [5.3.2 è¿½åŠ ä¾èµ–](#532-è¿½åŠ ä¾èµ–)
        - [5.4 `auth` å·¥ç¨‹](#54-auth-å·¥ç¨‹)
            - [5.4.1 è¿½åŠ ä»£ç  `member-login.html`](#541-è¿½åŠ ä»£ç -member-loginhtml)
    - [6 ä¿®æ”¹é‡å®šå‘åœ°å€, ä½¿ç”¨ `zuul`](#6-ä¿®æ”¹é‡å®šå‘åœ°å€-ä½¿ç”¨-zuul)
        - [6.1 å› ä¸º `Cookie` é—®é¢˜ä¸èƒ½ä½¿ç”¨é‡å®šå‘è·¨é¡¹ç›®è·³è½¬, æ‰€ä»¥é›†ä¸­è®¿é—® `zuul` æ¥è¿›è¡Œé‡å®šå‘](#61-å› ä¸º-cookie-é—®é¢˜ä¸èƒ½ä½¿ç”¨é‡å®šå‘è·¨é¡¹ç›®è·³è½¬-æ‰€ä»¥é›†ä¸­è®¿é—®-zuul-æ¥è¿›è¡Œé‡å®šå‘)
        - [6.2 å‰ç«¯é‡å®šå‘åœ°å€, ä½¿ç”¨ Session å…±äº«å­˜å‚¨ `zuul` åœ°å€è§£å†³](#62-å‰ç«¯é‡å®šå‘åœ°å€-ä½¿ç”¨-session-å…±äº«å­˜å‚¨-zuul-åœ°å€è§£å†³)
            - [6.2.1 é¡¹ç›®å¯åŠ¨è‡ªåŠ¨å­˜å‚¨ `zuul` åœ°å€](#621-é¡¹ç›®å¯åŠ¨è‡ªåŠ¨å­˜å‚¨-zuul-åœ°å€)
            - [6.2.2 è¿½åŠ ä»£ç  `CrowdConstant` ã€`common`å·¥ç¨‹ã€‘](#622-è¿½åŠ ä»£ç -crowdconstant-commonå·¥ç¨‹)
            - [6.2.3 å‰ç«¯é‡å®šå‘å¯ä»¥ä½¿ç”¨ `${session.zuulPath}`è·å–åœ°å€](#623-å‰ç«¯é‡å®šå‘å¯ä»¥ä½¿ç”¨-sessionzuulpathè·å–åœ°å€)

- [åä¹ OSS](#åä¹-oss)
    - [1. é˜¿é‡Œäº‘çš„ OSS å¯¹è±¡å­˜å‚¨](#1-é˜¿é‡Œäº‘çš„-oss-å¯¹è±¡å­˜å‚¨)
        - [1.1 æå‡ºé—®é¢˜](#11-æå‡ºé—®é¢˜)
            - [1.1.1 ä»¥å‰ä¸Šä¼ æ–‡ä»¶æ—¶ä¿æŒä½ç½®](#111-ä»¥å‰ä¸Šä¼ æ–‡ä»¶æ—¶ä¿æŒä½ç½®)
            - [1.1.2 é—®é¢˜1: Web åº”ç”¨é‡æ–°éƒ¨ç½²å¯¼è‡´æ–‡ä»¶ä¸¢å¤±](#112-é—®é¢˜1-web-åº”ç”¨é‡æ–°éƒ¨ç½²å¯¼è‡´æ–‡ä»¶ä¸¢å¤±)
            - [1.1.3 é—®é¢˜2: é›†ç¾¤ç¯å¢ƒä¸‹æ–‡ä»¶éš¾ä»¥åŒæ­¥](#113-é—®é¢˜2-é›†ç¾¤ç¯å¢ƒä¸‹æ–‡ä»¶éš¾ä»¥åŒæ­¥)
            - [1.1.4 é—®é¢˜3: Tomcat è¢«æ‹–å®](#114-é—®é¢˜3-tomcat-è¢«æ‹–å®)
            - [1.1.5 é—®é¢˜4: æœåŠ¡å™¨å­˜å‚¨è‡ªåŠ¨æ‰©å®¹é—®é¢˜](#115-é—®é¢˜4-æœåŠ¡å™¨å­˜å‚¨è‡ªåŠ¨æ‰©å®¹é—®é¢˜)
        - [1.2 è§£å†³æ–¹æ¡ˆä»‹ç»](#12-è§£å†³æ–¹æ¡ˆä»‹ç»)
            - [1.2.1 è‡ªå·±æ­å»ºæ–‡ä»¶æœåŠ¡å™¨](#121-è‡ªå·±æ­å»ºæ–‡ä»¶æœåŠ¡å™¨)
            - [1.2.2 ä½¿ç”¨ç¬¬ä¸‰æ–¹äº‘æœåŠ¡](#122-ä½¿ç”¨ç¬¬ä¸‰æ–¹äº‘æœåŠ¡)
        - [1.3 å¼€é€š OSS æœåŠ¡æ­¥éª¤](#13-å¼€é€š-oss-æœåŠ¡æ­¥éª¤)
        - [1.4 ä½¿ç”¨ `OSS`](#14-ä½¿ç”¨-oss)
        - [1.5 Java ç¨‹åºè°ƒç”¨ OSS æœåŠ¡æ¥å£](#15-java-ç¨‹åºè°ƒç”¨-oss-æœåŠ¡æ¥å£)
            - [1.5.1 å‚è€ƒæ–‡æ¡£åœ°å€](#151-å‚è€ƒæ–‡æ¡£åœ°å€)
            - [1.5.2 å®˜ç½‘ä»‹ç»](#152-å®˜ç½‘ä»‹ç»)
            - [1.5.3 åˆ›å»ºè®¿é—®ç§˜é’¥ `AccessKey`](#153-åˆ›å»ºè®¿é—®ç§˜é’¥-accesskey)
            - [1.5.4 åˆ›å»ºå­è´¦å· `AK` çš„æ“ä½œ](#154-åˆ›å»ºå­è´¦å·-ak-çš„æ“ä½œ)
            - [1.5.5 OSS ä¾èµ–](#155-oss-ä¾èµ–)
        - [1.6 å°† `OSS` å¼•å…¥ `project` é¡¹ç›®](#16-å°†-oss-å¼•å…¥-project-é¡¹ç›®)
            - [1.6.1 `config` åŒ…: `OSSProperties`](#161-config-åŒ…-ossproperties)
            - [1.6.2 ä¾èµ–](#162-ä¾èµ–)
            - [1.6.3 æ–°å»º `CrowdMainClass`ä¸»å¯åŠ¨ç±»](#163-æ–°å»º-crowdmainclassä¸»å¯åŠ¨ç±»)
            - [1.6.4 æ–°å»º `application.yml` é…ç½®](#164-æ–°å»º-applicationyml-é…ç½®)
        - [1.7 `common` å·¥ç¨‹](#17-common-å·¥ç¨‹)
            - [1.7.1 è¿½åŠ ä¾èµ–](#171-è¿½åŠ ä¾èµ–)
            - [1.7.2 å·¥å…·ç±» `CrowdUtil` ä¸­è¿½åŠ æ–¹æ³•](#172-å·¥å…·ç±»-crowdutil-ä¸­è¿½åŠ æ–¹æ³•)
            - [1.7.3 æµ‹è¯• OSS](#173-æµ‹è¯•-oss)
            - [1.7.4 å¦‚æœæŠ¥é”™: `Error: A JNI error has occurred, please check your installation and try agai`](#174-å¦‚æœæŠ¥é”™-error-a-jni-error-has-occurred-please-check-your-installation-and-try-agai)

- [äºŒå å‘èµ·é¡¹ç›®](#äºŒå-å‘èµ·é¡¹ç›®)
    - [1. å‘èµ·é¡¹ç›® å»ºæ¨¡/å‡†å¤‡](#1-å‘èµ·é¡¹ç›®-å»ºæ¨¡å‡†å¤‡)
        - [1.1 åˆ›å»ºæ•°æ®åº“](#11-åˆ›å»ºæ•°æ®åº“)
            - [1.1.1 åˆ†ç±»è¡¨](#111-åˆ†ç±»è¡¨)
            - [1.1.2 é¡¹ç›®åˆ†ç±»ä¸­é—´è¡¨](#112-é¡¹ç›®åˆ†ç±»ä¸­é—´è¡¨)
            - [1.1.3 æ ‡ç­¾è¡¨](#113-æ ‡ç­¾è¡¨)
            - [1.1.4 é¡¹ç›®æ ‡ç­¾ä¸­é—´è¡¨](#114-é¡¹ç›®æ ‡ç­¾ä¸­é—´è¡¨)
            - [1.1.5 é¡¹ç›®è¡¨](#115-é¡¹ç›®è¡¨)
            - [1.1.6 é¡¹ç›®è¡¨é¡¹ç›®è¯¦æƒ…å›¾ç‰‡è¡¨](#116-é¡¹ç›®è¡¨é¡¹ç›®è¯¦æƒ…å›¾ç‰‡è¡¨)
            - [1.1.7 é¡¹ç›®å‘èµ·äººä¿¡æ¯è¡¨](#117-é¡¹ç›®å‘èµ·äººä¿¡æ¯è¡¨)
            - [1.1.8 å›æŠ¥ä¿¡æ¯è¡¨](#118-å›æŠ¥ä¿¡æ¯è¡¨)
            - [1.1.9 å‘èµ·äººç¡®è®¤ä¿¡æ¯è¡¨](#119-å‘èµ·äººç¡®è®¤ä¿¡æ¯è¡¨)
        - [1.2. é€†å‘å·¥ç¨‹](#12-é€†å‘å·¥ç¨‹)
        - [1.3. `Mysql` å·¥ç¨‹](#13-mysql-å·¥ç¨‹)
            - [1.3.1 æ–°å»º `ProjectProviderHandler`](#131-æ–°å»º-projectproviderhandler)
            - [1.3.2 æ–°å»º `ProjectService`](#132-æ–°å»º-projectservice)
            - [1.3.1 æ–°å»º `ProjectServiceImpl`](#131-æ–°å»º-projectserviceimpl)
        - [1.4. åˆ›å»º `VO` å¯¹è±¡](#14-åˆ›å»º-vo-å¯¹è±¡)
            - [1.4.1 æ–°å»º `ProjcetVO`](#141-æ–°å»º-projcetvo)
            - [1.4.2 æ–°å»º `MemberLauchInfoVO`](#142-æ–°å»º-memberlauchinfovo)
            - [1.4.3 æ–°å»º `ReturnVO`](#143-æ–°å»º-returnvo)
            - [1.4.4 æ–°å»º `MemberConfirmInfoVO`](#144-æ–°å»º-memberconfirminfovo)
        - [1.5 ä¿®æ”¹ PO, è®°å¾—åŠ  `@NoArgsConstructor`, `@AllArgsConstructor`, `@Data`](#15-ä¿®æ”¹-po-è®°å¾—åŠ -noargsconstructor-allargsconstructor-data)
            - [1.5.1 ä¿®æ”¹ `ProjectPO`](#151-ä¿®æ”¹-projectpo)
    - [2. å‘èµ·é¡¹ç›®](#2-å‘èµ·é¡¹ç›®)
        - [2.1 æ€»ç›®æ ‡](#21-æ€»ç›®æ ‡)
        - [2.2 æ€è·¯](#22-æ€è·¯)
        - [2.3 è·³è½¬`å‘èµ·ä¼—ç­¹`çš„è¡¨å•é¡µé¢](#23-è·³è½¬å‘èµ·ä¼—ç­¹çš„è¡¨å•é¡µé¢)
            - [2.3.1 ç‚¹å‡» "æˆ‘çš„ä¼—ç­¹"`member-conter.html`ã€`auth` å·¥ç¨‹ã€‘](#231-ç‚¹å‡»-æˆ‘çš„ä¼—ç­¹member-conterhtmlauth-å·¥ç¨‹)
            - [2.3.2 è¿½åŠ ä»£ç  `CrowdWebMvcConfig`ã€`auth` å·¥ç¨‹ã€‘](#232-è¿½åŠ ä»£ç -crowdwebmvcconfigauth-å·¥ç¨‹)
            - [2.3.3 æ–°å»ºæˆ‘çš„ä¼—ç­¹é¡µé¢ `member-crowd.html`ã€`auth` å·¥ç¨‹ã€‘](#233-æ–°å»ºæˆ‘çš„ä¼—ç­¹é¡µé¢-member-crowdhtmlauth-å·¥ç¨‹)
            - [2.3.4 è¿½åŠ é…ç½® `application.yml`ã€`zuul` å·¥ç¨‹ã€‘](#234-è¿½åŠ é…ç½®-applicationymlzuul-å·¥ç¨‹)
            - [2.3.5 æ–°å»º `CrowdWebMvcConfig` é…ç½®ç±»ã€`project` å·¥ç¨‹ã€‘](#235-æ–°å»º-crowdwebmvcconfig-é…ç½®ç±»project-å·¥ç¨‹)
            - [2.3.5 é¡µé¢ä¸Šå†™åœ°å€éœ€è¦æ³¨æ„](#235-é¡µé¢ä¸Šå†™åœ°å€éœ€è¦æ³¨æ„)
            - [2.3.6 æ–°å»º `templates` >`project-agree.html`ã€`project` å·¥ç¨‹ã€‘](#236-æ–°å»º-templates-project-agreehtmlproject-å·¥ç¨‹)
            - [2.3.7 æ–°å»º `project-launch.html`ã€`project` å·¥ç¨‹ã€‘](#237-æ–°å»º-project-launchhtmlproject-å·¥ç¨‹)
        - [2.4 å¤„ç† `1. é¡¹ç›®åŠå‘èµ·äººä¿¡æ¯` çš„è¡¨å•è¯·æ±‚](#24-å¤„ç†-1-é¡¹ç›®åŠå‘èµ·äººä¿¡æ¯-çš„è¡¨å•è¯·æ±‚)
            - [2.4.1 æ–°å»º `ProjectConsumerHandler` ç±» ã€`project` å·¥ç¨‹ã€‘](#241-æ–°å»º-projectconsumerhandler-ç±»-project-å·¥ç¨‹)
            - [2.4.2 è¿½åŠ è·³è½¬ä»£ç  `CrowdWebMvcConfig` ã€`project` å·¥ç¨‹ã€‘](#242-è¿½åŠ è·³è½¬ä»£ç -crowdwebmvcconfig-project-å·¥ç¨‹)
            - [2.4.3 æ–°å»º  `project-return.html`é¡µé¢`2. å›æŠ¥è®¾ç½®`ã€`project` å·¥ç¨‹ã€‘](#243-æ–°å»º--project-returnhtmlé¡µé¢2-å›æŠ¥è®¾ç½®project-å·¥ç¨‹)
        - [2.5 å¤„ç†  `2. å›æŠ¥è®¾ç½®` é¡µé¢çš„è¡¨å•è¯·æ±‚](#25-å¤„ç†--2-å›æŠ¥è®¾ç½®-é¡µé¢çš„è¡¨å•è¯·æ±‚)
            - [2.5.1 è¿½åŠ å›¾ç‰‡ä¸Šä¼ ä»£ç  `ProjectConsumerHandler ç±»` ã€`project` å·¥ç¨‹ã€‘](#251-è¿½åŠ å›¾ç‰‡ä¸Šä¼ ä»£ç -projectconsumerhandler-ç±»-project-å·¥ç¨‹)
            - [2.5.2 è¿½åŠ  `æ·»åŠ å›æŠ¥ä¿¡æ¯` ä»£ç  `ProjectConsumerHandler ç±»` ã€`project` å·¥ç¨‹ã€‘](#252-è¿½åŠ -æ·»åŠ å›æŠ¥ä¿¡æ¯-ä»£ç -projectconsumerhandler-ç±»-project-å·¥ç¨‹)
        - [2.6 å¤„ç†3: ç¬¬ä¸‰æ­¥ `ç¡®è®¤ä¿¡æ¯` é¡µé¢ ã€`project` å·¥ç¨‹ã€‘](#26-å¤„ç†3-ç¬¬ä¸‰æ­¥-ç¡®è®¤ä¿¡æ¯-é¡µé¢-project-å·¥ç¨‹)
            - [2.6.1 æ·»åŠ  `view-comtorller` ä»£ç ](#261-æ·»åŠ -view-comtorller-ä»£ç )
            - [](#)
            - [2.6.2 æ–°å»º `project-confirm.html` ç¬¬ä¸‰æ­¥: ç¡®è®¤ä¿¡æ¯é¡µé¢](#262-æ–°å»º-project-confirmhtml-ç¬¬ä¸‰æ­¥-ç¡®è®¤ä¿¡æ¯é¡µé¢)
            - [2.6.3 è¿½åŠ å¤„ç† `ç¡®è®¤ä¿¡æ¯è¡¨å•æäº¤` çš„ä»£ç ](#263-è¿½åŠ å¤„ç†-ç¡®è®¤ä¿¡æ¯è¡¨å•æäº¤-çš„ä»£ç )
            - [2.6.4 è¿½åŠ è·³è½¬å®Œæˆé¡µé¢çš„ä»£ç ](#264-è¿½åŠ è·³è½¬å®Œæˆé¡µé¢çš„ä»£ç )
            - [2.6.5 æ–°å»ºå®Œæˆé¡µé¢ `project-success.html`](#265-æ–°å»ºå®Œæˆé¡µé¢-project-successhtml)
        - [2.7 ä¿å­˜ä¼šå‘˜å‘èµ·çš„ä¼—ç­¹ä¿¡æ¯](#27-ä¿å­˜ä¼šå‘˜å‘èµ·çš„ä¼—ç­¹ä¿¡æ¯)
            - [2.7.1 è¿½åŠ  `mysql çš„ Feign æ¥å£` ä»£ç ã€`api` å·¥ç¨‹ã€‘](#271-è¿½åŠ -mysql-çš„-feign-æ¥å£-ä»£ç api-å·¥ç¨‹)
            - [2.7.2 ä¿å­˜ä¼šå‘˜å‘èµ·çš„ä¼—ç­¹ä¿¡æ¯ ã€`mysql` å·¥ç¨‹ã€‘](#272-ä¿å­˜ä¼šå‘˜å‘èµ·çš„ä¼—ç­¹ä¿¡æ¯-mysql-å·¥ç¨‹)

- [äºŒåä¸€ å‰å°-é¦–é¡µæ˜¾ç¤ºé¡¹ç›®](#äºŒåä¸€-å‰å°-é¦–é¡µæ˜¾ç¤ºé¡¹ç›®)
    - [1. é¦–é¡µæ˜¾ç¤ºé¡¹ç›®](#1-é¦–é¡µæ˜¾ç¤ºé¡¹ç›®)
        - [1.1 ç›®æ ‡](#11-ç›®æ ‡)
        - [1.2 æ€è·¯](#12-æ€è·¯)
        - [1.3 æ•°æ®åº“](#13-æ•°æ®åº“)
            - [1.3.1 åˆ†ç±»è¡¨æ•°æ®](#131-åˆ†ç±»è¡¨æ•°æ®)
            - [1.3.2 æ ‡ç­¾è¡¨æ•°æ®](#132-æ ‡ç­¾è¡¨æ•°æ®)
            - [1.3.3 æ•°æ®åº“å¤‡ä»½](#133-æ•°æ®åº“å¤‡ä»½)
        - [1.4 ä»£ç ](#14-ä»£ç )
            - [1.4.1 æ–°å»º `PortalTypeVO` å®ä½“ç±»ã€`entity` å·¥ç¨‹ã€‘](#141-æ–°å»º-portaltypevo-å®ä½“ç±»entity-å·¥ç¨‹)
            - [1.4.2 æ–°å»º `PortalProjectVO` å®ä½“ç±»ã€`entity` å·¥ç¨‹ã€‘](#142-æ–°å»º-portalprojectvo-å®ä½“ç±»entity-å·¥ç¨‹)
            - [1.4.3  æš´éœ²æ•°æ®æŸ¥è¯¢çš„æ¥å£ã€`mysql` å·¥ç¨‹ã€‘](#143--æš´éœ²æ•°æ®æŸ¥è¯¢çš„æ¥å£mysql-å·¥ç¨‹)
            - [1.4.4 å£°æ˜ä¸€ä¸ª Feign çš„æ¥å£ ã€`api` å·¥ç¨‹ã€‘](#144-å£°æ˜ä¸€ä¸ª-feign-çš„æ¥å£-api-å·¥ç¨‹)
            - [1.4.5 è°ƒç”¨ `mysql` æš´éœ²çš„æ¥å£æ‹¿åˆ°æ•°æ®å­˜å…¥åˆ°æ¨¡å‹ ã€`auth` å·¥ç¨‹ã€‘](#145-è°ƒç”¨-mysql-æš´éœ²çš„æ¥å£æ‹¿åˆ°æ•°æ®å­˜å…¥åˆ°æ¨¡å‹-auth-å·¥ç¨‹)
            - [1.4.6 åœ¨ `portal.html` ä¸­æ˜¾ç¤ºæ¨¡å‹ä¸­çš„æ•°æ®ã€`auth` å·¥ç¨‹ã€‘](#146-åœ¨-portalhtml-ä¸­æ˜¾ç¤ºæ¨¡å‹ä¸­çš„æ•°æ®auth-å·¥ç¨‹)
    - [2. æ˜¾ç¤ºé¡¹ç›®è¯¦æƒ…](#2-æ˜¾ç¤ºé¡¹ç›®è¯¦æƒ…)
        - [2.1 ç›®æ ‡](#21-ç›®æ ‡)
        - [2.2 æ€è·¯](#22-æ€è·¯)
        - [2.3 ä»£ç ](#23-ä»£ç )
            - [2.3.1 åˆ›å»º `DetailProjectVO`å®ä½“ç±»ã€`entity` å·¥ç¨‹ã€‘](#231-åˆ›å»º-detailprojectvoå®ä½“ç±»entity-å·¥ç¨‹)
            - [2.3.2 åˆ›å»º `DetailReturnVO`å®ä½“ç±»ã€`entity` å·¥ç¨‹ã€‘](#232-åˆ›å»º-detailreturnvoå®ä½“ç±»entity-å·¥ç¨‹)
            - [2.3.3 æš´éœ²æ•°æ®æŸ¥è¯¢çš„æ¥å£ã€`mysql` å·¥ç¨‹ã€‘](#233-æš´éœ²æ•°æ®æŸ¥è¯¢çš„æ¥å£mysql-å·¥ç¨‹)
            - [2.3.4 å£°æ˜ä¸€ä¸ª Feign çš„æ¥å£ ã€`api` å·¥ç¨‹ã€‘](#234-å£°æ˜ä¸€ä¸ª-feign-çš„æ¥å£-api-å·¥ç¨‹)
            - [2.3.5 é¦–é¡µè·³è½¬åˆ°é¡¹ç›®è¯¦æƒ… `portal.html`ã€`auth` å·¥ç¨‹ã€‘](#235-é¦–é¡µè·³è½¬åˆ°é¡¹ç›®è¯¦æƒ…-portalhtmlauth-å·¥ç¨‹)
            - [2.3.6 è°ƒç”¨ `mysql` æš´éœ²çš„æ¥å£æ‹¿åˆ°æ•°æ®å­˜å…¥åˆ°æ¨¡å‹ ã€`project` å·¥ç¨‹ã€‘](#236-è°ƒç”¨-mysql-æš´éœ²çš„æ¥å£æ‹¿åˆ°æ•°æ®å­˜å…¥åˆ°æ¨¡å‹-project-å·¥ç¨‹)
            - [2.3.7 æ–°å»º `project-show-detail.html` ä¸­æ˜¾ç¤ºæ¨¡å‹ä¸­çš„æ•°æ®ã€`project` å·¥ç¨‹ã€‘](#237-æ–°å»º-project-show-detailhtml-ä¸­æ˜¾ç¤ºæ¨¡å‹ä¸­çš„æ•°æ®project-å·¥ç¨‹)

- [äºŒåäºŒ å‰å°-æ”¯ä»˜æ¡ˆä¾‹](#äºŒåäºŒ-å‰å°-æ”¯ä»˜æ¡ˆä¾‹)
    - [1. æ”¯ä»˜å®å¼€æ”¾å¹³å°](#1-æ”¯ä»˜å®å¼€æ”¾å¹³å°)
    - [2. ç”µè„‘ç½‘ç«™æ”¯ä»˜](#2-ç”µè„‘ç½‘ç«™æ”¯ä»˜)
        - [2.1 æ€»ä½“æ­¥éª¤å‚è€ƒ](#21-æ€»ä½“æ­¥éª¤å‚è€ƒ)
        - [2.2 åº”ç”¨](#22-åº”ç”¨)
        - [2.3 åŠ å¯†](#23-åŠ å¯†)
            - [2.3.1 å¯¹ç§°åŠ å¯†](#231-å¯¹ç§°åŠ å¯†)
            - [2.3.2 éå¯¹ç§°åŠ å¯†](#232-éå¯¹ç§°åŠ å¯†)
            - [2.3.3 è°ƒç”¨æ”¯ä»˜å®æ¥å£æ—¶ä½¿ç”¨çš„ç§˜é’¥](#233-è°ƒç”¨æ”¯ä»˜å®æ¥å£æ—¶ä½¿ç”¨çš„ç§˜é’¥)
            - [2.3.4 ç”Ÿæˆç§˜é’¥å·¥å…·](#234-ç”Ÿæˆç§˜é’¥å·¥å…·)
                - [2.3.5 ç”Ÿæˆå•†æˆ·ç§˜é’¥](#235-ç”Ÿæˆå•†æˆ·ç§˜é’¥)
        - [2.4 æ”¯ä»˜æµç¨‹](#24-æ”¯ä»˜æµç¨‹)
    - [3. å†…ç½‘ç©¿é€](#3-å†…ç½‘ç©¿é€)
        - [3.1 ä¸Šç½‘çš„å¸¸è§„æ–¹å¼](#31-ä¸Šç½‘çš„å¸¸è§„æ–¹å¼)
        - [3.2 é¡¹ç›®å‘å¸ƒçš„å¸¸è§„æ–¹å¼](#32-é¡¹ç›®å‘å¸ƒçš„å¸¸è§„æ–¹å¼)
        - [3.3 ç°åœ¨é¢ä¸´çš„ç‰¹æ®Šæƒ…å†µ](#33-ç°åœ¨é¢ä¸´çš„ç‰¹æ®Šæƒ…å†µ)
        - [3.4 å†…ç½‘ç©¿é€](#34-å†…ç½‘ç©¿é€)
        - [3.5 å†…ç½‘ç©¿é€å·¥å…· `natapp`](#35-å†…ç½‘ç©¿é€å·¥å…·-natapp)
            - [3.5.1 ä¸‹è½½å®¢æˆ·ç«¯å·¥å…·](#351-ä¸‹è½½å®¢æˆ·ç«¯å·¥å…·)
            - [3.5.2 æ³¨å†Œè´­ä¹°éš§é“](#352-æ³¨å†Œè´­ä¹°éš§é“)
            - [3.5.3 `Mac` ç”¨æˆ·ä½¿ç”¨ `natapp`](#353-mac-ç”¨æˆ·ä½¿ç”¨-natapp)
            - [3.5.4 æµ‹è¯•](#354-æµ‹è¯•)
    - [4. æ²™ç®±ç¯å¢ƒ](#4-æ²™ç®±ç¯å¢ƒ)
        - [4.1 è¿›å…¥æ²™ç®±ç¯å¢ƒ](#41-è¿›å…¥æ²™ç®±ç¯å¢ƒ)
        - [4.2 æ²™ç®±åº”ç”¨](#42-æ²™ç®±åº”ç”¨)
        - [4.3 æ²™ç®±æµ‹è¯• APP](#43-æ²™ç®±æµ‹è¯•-app)
    - [5. ç”µè„‘ç½‘ç«™æ”¯ä»˜ Demo](#5-ç”µè„‘ç½‘ç«™æ”¯ä»˜-demo)
        - [5.1 ä¸‹è½½ Demo](#51-ä¸‹è½½-demo)
    - [6. ä½¿ç”¨ `Eclipse` å¯¼å…¥ `Demo`](#6-ä½¿ç”¨-eclipse-å¯¼å…¥-demo)
    - [7. ä½¿ç”¨ `Idea` æ‰“å¼€æ”¯ä»˜æ¡ˆä¾‹ `Demo`](#7-ä½¿ç”¨-idea-æ‰“å¼€æ”¯ä»˜æ¡ˆä¾‹-demo)
        - [7.1 é…ç½®ä¾èµ– `command + ;`](#71-é…ç½®ä¾èµ–-command--)
        - [7.2 é…ç½® `Web` å’Œ `Tamcat Server`](#72-é…ç½®-web-å’Œ-tamcat-server)
        - [7.3 ä¿®æ”¹é…ç½®æ–‡ä»¶](#73-ä¿®æ”¹é…ç½®æ–‡ä»¶)
        - [7.4 å¯åŠ¨ `Tomcat`](#74-å¯åŠ¨-tomcat)
        - [7.5 æµ‹è¯•](#75-æµ‹è¯•)

- [äºŒåä¸‰ å‰å°-è®¢å•](#äºŒåä¸‰-å‰å°-è®¢å•)
    - [1. æ­å»º `order` å¼€å‘ç¯å¢ƒ](#1-æ­å»º-order-å¼€å‘ç¯å¢ƒ)
        - [1.1 è¿½åŠ ä»£ç  `pom.xml`](#11-è¿½åŠ ä»£ç -pomxml)
        - [1.2 æ–°å»º `application.yml` é…ç½®æ–‡ä»¶](#12-æ–°å»º-applicationyml-é…ç½®æ–‡ä»¶)
        - [1.3 æ–°å»º `CrowdMainClass` ä¸»å¯åŠ¨ç±»](#13-æ–°å»º-crowdmainclass-ä¸»å¯åŠ¨ç±»)
    - [2. é…ç½® `zuul`](#2-é…ç½®-zuul)
        - [2.1 è¿½åŠ è·¯ç”±è§„åˆ™ `application.yml`](#21-è¿½åŠ è·¯ç”±è§„åˆ™-applicationyml)
    - [3. å»ºæ¨¡](#3-å»ºæ¨¡)
        - [3.1 ç»“æ„](#31-ç»“æ„)
        - [3.2 ç‰©ç†å»ºæ¨¡](#32-ç‰©ç†å»ºæ¨¡)
            - [3.2.1 è®¢å•è¡¨](#321-è®¢å•è¡¨)
            - [3.2.2 æ”¶è´§åœ°å€è¡¨](#322-æ”¶è´§åœ°å€è¡¨)
            - [3.2.3 é¡¹ç›®ä¿¡æ¯è¡¨](#323-é¡¹ç›®ä¿¡æ¯è¡¨)
    - [4. ç”Ÿæˆå®ä½“ç±», é€†å‘å·¥ç¨‹ã€reverseã€‘å·¥ç¨‹](#4-ç”Ÿæˆå®ä½“ç±»-é€†å‘å·¥ç¨‹reverseå·¥ç¨‹)
        - [4.1 è¿½åŠ é…ç½®](#41-è¿½åŠ é…ç½®)
        - [4.2 å°†ç”Ÿæˆçš„æ–‡ä»¶ç§»åŠ¨åˆ°å¯¹åº”çš„ä½ç½®](#42-å°†ç”Ÿæˆçš„æ–‡ä»¶ç§»åŠ¨åˆ°å¯¹åº”çš„ä½ç½®)
    - [5. ç›®æ ‡1: ç¡®è®¤å›æŠ¥å†…å®¹](#5-ç›®æ ‡1-ç¡®è®¤å›æŠ¥å†…å®¹)
        - [5.1 æ€è·¯](#51-æ€è·¯)
        - [5.2 æ“ä½œèµ·ç‚¹](#52-æ“ä½œèµ·ç‚¹)
        - [5.3 æ–°å»º `OrderProjectVO`](#53-æ–°å»º-orderprojectvo)
        - [5.4 æ–°å»º `OderHandler`](#54-æ–°å»º-oderhandler)
        - [5.5 è¿½åŠ æ¥å£ ã€`api` å·¥ç¨‹ã€‘](#55-è¿½åŠ æ¥å£-api-å·¥ç¨‹)
        - [5.6 å®Œæˆæ¥å£ã€`mysql` å·¥ç¨‹ã€‘](#56-å®Œæˆæ¥å£mysql-å·¥ç¨‹)
        - [5.7 é¡µé¢æ˜¾ç¤º](#57-é¡µé¢æ˜¾ç¤º)
            - [5.7.1 æ–°å»º `confirm_return.html`](#571-æ–°å»º-confirm_returnhtml)
    - [6. ç›®æ ‡2: ç¡®è®¤è®¢å•](#6-ç›®æ ‡2-ç¡®è®¤è®¢å•)
        - [6.1 æ€è·¯](#61-æ€è·¯)
        - [6.2 æ–°å»º `AddressVO`ã€`entity` å·¥ç¨‹ã€‘](#62-æ–°å»º-addressvoentity-å·¥ç¨‹)
        - [6.3 è¿½åŠ ä»£ç , Session åŸŸåˆå¹¶å›æŠ¥æ•°é‡ã€`order` å·¥ç¨‹ã€‘](#63-è¿½åŠ ä»£ç -session-åŸŸåˆå¹¶å›æŠ¥æ•°é‡order-å·¥ç¨‹)
        - [6.4 æ–°å»º confirm_order.html](#64-æ–°å»º-confirm_orderhtml)
        - [6.5 è¿½åŠ ä»£ç : è·å–ç”¨æˆ·çš„æ”¶è´§åœ°å€ã€`api` å·¥ç¨‹ã€‘](#65-è¿½åŠ ä»£ç -è·å–ç”¨æˆ·çš„æ”¶è´§åœ°å€api-å·¥ç¨‹)
        - [6.6 è¿½åŠ ä»£ç ã€`mysql` å·¥ç¨‹ã€‘](#66-è¿½åŠ ä»£ç mysql-å·¥ç¨‹)
        - [6.7 æ–°å¢æ”¶è´§åœ°å€](#67-æ–°å¢æ”¶è´§åœ°å€)
            - [6.7.1 æ€è·¯](#671-æ€è·¯)
            - [6.7.2 å‘èµ·è¯·æ±‚](#672-å‘èµ·è¯·æ±‚)
            - [6.7.3 `OrderHandler` è¿œç¨‹è°ƒç”¨æ¥å£](#673-orderhandler-è¿œç¨‹è°ƒç”¨æ¥å£)
            - [6.7.4 `OrderProviderHandler`: ä¿å­˜æ”¶è´§åœ°å€ã€`mysql` å·¥ç¨‹ã€‘](#674-orderproviderhandler-ä¿å­˜æ”¶è´§åœ°å€mysql-å·¥ç¨‹)
            - [6.7.5 å¯ç”¨æœåŠ¡ç†”æ–­æœºåˆ¶ã€`mysql` å·¥ç¨‹ã€‘](#675-å¯ç”¨æœåŠ¡ç†”æ–­æœºåˆ¶mysql-å·¥ç¨‹)
            - [6.7.6 å¯ç”¨æœåŠ¡é™çº§æœºåˆ¶](#676-å¯ç”¨æœåŠ¡é™çº§æœºåˆ¶)
    - [7. `Hystrix` æ‰©å±•](#7-hystrix-æ‰©å±•)
        - [7.1 æœåŠ¡ç†”æ–­æœºåˆ¶](#71-æœåŠ¡ç†”æ–­æœºåˆ¶)
            - [7.1.1 `MemberProviderHandler` çš„](#711-memberproviderhandler-çš„)
            - [7.1.2 `OrderProviderHandler`çš„](#712-orderproviderhandlerçš„)
            - [7.1.3 `ProjectProviderHandler` çš„](#713-projectproviderhandler-çš„)
            - [7.1.4 `redis` å·¥ç¨‹æ•´åˆ `Hystrix`](#714-redis-å·¥ç¨‹æ•´åˆ-hystrix)
        - [7.2 æœåŠ¡é™çº§æœºåˆ¶](#72-æœåŠ¡é™çº§æœºåˆ¶)
            - [7.2.1 æ–°å»º `RedisFallBackFactory`](#721-æ–°å»º-redisfallbackfactory)
            - [7.2.2 ä½¿ç”¨ `RedisFallBackFactory`](#722-ä½¿ç”¨-redisfallbackfactory)

- [äºŒåå›› å‰å°-æ”¯ä»˜](#äºŒåå››-å‰å°-æ”¯ä»˜)
    - [1. æ€è·¯](#1-æ€è·¯)
    - [2. æ“ä½œä¸€: æ­å»º `pay` å·¥ç¨‹ç¯å¢ƒ](#2-æ“ä½œä¸€-æ­å»º-pay-å·¥ç¨‹ç¯å¢ƒ)
        - [2.1 è¿½åŠ ä¾èµ–å’Œæ’ä»¶](#21-è¿½åŠ ä¾èµ–å’Œæ’ä»¶)
        - [2.2 æ–°å»º `CrowdMainClass`](#22-æ–°å»º-crowdmainclass)
        - [2.3 æ–°å»º `PayProperties`](#23-æ–°å»º-payproperties)
        - [2.4 æ–°å»º `application.yml`](#24-æ–°å»º-applicationyml)
        - [2.5 æ–°å»º `OrderVO`ã€`entity` å·¥ç¨‹ã€‘](#25-æ–°å»º-ordervoentity-å·¥ç¨‹)
        - [2.6 è¿½åŠ è·¯ç”±è§„åˆ™ã€`zuul`å·¥ç¨‹ã€‘](#26-è¿½åŠ è·¯ç”±è§„åˆ™zuulå·¥ç¨‹)
    - [3. æ“ä½œäºŒ: æäº¤è®¢å•è¡¨å•](#3-æ“ä½œäºŒ-æäº¤è®¢å•è¡¨å•)
        - [3.1 æäº¤è¡¨å• <å…³é”®ä»£ç >](#31-æäº¤è¡¨å•-å…³é”®ä»£ç )
        - [3.2 è°ƒç”¨æ”¯ä»˜æ¥å£](#32-è°ƒç”¨æ”¯ä»˜æ¥å£)
            - [3.2.1 æ–°å»º `PayHandler`](#321-æ–°å»º-payhandler)
            - [3.2.2 `out_trade_no`ï¼ˆå•†æˆ·è®¢å•å·ï¼‰å‚æ•°è¯´æ˜](#322-out_trade_noå•†æˆ·è®¢å•å·å‚æ•°è¯´æ˜)
    - [4. æ“ä½œä¸‰: `returnUrl`æ–¹æ³•](#4-æ“ä½œä¸‰-returnurlæ–¹æ³•)
        - [4.1 è¿½åŠ ä»£ç ](#41-è¿½åŠ ä»£ç )
    - [5. æ“ä½œå››: `notifyUrl`æ–¹æ³•](#5-æ“ä½œå››-notifyurlæ–¹æ³•)
        - [5.1 è¿½åŠ ä»£ç ](#51-è¿½åŠ ä»£ç )
        - [5.2 è§¦å‘é€šçŸ¥ç±»å‹](#52-è§¦å‘é€šçŸ¥ç±»å‹)
    - [6. æ“ä½œäº”: è®¢å•ä¿¡æ¯ä¿å­˜åˆ°æ•°æ®åº“](#6-æ“ä½œäº”-è®¢å•ä¿¡æ¯ä¿å­˜åˆ°æ•°æ®åº“)
        - [6.1 æ€è·¯](#61-æ€è·¯)
        - [6.2 `return` æ–¹æ³•](#62-return-æ–¹æ³•)
        - [6.3 å£°æ˜æ¥å£](#63-å£°æ˜æ¥å£)
            - [6.3.1 å¯¹åº”çš„é™çº§æœºåˆ¶](#631-å¯¹åº”çš„é™çº§æœºåˆ¶)
        - [6.4 è¿½åŠ ä»£ç ã€`mysql` å·¥ç¨‹ã€‘](#64-è¿½åŠ ä»£ç mysql-å·¥ç¨‹)




# åå…­ ä¼šå‘˜ç³»ç»Ÿ-æ­å»ºç¯å¢ƒ

## 1. å°šç­¹ç½‘ä¼šå‘˜ç³»ç»Ÿæ€»ç›®æ ‡

- æ­å»ºç¯å¢ƒ
- ä¼šå‘˜ç™»å½•æ³¨å†Œ
- å‘èµ·ä¼—ç­¹é¡¹ç›®
- å±•ç¤ºä¼—ç­¹é¡¹ç›®
- æ”¯æŒä¼—ç­¹é¡¹ç›®
- è®¢å•
- æ”¯ä»˜



## 2. ä¼šå‘˜ç³»ç»Ÿæ¶æ„

### 2.1 æ¶æ„å›¾

![img](https://cdn.nlark.com/yuque/0/2022/jpeg/12811585/1660761992125-e76f9523-8539-4e87-809f-523efdb400ba.jpeg)



### 2.2 éœ€è¦åˆ›å»ºçš„å·¥ç¨‹

| **å·¥ç¨‹**         | **å·¥ç¨‹åç§°**                                      | **ç«¯å£å·** |
| ---------------- | ------------------------------------------------- | ---------- |
| çˆ¶å·¥ç¨‹ã€èšåˆå·¥ç¨‹ | `atcrowdfunding07-member-parent`                  |            |
| æ³¨å†Œä¸­å¿ƒ         | `atcrowdfunding08-member-eureka`                  | 1000       |
| å®ä½“ç±»æ¨¡å—       | `atcrowdfunding09-member-entity`                  |            |
| MySQL æ•°æ®æœåŠ¡   | `atcrowdfunding10-member-mysql-provider`          | 2000       |
| Redis æ•°æ®æœåŠ¡   | `atcrowdfunding11-member-redis-provider`          | 3000       |
| ä¼šå‘˜ä¸­å¿ƒ         | `atcrowdfunding12-member-authentication-consumer` | 4000       |
| é¡¹ç›®ç»´æŠ¤         | `atcrowdfunding13-member-project-consumer`        | 5000       |
| è®¢å•ç»´æŠ¤         | `atcrowdfunding14-member-order-consumer`          | 7000       |
| æ”¯ä»˜åŠŸèƒ½         | `atcrowdfunding15-member-pay-consumer`            | 8000       |
| ç½‘å…³             | `atcrowdfunding16-member-zuul`                    | 80         |
| API æ¨¡å—         | `atcrowdfunding17-member-api`                     |            |



#### 2.2.1 åˆ›å»ºçˆ¶å·¥ç¨‹

- çˆ¶å·¥ç¨‹ã€èšåˆå·¥ç¨‹: `atcrowdfunding07-member-parent`(å”¯ä¸€çš„ `pom` å·¥ç¨‹)

    - `groupId`: `com.atguigu.crowd`

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1660707430789-dd0a8cba-3455-4555-bfd3-6e09c1873e07.png)

1. å¿½ç•¥æŸäº›æ–‡ä»¶

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1660707703340-661f1278-d781-4f9d-9036-6cebddd3bb89.png)

```latex
### Java template
# Compiled class file
*.class

# Log file
*.log

# BlueJ files
*.ctxt

# Mobile Tools for Java (J2ME)
.mtj.tmp/

# Package Files #
*.jar
*.war
*.nar
*.ear
*.zip
*.tar.gz
*.rar

# virtual machine crash logs, see http://www.java.com/en/download/help/error_hotspot.xml
hs_err_pid*

# IntelliJ project files
.idea
*.iml
out
gen

*/target/
.gitignore
```



1. ä¸Šä¼ åˆ° Github

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1660707610301-75ac1d1f-a18b-4b04-b631-d9508b3d7823.png)

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1660752238786-a7b567fe-f0a7-44a7-a4b6-128da88463ee.png)



1. è·å–ä»¤ç‰Œ

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1660708042836-1497af56-4f8b-43cd-b963-3fa01013619b.png)

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1660708053831-2fc3084a-fdbb-4523-8d31-90861c211974.png)

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1660708068382-832697e0-2707-449c-b4a0-6b29fc2f0fd8.png)

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1660708079398-a4ebb822-9277-4fc0-86e8-5e3096bf2623.png)



1. ä½¿ç”¨ä»¤ç‰Œ

æ­¤å¤„ä¸ºè¯­é›€åŠ å¯†æ–‡æœ¬å¡ç‰‡ï¼Œç‚¹å‡»é“¾æ¥æŸ¥çœ‹ï¼šhttps://www.yuque.com/lingchen-bf1rc/hoahc6/rkxxg5#Fpv7c

```bash
git remote set-url origin https://ä»¤ç‰Œ@github.com/ç”¨æˆ·å/atcrowdfunding07-member-parent.git
```

- ç”¨æˆ·å: [https://github.com/](https://github.com/jianglinChen191023)ç”¨æˆ·å

1. åˆ° GitHub ä¸Šåˆ›å»º `README.md` æ–‡ä»¶: `Add a README`

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1660752398366-57894d6d-ce0b-4107-9606-86ee518b0b09.png)



1. æ›´æ–°åˆ°æœ¬åœ°: `git pull`



#### 2.2.2 åˆ›å»ºå­å·¥ç¨‹æ¨¡å—

åˆ†æ”¯: `git checkout -b 16.0.0_build_environment`



- æ³¨å†Œä¸­å¿ƒ: `atcrowdfunding08-member-eureka`

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1660748801355-aa089955-2b04-4c61-bb35-ee124e0793a1.png)



- å®ä½“ç±»æ¨¡å—: `atcrowdfunding09-member-entity`

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1660749600504-abcace78-e006-4ea6-b24c-5f456a3ba6aa.png)



- MySQL æ•°æ®æœåŠ¡: `atcrowdfunding10-member-mysql-provider`

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1660749646155-51baeb1e-8d18-4ae4-82f6-fb8f83f992c6.png)



- Redis æ•°æ®æœåŠ¡: `atcrowdfunding11-member-redis-provider`

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1660749689336-fe15aac4-f87d-40a5-ba8b-33aed63ec078.png)



- ä¼šå‘˜ä¸­å¿ƒ: `atcrowdfunding12-member-authentication-consumer`

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1660749736843-deb054d8-b097-4b28-86a0-4c884c4fcd47.png)



- é¡¹ç›®ç»´æŠ¤: `atcrowdfunding13-member-project-consumer`

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1660749794116-95648241-955c-4750-a8af-c61feb4f9777.png)



- è®¢å•ç»´æŠ¤: `atcrowdfunding14-member-order-consumer`

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1660749819591-ac051a78-eedc-44fe-a28f-55f740754f71.png)



- æ”¯ä»˜åŠŸèƒ½: `atcrowdfunding15-member-pay-consumer`

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1660749894730-b5fb2891-df3a-4713-8e26-a0086f86fb39.png)



- ç½‘å…³: `atcrowdfunding16-member-zuul`

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1660760529179-834536c1-0845-4cbe-8f04-f5bde543a909.png)



- API æ¨¡å—: `atcrowdfunding17-member-api`

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1660762061884-37abcf11-b193-46aa-b3ef-9824a3abcbff.png)



#### 2.2.3 ç¡®ä¿ `github` ä¸Šé¡¹ç›®ç»“æ„çš„å®Œæ•´

- å› ä¸º `github` ä¸Šä¸èƒ½ä¿å­˜ç©ºæ–‡ä»¶å¤¹, æ‰€ä»¥è¦åœ¨é¡¹ç›®ç©ºæ–‡ä»¶å¤¹ä¸‹åˆ›å»ºæ–‡ä»¶, ç¡®ä¿ `github` ä¸Šçš„é¡¹ç›®ç»“æ„çš„å®Œæ•´

```bash
find . \( -type d -empty \) -exec touch {}/.gitxxx \;
```



#### 2.2.4 åˆ é™¤çˆ¶é¡¹ç›®ä¸‹çš„ `src` ç›®å½•



## 3. çˆ¶å·¥ç¨‹ç¯å¢ƒ

- ä¾èµ–ç®¡ç†

```xml
<!-- é…ç½®åœ¨çˆ¶å·¥ç¨‹ä¸­è¦ç®¡ç†çš„ä¾èµ– -->
<dependencyManagement>
    <dependencies>
        <!-- å¯¼å…¥ SpringCloud éœ€è¦ä½¿ç”¨çš„ä¾èµ–ä¿¡æ¯ -->
        <dependency>
            <groupId>org.springframework.cloud</groupId>
            <artifactId>spring-cloud-dependencies</artifactId>
            <version>Greenwich.SR2</version>
            <type>pom</type>
            <!-- import ä¾èµ–èŒƒå›´è¡¨ç¤ºå°† spring-cloud-dependencies åŒ…ä¸­çš„ä¾èµ–ä¿¡æ¯å¯¼å…¥ -->
            <scope>import</scope>
        </dependency>
        <!-- å¯¼å…¥ SpringBoot éœ€è¦ä½¿ç”¨çš„ä¾èµ–ä¿¡æ¯ -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-dependencies</artifactId>
            <version>2.1.6.RELEASE</version>
            <type>pom</type>
            <scope>import</scope>
        </dependency>
        <dependency>
            <groupId>org.mybatis.spring.boot</groupId>
            <artifactId>mybatis-spring-boot-starter</artifactId>
            <version>2.1.1</version>
        </dependency>
        <dependency>
            <groupId>com.alibaba</groupId>
            <artifactId>druid-spring-boot-starter</artifactId>
            <version>1.1.17</version>
        </dependency>
     </dependencies>
</dependencyManagement>
```



## 4. `Eureka` å·¥ç¨‹

### 4.1 ä¾èµ–

```xml
    <dependencies>
        <dependency>
            <groupId>org.springframework.cloud</groupId>
            <artifactId>spring-cloud-starter-netflix-eureka-server</artifactId>
        </dependency>
    </dependencies>

    <build>
        <plugins>
            <!-- è¿™ä¸ªæ’ä»¶å°† SpringBoot åº”ç”¨æ‰“åŒ…æˆä¸€ä¸ªå¯æ‰§è¡Œçš„ jar åŒ… -->
            <plugin>
                <groupId>org.springframework.boot</groupId>
                <artifactId>spring-boot-maven-plugin</artifactId>
                <executions>
                    <execution>
                        <goals>
                            <goal>repackage</goal>
                        </goals>
                    </execution>
                </executions>
            </plugin>
        </plugins>
    </build>
```



### 4.2 ä¸»å¯åŠ¨ç±»

```java
package com.atguigu.crowd;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.cloud.netflix.eureka.server.EnableEurekaServer;

/**
 * @author chenjianglin
 * @date 2022/8/18 02:05
 */
@EnableEurekaServer
@SpringBootApplication
public class CrowdMainClass {

    public static void main(String[] args) {
        SpringApplication.run(CrowdMainClass.class, args);
    }
    
}
```



### 4.3 é…ç½®

```yaml
server:
  port: 1000

spring:
  application:
    name: atguigu-crowd-eureka

eureka:
  instance:
    hostname: location
  client:
    # è‡ªå·±å°±æ˜¯æ³¨å†Œä¸­å¿ƒ, æ‰€ä»¥è‡ªå·±ä¸æ³¨å†Œè‡ªå·±
    register-with-eureka: false
    # è‡ªå·±å°±æ˜¯æ³¨å†Œä¸­å¿ƒ, æ‰€ä»¥ä¸éœ€è¦"ä»æ³¨å†Œä¸­å¿ƒå–å›ä¿¡æ¯"
    fetch-registry: false
    # å®¢æˆ·ç«¯è®¿é—® Eureka æ—¶ä½¿ç”¨çš„åœ°å€
    service-url:
      defaultZone: http://${eureka.instance.hostname}:${server.port}/eureka
```



## 5. `Entity` å·¥ç¨‹

### 5.1 å®ä½“ç±»çš„è¿›ä¸€æ­¥ç»†åˆ†

![img](https://cdn.nlark.com/yuque/0/2022/jpeg/12811585/1660763085899-37674a6e-4e2a-4634-95c3-1a37e84771bd.jpeg)

- ä½¿ç”¨ `org.springframework.beans.BeanUtils.copyProperties(Object, Object)` åœ¨ä¸åŒå®ä½“ç±»ä¹‹é—´å¤åˆ¶å±æ€§
- `MemberVO` -> å¤åˆ¶å±æ€§ -> `MemberPO`

------

#### 5.1.1 `VO`

- `View Object` è§†å›¾å¯¹è±¡

    - ç”¨é€”1: å°è£…æµè§ˆå™¨è¡¨å•æäº¤çš„æ•°æ®ä¸º `VO` å¯¹è±¡

        - **æ¥é€**æµè§ˆå™¨å‘é€è¿‡æ¥çš„æ•°æ®

    - ç”¨é€”2: åç«¯ç¨‹åºå°†æ•°æ®å°è£…ä¸º `VO` å¯¹è±¡åå‘é€åˆ°æµè§ˆå™¨æ˜¾ç¤º

        - æŠŠæ•°æ®**å‘é€**ç»™æµè§ˆå™¨å»æ˜¾ç¤º



#### 5.1.2 `PO`

- `Persistent Object` æŒä¹…åŒ–å¯¹è±¡

    - ç”¨é€”1: å°†æ•°æ®å°è£…åˆ° `PO` å¯¹è±¡å­˜å…¥æ•°æ®åº“
    - ç”¨é€”2: å°†æ•°æ®åº“æ•°æ®æŸ¥è¯¢å‡ºæ¥å­˜å…¥ `PO` å¯¹è±¡

- æ‰€ä»¥ `PO` å¯¹è±¡æ˜¯å’Œæ•°æ®åº“è¡¨å¯¹åº”, ä¸€ä¸ªæ•°æ®åº“è¡¨å¯¹åº”ä¸€ä¸ª `PO` å¯¹è±¡



#### 5.1.3 `DO`

- `Data Object` æ•°æ®å¯¹è±¡

    - ç”¨é€”1: ä» `Redis` æŸ¥è¯¢å¾—åˆ°æ•°æ®å°è£…ä¸º `DO` å¯¹è±¡
    - ç”¨é€”2: ä» `ElasticSearch` æŸ¥è¯¢å¾—åˆ°æ•°æ®å°è£…ä¸º `DO` å¯¹è±¡
    - ç”¨é€”3: ä» `Solr` æŸ¥è¯¢å¾—åˆ°æ•°æ®å°è£…ä¸º `DO` å¯¹è±¡

- ä»ä¸­é—´ä»¶æˆ–å…¶ä»–ç¬¬ä¸‰æ–¹æ¥å£æŸ¥è¯¢åˆ°çš„æ•°æ®å°è£…ä¸º `DO` å¯¹è±¡



#### 5.1.4 `DTO`

- `Data Transfer Object` æ•°æ®ä¼ è¾“å¯¹è±¡

    - ç”¨é€”1: ä» `Consumer` å‘é€æ•°æ®åˆ° `Provider`
    - ç”¨é€”2: `Provider` è¿”å›æ•°æ®ç»™ `Consumer`



### 5.2 åˆ›å»ºåŒ…

- `con.atguigu.crowd.entity.po`
- `con.atguigu.crowd.entity.vo`



### 5.3 `Lombok`

| **æ³¨è§£**              | **è¯´æ˜**                                   |
| --------------------- | ------------------------------------------ |
| `@Data`               | get set equals hashCodetoString()æ„é€ å™¨... |
| `@Setter`             |                                            |
| `@Getter`             |                                            |
| `@ToString`           |                                            |
| `@EqualsAndHashCode`  |                                            |
| `@AllArgsConstructor` | æœ‰å‚æ„é€ å™¨                                 |
| `@NoArgsConstructor`  | æ— å‚æ„é€ å™¨                                 |

- ç»„åˆä½¿ç”¨ `@Data` `@AllArgsConstructor` `@NoArgsConstructor`



#### 5.3.1 `lombok` åŸç†

- æ ¹æ®æ³¨è§£ç¡®å®šè¦ç”Ÿæˆçš„ä»£ç ï¼Œ ç„¶åå°†ç”Ÿæˆçš„ä»£ç ä¾µå…¥åˆ°å­—èŠ‚ç æ–‡ä»¶ä¸­

![img](https://cdn.nlark.com/yuque/0/2022/jpeg/12811585/1660854421832-f3271bb0-ac5a-40d7-bfbf-810af7fcbcfb.jpeg)



#### 5.3.2 `Lombok` ä¾èµ–

```xml
<dependencies>
  <dependency>
    <groupId>org.projectlombok</groupId>
    <artifactId>lombok</artifactId>
  </dependency>
</dependencies>
```



## 5. `MySQL` å·¥ç¨‹

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1660866025697-5e59e7d5-494c-4865-901d-073d7e47b115.png)

------

### 5.1 ä¾èµ–

```xml
 <dependencies>
    <!-- ä¸ºèƒ½å¤Ÿä½¿ç”¨å®ä½“ç±» -->
    <dependency>
        <groupId>com.atguigu.crowd</groupId>
        <artifactId>atcrowdfunding09-member-entity</artifactId>
        <version>1.0-SNAPSHOT</version>
    </dependency>

    <!-- ä¸ºäº†èƒ½å¤Ÿä½¿ç”¨å·¥å…·ç±» -->
    <dependency>
        <groupId>com.atguigu.crowd</groupId>
        <artifactId>atcrowdfunding05-common-util</artifactId>
        <version>1.0-SNAPSHOT</version>
    </dependency>

    <!-- æ•´åˆ MyBatis -->
    <dependency>
        <groupId>org.mybatis.spring.boot</groupId>
        <artifactId>mybatis-spring-boot-starter</artifactId>
    </dependency>

    <!-- MySQL é©±åŠ¨-->
    <dependency>
        <groupId>mysql</groupId>
        <artifactId>mysql-connector-java</artifactId>
    </dependency>

    <!-- æ•´åˆæ•°æ®åº“è¿æ¥æ±  -->
    <dependency>
        <groupId>com.alibaba</groupId>
        <artifactId>druid-spring-boot-starter</artifactId>
    </dependency>

    <!-- SpringBoot æµ‹è¯• -->
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-test</artifactId>
        <scope>test</scope>
    </dependency>
   
    <!-- å¯¹å¤–æš´éœ²æœåŠ¡ -->
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-web</artifactId>
    </dependency>

    <!-- ä½œä¸ºå®¢æˆ·ç«¯è®¿é—® Eureka æ³¨å†Œä¸­å¿ƒ -->
    <dependency>
        <groupId>org.springframework.cloud</groupId>
        <artifactId>spring-cloud-starter-netflix-eureka-client</artifactId>
    </dependency>
</dependencies>

<build>
    <plugins>
        <!-- è¿™ä¸ªæ’ä»¶å°† SpringBoot åº”ç”¨æ‰“åŒ…æˆä¸€ä¸ªå¯æ‰§è¡Œçš„ jar åŒ… -->
        <plugin>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-maven-plugin</artifactId>
            <executions>
                <execution>
                    <goals>
                        <goal>repackage</goal>
                    </goals>
                </execution>
            </executions>
        </plugin>
    </plugins>
</build>
```



### 5.2 ä¸»å¯åŠ¨ç±»

```java
package com.atguigu.crowd;

import org.mybatis.spring.annotation.MapperScan;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

/**
 * @author chenjianglin
 * @date 2022/8/19 05:02
 */
@MapperScan("com.atguigu.crowd.mapper")
@SpringBootApplication
public class CrowdMainClass {

    public static void main(String[] args) {
        SpringApplication.run(CrowdMainClass.class, args);
    }

}
```



### 5.3 é…ç½®

```yaml
server:
  port: 2000

eureka:
  client:
    service-url:
      defaultZone: http://localhost:1000/eureka

# ç”Ÿæˆçš„å…¬é’¥
public-key: MFwwDQYJKoZIhvcNAQEBBQADSwAwSAJBAMNXQuj4GCqDt+t3ex6W9u5hf50/o/JZKS6C0lKlzzUXvWHqAhJxqWoa3C2+Jp+CUtJhugMtTpeLMf5+Acokg8ECAwEAAQ==

spring:
  application:
    name: atguigu-crowd-mysql
  datasource:
    name: mydb
    driver-class-name: com.mysql.cj.jdbc.Driver
    url: jdbc:mysql://175.178.174.83:3306/project_crowd ?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC&useSSL=false
    username: root
    # ç”Ÿæˆçš„åŠ å¯†åçš„å¯†ç 
    password: lEdXTUweRH6bqzFKEy07vHkzKrziXqkHBQNwjK6FohatpabGU+2uxc73RZftE1vD3F5GDPZDhNg6vebNTNAOcA==
    # é…ç½® connection-propertiesï¼Œå¯ç”¨åŠ å¯†ï¼Œé…ç½®å…¬é’¥ã€‚
    druid:
      connection-properties: config.decrypt=true;config.decrypt.key=${public-key}
      # å¯ç”¨ConfigFilter
      filter:
        config:
          enabled: true

mybatis:
  mapper-locations: classpath*:/mybatis/mapper/*Mapper.xml
logging:
  level:
    com.atguigu.crowd.mapper: debug
    com.atguigu.crowd.test: debug
```



### 5.4 æµ‹è¯•ç±»

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1660856789891-4bd1e4c5-f0ed-497e-8f97-267a05013a8c.png)

#### 5.4.1 æµ‹è¯• `connection`

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1660862236306-3a6ca70e-f178-4e01-8ade-cce8523d43c8.png)

------

```java
package com.atguigu.crowd.test;

import org.junit.Test;
import org.junit.runner.RunWithimport org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.test.context.junit4.SpringRunner;

import javax.sql.DataSource;
import java.sql.Connection;
import java.sql.SQLException;

/**
 * @author chenjianglin
 * @date 2022/8/19 05:05
 */
@RunWith(SpringRunner.class)
@SpringBootTest
public class MyBatisTest {

    @Autowired
    private DataSource dataSource;

    private Logger logger = LoggerFactory.getLogger(MyBatisTest.class);
    
    @Test
    public void test() throws SQLException {
        Connection connection = dataSource.getConnection();
        logger.debug("connection: " + connection.toString());
    }

}
```



#### 5.4.2 æµ‹è¯• `Mapper`

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1660865495253-13248331-5fb0-482c-a1a9-1bbbb874f79e.png)

------

- `testMember` æ–¹æ³•

```java
package com.atguigu.crowd.test;

import com.atguigu.crowd.entity.po.MemberPO;
import com.atguigu.crowd.mapper.MemberPOMapper;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;
import org.springframework.test.context.junit4.SpringRunner;

import javax.sql.DataSource;
import java.sql.Connection;
import java.sql.SQLException;

/**
 * @author chenjianglin
 * @date 2022/8/19 05:05
 */
@RunWith(SpringRunner.class)
@SpringBootTest
public class MyBatisTest {

    @Autowired
    private DataSource dataSource;

    private Logger logger = LoggerFactory.getLogger(MyBatisTest.class);

    @Autowired
    private MemberPOMapper memberPOMapper;

    @Test
    public void test() throws SQLException {
        Connection connection = dataSource.getConnection();
        logger.debug("connection: " + connection.toString());
    }

    @Test
    public void testMember() {
        BCryptPasswordEncoder bCryptPasswordEncoder = new BCryptPasswordEncoder();
        String source = "123123";
        String encode = bCryptPasswordEncoder.encode(source);
        MemberPO memberPO = new MemberPO(null, "jack", encode, "æ°å…‹", "jack@qq.com", 1, 1, "æ°å…‹", "430626220104045821", 2);
        memberPOMapper.insert(memberPO);
    }

}
```

- ä½¿ç”¨ `atcrowdfunding06-common-reverse` åˆ›å»º `MemberPO`å®ä½“ç±»

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1660863785162-764b1423-8866-464d-8d7d-ca889f23ddc8.png)

- å¤åˆ¶åˆ° é¡¹ç›®ä¸­

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1660864037860-e37c0937-a893-4bab-b631-17ec5f6ff591.png)



```java
package com.atguigu.crowd.entity.po;

import lombok.AllArgsConstructor;
import lombok.Data;
import lombok.NoArgsConstructor;

@NoArgsConstructor
@AllArgsConstructor
@Data
public class MemberPO {
    private Integer id;

    private String loginacct;

    private String userpswd;

    private String username;

    private String email;

    private Integer authstatus;

    private Integer usertype;

    private String realname;

    private String cardnum;

    private Integer accttype;
}
package com.atguigu.crowd.entity.po;

import java.util.ArrayList;
import java.util.List;

public class MemberPOExample {
    protected String orderByClause;

    protected boolean distinct;

    protected List<Criteria> oredCriteria;

    public MemberPOExample() {
        oredCriteria = new ArrayList<Criteria>();
    }

    public void setOrderByClause(String orderByClause) {
        this.orderByClause = orderByClause;
    }

    public String getOrderByClause() {
        return orderByClause;
    }

    public void setDistinct(boolean distinct) {
        this.distinct = distinct;
    }

    public boolean isDistinct() {
        return distinct;
    }

    public List<Criteria> getOredCriteria() {
        return oredCriteria;
    }

    public void or(Criteria criteria) {
        oredCriteria.add(criteria);
    }

    public Criteria or() {
        Criteria criteria = createCriteriaInternal();
        oredCriteria.add(criteria);
        return criteria;
    }

    public Criteria createCriteria() {
        Criteria criteria = createCriteriaInternal();
        if (oredCriteria.size() == 0) {
            oredCriteria.add(criteria);
        }
        return criteria;
    }

    protected Criteria createCriteriaInternal() {
        Criteria criteria = new Criteria();
        return criteria;
    }

    public void clear() {
        oredCriteria.clear();
        orderByClause = null;
        distinct = false;
    }

    protected abstract static class GeneratedCriteria {
        protected List<Criterion> criteria;

        protected GeneratedCriteria() {
            super();
            criteria = new ArrayList<Criterion>();
        }

        public boolean isValid() {
            return criteria.size() > 0;
        }

        public List<Criterion> getAllCriteria() {
            return criteria;
        }

        public List<Criterion> getCriteria() {
            return criteria;
        }

        protected void addCriterion(String condition) {
            if (condition == null) {
                throw new RuntimeException("Value for condition cannot be null");
            }
            criteria.add(new Criterion(condition));
        }

        protected void addCriterion(String condition, Object value, String property) {
            if (value == null) {
                throw new RuntimeException("Value for " + property + " cannot be null");
            }
            criteria.add(new Criterion(condition, value));
        }

        protected void addCriterion(String condition, Object value1, Object value2, String property) {
            if (value1 == null || value2 == null) {
                throw new RuntimeException("Between values for " + property + " cannot be null");
            }
            criteria.add(new Criterion(condition, value1, value2));
        }

        public Criteria andIdIsNull() {
            addCriterion("id is null");
            return (Criteria) this;
        }

        public Criteria andIdIsNotNull() {
            addCriterion("id is not null");
            return (Criteria) this;
        }

        public Criteria andIdEqualTo(Integer value) {
            addCriterion("id =", value, "id");
            return (Criteria) this;
        }

        public Criteria andIdNotEqualTo(Integer value) {
            addCriterion("id <>", value, "id");
            return (Criteria) this;
        }

        public Criteria andIdGreaterThan(Integer value) {
            addCriterion("id >", value, "id");
            return (Criteria) this;
        }

        public Criteria andIdGreaterThanOrEqualTo(Integer value) {
            addCriterion("id >=", value, "id");
            return (Criteria) this;
        }

        public Criteria andIdLessThan(Integer value) {
            addCriterion("id <", value, "id");
            return (Criteria) this;
        }

        public Criteria andIdLessThanOrEqualTo(Integer value) {
            addCriterion("id <=", value, "id");
            return (Criteria) this;
        }

        public Criteria andIdIn(List<Integer> values) {
            addCriterion("id in", values, "id");
            return (Criteria) this;
        }

        public Criteria andIdNotIn(List<Integer> values) {
            addCriterion("id not in", values, "id");
            return (Criteria) this;
        }

        public Criteria andIdBetween(Integer value1, Integer value2) {
            addCriterion("id between", value1, value2, "id");
            return (Criteria) this;
        }

        public Criteria andIdNotBetween(Integer value1, Integer value2) {
            addCriterion("id not between", value1, value2, "id");
            return (Criteria) this;
        }

        public Criteria andLoginacctIsNull() {
            addCriterion("loginacct is null");
            return (Criteria) this;
        }

        public Criteria andLoginacctIsNotNull() {
            addCriterion("loginacct is not null");
            return (Criteria) this;
        }

        public Criteria andLoginacctEqualTo(String value) {
            addCriterion("loginacct =", value, "loginacct");
            return (Criteria) this;
        }

        public Criteria andLoginacctNotEqualTo(String value) {
            addCriterion("loginacct <>", value, "loginacct");
            return (Criteria) this;
        }

        public Criteria andLoginacctGreaterThan(String value) {
            addCriterion("loginacct >", value, "loginacct");
            return (Criteria) this;
        }

        public Criteria andLoginacctGreaterThanOrEqualTo(String value) {
            addCriterion("loginacct >=", value, "loginacct");
            return (Criteria) this;
        }

        public Criteria andLoginacctLessThan(String value) {
            addCriterion("loginacct <", value, "loginacct");
            return (Criteria) this;
        }

        public Criteria andLoginacctLessThanOrEqualTo(String value) {
            addCriterion("loginacct <=", value, "loginacct");
            return (Criteria) this;
        }

        public Criteria andLoginacctLike(String value) {
            addCriterion("loginacct like", value, "loginacct");
            return (Criteria) this;
        }

        public Criteria andLoginacctNotLike(String value) {
            addCriterion("loginacct not like", value, "loginacct");
            return (Criteria) this;
        }

        public Criteria andLoginacctIn(List<String> values) {
            addCriterion("loginacct in", values, "loginacct");
            return (Criteria) this;
        }

        public Criteria andLoginacctNotIn(List<String> values) {
            addCriterion("loginacct not in", values, "loginacct");
            return (Criteria) this;
        }

        public Criteria andLoginacctBetween(String value1, String value2) {
            addCriterion("loginacct between", value1, value2, "loginacct");
            return (Criteria) this;
        }

        public Criteria andLoginacctNotBetween(String value1, String value2) {
            addCriterion("loginacct not between", value1, value2, "loginacct");
            return (Criteria) this;
        }

        public Criteria andUserpswdIsNull() {
            addCriterion("userpswd is null");
            return (Criteria) this;
        }

        public Criteria andUserpswdIsNotNull() {
            addCriterion("userpswd is not null");
            return (Criteria) this;
        }

        public Criteria andUserpswdEqualTo(String value) {
            addCriterion("userpswd =", value, "userpswd");
            return (Criteria) this;
        }

        public Criteria andUserpswdNotEqualTo(String value) {
            addCriterion("userpswd <>", value, "userpswd");
            return (Criteria) this;
        }

        public Criteria andUserpswdGreaterThan(String value) {
            addCriterion("userpswd >", value, "userpswd");
            return (Criteria) this;
        }

        public Criteria andUserpswdGreaterThanOrEqualTo(String value) {
            addCriterion("userpswd >=", value, "userpswd");
            return (Criteria) this;
        }

        public Criteria andUserpswdLessThan(String value) {
            addCriterion("userpswd <", value, "userpswd");
            return (Criteria) this;
        }

        public Criteria andUserpswdLessThanOrEqualTo(String value) {
            addCriterion("userpswd <=", value, "userpswd");
            return (Criteria) this;
        }

        public Criteria andUserpswdLike(String value) {
            addCriterion("userpswd like", value, "userpswd");
            return (Criteria) this;
        }

        public Criteria andUserpswdNotLike(String value) {
            addCriterion("userpswd not like", value, "userpswd");
            return (Criteria) this;
        }

        public Criteria andUserpswdIn(List<String> values) {
            addCriterion("userpswd in", values, "userpswd");
            return (Criteria) this;
        }

        public Criteria andUserpswdNotIn(List<String> values) {
            addCriterion("userpswd not in", values, "userpswd");
            return (Criteria) this;
        }

        public Criteria andUserpswdBetween(String value1, String value2) {
            addCriterion("userpswd between", value1, value2, "userpswd");
            return (Criteria) this;
        }

        public Criteria andUserpswdNotBetween(String value1, String value2) {
            addCriterion("userpswd not between", value1, value2, "userpswd");
            return (Criteria) this;
        }

        public Criteria andUsernameIsNull() {
            addCriterion("username is null");
            return (Criteria) this;
        }

        public Criteria andUsernameIsNotNull() {
            addCriterion("username is not null");
            return (Criteria) this;
        }

        public Criteria andUsernameEqualTo(String value) {
            addCriterion("username =", value, "username");
            return (Criteria) this;
        }

        public Criteria andUsernameNotEqualTo(String value) {
            addCriterion("username <>", value, "username");
            return (Criteria) this;
        }

        public Criteria andUsernameGreaterThan(String value) {
            addCriterion("username >", value, "username");
            return (Criteria) this;
        }

        public Criteria andUsernameGreaterThanOrEqualTo(String value) {
            addCriterion("username >=", value, "username");
            return (Criteria) this;
        }

        public Criteria andUsernameLessThan(String value) {
            addCriterion("username <", value, "username");
            return (Criteria) this;
        }

        public Criteria andUsernameLessThanOrEqualTo(String value) {
            addCriterion("username <=", value, "username");
            return (Criteria) this;
        }

        public Criteria andUsernameLike(String value) {
            addCriterion("username like", value, "username");
            return (Criteria) this;
        }

        public Criteria andUsernameNotLike(String value) {
            addCriterion("username not like", value, "username");
            return (Criteria) this;
        }

        public Criteria andUsernameIn(List<String> values) {
            addCriterion("username in", values, "username");
            return (Criteria) this;
        }

        public Criteria andUsernameNotIn(List<String> values) {
            addCriterion("username not in", values, "username");
            return (Criteria) this;
        }

        public Criteria andUsernameBetween(String value1, String value2) {
            addCriterion("username between", value1, value2, "username");
            return (Criteria) this;
        }

        public Criteria andUsernameNotBetween(String value1, String value2) {
            addCriterion("username not between", value1, value2, "username");
            return (Criteria) this;
        }

        public Criteria andEmailIsNull() {
            addCriterion("email is null");
            return (Criteria) this;
        }

        public Criteria andEmailIsNotNull() {
            addCriterion("email is not null");
            return (Criteria) this;
        }

        public Criteria andEmailEqualTo(String value) {
            addCriterion("email =", value, "email");
            return (Criteria) this;
        }

        public Criteria andEmailNotEqualTo(String value) {
            addCriterion("email <>", value, "email");
            return (Criteria) this;
        }

        public Criteria andEmailGreaterThan(String value) {
            addCriterion("email >", value, "email");
            return (Criteria) this;
        }

        public Criteria andEmailGreaterThanOrEqualTo(String value) {
            addCriterion("email >=", value, "email");
            return (Criteria) this;
        }

        public Criteria andEmailLessThan(String value) {
            addCriterion("email <", value, "email");
            return (Criteria) this;
        }

        public Criteria andEmailLessThanOrEqualTo(String value) {
            addCriterion("email <=", value, "email");
            return (Criteria) this;
        }

        public Criteria andEmailLike(String value) {
            addCriterion("email like", value, "email");
            return (Criteria) this;
        }

        public Criteria andEmailNotLike(String value) {
            addCriterion("email not like", value, "email");
            return (Criteria) this;
        }

        public Criteria andEmailIn(List<String> values) {
            addCriterion("email in", values, "email");
            return (Criteria) this;
        }

        public Criteria andEmailNotIn(List<String> values) {
            addCriterion("email not in", values, "email");
            return (Criteria) this;
        }

        public Criteria andEmailBetween(String value1, String value2) {
            addCriterion("email between", value1, value2, "email");
            return (Criteria) this;
        }

        public Criteria andEmailNotBetween(String value1, String value2) {
            addCriterion("email not between", value1, value2, "email");
            return (Criteria) this;
        }

        public Criteria andAuthstatusIsNull() {
            addCriterion("authstatus is null");
            return (Criteria) this;
        }

        public Criteria andAuthstatusIsNotNull() {
            addCriterion("authstatus is not null");
            return (Criteria) this;
        }

        public Criteria andAuthstatusEqualTo(Integer value) {
            addCriterion("authstatus =", value, "authstatus");
            return (Criteria) this;
        }

        public Criteria andAuthstatusNotEqualTo(Integer value) {
            addCriterion("authstatus <>", value, "authstatus");
            return (Criteria) this;
        }

        public Criteria andAuthstatusGreaterThan(Integer value) {
            addCriterion("authstatus >", value, "authstatus");
            return (Criteria) this;
        }

        public Criteria andAuthstatusGreaterThanOrEqualTo(Integer value) {
            addCriterion("authstatus >=", value, "authstatus");
            return (Criteria) this;
        }

        public Criteria andAuthstatusLessThan(Integer value) {
            addCriterion("authstatus <", value, "authstatus");
            return (Criteria) this;
        }

        public Criteria andAuthstatusLessThanOrEqualTo(Integer value) {
            addCriterion("authstatus <=", value, "authstatus");
            return (Criteria) this;
        }

        public Criteria andAuthstatusIn(List<Integer> values) {
            addCriterion("authstatus in", values, "authstatus");
            return (Criteria) this;
        }

        public Criteria andAuthstatusNotIn(List<Integer> values) {
            addCriterion("authstatus not in", values, "authstatus");
            return (Criteria) this;
        }

        public Criteria andAuthstatusBetween(Integer value1, Integer value2) {
            addCriterion("authstatus between", value1, value2, "authstatus");
            return (Criteria) this;
        }

        public Criteria andAuthstatusNotBetween(Integer value1, Integer value2) {
            addCriterion("authstatus not between", value1, value2, "authstatus");
            return (Criteria) this;
        }

        public Criteria andUsertypeIsNull() {
            addCriterion("usertype is null");
            return (Criteria) this;
        }

        public Criteria andUsertypeIsNotNull() {
            addCriterion("usertype is not null");
            return (Criteria) this;
        }

        public Criteria andUsertypeEqualTo(Integer value) {
            addCriterion("usertype =", value, "usertype");
            return (Criteria) this;
        }

        public Criteria andUsertypeNotEqualTo(Integer value) {
            addCriterion("usertype <>", value, "usertype");
            return (Criteria) this;
        }

        public Criteria andUsertypeGreaterThan(Integer value) {
            addCriterion("usertype >", value, "usertype");
            return (Criteria) this;
        }

        public Criteria andUsertypeGreaterThanOrEqualTo(Integer value) {
            addCriterion("usertype >=", value, "usertype");
            return (Criteria) this;
        }

        public Criteria andUsertypeLessThan(Integer value) {
            addCriterion("usertype <", value, "usertype");
            return (Criteria) this;
        }

        public Criteria andUsertypeLessThanOrEqualTo(Integer value) {
            addCriterion("usertype <=", value, "usertype");
            return (Criteria) this;
        }

        public Criteria andUsertypeIn(List<Integer> values) {
            addCriterion("usertype in", values, "usertype");
            return (Criteria) this;
        }

        public Criteria andUsertypeNotIn(List<Integer> values) {
            addCriterion("usertype not in", values, "usertype");
            return (Criteria) this;
        }

        public Criteria andUsertypeBetween(Integer value1, Integer value2) {
            addCriterion("usertype between", value1, value2, "usertype");
            return (Criteria) this;
        }

        public Criteria andUsertypeNotBetween(Integer value1, Integer value2) {
            addCriterion("usertype not between", value1, value2, "usertype");
            return (Criteria) this;
        }

        public Criteria andRealnameIsNull() {
            addCriterion("realname is null");
            return (Criteria) this;
        }

        public Criteria andRealnameIsNotNull() {
            addCriterion("realname is not null");
            return (Criteria) this;
        }

        public Criteria andRealnameEqualTo(String value) {
            addCriterion("realname =", value, "realname");
            return (Criteria) this;
        }

        public Criteria andRealnameNotEqualTo(String value) {
            addCriterion("realname <>", value, "realname");
            return (Criteria) this;
        }

        public Criteria andRealnameGreaterThan(String value) {
            addCriterion("realname >", value, "realname");
            return (Criteria) this;
        }

        public Criteria andRealnameGreaterThanOrEqualTo(String value) {
            addCriterion("realname >=", value, "realname");
            return (Criteria) this;
        }

        public Criteria andRealnameLessThan(String value) {
            addCriterion("realname <", value, "realname");
            return (Criteria) this;
        }

        public Criteria andRealnameLessThanOrEqualTo(String value) {
            addCriterion("realname <=", value, "realname");
            return (Criteria) this;
        }

        public Criteria andRealnameLike(String value) {
            addCriterion("realname like", value, "realname");
            return (Criteria) this;
        }

        public Criteria andRealnameNotLike(String value) {
            addCriterion("realname not like", value, "realname");
            return (Criteria) this;
        }

        public Criteria andRealnameIn(List<String> values) {
            addCriterion("realname in", values, "realname");
            return (Criteria) this;
        }

        public Criteria andRealnameNotIn(List<String> values) {
            addCriterion("realname not in", values, "realname");
            return (Criteria) this;
        }

        public Criteria andRealnameBetween(String value1, String value2) {
            addCriterion("realname between", value1, value2, "realname");
            return (Criteria) this;
        }

        public Criteria andRealnameNotBetween(String value1, String value2) {
            addCriterion("realname not between", value1, value2, "realname");
            return (Criteria) this;
        }

        public Criteria andCardnumIsNull() {
            addCriterion("cardnum is null");
            return (Criteria) this;
        }

        public Criteria andCardnumIsNotNull() {
            addCriterion("cardnum is not null");
            return (Criteria) this;
        }

        public Criteria andCardnumEqualTo(String value) {
            addCriterion("cardnum =", value, "cardnum");
            return (Criteria) this;
        }

        public Criteria andCardnumNotEqualTo(String value) {
            addCriterion("cardnum <>", value, "cardnum");
            return (Criteria) this;
        }

        public Criteria andCardnumGreaterThan(String value) {
            addCriterion("cardnum >", value, "cardnum");
            return (Criteria) this;
        }

        public Criteria andCardnumGreaterThanOrEqualTo(String value) {
            addCriterion("cardnum >=", value, "cardnum");
            return (Criteria) this;
        }

        public Criteria andCardnumLessThan(String value) {
            addCriterion("cardnum <", value, "cardnum");
            return (Criteria) this;
        }

        public Criteria andCardnumLessThanOrEqualTo(String value) {
            addCriterion("cardnum <=", value, "cardnum");
            return (Criteria) this;
        }

        public Criteria andCardnumLike(String value) {
            addCriterion("cardnum like", value, "cardnum");
            return (Criteria) this;
        }

        public Criteria andCardnumNotLike(String value) {
            addCriterion("cardnum not like", value, "cardnum");
            return (Criteria) this;
        }

        public Criteria andCardnumIn(List<String> values) {
            addCriterion("cardnum in", values, "cardnum");
            return (Criteria) this;
        }

        public Criteria andCardnumNotIn(List<String> values) {
            addCriterion("cardnum not in", values, "cardnum");
            return (Criteria) this;
        }

        public Criteria andCardnumBetween(String value1, String value2) {
            addCriterion("cardnum between", value1, value2, "cardnum");
            return (Criteria) this;
        }

        public Criteria andCardnumNotBetween(String value1, String value2) {
            addCriterion("cardnum not between", value1, value2, "cardnum");
            return (Criteria) this;
        }

        public Criteria andAccttypeIsNull() {
            addCriterion("accttype is null");
            return (Criteria) this;
        }

        public Criteria andAccttypeIsNotNull() {
            addCriterion("accttype is not null");
            return (Criteria) this;
        }

        public Criteria andAccttypeEqualTo(Integer value) {
            addCriterion("accttype =", value, "accttype");
            return (Criteria) this;
        }

        public Criteria andAccttypeNotEqualTo(Integer value) {
            addCriterion("accttype <>", value, "accttype");
            return (Criteria) this;
        }

        public Criteria andAccttypeGreaterThan(Integer value) {
            addCriterion("accttype >", value, "accttype");
            return (Criteria) this;
        }

        public Criteria andAccttypeGreaterThanOrEqualTo(Integer value) {
            addCriterion("accttype >=", value, "accttype");
            return (Criteria) this;
        }

        public Criteria andAccttypeLessThan(Integer value) {
            addCriterion("accttype <", value, "accttype");
            return (Criteria) this;
        }

        public Criteria andAccttypeLessThanOrEqualTo(Integer value) {
            addCriterion("accttype <=", value, "accttype");
            return (Criteria) this;
        }

        public Criteria andAccttypeIn(List<Integer> values) {
            addCriterion("accttype in", values, "accttype");
            return (Criteria) this;
        }

        public Criteria andAccttypeNotIn(List<Integer> values) {
            addCriterion("accttype not in", values, "accttype");
            return (Criteria) this;
        }

        public Criteria andAccttypeBetween(Integer value1, Integer value2) {
            addCriterion("accttype between", value1, value2, "accttype");
            return (Criteria) this;
        }

        public Criteria andAccttypeNotBetween(Integer value1, Integer value2) {
            addCriterion("accttype not between", value1, value2, "accttype");
            return (Criteria) this;
        }
    }

    public static class Criteria extends GeneratedCriteria {

        protected Criteria() {
            super();
        }
    }

    public static class Criterion {
        private String condition;

        private Object value;

        private Object secondValue;

        private boolean noValue;

        private boolean singleValue;

        private boolean betweenValue;

        private boolean listValue;

        private String typeHandler;

        public String getCondition() {
            return condition;
        }

        public Object getValue() {
            return value;
        }

        public Object getSecondValue() {
            return secondValue;
        }

        public boolean isNoValue() {
            return noValue;
        }

        public boolean isSingleValue() {
            return singleValue;
        }

        public boolean isBetweenValue() {
            return betweenValue;
        }

        public boolean isListValue() {
            return listValue;
        }

        public String getTypeHandler() {
            return typeHandler;
        }

        protected Criterion(String condition) {
            super();
            this.condition = condition;
            this.typeHandler = null;
            this.noValue = true;
        }

        protected Criterion(String condition, Object value, String typeHandler) {
            super();
            this.condition = condition;
            this.value = value;
            this.typeHandler = typeHandler;
            if (value instanceof List<?>) {
                this.listValue = true;
            } else {
                this.singleValue = true;
            }
        }

        protected Criterion(String condition, Object value) {
            this(condition, value, null);
        }

        protected Criterion(String condition, Object value, Object secondValue, String typeHandler) {
            super();
            this.condition = condition;
            this.value = value;
            this.secondValue = secondValue;
            this.typeHandler = typeHandler;
            this.betweenValue = true;
        }

        protected Criterion(String condition, Object value, Object secondValue) {
            this(condition, value, secondValue, null);
        }
    }
}
```



![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1660864374028-937103e0-8bf3-491d-9ef4-b5f55a61c046.png)

```java
package com.atguigu.crowd.mapper;

import com.atguigu.crowd.entity.po.MemberPO;
import com.atguigu.crowd.entity.po.MemberPOExample;
import org.apache.ibatis.annotations.Param;

import java.util.List;

public interface MemberPOMapper {
    int countByExample(MemberPOExample example);

    int deleteByExample(MemberPOExample example);

    int deleteByPrimaryKey(Integer id);

    int insert(MemberPO record);

    int insertSelective(MemberPO record);

    List<MemberPO> selectByExample(MemberPOExample example);

    MemberPO selectByPrimaryKey(Integer id);

    int updateByExampleSelective(@Param("record") MemberPO record, @Param("example") MemberPOExample example);

    int updateByExample(@Param("record") MemberPO record, @Param("example") MemberPOExample example);

    int updateByPrimaryKeySelective(MemberPO record);

    int updateByPrimaryKey(MemberPO record);
}
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.atguigu.crowd.mapper.MemberPOMapper" >
  <resultMap id="BaseResultMap" type="com.atguigu.crowd.entity.po.MemberPO" >
    <id column="id" property="id" jdbcType="INTEGER" />
    <result column="loginacct" property="loginacct" jdbcType="VARCHAR" />
    <result column="userpswd" property="userpswd" jdbcType="VARCHAR" />
    <result column="username" property="username" jdbcType="VARCHAR" />
    <result column="email" property="email" jdbcType="VARCHAR" />
    <result column="authstatus" property="authstatus" jdbcType="INTEGER" />
    <result column="usertype" property="usertype" jdbcType="INTEGER" />
    <result column="realname" property="realname" jdbcType="VARCHAR" />
    <result column="cardnum" property="cardnum" jdbcType="VARCHAR" />
    <result column="accttype" property="accttype" jdbcType="INTEGER" />
  </resultMap>
  <sql id="Example_Where_Clause" >
    <where >
      <foreach collection="oredCriteria" item="criteria" separator="or" >
        <if test="criteria.valid" >
          <trim prefix="(" suffix=")" prefixOverrides="and" >
            <foreach collection="criteria.criteria" item="criterion" >
              <choose >
                <when test="criterion.noValue" >
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue" >
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue" >
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue" >
                  and ${criterion.condition}
                  <foreach collection="criterion.value" item="listItem" open="(" close=")" separator="," >
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Update_By_Example_Where_Clause" >
    <where >
      <foreach collection="example.oredCriteria" item="criteria" separator="or" >
        <if test="criteria.valid" >
          <trim prefix="(" suffix=")" prefixOverrides="and" >
            <foreach collection="criteria.criteria" item="criterion" >
              <choose >
                <when test="criterion.noValue" >
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue" >
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue" >
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue" >
                  and ${criterion.condition}
                  <foreach collection="criterion.value" item="listItem" open="(" close=")" separator="," >
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Base_Column_List" >
    id, loginacct, userpswd, username, email, authstatus, usertype, realname, cardnum, 
    accttype
  </sql>
  <select id="selectByExample" resultMap="BaseResultMap" parameterType="com.atguigu.crowd.entity.po.MemberPOExample" >
    select
    <if test="distinct" >
      distinct
    </if>
    <include refid="Base_Column_List" />
    from t_member
    <if test="_parameter != null" >
      <include refid="Example_Where_Clause" />
    </if>
    <if test="orderByClause != null" >
      order by ${orderByClause}
    </if>
  </select>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Integer" >
    select 
    <include refid="Base_Column_List" />
    from t_member
    where id = #{id,jdbcType=INTEGER}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer" >
    delete from t_member
    where id = #{id,jdbcType=INTEGER}
  </delete>
  <delete id="deleteByExample" parameterType="com.atguigu.crowd.entity.po.MemberPOExample" >
    delete from t_member
    <if test="_parameter != null" >
      <include refid="Example_Where_Clause" />
    </if>
  </delete>
  <insert id="insert" parameterType="com.atguigu.crowd.entity.po.MemberPO" >
    insert into t_member (id, loginacct, userpswd, 
      username, email, authstatus, 
      usertype, realname, cardnum, 
      accttype)
    values (#{id,jdbcType=INTEGER}, #{loginacct,jdbcType=VARCHAR}, #{userpswd,jdbcType=VARCHAR}, 
      #{username,jdbcType=VARCHAR}, #{email,jdbcType=VARCHAR}, #{authstatus,jdbcType=INTEGER}, 
      #{usertype,jdbcType=INTEGER}, #{realname,jdbcType=VARCHAR}, #{cardnum,jdbcType=VARCHAR}, 
      #{accttype,jdbcType=INTEGER})
  </insert>
  <insert id="insertSelective" parameterType="com.atguigu.crowd.entity.po.MemberPO" >
    insert into t_member
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        id,
      </if>
      <if test="loginacct != null" >
        loginacct,
      </if>
      <if test="userpswd != null" >
        userpswd,
      </if>
      <if test="username != null" >
        username,
      </if>
      <if test="email != null" >
        email,
      </if>
      <if test="authstatus != null" >
        authstatus,
      </if>
      <if test="usertype != null" >
        usertype,
      </if>
      <if test="realname != null" >
        realname,
      </if>
      <if test="cardnum != null" >
        cardnum,
      </if>
      <if test="accttype != null" >
        accttype,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        #{id,jdbcType=INTEGER},
      </if>
      <if test="loginacct != null" >
        #{loginacct,jdbcType=VARCHAR},
      </if>
      <if test="userpswd != null" >
        #{userpswd,jdbcType=VARCHAR},
      </if>
      <if test="username != null" >
        #{username,jdbcType=VARCHAR},
      </if>
      <if test="email != null" >
        #{email,jdbcType=VARCHAR},
      </if>
      <if test="authstatus != null" >
        #{authstatus,jdbcType=INTEGER},
      </if>
      <if test="usertype != null" >
        #{usertype,jdbcType=INTEGER},
      </if>
      <if test="realname != null" >
        #{realname,jdbcType=VARCHAR},
      </if>
      <if test="cardnum != null" >
        #{cardnum,jdbcType=VARCHAR},
      </if>
      <if test="accttype != null" >
        #{accttype,jdbcType=INTEGER},
      </if>
    </trim>
  </insert>
  <select id="countByExample" parameterType="com.atguigu.crowd.entity.po.MemberPOExample" resultType="java.lang.Integer" >
    select count(*) from t_member
    <if test="_parameter != null" >
      <include refid="Example_Where_Clause" />
    </if>
  </select>
  <update id="updateByExampleSelective" parameterType="map" >
    update t_member
    <set >
      <if test="record.id != null" >
        id = #{record.id,jdbcType=INTEGER},
      </if>
      <if test="record.loginacct != null" >
        loginacct = #{record.loginacct,jdbcType=VARCHAR},
      </if>
      <if test="record.userpswd != null" >
        userpswd = #{record.userpswd,jdbcType=VARCHAR},
      </if>
      <if test="record.username != null" >
        username = #{record.username,jdbcType=VARCHAR},
      </if>
      <if test="record.email != null" >
        email = #{record.email,jdbcType=VARCHAR},
      </if>
      <if test="record.authstatus != null" >
        authstatus = #{record.authstatus,jdbcType=INTEGER},
      </if>
      <if test="record.usertype != null" >
        usertype = #{record.usertype,jdbcType=INTEGER},
      </if>
      <if test="record.realname != null" >
        realname = #{record.realname,jdbcType=VARCHAR},
      </if>
      <if test="record.cardnum != null" >
        cardnum = #{record.cardnum,jdbcType=VARCHAR},
      </if>
      <if test="record.accttype != null" >
        accttype = #{record.accttype,jdbcType=INTEGER},
      </if>
    </set>
    <if test="_parameter != null" >
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <update id="updateByExample" parameterType="map" >
    update t_member
    set id = #{record.id,jdbcType=INTEGER},
      loginacct = #{record.loginacct,jdbcType=VARCHAR},
      userpswd = #{record.userpswd,jdbcType=VARCHAR},
      username = #{record.username,jdbcType=VARCHAR},
      email = #{record.email,jdbcType=VARCHAR},
      authstatus = #{record.authstatus,jdbcType=INTEGER},
      usertype = #{record.usertype,jdbcType=INTEGER},
      realname = #{record.realname,jdbcType=VARCHAR},
      cardnum = #{record.cardnum,jdbcType=VARCHAR},
      accttype = #{record.accttype,jdbcType=INTEGER}
    <if test="_parameter != null" >
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <update id="updateByPrimaryKeySelective" parameterType="com.atguigu.crowd.entity.po.MemberPO" >
    update t_member
    <set >
      <if test="loginacct != null" >
        loginacct = #{loginacct,jdbcType=VARCHAR},
      </if>
      <if test="userpswd != null" >
        userpswd = #{userpswd,jdbcType=VARCHAR},
      </if>
      <if test="username != null" >
        username = #{username,jdbcType=VARCHAR},
      </if>
      <if test="email != null" >
        email = #{email,jdbcType=VARCHAR},
      </if>
      <if test="authstatus != null" >
        authstatus = #{authstatus,jdbcType=INTEGER},
      </if>
      <if test="usertype != null" >
        usertype = #{usertype,jdbcType=INTEGER},
      </if>
      <if test="realname != null" >
        realname = #{realname,jdbcType=VARCHAR},
      </if>
      <if test="cardnum != null" >
        cardnum = #{cardnum,jdbcType=VARCHAR},
      </if>
      <if test="accttype != null" >
        accttype = #{accttype,jdbcType=INTEGER},
      </if>
    </set>
    where id = #{id,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.atguigu.crowd.entity.po.MemberPO" >
    update t_member
    set loginacct = #{loginacct,jdbcType=VARCHAR},
      userpswd = #{userpswd,jdbcType=VARCHAR},
      username = #{username,jdbcType=VARCHAR},
      email = #{email,jdbcType=VARCHAR},
      authstatus = #{authstatus,jdbcType=INTEGER},
      usertype = #{usertype,jdbcType=INTEGER},
      realname = #{realname,jdbcType=VARCHAR},
      cardnum = #{cardnum,jdbcType=VARCHAR},
      accttype = #{accttype,jdbcType=INTEGER}
    where id = #{id,jdbcType=INTEGER}
  </update>
</mapper>
```



## 6. `Api` å·¥ç¨‹

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1660873057527-e33e6a90-37b3-4e46-96c7-df60ed3138fe.png)

------

### 6.1 ä¾èµ–

```xml
<dependencies>
    <dependency>
        <groupId>com.atguigu.crowd</groupId>
        <artifactId>atcrowdfunding05-common-util</artifactId>
        <version>1.0-SNAPSHOT</version>
    </dependency>
    <dependency>
        <groupId>com.atguigu.crowd</groupId>
        <artifactId>atcrowdfunding09-member-entity</artifactId>
        <version>1.0-SNAPSHOT</version>
    </dependency>
    <dependency>
        <groupId>org.springframework.cloud</groupId>
        <artifactId>spring-cloud-starter-openfeign</artifactId>
    </dependency>
</dependencies>
```



### 6.2 æ¥å£

```java
package com.atguigu.crowd.api;

import com.atguigu.crowd.entity.po.MemberPO;
import com.atguigu.crowd.util.ResultEntity;
import org.springframework.cloud.openfeign.FeignClient;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;

/**
 * @author chenjianglin
 * @date 2022/8/19 09:05
 */
@FeignClient("atguigu-crowd-mysql")
public interface MySQLRemoteService {

    /**
     * æ ¹æ®è´¦å·æŸ¥è¯¢
     * 
     * @param loginacc è´¦å·
     * @return
     */
    @RequestMapping("/get/memberpo/login/acct/remote")
    ResultEntity<MemberPO> getMemberPOByLoginAcctRemote(@RequestParam("loginacc") String loginacc);

}
```



### 6.3 `MySQL`å·¥ç¨‹å¯¹å¤–æš´éœ²æœåŠ¡

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1660874434538-669f0b42-a24d-4844-8b9a-0ab06d2df13d.png)

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1660872968226-313cbd18-aebb-4ca0-becc-7fdcaebd4f4c.png)

------

#### 6.3.1 `Hnadler` ä»£ç 

```java
package com.atguigu.crowd.handler;

import com.atguigu.crowd.entity.po.MemberPO;
import com.atguigu.crowd.service.api.MemberService;
import com.atguigu.crowd.util.ResultEntity;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RestController;

/**
 * @author chenjianglin
 * @date 2022/8/19 09:11
 */
@RestController
public class MemberProviderHandler {

    @Autowired
    private MemberService memberService;

    @RequestMapping("/get/memberpo/login/acct/remote")
    public ResultEntity<MemberPO> getMemberPOByLoginAcctRemote(@RequestParam("loginacct") String loginacct) {
        try {
            // è°ƒç”¨æœ¬åœ° Service å®ŒæˆæŸ¥è¯¢
            MemberPO memberPO = memberService.getMemberPOByLoginAcct(loginacct);
            // å¦‚æœæ²¡æœ‰æŠ›å¼‚å¸¸, é‚£ä¹ˆå°±è¿”å›æˆåŠŸçš„ç»“æœ
            return ResultEntity.successWithData(memberPO);
        } catch (Exception e){
            // å¦‚æœæ•è·åˆ°å¼‚å¸¸åˆ™è¿”å›å¤±è´¥çš„ç»“æœ
            return ResultEntity.failed(e.getMessage());
        }
    }
}
```

#### 6.3.2 `Service` æ¥å£

```java
package com.atguigu.crowd.service.api;

import com.atguigu.crowd.entity.po.MemberPO;

/**
 * @author chenjianglin
 * @date 2022/8/19 09:15
 */
public interface MemberService {

    /**
     * æ ¹æ®è´¦å·æŸ¥è¯¢
     *
     * @param loginacct è´¦å·
     * @return
     */
    MemberPO getMemberPOByLoginAcct(String loginacct);

}
```

#### 6.3.3 `Service` ç±»çš„ä»£ç 

```java
package com.atguigu.crowd.service.impl;

import com.atguigu.crowd.entity.po.MemberPO;
import com.atguigu.crowd.entity.po.MemberPOExample;
import com.atguigu.crowd.mapper.MemberPOMapper;
import com.atguigu.crowd.service.api.MemberService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

import java.util.List;

/**
 * ## 1.åœ¨ç±»ä¸Šä½¿ç”¨ @Transactional(readOnly = true)
 * - é’ˆå¯¹æŸ¥è¯¢æ“ä½œè®¾ç½®äº‹åŠ¡å±æ€§
 *
 * @author chenjianglin
 * @date 2022/8/19 09:16
 */
@Transactional(readOnly = true)
@Service
public class MemberServiceImpl implements MemberService {

    @Autowired
    private MemberPOMapper memberPOMapper;

    @Override
    public MemberPO getMemberPOByLoginAcct(String loginacct) {
        // åˆ›å»º Example å¯¹è±¡
        MemberPOExample memberPOExample = new MemberPOExample();

        // åˆ›å»º Criteria å¯¹è±¡
        MemberPOExample.Criteria criteria = memberPOExample.createCriteria();

        // å°è£…æŸ¥è¯¢æ¡ä»¶
        criteria.andLoginacctEqualTo(loginacct);

        // æ‰§è¡ŒæŸ¥è¯¢
        List<MemberPO> list = memberPOMapper.selectByExample(memberPOExample);

        // 5.è·å–ç»“æœ
        if(list == null || list.size() == 0) {
            return null;
        }
        
        return list.get(0);
    }
}
```



## 7. `Redis` å·¥ç¨‹

- ç›®æ ‡: æŠ½å–é¡¹ç›®ä¸­æ‰€æœ‰è®¿é—® `Redis` çš„æ“ä½œ

### 7.1 `Linux` è‡ªåŠ¨å®‰è£… `Redis`

```bash
wget -c http://mirrors.linuxeye.com/oneinstack-full.tar.gz && tar xzf oneinstack-full.tar.gz && ./oneinstack/install.sh --redis 
```

- ä¿®æ”¹redisçš„é…ç½®æ–‡ä»¶: `redis.conf`, æ³¨é‡Šæ‰é…ç½®æ–‡ä»¶é‡Œçš„è¿™ä¸€è¡Œ: `bind 127.0.0.1`
- å°†`protected-mode yes `æ”¹æˆ:`protected-mode no` æ„æ€æ˜¯ä¸ä½¿ç”¨å¯†ç ç™»å½•

### 7.2 Reids å‘½ä»¤åˆ—è¡¨

| å‘½ä»¤                                                         | è¯´æ˜                    |
| ------------------------------------------------------------ | ----------------------- |
| `/usr/local/redis/bin/redis-server /usr/local/redis/etc/redis.conf` | å¯åŠ¨ `Linux` çš„ `Redis` |
| `ps -ef | grep redis | grep -v grep`                         | æŸ¥çœ‹ `Redis`            |
| `/usr/local/redis/bin/redis-cli -h 127.0.0.1`                | ç™»å½• `Redis`            |
| `keys *`                                                     | æŸ¥çœ‹æ‰€æœ‰                |
|                                                              |                         |

#### 7.2.1 æŸ¥çœ‹ `Redis`

```bash
ps -ef | grep redis | grep -v grep
```

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1660876054593-ee6dedc3-0f21-4ca4-bc8a-9f4e8b3c5b27.png)



### 7.3 å·¥ç¨‹ä¾èµ–

```xml
<dependencies>
    <!-- æ•´åˆ Redis -->
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-data-redis</artifactId>
    </dependency>

    <!-- SpringBoot æµ‹è¯• -->
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-test</artifactId>
        <scope>test</scope>
    </dependency>
</dependencies>

<build>
    <plugins>
        <!-- è¿™ä¸ªæ’ä»¶å°† SpringBoot åº”ç”¨æ‰“åŒ…æˆä¸€ä¸ªå¯æ‰§è¡Œçš„ jar åŒ… -->
        <plugin>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-maven-plugin</artifactId>
            <executions>
                <execution>
                    <goals>
                        <goal>repackage</goal>
                    </goals>
                </execution>
            </executions>
        </plugin>
    </plugins>
</build>
```



### 7.4 ä¸»å¯åŠ¨ç±»

```java
package com.atguigu.crowd;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

/**
 * @author chenjianglin
 * @date 2022/8/19 11:05
 */
@SpringBootApplication
public class CrowdMainClass {

    public static void main(String[] args) {
        SpringApplication.run(CrowdMainClass.class, args);
    }

}
```

### 7.5 æ–°å»º `application.yml` é…ç½®

```yaml
server:
  port: 3000

spring:
  application:
    name: atguigu-crowd-redis
  redis:
    host: 127.0.0.1

eureka:
  client:
    service-url:
      defaultZone: http://localhost:1000/eureka
```



### 7.6 æµ‹è¯•ç±»

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1660955755275-432e9dd7-f4ca-4f41-9b66-7bf765b03458.png)

------

```java
package com.atguigu.crowd;

import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.data.redis.core.StringRedisTemplate;
import org.springframework.data.redis.core.ValueOperations;
import org.springframework.test.context.junit4.SpringRunner;

/**
 * @author chenjianglin
 * @date 2022/8/19 11:14
 */
@RunWith(SpringRunner.class)
@SpringBootTest
public class RedisTest {

    // private Logger logger = LoggerFactory.getLogger(RedisTest.class);

    @Autowired
    private StringRedisTemplate redisTemplate;

    @Test
    public void testSet(){
        ValueOperations<String, String> operations = redisTemplate.opsForValue();

        operations.set("apple", "red");
    }

}
```



## 8. `Redis` å·¥ç¨‹å¯¹å¤–æš´éœ²æœåŠ¡

### 8.1 `API` å·¥ç¨‹

#### 8.1.1 æ–°å»º `RedisRemoteService`æ¥å£

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661693533381-25454274-ea82-4072-b4ff-8ecfe4a2e96b.png)

```java
package com.atguigu.crowd.api;

import com.atguigu.crowd.util.ResultEntity;
import org.springframework.cloud.openfeign.FeignClient;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;

import java.util.concurrent.TimeUnit;

/**
 * @author é™ˆæ±Ÿæ—
 * @date 2022/8/28 21:30
 */
@FeignClient("atguigu-crowd-redis")
public interface RedisRemoteService {

    /**
     * ä¿å­˜
     *
     * @param key
     * @param value
     * @return
     */
    @RequestMapping("/set/redis/key/value/remote")
    ResultEntity<String> setRedisKeyValueRemote(
            @RequestParam("key") String key,
            @RequestParam("value") String value);

    /**
     * è®¾ç½®å¸¦è¶…æ—¶æ—¶é—´çš„
     *
     * @param key
     * @param value
     * @param time  æ—¶é—´
     * @param timeUnit æ—¶é—´å•ä½
     * @return
     */
    @RequestMapping("/set/redis/key/value/remote/with/timeout")
    ResultEntity<String> setRedisKeyValueRemoteWithTimeout(
            @RequestParam("key") String key,
            @RequestParam("value") String value,
            @RequestParam("time") long time,
            @RequestParam("timeUnit") TimeUnit timeUnit);

    /**
     * æ ¹æ® Key è·å–
     *
     * @param key
     * @return
     */
    @RequestMapping("get/redis/key/value/by/key")
    ResultEntity<String> getRedisKeyValueByKey(@RequestParam("key") String key);

    /**
     * æ ¹æ® Key åˆ é™¤
     *
     * @param key
     * @return
     */
    @RequestMapping("remove/redis/key/remote")
    ResultEntity<String> removeRedisKeyRemote(@RequestParam("key") String key);

}
```



### 8.2 `Redis` å·¥ç¨‹

#### 8.2.1 å¯¹å¤–æš´éœ²æœåŠ¡ è¿½åŠ ä¾èµ–

```xml
<!-- å¯¹å¤–æš´éœ²æœåŠ¡ -->
<dependency>
  <groupId>org.springframework.boot</groupId>
  <artifactId>spring-boot-starter-web</artifactId>
</dependency>

<!-- ä½œä¸ºå®¢æˆ·ç«¯è®¿é—® Eureka æ³¨å†Œä¸­å¿ƒ -->
<dependency>
    <groupId>org.springframework.cloud</groupId>
    <artifactId>spring-cloud-starter-netflix-eureka-client</artifactId>
</dependency>

<!-- ä¸ºäº†èƒ½å¤Ÿä½¿ç”¨å·¥å…·ç±» -->
<dependency>
    <groupId>com.atguigu.crowd</groupId>
    <artifactId>atcrowdfunding05-common-util</artifactId>
    <version>1.0-SNAPSHOT</version>
</dependency>

<!-- ä¸ºèƒ½å¤Ÿä½¿ç”¨å®ä½“ç±» -->
<dependency>
    <groupId>com.atguigu.crowd</groupId>
    <artifactId>atcrowdfunding09-member-entity</artifactId>
    <version>1.0-SNAPSHOT</version>
</dependency>
```



#### 8.2.2 è¿½åŠ  `RedisTest` æµ‹è¯•æ–¹æ³•

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661693754588-d693a971-4c03-43d9-825c-6b35203fe027.png)

------

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661693807950-a6dd3c89-2645-47d4-878e-7499353994af.png)

```java
@Test 
public void testExSet() {
    ValueOperations<String, String> operations = redisTemplate.opsForValue();
    
    // å­˜æ´» 5000 ç§’
    operations.set("banana", "yellow", 5000, TimeUnit.SECONDS);
}
```



#### 8.2.3 æ–°å»º `handler` åŒ…, æ–°å»º `RedisHandler` ç±»

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661694452017-1143ea90-2378-45f8-9751-dfb107d6265a.png)

```java
package com.atguigu.crowd.handler;

import com.atguigu.crowd.util.ResultEntity;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.data.redis.core.StringRedisTemplate;
import org.springframework.data.redis.core.ValueOperations;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RestController;

import java.util.concurrent.TimeUnit;

/**
 * @author é™ˆæ±Ÿæ—
 * @date 2022/8/28 21:39
 */
@RestController
public class RedisHandler {

    @Autowired
    private StringRedisTemplate redisTemplate;

    /**
     * ä¿å­˜
     *
     * @param key
     * @param value
     * @return
     */
    @RequestMapping("/set/redis/key/value/remote")
    ResultEntity<String> setRedisKeyValueRemote(
            @RequestParam("key") String key,
            @RequestParam("value") String value) {
        try {
            ValueOperations<String, String> operations = redisTemplate.opsForValue();
            operations.set(key, value);

            return ResultEntity.successWithoutData();
        } catch(Exception e) {
            return ResultEntity.failed(e.getMessage());
        }
    }

    /**
     * è®¾ç½®å¸¦è¶…æ—¶æ—¶é—´çš„
     *
     * @param key
     * @param value
     * @param time æ—¶é—´
     * @param timeUnit æ—¶é—´å•ä½
     * @return
     */
    @RequestMapping("/set/redis/key/value/remote/with/timeout")
    ResultEntity<String> setRedisKeyValueRemoteWithTimeout(
            @RequestParam("key") String key,
            @RequestParam("value") String value,
            @RequestParam("time") long time,
            @RequestParam("timeUnit") TimeUnit timeUnit) {
        try {
            ValueOperations<String, String> operations = redisTemplate.opsForValue();
            operations.set(key, value, time, timeUnit);

            return ResultEntity.successWithoutData();
        } catch(Exception e) {
            return ResultEntity.failed(e.getMessage());
        }
    }

    /**
     * æ ¹æ® Key è·å–
     *
     * @param key
     * @return
     */
    @RequestMapping("get/redis/key/value/by/key")
    ResultEntity<String> getRedisKeyValueByKey(@RequestParam("key") String key) {
        try {
            ValueOperations<String, String> operations = redisTemplate.opsForValue();
            String value = operations.get(key);

            return ResultEntity.successWithData(value);
        } catch(Exception e) {
            return ResultEntity.failed(e.getMessage());
        }
    }

    /**
     * æ ¹æ® Key åˆ é™¤
     *
     * @param key
     * @return
     */
    @RequestMapping("remove/redis/key/remote")
    ResultEntity<String> removeRedisKeyRemote(@RequestParam("key") String key) {
        try {
            redisTemplate.delete(key);

            return ResultEntity.successWithoutData();
        } catch(Exception e) {
            return ResultEntity.failed(e.getMessage());
        }
    }
}
```



## 9. `authentication` ä¼šå‘˜ä¸­å¿ƒå·¥ç¨‹

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661697476147-0cd37190-ad03-45fc-b846-7f553c6858a4.png)

------

### 9.1 ä¾èµ–

```xml
<dependencies>
  <!-- å¯¹å¤–æš´éœ²æœåŠ¡ -->
  <dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-web</artifactId>
  </dependency>
  
  <!-- æ•´åˆè§†å›¾ -->
  <dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-thymeleaf</artifactId>
  </dependency>
  
  <!-- ä½œä¸ºå®¢æˆ·ç«¯è®¿é—® Eureka æ³¨å†Œä¸­å¿ƒ -->
  <dependency>
    <groupId>org.springframework.cloud</groupId>
    <artifactId>spring-cloud-starter-netflix-eureka-client</artifactId>
  </dependency>
  
  <dependency>
      <groupId>com.atguigu.crowd</groupId>
      <artifactId>atcrowdfunding17-member-api</artifactId>
      <version>1.0-SNAPSHOT</version>
  </dependency>
</dependencies>

<build>
    <plugins>
        <!-- è¿™ä¸ªæ’ä»¶å°† SpringBoot åº”ç”¨æ‰“åŒ…æˆä¸€ä¸ªå¯æ‰§è¡Œçš„ jar åŒ… -->
        <plugin>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-maven-plugin</artifactId>
            <executions>
                <execution>
                    <goals>
                        <goal>repackage</goal>
                    </goals>
                </execution>
            </executions>
        </plugin>
    </plugins>
</build>
```



### 9.2 æ–°å»º `CrowdMainClass` ä¸»å¯åŠ¨ç±»

```java
package com.atguigu.crowd;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.cloud.client.discovery.EnableDiscoveryClient;
import org.springframework.cloud.openfeign.EnableFeignClients;

/**
 * `@EnableFeignClients` å¯ç”¨ Feign å®¢æˆ·ç«¯åŠŸèƒ½
 * `@EnableDiscoveryClient` å½“å‰ç‰ˆæœ¬å¯ä»¥ä¸å†™
 *
 * @author é™ˆæ±Ÿæ—
 * @date 2022/8/28 21:51
 */
@EnableFeignClients
@EnableDiscoveryClient
@SpringBootApplication
public class CrowdMainClass {

    public static void main(String[] args) {
        SpringApplication.run(CrowdMainClass.class, args);
    }

}
```



### 9.3 æ–°å»º `application.yml` é…ç½®

```yaml
server:
  port: 4000

spring:
  application:
    name: atguigu-crowd-auth

eureka:
  client:
    service-url:
      defaultZone: http://localhost:1000/eureka

ribbon:
  # 10ç§’ - å¤„ç†è¯·æ±‚çš„è¶…æ—¶æ—¶é—´ï¼Œé»˜è®¤ä¸º5ç§’
  ReadTimeout: 10000
  # 10ç§’ - è¿æ¥å»ºç«‹çš„è¶…æ—¶æ—¶é•¿ï¼Œé»˜è®¤5ç§’
  ConnectTimeout: 10000
```



#### 9.3.1 æ–°å»ºåŒ… `templates`ã€`static`

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661696005316-59625806-3823-456f-a226-213501b49623.png)



### 9.4 æ–°å»º `PortalHandler` ç±»

```java
package com.atguigu.crowd.handler;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;

/**
 * @author é™ˆæ±Ÿæ—
 * @date 2022/8/28 22:14
 */
@Controller
public class PortalHandler {

    /**
     * æ˜¾ç¤ºé¦–é¡µ
     * 
     * @return
     */
    @RequestMapping("/")
    public String toPortalPage() {
        // è¿™é‡Œå®é™…å¼€å‘ä¸­éœ€è¦è·å–æ•°æ®

        return "portal";
    }

}
```



### 9.5 æ–°å»º `portal.html` é¦–é¡µ

```html
<!DOCTYPE html>
<html lang="zh-CN" xmlns:th="https://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <base th:href="@{/}">
    <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <link rel="stylesheet" href="css/carousel.css">
    <script src="jquery/jquery-2.1.1.min.js"></script>
    <script src="bootstrap/js/bootstrap.min.js"></script>
    <script src="script/docs.min.js"></script>
    <script src="script/back-to-top.js"></script>
    <script>
        $(".thumbnail img").css("cursor", "pointer");
        $(".thumbnail img").click(function () {
            window.location.href = "project.html";
        });
    </script>
    <style>
        h3 {
            font-weight: bold;
        }

        #footer {
            padding: 15px 0;
            background: #fff;
            border-top: 1px solid #ddd;
            text-align: center;
        }

        #topcontrol {
            color: #fff;
            z-index: 99;
            width: 30px;
            height: 30px;
            font-size: 20px;
            background: #222;
            position: relative;
            right: 14px !important;
            bottom: 11px !important;
            border-radius: 3px !important;
        }

        #topcontrol:after {
            /*top: -2px;*/
            left: 8.5px;
            content: "\f106";
            position: absolute;
            text-align: center;
            font-family: FontAwesome;
        }

        #topcontrol:hover {
            color: #fff;
            background: #18ba9b;
            -webkit-transition: all 0.3s ease-in-out;
            -moz-transition: all 0.3s ease-in-out;
            -o-transition: all 0.3s ease-in-out;
            transition: all 0.3s ease-in-out;
        }

        /* ä¾§æ å¯¼èˆª */
        .sideBox {
            padding: 10px;
            height: 220px;
            background: #fff;
            margin-bottom: 10px;
            overflow: hidden;
        }

        .sideBox .hd {
            height: 30px;
            line-height: 30px;
            background: #f60;
            padding: 0 10px;
            text-align: center;
            overflow: hidden;
        }

        .sideBox .hd .more {
            color: #fff;
        }

        .sideBox .hd h3 span {
            font-weight: bold;
            font-size: 14px;
            color: #fff;
        }

        .sideBox .bd {
            padding: 5px 0 0;
        }

        #sideMenu .bd li {
            margin-bottom: 2px;
            height: 30px;
            line-height: 30px;
            text-align: center;
            overflow: hidden;
        }

        #sideMenu .bd li a {
            display: block;
            background: #EAE6DD;
        }

        #sideMenu .bd li a:hover {
            background: #D5CFBF;
        }

        /* åˆ—è¡¨é¡µ */
        #mainBox {
            margin-bottom: 10px;
            padding: 10px;
            background: #fff;
            overflow: hidden;
        }

        #mainBox .mHd {
            border-bottom: 2px solid #09c;
            height: 30px;
            line-height: 30px;
        }

        #mainBox .mHd h3 {
            display: initial;
            *display: inline;
            zoom: 1;
            padding: 0 15px;
            background: #09c;
            color: #fff;
        }

        #mainBox .mHd h3 span {
            color: #fff;
            font-size: 14px;
            font-weight: bold;
        }

        #mainBox .path {
            float: right;
        }

        /* ä½ç½®å¯¼èˆª */
        .path {
            height: 30px;
            line-height: 30px;
            padding-left: 10px;
        }

        .path a, .path span {
            margin: 0 5px;
        }

        /* æ–‡ç« åˆ—è¡¨ */
        .newsList {
            padding: 10px;
            text-align: left;
        }

        .newsList li {
            background: url("../images/share/point.png") no-repeat 2px 14px;
            padding-left: 10px;
            height: 30px;
            line-height: 30px;
        }

        .newsList li a {
            display: inline-block;
            *display: inline;
            zoom: 1;
            font-size: 14px;
        }

        .newsList li .date {
            float: right;
            color: #999;
        }

        .newsList li.split {
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px dotted #ddd;
            height: 0px;
            line-height: 0px;
            overflow: hidden;
        }

        /* é€šç”¨å¸¦å›¾ç‰‡çš„ä¿¡æ¯åˆ—è¡¨_æ™®é€šå¼ */
        .picList {
            padding: 10px;
            text-align: left;
        }

        .picList li {
            margin: 0 5px;
            height: 190px;
        }

        h3.break {
            font-size: 16px;
            display: block;
            white-space: nowrap;
            word-wrap: normal;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        h3.break > a {
            text-decoration: none;
        }

    </style>
</head>
<body>
<div class="navbar-wrapper">
    <div class="container">
        <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand" href="index.html" style="font-size:32px;">å°šç­¹ç½‘-åˆ›æ„äº§å“ä¼—ç­¹å¹³å°</a>
                </div>
                <div id="navbar" class="navbar-collapse collapse" style="float:right;">
                    <ul class="nav navbar-nav navbar-right">
                        <li><a href="login.html">ç™»å½•</a></li>
                        <li><a href="reg.html">æ³¨å†Œ</a></li>
                        <li><a>|</a></li>
                        <li><a href="admin-login.html">ç®¡ç†å‘˜å…¥å£</a></li>
                    </ul>
                </div>
            </div>
        </nav>
    </div>
</div>


<!-- Carousel
================================================== -->
<div id="myCarousel" class="carousel slide" data-ride="carousel">
    <!-- Indicators -->
    <ol class="carousel-indicators">
        <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
        <li data-target="#myCarousel" data-slide-to="1"></li>
        <li data-target="#myCarousel" data-slide-to="2"></li>
    </ol>
    <div class="carousel-inner" role="listbox">
        <div class="item active" onclick="window.location.href='project.html'" style="cursor:pointer;">
            <img src="img/carousel-1.jpg" alt="First slide">
        </div>
        <div class="item" onclick="window.location.href='project.html'" style="cursor:pointer;">
            <img src="img/carousel-2.jpg" alt="Second slide">
        </div>
        <div class="item" onclick="window.location.href='project.html'" style="cursor:pointer;">
            <img src="img/carousel-3.jpg" alt="Third slide">
        </div>
    </div>
    <a class="left carousel-control" href="#myCarousel" role="button" data-slide="prev">
        <span class="glyphicon glyphicon-chevron-left"></span>
        <span class="sr-only">Previous</span>
    </a>
    <a class="right carousel-control" href="#myCarousel" role="button" data-slide="next">
        <span class="glyphicon glyphicon-chevron-right"></span>
        <span class="sr-only">Next</span>
    </a>
</div><!-- /.carousel -->


<!-- Marketing messaging and featurettes
================================================== -->
<!-- Wrap the rest of the page in another container to center all the content. -->

<div class="container marketing">

    <!-- Three columns of text below the carousel -->
    <div class="row">
        <div class="col-lg-4">
            <img class="img-circle" src="img/p1.jpg" alt="Generic placeholder image"
                 style="width: 140px; height: 140px;">
            <h2>æ™ºèƒ½é«˜æ¸…ç›‘æ§æœºå™¨äºº</h2>
            <p>å¯çˆ±çš„é€ å‹ï¼Œæ‘„åƒå®‰é˜²è¿œç¨‹äº’è”çš„å…¨èƒ½è®¾è®¡ï¼Œè®©ä½ éšæ—¶éšåœ°å®ˆæŠ¤æ‚¨çš„å®¶äººï¼Œé™ªä¼´ä½ çš„ç”Ÿæ´»ã€‚</p>
            <p><a class="btn btn-default" href="project.html" role="button">é¡¹ç›®è¯¦æƒ… &raquo;</a></p>
        </div><!-- /.col-lg-4 -->
        <div class="col-lg-4">
            <img class="img-circle" src="img/p2.jpg" alt="Generic placeholder image"
                 style="width: 140px; height: 140px;">
            <h2>NEOKAæ™ºèƒ½æ‰‹ç¯</h2>
            <p>è¦è¿åŠ¨æ›´è¦å®‰å…¨ï¼Œè¿™æ¬¾ã€åä¸ºâ€œè¶èˆâ€çš„NEOKA-V9100æ™ºèƒ½è¿åŠ¨æ‰‹ç¯ä¸ºâ€œå®‰å…¨è¿åŠ¨è€Œç”Ÿâ€ã€‚</p>
            <p><a class="btn btn-default" href="project.html" role="button">é¡¹ç›®è¯¦æƒ… &raquo;</a></p>
        </div><!-- /.col-lg-4 -->
        <div class="col-lg-4">
            <img class="img-circle" src="img/p3.png" alt="Generic placeholder image"
                 style="width: 140px; height: 140px;">
            <h2>é©±èšŠæ‰£</h2>
            <p>éšå¤„ä½¿ç”¨çš„é©±èšŠçº½æ‰£ï¼Œ<br>è§£å†³å¤å­£èšŠè™«é—®é¢˜ã€‚</p>
            <p><a class="btn btn-default" href="project.html" role="button">é¡¹ç›®è¯¦æƒ… &raquo;</a></p>
        </div><!-- /.col-lg-4 -->
    </div><!-- /.row -->

    <div class="container">
        <div class="row clearfix">
            <div class="col-md-12 column">
                <div class="box ui-draggable" id="mainBox">
                    <div class="mHd" style="">
                        <div class="path">
                            <a href="projects.html">æ›´å¤š...</a>
                        </div>
                        <h3>
                            ç§‘æŠ€ <small style="color:#FFF;">å¼€å¯æ™ºæ…§æœªæ¥</small>
                        </h3>
                    </div>
                    <div class="mBd" style="padding-top:10px;">
                        <div class="row">
                            <div class="col-md-3">
                                <div class="thumbnail">
                                    <img alt="300x200" src="img/product-1.jpg"/>
                                    <div class="caption">
                                        <h3 class="break">
                                            <a href="project.html">æ´»æ€§å¯Œæ°¢å‡€æ°´ç›´é¥®æœº</a>
                                        </h3>
                                        <p>
                                        <div style="float:left;"><i class="glyphicon glyphicon-screenshot"
                                                                    title="ç›®æ ‡é‡‘é¢"></i> $20,000
                                        </div>
                                        <div style="float:right;"><i title="æˆªè‡³æ—¥æœŸ"
                                                                     class="glyphicon glyphicon-calendar"></i>
                                            2017-20-20
                                        </div>
                                        </p>
                                        <br>
                                        <div class="progress" style="margin-bottom: 4px;">
                                            <div class="progress-bar progress-bar-success" role="progressbar"
                                                 aria-valuenow="40" aria-valuemin="0" aria-valuemax="100"
                                                 style="width: 40%">
                                                <span>40% </span>
                                            </div>
                                        </div>
                                        <div><span style="float:right;"><i
                                                class="glyphicon glyphicon-star-empty"></i></span> <span><i
                                                class="glyphicon glyphicon-user" title="æ”¯æŒäººæ•°"></i> 12345</span></div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="thumbnail">
                                    <img alt="300x200" src="img/product-2.gif"/>
                                    <div class="caption">
                                        <h3 class="break">
                                            <a href="project.html">é…·é©°è§¦æ§é¾™å¤´ï¼Œæ™ºäº«å¨æˆ¿é»‘ç§‘æŠ€</a>
                                        </h3>
                                        <p>
                                        <div style="float:left;"><i class="glyphicon glyphicon-screenshot"
                                                                    title="ç›®æ ‡é‡‘é¢"></i> $20,000
                                        </div>
                                        <div style="float:right;"><i title="æˆªè‡³æ—¥æœŸ"
                                                                     class="glyphicon glyphicon-calendar"></i>
                                            2017-20-20
                                        </div>
                                        </p>
                                        <br>
                                        <div class="progress" style="margin-bottom: 4px;">
                                            <div class="progress-bar progress-bar-success" role="progressbar"
                                                 aria-valuenow="40" aria-valuemin="0" aria-valuemax="100"
                                                 style="width: 40%">
                                                <span>40% </span>
                                            </div>
                                        </div>
                                        <div><span style="float:right;"><i
                                                class="glyphicon glyphicon-star-empty"></i></span> <span><i
                                                class="glyphicon glyphicon-user" title="æ”¯æŒäººæ•°"></i> 12345</span></div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="thumbnail">
                                    <img alt="300x200" src="img/product-3.png"/>
                                    <div class="caption">
                                        <h3 class="break">
                                            <a href="project.html">å°ç†ŠçŒ«é±¼çœ¼å…¨æ™¯å®‰é˜²æ‘„åƒæœº</a>
                                        </h3>
                                        <p>
                                        <div style="float:left;"><i class="glyphicon glyphicon-screenshot"
                                                                    title="ç›®æ ‡é‡‘é¢"></i> $20,000
                                        </div>
                                        <div style="float:right;"><i title="æˆªè‡³æ—¥æœŸ"
                                                                     class="glyphicon glyphicon-calendar"></i>
                                            2017-20-20
                                        </div>
                                        </p>
                                        <br>
                                        <div class="progress" style="margin-bottom: 4px;">
                                            <div class="progress-bar progress-bar-success" role="progressbar"
                                                 aria-valuenow="40" aria-valuemin="0" aria-valuemax="100"
                                                 style="width: 40%">
                                                <span>40% </span>
                                            </div>
                                        </div>
                                        <div><span style="float:right;"><i
                                                class="glyphicon glyphicon-star-empty"></i></span> <span><i
                                                class="glyphicon glyphicon-user" title="æ”¯æŒäººæ•°"></i> 12345</span></div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="thumbnail">
                                    <img alt="300x200" src="img/product-4.jpg"/>
                                    <div class="caption">
                                        <h3 class="break">
                                            <a href="project.html">ä¸€æ¬¾ç²¾è‡´çš„æœºæ¢°è¡¨</a>
                                        </h3>
                                        <p>
                                        <div style="float:left;"><i class="glyphicon glyphicon-screenshot"
                                                                    title="ç›®æ ‡é‡‘é¢"></i> $20,000
                                        </div>
                                        <div style="float:right;"><i title="æˆªè‡³æ—¥æœŸ"
                                                                     class="glyphicon glyphicon-calendar"></i>
                                            2017-20-20
                                        </div>
                                        </p>
                                        <br>
                                        <div class="progress" style="margin-bottom: 4px;">
                                            <div class="progress-bar progress-bar-success" role="progressbar"
                                                 aria-valuenow="40" aria-valuemin="0" aria-valuemax="100"
                                                 style="width: 40%">
                                                <span>40% </span>
                                            </div>
                                        </div>
                                        <div><span style="float:right;"><i
                                                class="glyphicon glyphicon-star-empty"></i></span> <span><i
                                                class="glyphicon glyphicon-user" title="æ”¯æŒäººæ•°"></i> 12345</span></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <div class="container">
        <div class="row clearfix">
            <div class="col-md-12 column">
                <div class="box ui-draggable" id="mainBox">
                    <div class="mHd" style="">
                        <div class="path">
                            <a href="projects.html">æ›´å¤š...</a>
                        </div>
                        <h3>
                            è®¾è®¡ <small style="color:#FFF;">åˆ›æ„æ”¹å˜ç”Ÿæ´»</small>
                        </h3>
                    </div>
                    <div class="mBd" style="padding-top:10px;">
                        <div class="row">
                            <div class="col-md-3">
                                <div class="thumbnail">
                                    <img alt="300x200" src="img/product-5.jpg"/>
                                    <div class="caption">
                                        <h3 class="break">
                                            <a href="project.html">æ´»æ€§å¯Œæ°¢å‡€æ°´ç›´é¥®æœº</a>
                                        </h3>
                                        <p>
                                        <div style="float:left;"><i class="glyphicon glyphicon-screenshot"
                                                                    title="ç›®æ ‡é‡‘é¢"></i> $20,000
                                        </div>
                                        <div style="float:right;"><i title="æˆªè‡³æ—¥æœŸ"
                                                                     class="glyphicon glyphicon-calendar"></i>
                                            2017-20-20
                                        </div>
                                        </p>
                                        <br>
                                        <div class="progress" style="margin-bottom: 4px;">
                                            <div class="progress-bar progress-bar-success" role="progressbar"
                                                 aria-valuenow="40" aria-valuemin="0" aria-valuemax="100"
                                                 style="width: 40%">
                                                <span>40% </span>
                                            </div>
                                        </div>
                                        <div><span style="float:right;"><i
                                                class="glyphicon glyphicon-star-empty"></i></span> <span><i
                                                class="glyphicon glyphicon-user" title="æ”¯æŒäººæ•°"></i> 12345</span></div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="thumbnail">
                                    <img alt="300x200" src="img/product-6.jpg"/>
                                    <div class="caption">
                                        <h3 class="break">
                                            <a href="project.html">é…·é©°è§¦æ§é¾™å¤´ï¼Œæ™ºäº«å¨æˆ¿é»‘ç§‘æŠ€</a>
                                        </h3>
                                        <p>
                                        <div style="float:left;"><i class="glyphicon glyphicon-screenshot"
                                                                    title="ç›®æ ‡é‡‘é¢"></i> $20,000
                                        </div>
                                        <div style="float:right;"><i title="æˆªè‡³æ—¥æœŸ"
                                                                     class="glyphicon glyphicon-calendar"></i>
                                            2017-20-20
                                        </div>
                                        </p>
                                        <br>
                                        <div class="progress" style="margin-bottom: 4px;">
                                            <div class="progress-bar progress-bar-success" role="progressbar"
                                                 aria-valuenow="40" aria-valuemin="0" aria-valuemax="100"
                                                 style="width: 40%">
                                                <span>40% </span>
                                            </div>
                                        </div>
                                        <div><span style="float:right;"><i
                                                class="glyphicon glyphicon-star-empty"></i></span> <span><i
                                                class="glyphicon glyphicon-user" title="æ”¯æŒäººæ•°"></i> 12345</span></div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="thumbnail">
                                    <img alt="300x200" src="img/product-7.jpg"/>
                                    <div class="caption">
                                        <h3 class="break">
                                            <a href="project.html">å°ç†ŠçŒ«é±¼çœ¼å…¨æ™¯å®‰é˜²æ‘„åƒæœº</a>
                                        </h3>
                                        <p>
                                        <div style="float:left;"><i class="glyphicon glyphicon-screenshot"
                                                                    title="ç›®æ ‡é‡‘é¢"></i> $20,000
                                        </div>
                                        <div style="float:right;"><i title="æˆªè‡³æ—¥æœŸ"
                                                                     class="glyphicon glyphicon-calendar"></i>
                                            2017-20-20
                                        </div>
                                        </p>
                                        <br>
                                        <div class="progress" style="margin-bottom: 4px;">
                                            <div class="progress-bar progress-bar-success" role="progressbar"
                                                 aria-valuenow="40" aria-valuemin="0" aria-valuemax="100"
                                                 style="width: 40%">
                                                <span>40% </span>
                                            </div>
                                        </div>
                                        <div><span style="float:right;"><i
                                                class="glyphicon glyphicon-star-empty"></i></span> <span><i
                                                class="glyphicon glyphicon-user" title="æ”¯æŒäººæ•°"></i> 12345</span></div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="thumbnail">
                                    <img alt="300x200" src="img/product-8.jpg"/>
                                    <div class="caption">
                                        <h3 class="break">
                                            <a href="project.html">ä¸€æ¬¾ç²¾è‡´çš„æœºæ¢°è¡¨</a>
                                        </h3>
                                        <p>
                                        <div style="float:left;"><i class="glyphicon glyphicon-screenshot"
                                                                    title="ç›®æ ‡é‡‘é¢"></i> $20,000
                                        </div>
                                        <div style="float:right;"><i title="æˆªè‡³æ—¥æœŸ"
                                                                     class="glyphicon glyphicon-calendar"></i>
                                            2017-20-20
                                        </div>
                                        </p>
                                        <br>
                                        <div class="progress" style="margin-bottom: 4px;">
                                            <div class="progress-bar progress-bar-success" role="progressbar"
                                                 aria-valuenow="40" aria-valuemin="0" aria-valuemax="100"
                                                 style="width: 40%">
                                                <span>40% </span>
                                            </div>
                                        </div>
                                        <div><span style="float:right;"><i
                                                class="glyphicon glyphicon-star-empty"></i></span> <span><i
                                                class="glyphicon glyphicon-user" title="æ”¯æŒäººæ•°"></i> 12345</span></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <div class="container">
        <div class="row clearfix">
            <div class="col-md-12 column">
                <div class="box ui-draggable" id="mainBox">
                    <div class="mHd" style="">
                        <div class="path">
                            <a href="projects.html">æ›´å¤š...</a>
                        </div>
                        <h3>
                            å†œä¸š <small style="color:#FFF;">ç½‘ç»œå¤©ä¸‹è‚¥ç¾</small>
                        </h3>
                    </div>
                    <div class="mBd" style="padding-top:10px;">
                        <div class="row">
                            <div class="col-md-3">
                                <div class="thumbnail">
                                    <img alt="300x200" src="img/product-9.jpg"/>
                                    <div class="caption">
                                        <h3 class="break">
                                            <a href="project.html">æ´»æ€§å¯Œæ°¢å‡€æ°´ç›´é¥®æœº</a>
                                        </h3>
                                        <p>
                                        <div style="float:left;"><i class="glyphicon glyphicon-screenshot"
                                                                    title="ç›®æ ‡é‡‘é¢"></i> $20,000
                                        </div>
                                        <div style="float:right;"><i title="æˆªè‡³æ—¥æœŸ"
                                                                     class="glyphicon glyphicon-calendar"></i>
                                            2017-20-20
                                        </div>
                                        </p>
                                        <br>
                                        <div class="progress" style="margin-bottom: 4px;">
                                            <div class="progress-bar progress-bar-success" role="progressbar"
                                                 aria-valuenow="40" aria-valuemin="0" aria-valuemax="100"
                                                 style="width: 40%">
                                                <span>40% </span>
                                            </div>
                                        </div>
                                        <div><span style="float:right;"><i
                                                class="glyphicon glyphicon-star-empty"></i></span> <span><i
                                                class="glyphicon glyphicon-user" title="æ”¯æŒäººæ•°"></i> 12345</span></div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="thumbnail">
                                    <img alt="300x200" src="img/product-2.gif"/>
                                    <div class="caption">
                                        <h3 class="break">
                                            <a href="project.html">é…·é©°è§¦æ§é¾™å¤´ï¼Œæ™ºäº«å¨æˆ¿é»‘ç§‘æŠ€</a>
                                        </h3>
                                        <p>
                                        <div style="float:left;"><i class="glyphicon glyphicon-screenshot"
                                                                    title="ç›®æ ‡é‡‘é¢"></i> $20,000
                                        </div>
                                        <div style="float:right;"><i title="æˆªè‡³æ—¥æœŸ"
                                                                     class="glyphicon glyphicon-calendar"></i>
                                            2017-20-20
                                        </div>
                                        </p>
                                        <br>
                                        <div class="progress" style="margin-bottom: 4px;">
                                            <div class="progress-bar progress-bar-success" role="progressbar"
                                                 aria-valuenow="40" aria-valuemin="0" aria-valuemax="100"
                                                 style="width: 40%">
                                                <span>40% </span>
                                            </div>
                                        </div>
                                        <div><span style="float:right;"><i
                                                class="glyphicon glyphicon-star-empty"></i></span> <span><i
                                                class="glyphicon glyphicon-user" title="æ”¯æŒäººæ•°"></i> 12345</span></div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="thumbnail">
                                    <img alt="300x200" src="img/product-3.png"/>
                                    <div class="caption">
                                        <h3 class="break">
                                            <a href="project.html">å°ç†ŠçŒ«é±¼çœ¼å…¨æ™¯å®‰é˜²æ‘„åƒæœº</a>
                                        </h3>
                                        <p>
                                        <div style="float:left;"><i class="glyphicon glyphicon-screenshot"
                                                                    title="ç›®æ ‡é‡‘é¢"></i> $20,000
                                        </div>
                                        <div style="float:right;"><i title="æˆªè‡³æ—¥æœŸ"
                                                                     class="glyphicon glyphicon-calendar"></i>
                                            2017-20-20
                                        </div>
                                        </p>
                                        <br>
                                        <div class="progress" style="margin-bottom: 4px;">
                                            <div class="progress-bar progress-bar-success" role="progressbar"
                                                 aria-valuenow="40" aria-valuemin="0" aria-valuemax="100"
                                                 style="width: 40%">
                                                <span>40% </span>
                                            </div>
                                        </div>
                                        <div><span style="float:right;"><i
                                                class="glyphicon glyphicon-star-empty"></i></span> <span><i
                                                class="glyphicon glyphicon-user" title="æ”¯æŒäººæ•°"></i> 12345</span></div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="thumbnail">
                                    <img alt="300x200" src="img/product-4.jpg"/>
                                    <div class="caption">
                                        <h3 class="break">
                                            <a href="project.html">ä¸€æ¬¾ç²¾è‡´çš„æœºæ¢°è¡¨</a>
                                        </h3>
                                        <p>
                                        <div style="float:left;"><i class="glyphicon glyphicon-screenshot"
                                                                    title="ç›®æ ‡é‡‘é¢"></i> $20,000
                                        </div>
                                        <div style="float:right;"><i title="æˆªè‡³æ—¥æœŸ"
                                                                     class="glyphicon glyphicon-calendar"></i>
                                            2017-20-20
                                        </div>
                                        </p>
                                        <br>
                                        <div class="progress" style="margin-bottom: 4px;">
                                            <div class="progress-bar progress-bar-success" role="progressbar"
                                                 aria-valuenow="40" aria-valuemin="0" aria-valuemax="100"
                                                 style="width: 40%">
                                                <span>40% </span>
                                            </div>
                                        </div>
                                        <div><span style="float:right;"><i
                                                class="glyphicon glyphicon-star-empty"></i></span> <span><i
                                                class="glyphicon glyphicon-user" title="æ”¯æŒäººæ•°"></i> 12345</span></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <div class="container">
        <div class="row clearfix">
            <div class="col-md-12 column">
                <div class="box ui-draggable" id="mainBox">
                    <div class="mHd" style="">
                        <div class="path">
                            <a href="projects.html">æ›´å¤š...</a>
                        </div>
                        <h3>
                            å…¶ä»– <small style="color:#FFF;">å‘ç°æ›´å¤šæƒŠå–œ</small>
                        </h3>
                    </div>
                    <div class="mBd" style="padding-top:10px;">
                        <div class="row">
                            <div class="col-md-3">
                                <div class="thumbnail">
                                    <img alt="300x200" src="img/product-1.jpg"/>
                                    <div class="caption">
                                        <h3 class="break">
                                            <a href="project.html">æ´»æ€§å¯Œæ°¢å‡€æ°´ç›´é¥®æœº</a>
                                        </h3>
                                        <p>
                                        <div style="float:left;"><i class="glyphicon glyphicon-screenshot"
                                                                    title="ç›®æ ‡é‡‘é¢"></i> $20,000
                                        </div>
                                        <div style="float:right;"><i title="æˆªè‡³æ—¥æœŸ"
                                                                     class="glyphicon glyphicon-calendar"></i>
                                            2017-20-20
                                        </div>
                                        </p>
                                        <br>
                                        <div class="progress" style="margin-bottom: 4px;">
                                            <div class="progress-bar progress-bar-success" role="progressbar"
                                                 aria-valuenow="40" aria-valuemin="0" aria-valuemax="100"
                                                 style="width: 40%">
                                                <span>40% </span>
                                            </div>
                                        </div>
                                        <div><span style="float:right;"><i
                                                class="glyphicon glyphicon-star-empty"></i></span> <span><i
                                                class="glyphicon glyphicon-user" title="æ”¯æŒäººæ•°"></i> 12345</span></div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="thumbnail">
                                    <img alt="300x200" src="img/product-2.gif"/>
                                    <div class="caption">
                                        <h3 class="break">
                                            <a href="project.html">é…·é©°è§¦æ§é¾™å¤´ï¼Œæ™ºäº«å¨æˆ¿é»‘ç§‘æŠ€</a>
                                        </h3>
                                        <p>
                                        <div style="float:left;"><i class="glyphicon glyphicon-screenshot"
                                                                    title="ç›®æ ‡é‡‘é¢"></i> $20,000
                                        </div>
                                        <div style="float:right;"><i title="æˆªè‡³æ—¥æœŸ"
                                                                     class="glyphicon glyphicon-calendar"></i>
                                            2017-20-20
                                        </div>
                                        </p>
                                        <br>
                                        <div class="progress" style="margin-bottom: 4px;">
                                            <div class="progress-bar progress-bar-success" role="progressbar"
                                                 aria-valuenow="40" aria-valuemin="0" aria-valuemax="100"
                                                 style="width: 40%">
                                                <span>40% </span>
                                            </div>
                                        </div>
                                        <div><span style="float:right;"><i
                                                class="glyphicon glyphicon-star-empty"></i></span> <span><i
                                                class="glyphicon glyphicon-user" title="æ”¯æŒäººæ•°"></i> 12345</span></div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="thumbnail">
                                    <img alt="300x200" src="img/product-3.png"/>
                                    <div class="caption">
                                        <h3 class="break">
                                            <a href="project.html">å°ç†ŠçŒ«é±¼çœ¼å…¨æ™¯å®‰é˜²æ‘„åƒæœº</a>
                                        </h3>
                                        <p>
                                        <div style="float:left;"><i class="glyphicon glyphicon-screenshot"
                                                                    title="ç›®æ ‡é‡‘é¢"></i> $20,000
                                        </div>
                                        <div style="float:right;"><i title="æˆªè‡³æ—¥æœŸ"
                                                                     class="glyphicon glyphicon-calendar"></i>
                                            2017-20-20
                                        </div>
                                        </p>
                                        <br>
                                        <div class="progress" style="margin-bottom: 4px;">
                                            <div class="progress-bar progress-bar-success" role="progressbar"
                                                 aria-valuenow="40" aria-valuemin="0" aria-valuemax="100"
                                                 style="width: 40%">
                                                <span>40% </span>
                                            </div>
                                        </div>
                                        <div><span style="float:right;"><i
                                                class="glyphicon glyphicon-star-empty"></i></span> <span><i
                                                class="glyphicon glyphicon-user" title="æ”¯æŒäººæ•°"></i> 12345</span></div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="thumbnail">
                                    <img alt="300x200" src="img/product-4.jpg"/>
                                    <div class="caption">
                                        <h3 class="break">
                                            <a href="project.html">ä¸€æ¬¾ç²¾è‡´çš„æœºæ¢°è¡¨</a>
                                        </h3>
                                        <p>
                                        <div style="float:left;"><i class="glyphicon glyphicon-screenshot"
                                                                    title="ç›®æ ‡é‡‘é¢"></i> $20,000
                                        </div>
                                        <div style="float:right;"><i title="æˆªè‡³æ—¥æœŸ"
                                                                     class="glyphicon glyphicon-calendar"></i>
                                            2017-20-20
                                        </div>
                                        </p>
                                        <br>
                                        <div class="progress" style="margin-bottom: 4px;">
                                            <div class="progress-bar progress-bar-success" role="progressbar"
                                                 aria-valuenow="40" aria-valuemin="0" aria-valuemax="100"
                                                 style="width: 40%">
                                                <span>40% </span>
                                            </div>
                                        </div>
                                        <div><span style="float:right;"><i
                                                class="glyphicon glyphicon-star-empty"></i></span> <span><i
                                                class="glyphicon glyphicon-user" title="æ”¯æŒäººæ•°"></i> 12345</span></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <!-- FOOTER -->
    <div class="container">
        <div class="row clearfix">
            <div class="col-md-12 column">
                <div id="footer">
                    <div class="footerNav">
                        <a rel="nofollow" href="http://www.atguigu.com">å…³äºæˆ‘ä»¬</a> | <a rel="nofollow"
                                                                                      href="http://www.atguigu.com">æœåŠ¡æ¡æ¬¾</a>
                        | <a rel="nofollow" href="http://www.atguigu.com">å…è´£å£°æ˜</a> | <a rel="nofollow"
                                                                                        href="http://www.atguigu.com">ç½‘ç«™åœ°å›¾</a>
                        | <a rel="nofollow" href="http://www.atguigu.com">è”ç³»æˆ‘ä»¬</a>
                    </div>
                    <div class="copyRight">
                        Copyright ?2017-2017atguigu.com ç‰ˆæƒæ‰€æœ‰
                    </div>
                </div>

            </div>
        </div>
    </div>

</div><!-- /.container -->
</body>
</html>
```

- `<baseth:href="@{/}">`

    - å°±ç®—é…ç½® `server.servlet.context-path: /aaa`, ä¹Ÿå¯ä»¥æ­£å¸¸è®¿é—®



### 9.6 `static` èµ„æº

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661696345312-26f74d50-297f-46d8-b470-3a3ea367f66a.png)

- `SpringBoot` è¦æ±‚åœ¨ `static` ä¸­å­˜æ”¾é™æ€èµ„æº ,å¤åˆ¶åˆ° `static` æ–‡ä»¶å¤¹ä¸­

    - èµ„æºåŒ…:  [ğŸ“static.zip](https://www.yuque.com/attachments/yuque/0/2022/zip/12811585/1660963709173-585dad43-5a60-45b4-9fa2-97457f611bcf.zip)



## 10. `Zuul` ç½‘å…³é¡¹ç›®

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661699552724-09ee472d-28b1-43c6-ad01-170e80d058f0.png)

------

### 10.1 ä¾èµ–

```xml
<dependencies>
    <!-- ä½œä¸ºå®¢æˆ·ç«¯è®¿é—® Eureka æ³¨å†Œä¸­å¿ƒ -->
    <dependency>
        <groupId>org.springframework.cloud</groupId>
        <artifactId>spring-cloud-starter-netflix-eureka-client</artifactId>
    </dependency>

    <!-- æ•´åˆ Zuul ç½‘å…³ -->
    <dependency>
        <groupId>org.springframework.cloud</groupId>
        <artifactId>spring-cloud-starter-netflix-zuul</artifactId>
    </dependency>
</dependencies>

<build>
<plugins>
    <!-- è¿™ä¸ªæ’ä»¶å°† SpringBoot åº”ç”¨æ‰“åŒ…æˆä¸€ä¸ªå¯æ‰§è¡Œçš„ jar åŒ… -->
    <plugin>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-maven-plugin</artifactId>
        <executions>
            <execution>
                <goals>
                    <goal>repackage</goal>
                </goals>
            </execution>
        </executions>
    </plugin>
</plugins>
</build>
```



### 10.2 æ–°å»º `CrowdMainClass` ä¸»å¯åŠ¨ç±»

```java
package com.atguigu.crowd;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.cloud.netflix.zuul.EnableZuulProxy;

/**
 * `@EnableZuulProxy` å¯åŠ¨ zuul ä»£ç†åŠŸèƒ½
 *
 * @author é™ˆæ±Ÿæ—
 * @date 2022/8/28 22:26
 */
@EnableZuulProxy
@SpringBootApplication
public class CrowdMainClass {

    public static void main(String[] args) {
        SpringApplication.run(CrowdMainClass.class, args);
    }

}
```



### 10.3 æ–°å»º `application.yml` é…ç½®

```yaml
server:
  port: 80

spring:
  application:
    name: atguigu-crowd-zuul

eureka:
  client:
    service-url:
      defaultZone: http://localhost:1000/eureka

zuul:
  # å¿½ç•¥åŸæœ¬çš„å¾®æœåŠ¡åç§°
  ignored-services: "*"
  # åœ¨ zuul ä¸­å…¶ä»–å¾®æœåŠ¡é‡å®šå‘æ—¶ä¿æŒåŸæœ¬çš„å¤´ä¿¡æ¯ï¼ˆè¯·æ±‚å¤´ã€å“åº”å¤´ï¼‰
  sensitive-headers: "*"
  routes:
    crowd-portal:
      service-id: atguigu-crowd-auth
      path: /**

ribbon:
  # 10ç§’ - å¤„ç†è¯·æ±‚çš„è¶…æ—¶æ—¶é—´ï¼Œé»˜è®¤ä¸º5ç§’
  ReadTimeout: 10000
  # 10ç§’ - è¿æ¥å»ºç«‹çš„è¶…æ—¶æ—¶é•¿ï¼Œé»˜è®¤5ç§’
  ConnectTimeout: 10000
```



## 11. å…³äºç¬¬ä¸€æ¬¡è¯·æ±‚è¶…æ—¶

- ç”±äºåœ¨ç¬¬ä¸€æ¬¡è¯·æ±‚ä¸­éœ€è¦å»ºç«‹ç¼“å­˜ã€å»ºç«‹è¿æ¥, æ“ä½œè¾ƒå¤š, æ‰€ä»¥æ¯”è¾ƒè€—æ—¶
- å¦‚æœæŒ‰ç…§é»˜è®¤çš„ `ribbon` è¶…æ—¶æ—¶é—´æ¥å·¥ä½œ, ç¬¬ä¸€æ¬¡è¯·æ±‚ä¼šè¶…è¿‡è¿™ä¸ªæ—¶é—´å¯¼è‡´è¶…æ—¶æŠ¥é”™
- ä¸ºäº†é¿å…è¿™ä¸ªé—®é¢˜, æŠŠ `ribbon` çš„è¶…æ—¶æ—¶é—´å»¶é•¿
- `application.yml` ä¸­é…ç½®

```yaml
ribbon:
  # 10ç§’ - å¤„ç†è¯·æ±‚çš„è¶…æ—¶æ—¶é—´ï¼Œé»˜è®¤ä¸º5ç§’
  ReadTimeout: 10000
  # 10ç§’ - è¿æ¥å»ºç«‹çš„è¶…æ—¶æ—¶é•¿ï¼Œé»˜è®¤5ç§’
  ConnectTimeout: 10000
```


# åä¸ƒ ä¼šå‘˜æ³¨å†Œ

>  `git checkout -b 17.0.0_member_reg`

## 1. è°ƒç”¨ç¬¬ä¸‰æ–¹çŸ­ä¿¡æ¥å£

- [äº‘å¸‚åœº](https://market.aliyun.com/?spm=5176.product-detail.J_3207526240.2.2ba07b9d1oPiiz)

### 1.1 è¿½åŠ ä¾èµ–ã€`common`å·¥ç¨‹ã€‘

```xml
<!-- ä»¥ä¸‹æ˜¯å‘é€çŸ­ä¿¡æ—¶è°ƒç”¨ç¬¬ä¸‰æ–¹ API æ‰€éœ€çš„ä¾èµ– -->
<dependency>
    <groupId>com.alibaba</groupId>
    <artifactId>fastjson</artifactId>
    <version>1.2.15</version>
</dependency>

<dependency>
    <groupId>org.apache.httpcomponents</groupId>
    <artifactId>httpclient</artifactId>
    <version>4.5.9</version>
</dependency>

<dependency>
    <groupId>org.eclipse.jetty</groupId>
    <artifactId>jetty-util</artifactId>
    <version>9.4.19.v20190610</version>
</dependency>

<dependency>
    <groupId>commons-lang</groupId>
    <artifactId>commons-lang</artifactId>
    <version>2.6</version>
</dependency>
```



### 1.2 æ–°å»º `HttpUtils` ç±»ã€`common`å·¥ç¨‹ã€‘

```java
package com.aliyun.api.gateway.demo.util;

import org.apache.commons.lang.StringUtils;
import org.apache.http.HttpResponse;
import org.apache.http.NameValuePair;
import org.apache.http.client.HttpClient;
import org.apache.http.client.entity.UrlEncodedFormEntity;
import org.apache.http.client.methods.HttpDelete;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.client.methods.HttpPut;
import org.apache.http.conn.ClientConnectionManager;
import org.apache.http.conn.scheme.Scheme;
import org.apache.http.conn.scheme.SchemeRegistry;
import org.apache.http.conn.ssl.SSLSocketFactory;
import org.apache.http.entity.ByteArrayEntity;
import org.apache.http.entity.StringEntity;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.message.BasicNameValuePair;

import javax.net.ssl.SSLContext;
import javax.net.ssl.TrustManager;
import javax.net.ssl.X509TrustManager;
import java.io.UnsupportedEncodingException;
import java.net.URLEncoder;
import java.security.KeyManagementException;
import java.security.NoSuchAlgorithmException;
import java.security.cert.X509Certificate;
import java.util.ArrayList;
import java.util.List;
import java.util.Map;

/**
 * @author é™ˆæ±Ÿæ—
 * @date 2022/8/29 09:27
 */
public class HttpUtils {

    /**
     * get
     *
     * @param host
     * @param path
     * @param method
     * @param headers
     * @param querys
     * @return
     * @throws Exception
     */
    public static HttpResponse doGet(String host, String path, String method,
                                     Map<String, String> headers,
                                     Map<String, String> querys)
            throws Exception {
        HttpClient httpClient = wrapClient(host);

        HttpGet request = new HttpGet(buildUrl(host, path, querys));
        for (Map.Entry<String, String> e : headers.entrySet()) {
            request.addHeader(e.getKey(), e.getValue());
        }

        return httpClient.execute(request);
    }

    /**
     * post form
     *
     * @param host
     * @param path
     * @param method
     * @param headers
     * @param querys
     * @param bodys
     * @return
     * @throws Exception
     */
    public static HttpResponse doPost(String host, String path, String method,
                                      Map<String, String> headers,
                                      Map<String, String> querys,
                                      Map<String, String> bodys)
            throws Exception {
        HttpClient httpClient = wrapClient(host);

        HttpPost request = new HttpPost(buildUrl(host, path, querys));
        for (Map.Entry<String, String> e : headers.entrySet()) {
            request.addHeader(e.getKey(), e.getValue());
        }

        if (bodys != null) {
            List<NameValuePair> nameValuePairList = new ArrayList<NameValuePair>();

            for (String key : bodys.keySet()) {
                nameValuePairList.add(new BasicNameValuePair(key, bodys.get(key)));
            }
            UrlEncodedFormEntity formEntity = new UrlEncodedFormEntity(nameValuePairList, "utf-8");
            formEntity.setContentType("application/x-www-form-urlencoded; charset=UTF-8");
            request.setEntity(formEntity);
        }

        return httpClient.execute(request);
    }

    /**
     * Post String
     *
     * @param host
     * @param path
     * @param method
     * @param headers
     * @param querys
     * @param body
     * @return
     * @throws Exception
     */
    public static HttpResponse doPost(String host, String path, String method,
                                      Map<String, String> headers,
                                      Map<String, String> querys,
                                      String body)
            throws Exception {
        HttpClient httpClient = wrapClient(host);

        HttpPost request = new HttpPost(buildUrl(host, path, querys));
        for (Map.Entry<String, String> e : headers.entrySet()) {
            request.addHeader(e.getKey(), e.getValue());
        }

        if (StringUtils.isNotBlank(body)) {
            request.setEntity(new StringEntity(body, "utf-8"));
        }

        return httpClient.execute(request);
    }

    /**
     * Post stream
     *
     * @param host
     * @param path
     * @param method
     * @param headers
     * @param querys
     * @param body
     * @return
     * @throws Exception
     */
    public static HttpResponse doPost(String host, String path, String method,
                                      Map<String, String> headers,
                                      Map<String, String> querys,
                                      byte[] body)
            throws Exception {
        HttpClient httpClient = wrapClient(host);

        HttpPost request = new HttpPost(buildUrl(host, path, querys));
        for (Map.Entry<String, String> e : headers.entrySet()) {
            request.addHeader(e.getKey(), e.getValue());
        }

        if (body != null) {
            request.setEntity(new ByteArrayEntity(body));
        }

        return httpClient.execute(request);
    }

    /**
     * Put String
     *
     * @param host
     * @param path
     * @param method
     * @param headers
     * @param querys
     * @param body
     * @return
     * @throws Exception
     */
    public static HttpResponse doPut(String host, String path, String method,
                                     Map<String, String> headers,
                                     Map<String, String> querys,
                                     String body)
            throws Exception {
        HttpClient httpClient = wrapClient(host);

        HttpPut request = new HttpPut(buildUrl(host, path, querys));
        for (Map.Entry<String, String> e : headers.entrySet()) {
            request.addHeader(e.getKey(), e.getValue());
        }

        if (StringUtils.isNotBlank(body)) {
            request.setEntity(new StringEntity(body, "utf-8"));
        }

        return httpClient.execute(request);
    }

    /**
     * Put stream
     *
     * @param host
     * @param path
     * @param method
     * @param headers
     * @param querys
     * @param body
     * @return
     * @throws Exception
     */
    public static HttpResponse doPut(String host, String path, String method,
                                     Map<String, String> headers,
                                     Map<String, String> querys,
                                     byte[] body)
            throws Exception {
        HttpClient httpClient = wrapClient(host);

        HttpPut request = new HttpPut(buildUrl(host, path, querys));
        for (Map.Entry<String, String> e : headers.entrySet()) {
            request.addHeader(e.getKey(), e.getValue());
        }

        if (body != null) {
            request.setEntity(new ByteArrayEntity(body));
        }

        return httpClient.execute(request);
    }

    /**
     * Delete
     *
     * @param host
     * @param path
     * @param method
     * @param headers
     * @param querys
     * @return
     * @throws Exception
     */
    public static HttpResponse doDelete(String host, String path, String method,
                                        Map<String, String> headers,
                                        Map<String, String> querys)
            throws Exception {
        HttpClient httpClient = wrapClient(host);

        HttpDelete request = new HttpDelete(buildUrl(host, path, querys));
        for (Map.Entry<String, String> e : headers.entrySet()) {
            request.addHeader(e.getKey(), e.getValue());
        }

        return httpClient.execute(request);
    }

    private static String buildUrl(String host, String path, Map<String, String> querys) throws UnsupportedEncodingException {
        StringBuilder sbUrl = new StringBuilder();
        sbUrl.append(host);
        if (!StringUtils.isBlank(path)) {
            sbUrl.append(path);
        }
        if (null != querys) {
            StringBuilder sbQuery = new StringBuilder();
            for (Map.Entry<String, String> query : querys.entrySet()) {
                if (0 < sbQuery.length()) {
                    sbQuery.append("&");
                }
                if (StringUtils.isBlank(query.getKey()) && !StringUtils.isBlank(query.getValue())) {
                    sbQuery.append(query.getValue());
                }
                if (!StringUtils.isBlank(query.getKey())) {
                    sbQuery.append(query.getKey());
                    if (!StringUtils.isBlank(query.getValue())) {
                        sbQuery.append("=");
                        sbQuery.append(URLEncoder.encode(query.getValue(), "utf-8"));
                    }
                }
            }
            if (0 < sbQuery.length()) {
                sbUrl.append("?").append(sbQuery);
            }
        }

        return sbUrl.toString();
    }

    private static HttpClient wrapClient(String host) {
        HttpClient httpClient = new DefaultHttpClient();
        if (host.startsWith("https://")) {
            sslClient(httpClient);
        }

        return httpClient;
    }

    private static void sslClient(HttpClient httpClient) {
        try {
            SSLContext ctx = SSLContext.getInstance("TLS");
            X509TrustManager tm = new X509TrustManager() {
                @Override
                public X509Certificate[] getAcceptedIssuers() {
                    return null;
                }

                @Override
                public void checkClientTrusted(X509Certificate[] xcs, String str) {

                }

                @Override
                public void checkServerTrusted(X509Certificate[] xcs, String str) {

                }
            };
            ctx.init(null, new TrustManager[]{tm}, null);
            SSLSocketFactory ssf = new SSLSocketFactory(ctx);
            ssf.setHostnameVerifier(SSLSocketFactory.ALLOW_ALL_HOSTNAME_VERIFIER);
            ClientConnectionManager ccm = httpClient.getConnectionManager();
            SchemeRegistry registry = ccm.getSchemeRegistry();
            registry.register(new Scheme("https", 443, ssf));
        } catch (KeyManagementException ex) {
            throw new RuntimeException(ex);
        } catch (NoSuchAlgorithmException ex) {
            throw new RuntimeException(ex);
        }
    }
}
```



### 1.3 æ–°å»º `CrowdTest` æµ‹è¯•ç±»ã€`auth` å·¥ç¨‹ã€‘

#### 1.3.1 å‰ç½®: è¿½åŠ ä¾èµ–

```xml
<!-- SpringBoot æµ‹è¯• -->
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-test</artifactId>
    <version>2.1.6.RELEASE</version>
    <scope>test</scope>
</dependency>
```

------

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661739650139-ba5aeaa8-0737-4890-9b90-9f38ba8a388d.png)

```java
package com.atguigu.crowd.test;

import com.aliyun.api.gateway.demo.util.HttpUtils;
import org.apache.http.HttpResponse;
import org.apache.http.util.EntityUtils;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.test.context.junit4.SpringRunner;

import java.util.HashMap;
import java.util.Map;

/**
 * @author é™ˆæ±Ÿæ—
 * @date 2022/8/29 09:16
 */
@RunWith(SpringRunner.class)
@SpringBootTest
public class CrowdTest {

    @Test
    public void testSendMessage() {
        String host = "https://dfsns.market.alicloudapi.com";
        String path = "/data/send_sms";
        String method = "POST";
        String appcode = "1948fa6afc674ea3bc2fea47f36e1108";
        Map<String, String> headers = new HashMap<>();
        //æœ€ååœ¨headerä¸­çš„æ ¼å¼(ä¸­é—´æ˜¯è‹±æ–‡ç©ºæ ¼)ä¸ºAuthorization:APPCODE 83359fd73fe94948385f570e3c139105
        headers.put("Authorization", "APPCODE " + appcode);
        //æ ¹æ®APIçš„è¦æ±‚ï¼Œå®šä¹‰ç›¸å¯¹åº”çš„Content-Type
        headers.put("Content-Type", "application/x-www-form-urlencoded; charset=UTF-8");
        Map<String, String> querys = new HashMap<>();
        Map<String, String> bodys = new HashMap<>();
        bodys.put("content", "code:1234");
        bodys.put("phone_number", "185xxxx5080");
        bodys.put("template_id", "TPL_0000");

        try {
            /**
             * é‡è¦æç¤ºå¦‚ä¸‹:
             * HttpUtilsè¯·ä»
             * https://github.com/aliyun/api-gateway-demo-sign-java/blob/master/src/main/java/com/aliyun/api/gateway/demo/util/HttpUtils.java
             * ä¸‹è½½
             *
             * ç›¸åº”çš„ä¾èµ–è¯·å‚ç…§
             * https://github.com/aliyun/api-gateway-demo-sign-java/blob/master/pom.xml
             */
            HttpResponse response = HttpUtils.doPost(host, path, method, headers, querys, bodys);
            // System.out.println(response.toString());
            // è·å–responseçš„body
            // {"status":"OK","request_id":"TIDef01a498c96747a19aa166cd81f9279d"}
            System.out.println(EntityUtils.toString(response.getEntity()));
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
```

### 1.4 `CrowdUtil` è¿½åŠ æ–¹æ³•ã€`common`å·¥ç¨‹ã€‘

```java
/**
 * ç»™è¿œç¨‹ç¬¬ä¸‰æ–¹æ¥å£å‘é€è¯·æ±‚æŠŠéªŒè¯ç å‘é€åˆ°ç”¨æˆ·æ‰‹æœºä¸Š
 *
 * @param appCode     ç”¨æ¥è°ƒç”¨ç¬¬ä¸‰æ–¹çŸ­ä¿¡ API çš„ AppCode
 * @param templateId  æ¨¡æ¿çš„ç¼–å·
 * @param host        çŸ­ä¿¡æ¥å£è°ƒç”¨çš„ URL åœ°å€
 * @param path        å…·ä½“å‘é€çŸ­ä¿¡åŠŸèƒ½çš„åœ°å€
 * @param method      è¯·æ±‚æ–¹å¼
 * @param phoneNumber æ¥æ”¶çŸ­ä¿¡çš„æ‰‹æœºå·ç 
 * @return æˆåŠŸè¿”å›: éªŒè¯ç 
 */
public static ResultEntity<String> sendShortMessage(String appCode, String templateId, String host, String path, String method, String phoneNumber) {
    // ç”ŸæˆéªŒè¯ç 
    StringBuilder code = new StringBuilder();
    for (int i = 0; i < 4; i++) {
        int random = (int) (Math.random() * 10);
        code.append(random);
    }

    Map<String, String> headers = new HashMap<>();
    //æœ€ååœ¨headerä¸­çš„æ ¼å¼(ä¸­é—´æ˜¯è‹±æ–‡ç©ºæ ¼)ä¸ºAuthorization:APPCODE 83359fd73fe94948385f570e3c139105
    headers.put("Authorization", "APPCODE " + appCode);
    //æ ¹æ®APIçš„è¦æ±‚ï¼Œå®šä¹‰ç›¸å¯¹åº”çš„Content-Type
    headers.put("Content-Type", "application/x-www-form-urlencoded; charset=UTF-8");
    Map<String, String> querys = new HashMap<>();
    Map<String, String> bodys = new HashMap<>();

    bodys.put("content", "code:" + code);
    bodys.put("phone_number", phoneNumber);
    if (templateId == null) {
        // æµ‹è¯•æ¨¡æ¿çš„ Id
        bodys.put("template_id", "TPL_0000");
    } else {
        bodys.put("template_id", templateId);
    }

    try {
        /**
         * é‡è¦æç¤ºå¦‚ä¸‹:
         * HttpUtilsè¯·ä»
         * https://github.com/aliyun/api-gateway-demo-sign-java/blob/master/src/main/java/com/aliyun/api/gateway/demo/util/HttpUtils.java
         * ä¸‹è½½
         *
         * ç›¸åº”çš„ä¾èµ–è¯·å‚ç…§
         * https://github.com/aliyun/api-gateway-demo-sign-java/blob/master/pom.xml
         */
        HttpResponse response = HttpUtils.doPost(host, path, method, headers, querys, bodys);
        System.out.println(response.toString());
        //è·å–responseçš„body
        //System.out.println(EntityUtils.toString(response.getEntity()));

        StatusLine statusLine = response.getStatusLine();
        // çŠ¶æ€ç : [{200: æ­£å¸¸}, {400: è¯·æ±‚å‚æ•°é”™è¯¯}, {403: å¥—é¤ä½™é¢ç”¨å®Œ}, {500: æœåŠ¡å™¨å†…éƒ¨é”™è¯¯}]
        int statusCode = statusLine.getStatusCode();
        String reasonPhrase = statusLine.getReasonPhrase();

        if (statusCode == 200) {
            return ResultEntity.successWithData(code.toString());
        } else {
            return ResultEntity.failed(reasonPhrase);
        }
    } catch (Exception e) {
        return ResultEntity.failed(e.getMessage());
    }
}
```



## 2. å‘é€éªŒè¯ç ã€`auth` å·¥ç¨‹ã€‘

- å°†éªŒè¯ç å‘é€åˆ°ç”¨æˆ·æ‰‹æœºä¸Š
- å°†éªŒè¯ç å­˜å…¥ `Redis` ä¸­

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661752982629-d2f728d5-2193-4e09-9e26-1238e5862231.png)

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661303711451-a1e90c90-61a4-4c8c-8822-806ebac12970.png)



### 2.1 é…ç½®è·³è½¬è·¯å¾„å’Œå¯¹åº”çš„é¡µé¢

#### 2.1.1 æ–°å»º `CrowdWebMvcConfig` ç±»

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661741337449-58492ae4-ac1b-41d9-9555-3ce4f4267504.png)

```java
package com.atguigu.crowd.config;

import org.springframework.context.annotation.Configuration;
import org.springframework.web.servlet.config.annotation.ViewControllerRegistry;
import org.springframework.web.servlet.config.annotation.WebMvcConfigurer;

/**
 * @author é™ˆæ±Ÿæ—
 * @date 2022/8/29 10:48
 */
@Configuration
public class CrowdWebMvcConfig implements WebMvcConfigurer {

    @Override
    public void addViewControllers(ViewControllerRegistry registry) {
        registry.addViewController("/auth/member/to/reg/page").setViewName("member-reg");
        registry.addViewController("/auth/member/to/login/page").setViewName("member-login");
    }

}
```



### 2.2 ä¿®æ”¹ä»£ç  `portal.html`

```html
<!--                        <li><a href="login.html">ç™»å½•</a></li>-->
<!--                        <li><a href="reg.html">æ³¨å†Œ</a></li>-->
<li><a th:href="@{/auth/member/to/login/page}">ç™»å½•</a></li>
<li><a th:href="@{/auth/member/to/reg/page}">æ³¨å†Œ</a></li>
```



### 2.3 æ–°å»º `member-reg.html` æ³¨å†Œé¡µé¢

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661742933900-febbd4fc-ff6d-4b2a-9904-f8b58fbfeb3c.png)

```html
<!DOCTYPE html>
<html lang="zh-CN" xmlns:th="https://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="keys" content="">
    <meta name="author" content="">
    <base th:href="@{/}">
    <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <link rel="stylesheet" href="css/login.css">
    <script type="text/javascript" src="jquery/jquery-2.1.1.min.js"></script>
    <script type="text/javascript" src="bootstrap/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="layer/layer.js"></script>
    <script type="text/javascript">
        // layer.msg("aaa...");

        $(function () {
            $("#sendBtn").click(function () {
                // 1. è·å–æ¥é€çŸ­ä¿¡çš„æ‰‹æœºå·ç 
                let phoneNum = $.trim($("[name=phoneNum]").val());

                // 2. å‘é€è¯·æ±‚
                $.ajax({
                    url: "auth/member/send/short/message.json",
                    type: "post",
                    data: {
                        phoneNum: phoneNum
                    },
                    dataType: "json",
                    success: function (response) {
                        var result = response.result;
                        if ("SUCCESS" === result) {
                            layer.msg("å‘é€æˆåŠŸ")
                        }

                        if ("FAILED" === result) {
                            layer.msg("å‘é€å¤±è´¥, è¯·é‡è¯•")
                        }
                    },
                    error: function (response) {
                        layer.msg(response.status + " " + response.statusText);
                    }
                })
            })
        })
    </script>
</head>
<body>
<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <div><a class="navbar-brand" th:href="@{/}" style="font-size:32px;">å°šç­¹ç½‘-åˆ›æ„äº§å“ä¼—ç­¹å¹³å°</a></div>
        </div>
    </div>
</nav>

<div class="container">

    <form action="/auth/do/member/register" method="post" class="form-signin" role="form">
        <h2 class="form-signin-heading"><i class="glyphicon glyphicon-log-in"></i> ç”¨æˆ·æ³¨å†Œ</h2>
        <p th:text="${message}">è¿™é‡Œæ˜¾ç¤ºä»è¯·æ±‚åŸŸå–å‡ºçš„æç¤ºæ¶ˆæ¯</p>
        <div class="form-group has-success has-feedback">
            <input type="text" class="form-control" id="loginacct" name="loginacct" placeholder="è¯·è¾“å…¥ç™»å½•è´¦å·" autofocus>
            <span class="glyphicon glyphicon-user form-control-feedback"></span>
        </div>
        <div class="form-group has-success has-feedback">
            <input type="text" class="form-control" id="userpswd" name="userpswd" placeholder="è¯·è¾“å…¥ç™»å½•å¯†ç "
                   style="margin-top:10px;">
            <span class="glyphicon glyphicon-lock form-control-feedback"></span>
        </div>
        <div class="form-group has-success has-feedback">
            <input type="text" class="form-control" id="username" name="username" placeholder="è¯·è¾“å…¥ç™»å½•æ˜µç§°" autofocus>
            <span class="glyphicon glyphicon-user form-control-feedback"></span>
        </div>
        <div class="form-group has-success has-feedback">
            <input type="text" class="form-control" id="email" name="email" placeholder="è¯·è¾“å…¥é‚®ç®±åœ°å€"
                   style="margin-top:10px;">
            <span class="glyphicon glyphicon glyphicon-envelope form-control-feedback"></span>
        </div>
        <div class="form-group has-success has-feedback">
            <input type="text" class="form-control" id="phoneNum" name="phoneNum" placeholder="è¯·è¾“å…¥æ‰‹æœºå·"
                   style="margin-top:10px;">
            <span class="glyphicon glyphicon glyphicon-earphone form-control-feedback"></span>
        </div>
        <div class="form-group has-success has-feedback">
            <input type="text" class="form-control" id="code" name="code" placeholder="è¯·è¾“å…¥éªŒè¯ç " style="margin-top:10px;">
            <span class="glyphicon glyphicon glyphicon-comment form-control-feedback"></span>
        </div>
        <button id="sendBtn" type="button" class="btn btn-lg btn-success btn-block"> è·å–éªŒè¯ç </button>
        <button type="submit" class="btn btn-lg btn-success btn-block"> æ³¨å†Œ</button>
    </form>

</div>

</body>
</html>
```



#### 2.3.1 æ·»åŠ  `layer`åˆ° `static` ä¸‹ [ğŸ“layer.zip](https://www.yuque.com/attachments/yuque/0/2022/zip/12811585/1661304823359-ba71611a-3f5d-482b-ad14-5451941d27a6.zip)

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661741626640-e781ac6d-c56d-4fe4-b722-59e628c8b5d9.png)



### 2.4 è¿½åŠ ä¾èµ–

```xml
<!-- å¯¼å…¥é…ç½®æ–‡ä»¶å¤„ç†å™¨, é…ç½®æ–‡ä»¶è¿›è¡Œç»‘å®š -->
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-configuration-processor</artifactId>
    <optional>true</optional>
</dependency>
```



### 2.5 æ–°å»º `ShortMessageProperties` ç±»

```java
package com.atguigu.crowd.config;

import lombok.AllArgsConstructor;
import lombok.Data;
import lombok.NoArgsConstructor;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.stereotype.Component;

/**
 * ç¬¬ä¸‰æ–¹çŸ­ä¿¡æ¥å£å±æ€§
 *
 * @author é™ˆæ±Ÿæ—
 * @date 2022/8/29 11:24
 */
@NoArgsConstructor
@AllArgsConstructor
@Data
@Component
@ConfigurationProperties(prefix = "short.message")
public class ShortMessageProperties {

    private String appCode;
    private String templateId;
    private String host;
    private String method;
    private String path;

}
```



### 2.6 è¿½åŠ é…ç½®

```yaml
# ç¬¬ä¸‰æ–¹çŸ­ä¿¡æ¥å£
short:
  message:
    app-code: 1948fa6afc674ea3bc2fea47f36e1108
    host: https://dfsns.market.alicloudapi.com
    path: /data/send_sms
    method: POST
```



### 2.7 æ–°å»º `MemberHandler` å‘é€çŸ­ä¿¡

```java
package com.atguigu.crowd.handler;

import com.atguigu.crowd.api.RedisRemoteService;
import com.atguigu.crowd.config.ShortMessageProperties;
import com.atguigu.crowd.constant.CrowdConstant;
import com.atguigu.crowd.util.CrowdUtil;
import com.atguigu.crowd.util.ResultEntity;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.ResponseBody;

import java.util.concurrent.TimeUnit;

/**
 * @author é™ˆæ±Ÿæ—
 * @date 2022/8/29 11:21
 */
@Controller
public class MemberHandler {

    @Autowired
    private ShortMessageProperties shortMessageProperties;

    @Autowired
    private RedisRemoteService redisRemoteService;

    /**
     * å‘é€çŸ­ä¿¡éªŒè¯ç 
     *
     * @param phoneNum æ‰‹æœºå·ç 
     * @return
     */
    @ResponseBody
    @RequestMapping("/auth/member/send/short/message.json")
    public ResultEntity<String> sendMessage(
            @RequestParam("phoneNum") String phoneNum) {
        try {
            // 1. å‘é€éªŒè¯ç 
            ResultEntity<String> sendMessageResultEntity = CrowdUtil.sendShortMessage(
                    shortMessageProperties.getAppCode(),
                    shortMessageProperties.getTemplateId(),
                    shortMessageProperties.getHost(),
                    shortMessageProperties.getPath(),
                    shortMessageProperties.getMethod(),
                    phoneNum
            );

            // 2. åˆ¤æ–­å‘é€ç»“æœ
            if(ResultEntity.SUCCESS.equals(sendMessageResultEntity.getResult())) {
                // 3. æˆåŠŸ: å°†éªŒè¯ç å­˜å…¥ Redis
                String code = sendMessageResultEntity.getData();
                String key = CrowdConstant.REDIS_CODE_PREFIX + phoneNum;
                ResultEntity<String> saveCodeResultEntity = redisRemoteService.setRedisKeyValueRemoteWithTimeout(key, code, 15, TimeUnit.MINUTES);
                if(ResultEntity.SUCCESS.equals(saveCodeResultEntity.getResult())) {
                    return ResultEntity.successWithoutData();
                } else {
                    return saveCodeResultEntity;
                }
            } else {
                return sendMessageResultEntity;
            }
        } catch (Exception e){
            return ResultEntity.failed(e.getMessage());
        }
    }
}
```



### 2.8 è¿½åŠ ä»£ç  `CrowdConstant`ã€`common`ã€‘

```java
public static final String REDIS_CODE_PREFIX = "REDIS_CODE_PREFIX_";
```



## 3. æ‰§è¡Œæ³¨å†Œæµç¨‹

- å¦‚æœé’ˆå¯¹æ³¨å†Œæ“ä½œæ‰€åšçš„å„é¡¹éªŒè¯èƒ½å¤Ÿé€šè¿‡, åˆ™å°† Member ä¿¡æ¯å­˜å…¥æ•°æ®åº“

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661318337459-34acb207-e4f6-442c-bcc7-d6535d5bcc1c.png)



- **æ“ä½œ**: ç»™ `t_member` è¡¨ä¸­å­—æ®µ `loginacct` è®¾ç½®å”¯ä¸€

### 3.1 è¿½åŠ ä»£ç  `MySQLRemoteService`ã€`API` å·¥ç¨‹ã€‘

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661753173442-0bc49c95-f1ee-40e2-8638-f9fe7685858c.png)

```java
/**
 * ä¿å­˜
 *
 * @param memberPO ä¼šå‘˜å®ä½“ç±»
 * @return
 */
@RequestMapping("/save/member/remote")
ResultEntity<String> saveMember(@RequestBody MemberPO memberPO);
```



### 3.2 `MySQL` é¡¹ç›®

#### 3.2.1 è¿½åŠ ä»£ç  `MemberProviderHandler`

```java
/**
 * ä¿å­˜
 *
 * @param memberPO ä¼šå‘˜å®ä½“ç±»
 * @return
 */
@RequestMapping("/save/member/remote")
public ResultEntity<String> saveMember(@RequestBody MemberPO memberPO) {
    try {
        memberService.saveMember(memberPO);
        return ResultEntity.successWithoutData();
    } catch (Exception e) {
        if (e instanceof DuplicateKeyException) {
            return ResultEntity.failed(CrowdConstant.MESSAGE_LOGIN_ACCT_ALREADY_IN_USE);
        }

        return ResultEntity.failed(e.getMessage());
    }
}
```



#### 3.2.2 è¿½åŠ ä»£ç  `MemberService`

```java
/**
 * ä¿å­˜
 *
 * @param memberPO ä¼šå‘˜å®ä½“ç±»
 * @return
 */
void saveMember(MemberPO memberPO);
```



#### 3.2.3 è¿½åŠ ä»£ç  `MemberServiceImpl`

```java
@Transactional(
    propagation = Propagation.REQUIRES_NEW, 
    rollbackFor = Exception.class
)
@Override
public void saveMember(MemberPO memberPO) {
    memberPOMapper.insert(memberPO);
}
```



### 3.3 æµ‹è¯• `http://localhost:2000/save/member/remote`

- `body`: `{"loginacct": "tom","userpswd": "123"}`

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661762061989-533b9ba6-7d23-46bc-aecb-164a9a1e141e.png)

- `Content-Type`: `application/json;charset=utf-8`

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661319471006-2d33c481-848c-4fc9-b2d2-47390293465e.png)

- ç»“æœ

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661762078859-d289e693-501b-4702-837c-6bfdbef7310c.png)



### 3.4 `Entity` å·¥ç¨‹

#### 3.4.1 æ–°å»º `MemberVO` å°è£…è¡¨å•æ•°æ®

```java
package com.atguigu.crowd.entity.vo;

import lombok.AllArgsConstructor;
import lombok.Data;
import lombok.NoArgsConstructor;

/**
 * @author é™ˆæ±Ÿæ—
 * @date 2022/8/29 16:35
 */
@NoArgsConstructor
@AllArgsConstructor
@Data
public class MemberVO {

    private String loginacct;

    private String userpswd;

    private String username;

    private String email;

    private String phoneNum;

    private String code;

}
```



### 3.5 `Auth` é¡¹ç›®

#### 3.5.1 è¿½åŠ ä»£ç  `MemberHandler`

```java
@RequestMapping("/auth/do/member/register")
public String register(MemberVO memberVO, ModelMap modelMape) {
    // 1. è·å–ç”¨æˆ·è¾“å…¥çš„æ‰‹æœºå·ç 
    String phoneNum = memberVO.getPhoneNum();
    
    // 2. æ‹¼ Redis ä¸­å­˜å‚¨éªŒè¯ç çš„ Key
    String key = CrowdConstant.REDIS_CODE_PREFIX + phoneNum;
    
    // 3. ä» Redis è¯»å– Key å¯¹åº”çš„ Value
    ResultEntity<String> resultEntity = redisRemoteService.getRedisStringValue(key);
    
    // 4. æ£€æŸ¥æŸ¥è¯¢æ“ä½œæ˜¯å¦æœ‰æ•ˆ
    String result = resultEntity.getResult();
    if(resultEntity.FAILD.equals(result)) {
        // ATTR_NAME_MESSAGE = message;
        modelMape.addAttribute(CrowdConstant.ATTR_NAME_MESSAGE, resultEntity.getMessage());
        return "member-reg";
    }
        
    String redisCode = resultEntity.getData();
    
    if(redisCode == null) {
        // MESSAGE_CODE_NOT_EXISTS = éªŒè¯ç å·²è¿‡æœŸ!è¯·æ£€æŸ¥æ‰‹æœºå·ç æ˜¯å¦æ­£ç¡®æˆ–é‡æ–°å‘é€!
        modelMape.addAttribute(CrowdConstant.ATTR_NAME_MESSAGE, CrowdConstant.MESSAGE_CODE_NOT_EXISTS);
        return "member-reg";
    }
    
    // 5. å¦‚æœä» Redis èƒ½å¤ŸæŸ¥è¯¢åˆ° Value åˆ™æ¯”è¾ƒè¡¨å•çš„éªŒè¯ç å’Œ Redis çš„éªŒè¯ç 
    String formCode = memberVO.getCode();
    
    if(!Object.equals(formCode, redisCode)) {
        // MESSAGE_CODE_INVALID = éªŒè¯ç ä¸æ­£ç¡®!
        modelMape.addAttribute(CrowdConstant.ATTR_NAME_MESSAGE, CrowdConstant.MESSAGE_CODE_INVALID);
        return "member-reg";
    }
    
    // 6. å¦‚æœéªŒè¯ç ä¸€è‡´åˆ™ä» Redis åˆ é™¤
    redisRemoteService.removeRedisKeyRemote(key);
    
    // 7. æ‰§è¡Œå¯†ç åŠ å¯†
    BCryptPasswordEncoder bCryptPasswordEncoder = new BCryptPasswordEncoder();
    String userpswdBeforeEncode = memberVO.getUserpswd();
    String userpswdAfterEncode = bCryptPasswordEncoder.encode(userpswdBeforeEncode);
    
    memberVO.serUserpswd(userpswdAfterEncode);
    // 8. æ‰§è¡Œä¿å­˜
    // 8.1 åˆ›å»ºç©ºçš„ memberPO å¯¹è±¡
    MemberPO memberPO = new MemberPO();
    
    // 8.2 å¤åˆ¶å±æ€§
    BeanUtils.copyProperties(memberVO, memberPO);
    
    // 8.3 è°ƒç”¨è¿œç¨‹çš„æ–¹æ³•
    ResultEntity<String> saveMemberResultEntity = mysqlRemoteService.saveMember(memberPO);
    if(saveMemberResultEntity.FAILD.equals(result)) {
        modelMape.addAttribute(CrowdConstant.ATTR_NAME_MESSAGE, saveMemberResultEntity.getMessage());
        return "member-reg";
    }
    
    // ä½¿ç”¨é‡å®šå‘é¿å…åˆ·æ–°æµè§ˆå™¨å¯¼è‡´é‡æ–°æ‰§è¡Œæ³¨å†Œæµç¨‹
    return "redirect:/auth/member/to/login/page";
}
```



#### 3.5.2 ç™»å½•é¡µé¢ `member-login.html`

```html
<!DOCTYPE html>
<html lang="zh-CN" xmlns:th="https://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="keys" content="">
    <meta name="author" content="">
    <base th:href="@{/}">
    <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <link rel="stylesheet" href="css/login.css">
    <script src="jquery/jquery-2.1.1.min.js"></script>
    <script src="bootstrap/js/bootstrap.min.js"></script>
</head>
<body>
<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <div><a class="navbar-brand" th:href="@{/}" style="font-size:32px;">å°šç­¹ç½‘-åˆ›æ„äº§å“ä¼—ç­¹å¹³å°</a></div>
        </div>
    </div>
</nav>

<div class="container">

    <form class="form-signin" role="form">
        <h2 class="form-signin-heading"><i class="glyphicon glyphicon-log-in"></i> ç”¨æˆ·ç™»å½•</h2>
        <div class="form-group has-success has-feedback">
            <input type="text" class="form-control" id="loginacct" name="loginacct" placeholder="è¯·è¾“å…¥ç™»å½•è´¦å·" autofocus>
            <span class="glyphicon glyphicon-user form-control-feedback"></span>
        </div>
        <div class="form-group has-success has-feedback">
            <input type="text" class="form-control" id="userpswd" name="userpswd" placeholder="è¯·è¾“å…¥ç™»å½•å¯†ç "
                   style="margin-top:10px;">
            <span class="glyphicon glyphicon-lock form-control-feedback"></span>
        </div>
        <div class="checkbox" style="text-align:right;"><a th:href="@{/auth/member/to/reg/page}">æˆ‘è¦æ³¨å†Œ</a></div>
        <button type="submit" class="btn btn-lg btn-success btn-block">ç™»å½•</button>
    </form>
</div>

</body>
</html>
```



### 3.6 `Common` å·¥ç¨‹

#### 3.6.1 è¿½åŠ ä»£ç  `CrowdContant`

```java
public static final String MESSAGE_CODE_NOT_EXISTS = "éªŒè¯ç å·²è¿‡æœŸ!è¯·æ£€æŸ¥æ‰‹æœºå·ç æ˜¯å¦æ­£ç¡®æˆ–é‡æ–°å‘é€!";
public static final String MESSAGE_CODE_INVALID = "éªŒè¯ç ä¸æ­£ç¡®!";

public static final String REDIS_CODE_PREFIX = "REDIS_CODE_PREFIX_";
public static final String ATTR_NAME_MESSAGE = "message";
```




# åå…« ä¼šå‘˜ç™»å½•

```
git checkout -b 18.0.0_member_login
```

## 1. ç™»å½•æµç¨‹

- æ£€æŸ¥è´¦å·å¯†ç æ­£ç¡®åå°†ç”¨æˆ·ä¿¡æ¯å­˜å…¥ `Session`, è¡¨ç¤ºç”¨æˆ·å·²ç™»å½•

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661501170375-e4fa33c7-9564-4a02-8e2e-6f8988022eef.png)



### 1.1 `Entity`

#### 1.1.1 æ–°å»º `MemberLoginVO`

```java
package com.atguigu.crowd.entity.vo;

import lombok.AllArgsConstructor;
import lombok.Data;
import lombok.NoArgsConstructor;

import java.io.Serializable;

/**
 * @author é™ˆæ±Ÿæ—
 * @date 2022/8/29 21:09
 */
@Data
@NoArgsConstructor
@AllArgsConstructor
public class MemberLoginVO implements Serializable {

    private static final long serialVersionUID = 1L;

    private Integer id;

    private String username;

    private String email;

}
```





### 1.2 `Auth` å·¥ç¨‹

#### 1.2.1 ä¿®æ”¹ä»£ç  `member-login.html`

```html
<!DOCTYPE html>
<html lang="zh-CN" xmlns:th="https://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="keys" content="">
    <meta name="author" content="">
    <base th:href="@{/}">
    <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <link rel="stylesheet" href="css/login.css">
    <script src="jquery/jquery-2.1.1.min.js"></script>
    <script src="bootstrap/js/bootstrap.min.js"></script>
</head>
<body>
<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <div><a class="navbar-brand" th:href="@{/}" style="font-size:32px;">å°šç­¹ç½‘-åˆ›æ„äº§å“ä¼—ç­¹å¹³å°</a></div>
        </div>
    </div>
</nav>

<div class="container">
    <form action="/auth/member/do/login" method="post" class="form-signin" role="form">
        <h2 class="form-signin-heading"><i class="glyphicon glyphicon-log-in"></i> ç”¨æˆ·ç™»å½•</h2>
        <p th:text="${message}">è¿™é‡Œæ˜¾ç¤ºä»è¯·æ±‚åŸŸå–å‡ºçš„æç¤ºæ¶ˆæ¯</p>
        <div class="form-group has-success has-feedback">
            <input type="text" class="form-control" id="loginacct" name="loginacct" placeholder="è¯·è¾“å…¥ç™»å½•è´¦å·" autofocus>
            <span class="glyphicon glyphicon-user form-control-feedback"></span>
        </div>
        <div class="form-group has-success has-feedback">
            <input type="text" class="form-control" id="userpswd" name="userpswd" placeholder="è¯·è¾“å…¥ç™»å½•å¯†ç "
                   style="margin-top:10px;">
            <span class="glyphicon glyphicon-lock form-control-feedback"></span>
        </div>
        <div class="checkbox" style="text-align:right;"><a th:href="@{/auth/member/to/reg/page}">æˆ‘è¦æ³¨å†Œ</a></div>
        <button type="submit" class="btn btn-lg btn-success btn-block">ç™»å½•</button>
    </form>
</div>

</body>
</html>
```



#### 1.2.2 è¿½åŠ ä»£ç  `MemberHandler`

```java
/**
 * ä¼šå‘˜ç™»å½•
 *
 * @param loginacct è´¦æˆ·
 * @param userpswd å¯†ç 
 * @param modelMap
 * @param session
 * @return
 */
@RequestMapping("/auth/member/do/login")
public String doLogin(
        @RequestParam("loginacct") String loginacct,
        @RequestParam("userpswd") String userpswd,
        ModelMap modelMap,
        HttpSession session) {
    ResultEntity<MemberPO> resultEntity = mySQLRemoteService.getMemberPOByLoginAcctRemote(loginacct);
    if (ResultEntity.FAILED.equals(resultEntity.getResult())) {
        modelMap.addAttribute(CrowdConstant.ATTR_NAME_MESSAGE, resultEntity.getMessage());
        return "member-login";
    }

    MemberPO memberPO = resultEntity.getData();
    if (memberPO == null) {
        modelMap.addAttribute(CrowdConstant.ATTR_NAME_MESSAGE, CrowdConstant.MESSAGE_LOGIN_FAILED);
        return "member-login";
    }

    // 2. æ¯”è¾ƒå¯†ç 
    String userpswdDataBase = memberPO.getUserpswd();

    BCryptPasswordEncoder bCryptPasswordEncoder = new BCryptPasswordEncoder();
    bCryptPasswordEncoder.matches(userpswd, userpswdDataBase);

    // 3. åˆ›å»º MemberLoginVO å¯¹è±¡ä¼ å…¥ Session åŸŸ
    MemberLoginVO memberLoginVO = new MemberLoginVO(memberPO.getId(), memberPO.getUsername(), memberPO.getEmail());
    // ATTR_NAME_LOGIN_MEMBER = loginMember
    session.setAttribute(CrowdConstant.ATTR_NAME_LOGIN_MEMBER, memberLoginVO);

    return "redirect:/auth/member/to/conter/page";
}
```



#### 1.2.3 è¿½åŠ ä»£ç  `CrowdWebMvcConfig` è®¾ç½®è·³è½¬é¡µé¢

```java
registry.addViewController("/auth/member/to/conter/page").setViewName("member-conter");
```



#### 1.2.4 æ–°å»ºé¡µé¢ `member-conter.html`

```html
<!DOCTYPE html>
<html lang="zh-CN" xmlns:th="https://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <base th:href="@{/}">
    <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <link rel="stylesheet" href="css/theme.css">
    <script src="jquery/jquery-2.1.1.min.js"></script>
    <script src="bootstrap/js/bootstrap.min.js"></script>
    <script src="script/docs.min.js"></script>
    <script src="script/back-to-top.js"></script>
    <script src="script/echarts.js"></script>
    <style>
        #footer {
            padding: 15px 0;
            background: #fff;
            border-top: 1px solid #ddd;
            text-align: center;
        }

        #topcontrol {
            color: #fff;
            z-index: 99;
            width: 30px;
            height: 30px;
            font-size: 20px;
            background: #222;
            position: relative;
            right: 14px !important;
            bottom: 11px !important;
            border-radius: 3px !important;
        }

        #topcontrol:after {
            /*top: -2px;*/
            left: 8.5px;
            content: "\f106";
            position: absolute;
            text-align: center;
            font-family: FontAwesome;
        }

        #topcontrol:hover {
            color: #fff;
            background: #18ba9b;
            -webkit-transition: all 0.3s ease-in-out;
            -moz-transition: all 0.3s ease-in-out;
            -o-transition: all 0.3s ease-in-out;
            transition: all 0.3s ease-in-out;
        }

    </style>
</head>
<body>
<div class="navbar-wrapper">
    <div class="container">
        <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand" th:href="@{/}" style="font-size:32px;">å°šç­¹ç½‘-åˆ›æ„äº§å“ä¼—ç­¹å¹³å°</a>
                </div>
                <div id="navbar" class="navbar-collapse collapse" style="float:right;">
                    <ul class="nav navbar-nav">
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i
                                    class="glyphicon glyphicon-user"></i> [[${session.loginMember.username}]]<span
                                    class="caret"></span></a>
                            <ul class="dropdown-menu" role="menu">
                                <li><a href="member.html"><i class="glyphicon glyphicon-scale"></i> ä¼šå‘˜ä¸­å¿ƒ</a></li>
                                <li><a href="#"><i class="glyphicon glyphicon-comment"></i> æ¶ˆæ¯</a></li>
                                <li class="divider"></li>
                                <li><a href="index.html"><i class="glyphicon glyphicon-off"></i> é€€å‡ºç³»ç»Ÿ</a></li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>

    </div>
</div>
<div class="container">
    <div class="row clearfix">
        <div class="col-sm-3 col-md-3 column">
            <div class="row">
                <div class="col-md-12">
                    <div class="thumbnail" style="    border-radius: 0px;">
                        <img src="img/services-box1.jpg" class="img-thumbnail" alt="">
                        <div class="caption" style="text-align:center;">
                            <h3>
                                [[${session.loginMember.username}]]
                            </h3>
                            <span class="label label-danger" style="cursor:pointer;"
                                  onclick="window.location.href='accttype.html'">æœªå®åè®¤è¯</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="list-group">
                <div class="list-group-item active">
                    èµ„äº§æ€»è§ˆ<span class="badge"><i class="glyphicon glyphicon-chevron-right"></i></span>
                </div>
                <div class="list-group-item " style="cursor:pointer;"
                     onclick="window.location.href='minecrowdfunding.html'">
                    æˆ‘çš„ä¼—ç­¹<span class="badge"><i class="glyphicon glyphicon-chevron-right"></i></span>
                </div>
            </div>
        </div>
        <div class="col-sm-9 col-md-9 column">
            <blockquote style="border-left: 5px solid #f60;color:#f60;padding: 0 0 0 20px;">
                <b>
                    æˆ‘çš„é’±åŒ…
                </b>
            </blockquote>
            <div id="main" style="width: 600px;height:400px;"></div>
            <blockquote style="border-left: 5px solid #f60;color:#f60;padding: 0 0 0 20px;">
                <b>
                    ç†è´¢
                </b>
            </blockquote>
            <div id="main1" style="width: 600px;height:400px;"></div>
            <blockquote style="border-left: 5px solid #f60;color:#f60;padding: 0 0 0 20px;">
                <b>
                    æ¯”ä¾‹
                </b>
            </blockquote>
            <div id="main2" style="width: 600px;height:400px;"></div>
        </div>
    </div>
</div>
<div class="container" style="margin-top:20px;">
    <div class="row clearfix">
        <div class="col-md-12 column">
            <div id="footer">
                <div class="footerNav">
                    <a rel="nofollow" href="http://www.atguigu.com">å…³äºæˆ‘ä»¬</a> | <a rel="nofollow"
                                                                                  href="http://www.atguigu.com">æœåŠ¡æ¡æ¬¾</a>
                    | <a rel="nofollow" href="http://www.atguigu.com">å…è´£å£°æ˜</a> | <a rel="nofollow"
                                                                                    href="http://www.atguigu.com">ç½‘ç«™åœ°å›¾</a>
                    | <a rel="nofollow" href="http://www.atguigu.com">è”ç³»æˆ‘ä»¬</a>
                </div>
                <div class="copyRight">
                    Copyright ?2017-2017atguigu.com ç‰ˆæƒæ‰€æœ‰
                </div>
            </div>

        </div>
    </div>
</div>

<script>
    $('#myTab a').click(function (e) {
        e.preventDefault()
        $(this).tab('show')
    })
    $('#myTab1 a').click(function (e) {
        e.preventDefault()
        $(this).tab('show')
    })

    var myChart = echarts.init(document.getElementById('main'));

    // æŒ‡å®šå›¾è¡¨çš„é…ç½®é¡¹å’Œæ•°æ®
    option = {
        title: {
            text: 'ä¸ƒæ—¥å¹´åŒ–æ”¶ç›Šç‡(%)'
        },
        tooltip: {
            trigger: 'axis'
        },
        legend: {
            data: ['åŸºé‡‘', 'è‚¡ç¥¨']
        },
        toolbox: {
            show: false,
            feature: {
                dataZoom: {
                    yAxisIndex: 'none'
                },
                dataView: {readOnly: false},
                magicType: {type: ['line', 'bar']},
                restore: {},
                saveAsImage: {}
            }
        },
        xAxis: {
            type: 'category',
            boundaryGap: false,
            data: ['2017-05-16', '2017-05-17', '2017-05-18', '2017-05-19', '2017-05-20', '2017-05-21', '2017-05-22']
        },
        yAxis: {
            type: 'value',
            axisLabel: {
                formatter: '{value} '
            }
        },
        series: [
            {
                name: 'åŸºé‡‘',
                type: 'line',
                data: [1, 1, 5, 3, 2, 3, 2],
                markPoint: {
                    data: [
                        {type: 'max', name: 'æœ€å¤§å€¼'},
                        {type: 'min', name: 'æœ€å°å€¼'}
                    ]
                },
                markLine: {
                    data: [
                        {type: 'average', name: 'å¹³å‡å€¼'}
                    ]
                }
            },
            {
                name: 'è‚¡ç¥¨',
                type: 'line',
                data: [1, -2, 2, 5, 3, 2, 4],
                markPoint: {
                    data: [
                        {name: 'å‘¨æœ€ä½', value: -2, xAxis: 1, yAxis: -1.5}
                    ]
                },
                markLine: {
                    data: [
                        {type: 'average', name: 'å¹³å‡å€¼'},
                        [{
                            symbol: 'none',
                            x: '90%',
                            yAxis: 'max'
                        }, {
                            symbol: 'circle',
                            label: {
                                normal: {
                                    position: 'start',
                                    formatter: 'æœ€å¤§å€¼'
                                }
                            },
                            type: 'max',
                            name: 'æœ€é«˜ç‚¹'
                        }]
                    ]
                }
            }
        ]
    };
    myChart.setOption(option);
    var myChart1 = echarts.init(document.getElementById('main1'));

    // æŒ‡å®šå›¾è¡¨çš„é…ç½®é¡¹å’Œæ•°æ®
    option1 = {
        color: ['#3398DB'],
        tooltip: {
            trigger: 'axis',
            axisPointer: {            // åæ ‡è½´æŒ‡ç¤ºå™¨ï¼Œåæ ‡è½´è§¦å‘æœ‰æ•ˆ
                type: 'shadow'        // é»˜è®¤ä¸ºç›´çº¿ï¼Œå¯é€‰ä¸ºï¼š'line' | 'shadow'
            }
        },
        grid: {
            left: '3%',
            right: '4%',
            bottom: '3%',
            containLabel: true
        },
        xAxis: [
            {
                type: 'category',
                data: ['åŸºé‡‘', 'ç¥¨æ®', 'å®šæœŸç†è´¢', 'å˜ç°è´·'],
                axisTick: {
                    alignWithLabel: true
                }
            }
        ],
        yAxis: [
            {
                type: 'value'
            }
        ],
        series: [
            {
                name: 'ç›´æ¥è®¿é—®',
                type: 'bar',
                barWidth: '60%',
                data: [10, 52, 200, 334, 390, 330, 220]
            }
        ]
    };

    // ä½¿ç”¨åˆšæŒ‡å®šçš„é…ç½®é¡¹å’Œæ•°æ®æ˜¾ç¤ºå›¾è¡¨ã€‚
    myChart1.setOption(option1);

    var myChart2 = echarts.init(document.getElementById('main2'));

    // æŒ‡å®šå›¾è¡¨çš„é…ç½®é¡¹å’Œæ•°æ®
    option2 = {
        title: {
            text: 'æŸç«™ç‚¹ç”¨æˆ·è®¿é—®æ¥æº',
            subtext: 'çº¯å±è™šæ„',
            x: 'center'
        },
        tooltip: {
            trigger: 'item',
            formatter: "{a} <br/>{b} : {c} ({d}%)"
        },
        legend: {
            orient: 'vertical',
            left: 'left',
            data: ['ç›´æ¥è®¿é—®', 'é‚®ä»¶è¥é”€', 'è”ç›Ÿå¹¿å‘Š', 'è§†é¢‘å¹¿å‘Š', 'æœç´¢å¼•æ“']
        },
        series: [
            {
                name: 'è®¿é—®æ¥æº',
                type: 'pie',
                radius: '55%',
                center: ['50%', '60%'],
                data: [
                    {value: 335, name: 'ç›´æ¥è®¿é—®'},
                    {value: 310, name: 'é‚®ä»¶è¥é”€'},
                    {value: 234, name: 'è”ç›Ÿå¹¿å‘Š'},
                    {value: 135, name: 'è§†é¢‘å¹¿å‘Š'},
                    {value: 1548, name: 'æœç´¢å¼•æ“'}
                ],
                itemStyle: {
                    emphasis: {
                        shadowBlur: 10,
                        shadowOffsetX: 0,
                        shadowColor: 'rgba(0, 0, 0, 0.5)'
                    }
                }
            }
        ]
    };

    // ä½¿ç”¨åˆšæŒ‡å®šçš„é…ç½®é¡¹å’Œæ•°æ®æ˜¾ç¤ºå›¾è¡¨ã€‚
    myChart2.setOption(option2);
</script>
</body>
</html>
```



## 2. ä¼šå‘˜é€€å‡ºç™»å½•

### 2.1 `auth` å·¥ç¨‹

#### 2.1.1 ä¿®æ”¹ä»£ç `member-conter.html`

```html
<!--<li><a href="index.html"><i class="glyphicon glyphicon-off"></i> é€€å‡ºç³»ç»Ÿ</a></li>-->
<li><a th:href="@{/auth/member/logout}"><i class="glyphicon glyphicon-off"></i> é€€å‡ºç³»ç»Ÿ</a></li>
```



#### 2.1.2 è¿½åŠ ä»£ç  `MemberHandler`

```java
/**
 * é€€å‡ºç™»å½•
 * 
 * @param session
 * @return
 */
@RequestMapping("/auth/member/logout")
public String logout(HttpSession session) {

    session.invalidate();

    return "redirect:/";
}
```



## 3. çŸ¥è¯†ç‚¹: Session å…±äº«, è§£å†³ Session ä¸äº’é€šçš„é—®é¢˜

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661512959472-2c320b0f-fa66-49a7-b6ef-2c79c3ac8131.png)

- åœ¨åˆ†å¸ƒå¼å’Œé›†ç¾¤ç¯å¢ƒä¸‹,  æ¯ä¸ªå…·ä½“æ¨¡å—è¿è¡Œåœ¨å•ç‹¬çš„ Tomcat ä¸Š, è€Œ Session æ˜¯è¢«ä¸åŒ Tomcat æ‰€ "åŒºéš”" çš„, æ‰€ä»¥ä¸èƒ½äº’é€š, ä¼šå¯¼è‡´ç¨‹åºè¿è¡Œæ—¶, ç”¨æˆ·ä¼šè¯å‘ç”Ÿé”™è¯¯

    - æœ‰çš„æœåŠ¡å™¨ä¸Šæœ‰, æœ‰çš„æœåŠ¡å™¨ä¸Šæ²¡æœ‰

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661514510084-6df436b4-7639-49f6-ba64-5b695c7f1e5e.png)

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661514533002-7fbb4bb6-851d-41c1-84c5-3158fd1f0c62.png)

### 3.1 ä¼šè¯æ§åˆ¶å›é¡¾

- æµè§ˆå™¨: å‘é€ `Cookie` æ•°æ®
- æœåŠ¡å™¨: è§£æ `Cookie` æ•°æ®
- æœåŠ¡å™¨: æŸ¥æ‰¾å¯¹åº”çš„ `Session`, å¦‚æœæ²¡æœ‰åˆ™æ–°å»º
- æœåŠ¡å™¨: æŠŠæ–°å»ºçš„ `Session` å­˜å…¥ `Redis`

========= ========

- æµè§ˆå™¨: è¯·æ±‚è¦æ±‚åœ¨åŸæœ‰çš„ `Session` ä¸­å­˜å…¥æ–°æ•°æ®
- æœåŠ¡å™¨: æ ¹æ® `Cookie` æŠŠæ—§çš„ `Session` æ‰¾åˆ°, å­˜å…¥æ•°æ®, å­˜å› Redis



#### 3.1.1 Cookie çš„å·¥ä½œæœºåˆ¶

- æœåŠ¡å™¨ç«¯è¿”å› `Cookie` ä¿¡æ¯ç»™æµè§ˆå™¨

    - `Java` ä»£ç : `response.addCookie(cookie å¯¹è±¡);`
    - `Http` å“åº”æ¶ˆæ¯å¤´: `Set-Cookie`: `Cookie` çš„åå­— = `Cookie` çš„å€¼, æµè§ˆå™¨æ¥æ”¶åˆ°æœåŠ¡å™¨ç«¯è¿”å›çš„ `Cookie`, ä»¥åçš„æ¯ä¸€æ¬¡è¯·æ±‚éƒ½ä¼šæŠŠ `Cookie` å¸¦ä¸Š
    - Http è¯·æ±‚æ¶ˆæ¯å¤´: `Cookie`: `Cookie` çš„åå­— = `Cookie` çš„å€¼



#### 3.1.2 Session çš„å·¥ä½œæœºåˆ¶

- è·å– `Session` å¯¹è±¡:` request.getSession();`

    - æ£€æŸ¥å½“å‰è¯·æ±‚æ˜¯å¦æºå¸¦äº† `JSESSIONID` è¿™ä¸ª `Cookie`

        - å¸¦äº†: æ ¹æ®è¿™ä¸ª `JSESSIONID` åœ¨æœåŠ¡å™¨ç«¯æŸ¥æ‰¾å¯¹åº”çš„ `Session` å¯¹è±¡

            - èƒ½æ‰¾åˆ°: å°±æŠŠæ‰¾åˆ°çš„ `Seesion` å¯¹è±¡è¿”å›
            - æ²¡æ‰¾åˆ°: æ–°å»º `Session` å¯¹è±¡è¿”å›, åŒæ—¶è¿”å› `JSESSIONID` çš„ `Cookie`

        - æ²¡å¸¦: æ–°å»º `Session` å¯¹è±¡è¿”å›, åŒæ—¶è¿”å› `JSESSIONID` çš„ `Cookie`



### 3.2 è§£å†³æ–¹æ¡ˆæ¢ç´¢

#### 3.2.1 Session åŒæ­¥

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661514573168-4b3e0b73-8e36-4e2b-bb18-aedb5fbf8c9d.png)![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661514589044-b0761750-12b5-478f-80cc-14ca350a0d0c.png)

- é—®é¢˜1: é€ æˆ `Session` åœ¨å„ä¸ªæœåŠ¡å™¨ä¸Š "åŒé‡" ä¿å­˜

    - `TomcatA` ä¿å­˜äº† 1G çš„ `Session` æ•°æ®, `TomcatB` ä¹Ÿéœ€è¦ä¿å­˜ 1G çš„ `Session` æ•°æ®
    - æ•°æ®é‡å¤ªå¤§çš„ä¼šå¯¼è‡´ `Tomcat` æ€§èƒ½ä¸‹é™

- é—®é¢˜2: æ•°æ®åŒæ­¥å¯¹æ€§èƒ½æœ‰ä¸€å®šå½±å“
- é—®é¢˜3: å¯¹åº”é›†ç¾¤å¤–çš„æœåŠ¡å™¨æ— æ•ˆ



#### 3.2.2 å°† `Session` æ•°æ®å­˜å‚¨åœ¨ `Cookie` ä¸­

- åšæ³•: æ‰€æœ‰ä¼šè¯æ•°æ®åœ¨æµè§ˆå™¨ç«¯ä½¿ç”¨ `Cookie` ä¿å­˜, æœåŠ¡å™¨ç«¯ä¸å­˜å‚¨å¦‚ä½•ä¼šè¯æ‰‹æœº

    - å¥½å¤„: æœåŠ¡å™¨ç«¯å¤§å¤§å‡è½»äº†æ•°æ®å­˜å‚¨çš„å‹åŠ›ã€‚ä¸ä¼šæœ‰ `Session` ä¸ä¸€è‡´çš„é—®é¢˜
    - ç¼ºç‚¹:

        - `Cookie` èƒ½å¤Ÿå­˜å‚¨çš„æ•°æ®éå¸¸æœ‰é™ã€‚ä¸€èˆ¬æ˜¯ 4KBã€‚ä¸èƒ½å­˜å‚¨ä¸°å¯Œçš„æ•°æ®
        - `Cookie` æ•°æ®åœ¨æµè§ˆå™¨ç«¯å­˜å‚¨, å¾ˆå¤§ç¨‹åº¦ä¸Šä¸å—æœåŠ¡å™¨ç«¯çš„æ§åˆ¶, å¦‚æœæµè§ˆå™¨ç«¯æ¸…ç† `Cookie`, ç›¸å…³æ•°æ®ä¼šä¸¢å¤±



#### 3.2.3 åå‘ä»£ç† `hash` ä¸€è‡´æ€§

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661515160158-b2f4d58a-0d86-4c34-ae32-29b465222cd1.png)

- é—®é¢˜1: å…·ä½“ä¸€ä¸ªæµè§ˆå™¨, ä¸“é—¨è®¿é—®æŸä¸€ä¸ªå…·ä½“æœåŠ¡å™¨, å¦‚æœæµè§ˆå™¨å®•æœº, ä¼šä¸¢å¤±æ•°æ®ã€‚å­˜åœ¨å•ç‚¹æ•…éšœé£é™©
- é—®é¢˜2: ä»…ä»…é€‚ç”¨äºé›†ç¾¤èŒƒå›´å†…, è¶…å‡ºé›†ç¾¤èŒƒå›´, è´Ÿè½½å‡è¡¡æœåŠ¡å™¨æ— æ•ˆ



#### 3.2.4 åç«¯ç»Ÿä¸€å­˜å‚¨ Session æ•°æ®

- åç«¯å­˜å‚¨ Session æ•°æ®æ—¶, ä¸€èˆ¬éœ€è¦ä½¿ç”¨ Redis è¿™æ ·çš„å†…å­˜æ•°æ®åº“ï¼Œè€Œä¸€èˆ¬ä¸é‡‡ç”¨ MySQL è¿™æ ·çš„å…³ç³»å‹æ•°æ®åº“ã€‚åŸå› å¦‚ä¸‹

    - Session æ•°æ®å­˜å–æ¯”è¾ƒé¢‘ç¹ã€‚å†…å­˜è®¿é—®é€Ÿåº¦å¿«
    - Session æœ‰è¿‡æœŸæ—¶é—´, Redis è¿™æ ·çš„å†…å­˜æ•°æ®åº“èƒ½å¤Ÿæ¯”è¾ƒæ–¹ä¾¿å®ç°è¿‡æœŸé‡Šæ”¾

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661515652333-64a76e2d-ec08-4925-8421-60f8b830804e.png)

- ä¼˜ç‚¹:

    - è®¿é—®é€Ÿåº¦æ¯”è¾ƒå¿«ã€‚è™½ç„¶éœ€è¦ç»è¿‡ç½‘ç»œè®¿é—®, ä½†æ˜¯ç°åœ¨ç¡¬ä»¶æ¡ä»¶å·²ç»èƒ½å¤Ÿè¾¾åˆ°ç½‘ç»œè®¿é—®æ¯”ç¡¬ç›˜è®¿é—®è¿˜è¦å¿«

        - ç¡¬ç›˜è®¿é—®é€Ÿåº¦: 200M/s
        - ç½‘ç»œè®¿é—®é€Ÿåº¦: 1G/s

    - Redis å¯ä»¥é…ç½®ä¸»ä»å¤åˆ¶é›†ç¾¤, ä¸æ‹…å¿ƒå•ç‚¹æ•…éšœ



### 3.3 `SpringSession` ä½¿ç”¨

- è£…é¥°æ¨¡å¼
- `SpringSession` ä½¿å¾—æ”¯æŒé›†ç¾¤ä¼šè¯å˜å¾—å¾®ä¸è¶³é“ï¼Œè€Œæ— éœ€ç»‘å®šåˆ°åº”ç”¨ç¨‹åºå®¹å™¨ç‰¹å®šçš„è§£å†³æ–¹æ¡ˆ
- ä»¥ä¸‹æ–‡æ¡£é’ˆå¯¹åœ¨ `SpringBoot` ç¯å¢ƒä¸‹ä½¿ç”¨
- å®ç°è·¨é¡¹ç›®å­˜å– Session

    - ç‹¬ç«‹é¡¹ç›®æµ‹è¯•ä½¿ç”¨
    - `pro18-spring-session-a` å­˜

        - ç«¯å£ 8181

    - `pro18-spring-session-b` å–

        - ç«¯å£ 8182

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661562452557-a4def515-53a9-4974-972d-387a2df677af.png)

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661562486613-e72c7a45-663f-4a40-b18c-3b56142e5b51.png)



![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661562475253-0123cd9b-2e29-48d1-8f97-dc590cb7db6b.png)

#### 3.3.1 å…±åŒä»£ç 

##### 3.3.1.1 å¼•å…¥ä¾èµ–

```xml
çˆ¶å¼•ç”¨ springboot
<dependencies>
  <dependency>  
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-web</artifactId>
  </dependency>
  <!-- å¼•å…¥ SpringBoot & Redis åœºæ™¯ -->
  <dependency>  
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-data-redis</artifactId>
  </dependency>
  <!-- å¼•å…¥ SpringBoot & SpringSeesion åœºæ™¯ -->
  <dependency>  
    <groupId>org.springframework.session</groupId>
    <artifactId>spring-session-data-redis</artifactId>
  </dependency>
</dependencies>
```



##### 3.3.1.2 æ–°å»º `MainClass` ä¸»å¯åŠ¨ç±»

```java
@SpringBootApplication
public class MainClass {

    public static void main(String[] args) {
        SpringApplication.run(MainClass.class, args);
    }

}
```



##### 3.3.1.3 æ–°å»º `application.yml` é…ç½®

```yaml
server:
  port: 8181

# Redis é…ç½®
spring:
  redis:
    host: 127.0.0.1

# SpringSession é…ç½®
  session:
    store-type: redis
```

- æ³¨æ„: å­˜å…¥ `Session` åŸŸçš„å®ä½“ç±»å¯¹è±¡éœ€è¦æ”¯æŒåºåˆ—åŒ–



#### 3.3.2 `pro18-spring-session-a`

##### 3.3.2.1 æ–°å»º `HelloHandler` ç±»

```java
@RestController
public class HelloHandler {
    
   @RequestMapping("/test/spring/session")
   public String testSession(HttpSession session) {
       session.setAttribute("king", "hello-king");
       
       return "æ•°æ®å­˜å…¥ Session åŸŸ";
   }
   
}
```



#### 3.3.3 `pro18-spring-session-b`

##### 3.3.3.1 æ–°å»º`HelloHandler`ç±»

```java
@RestController
public class HelloHandler {
    
   @RequestMapping("/test/spring/session/retrieve")
   public String testSession(HttpSession session) {
       String value = session.getAttribute("king");
       
       return value;
   }
   
}
```



### 3.4 `SpringSession` åŸºæœ¬åŸç†

- æ¦‚å†µ: `SpringSession` ä»åº•å±‚å…¨æ–¹ä½"æ¥ç®¡"äº† `Tomcat` å¯¹ `Session` çš„ç®¡ç†

#### 3.4.1 `SpringSession` éœ€è¦å®Œæˆçš„ä»»åŠ¡

- åŒ…è£… `Request` å¯¹è±¡
- æ‰¾ `Session` çš„æ—¶å€™è®¿é—® `Redis` æ‰¾
- æ‰¾åˆ°åŒ…è£…ä»¥åå¾—  `Session`
- ä¼ ç»™ `Handler`

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661562248532-8636c529-6b69-41e3-95c8-5622afa8431d.png)



#### 3.4.2 `SessionRepositoryFilter`

- åˆ©ç”¨ Filter åŸç†, åœ¨æ¯æ¬¡è¯·æ±‚åˆ°è¾¾ç›®æ ‡æ–¹æ³•ä¹‹å‰, å°†åŸç”Ÿ `HttpSeesionRequest`/`HttpServletResponse` å¯¹è±¡åŒ…è£…æˆä¸º `SessoinRepositoryRequest`/`ResponseWrapper`
- åŒ…è£… `request` å¯¹è±¡æ—¶è¦åšåˆ°: åŒ…è£…åå’ŒåŒ…è£…å‰çš„**ç±»å‹å…¼å®¹**

    - æ‰€è°“ç±»å‹å…¼å®¹: "åŒ…è£…å¾—åˆ°çš„å¯¹è±¡ `instanceof` åŒ…è£…å‰ç±»å‹" è¿”å› `true`

- åªæœ‰åšåˆ°äº†ç±»å‹çš„å…¼å®¹, åé¢ä½¿ç”¨åŒ…è£…è¿‡çš„å¯¹è±¡æ‰èƒ½ä¿æŒä½¿ç”¨æ–¹æ³•ä¸å˜ã€‚

    - åŒ…è£…è¿‡çš„å¯¹è±¡ç±»å‹å…¼å®¹ã€ä½¿ç”¨æ–¹æ³•ä¸å˜, æ‰èƒ½å®ç° "å·æ¢æ¢æŸ±"

- ä½†æ˜¯å¦‚æœç›´æ¥å®ç° `HttpServletRequest` æ¥å£, æˆ‘ä»¬åˆçŸ¥é“å¦‚ä½•å®ç°å„ä¸ªæŠ½è±¡æ–¹æ³•

    - è¿™ä¸ªé—®é¢˜å¯ä»¥å€ŸåŠ©åŸå§‹è¢«åŒ…è£…çš„å¯¹è±¡æ¥è§£å†³

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661563117912-1161408d-478c-4841-96f9-11fd6d9b33ff.png)



## 4. æ˜Ÿå›¾/æ¶æ„å›¾

- å•ä¸€æ¶æ„

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661567926586-fc92341c-87aa-4487-9c4e-c39f58c1c430.png)

- åˆ†å¸ƒå¼æ¶æ„

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661568221042-fe361def-4fa5-4e74-a848-e0e23ff48873.png)



## 5. ç™»å½•æ£€æŸ¥

- æŠŠé¡¹ç›®ä¸­å¿…é¡»ç™»å½•æ‰èƒ½è®¿é—®çš„åŠŸèƒ½ä¿æŠ¤èµ·æ¥, å¦‚æœæ²¡æœ‰ç™»å½•å°±è®¿é—®åˆ™è·³è½¬åˆ°ç™»å½•é¡µé¢

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661569729881-d91ee6df-526d-4670-adff-0f4789518180.png)



### 5.1 ä»£ç : è®¾ç½® `Session` å…±äº«

#### 5.1.1 `zuulã€auth` å·¥ç¨‹

- è¿½åŠ ä¾èµ–

```xml
<!-- å¼•å…¥ SpringBoot & Redis åœºæ™¯ -->
<dependency>  
  <groupId>org.springframework.boot</groupId>
  <artifactId>spring-boot-starter-data-redis</artifactId>
</dependency>

<!-- å¼•å…¥ SpringBoot & SpringSession åœºæ™¯ -->
<dependency>  
  <groupId>org.springframework.session</groupId>
  <artifactId>spring-session-data-redis</artifactId>
</dependency>
```

- è¿½åŠ é…ç½®

```yaml
spring:
  redis:
    host: localhost
  session:
    store-type: redis
```



### 5.2 ä»£ç : å‡†å¤‡ä¸éœ€è¦ç™»å½•æ£€æŸ¥çš„èµ„æº

#### 5.2.1 æ–°å»º `AccessPassResources` ç±»

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661822425179-cc305e7e-eb17-4b6f-8e2f-7f898f653c69.png)

```java
package com.atguigu.crowd.constant;

import java.util.HashSet;
import java.util.Set;

/**
 * ç‰¹å®šè¯·æ±‚åœ°å€å’Œé™æ€èµ„æº
 *
 * @author é™ˆæ±Ÿæ—
 * @date 2022/8/30 09:19
 */
public class AccessPassResources {

    public static final Set<String> PASS_RES_SET = new HashSet<>();

    static {
        PASS_RES_SET.add("/");
        PASS_RES_SET.add("/auth/member/to/reg/page");
        PASS_RES_SET.add("/auth/member/to/login/page");
        PASS_RES_SET.add("/auth/member/logout");
        PASS_RES_SET.add("/auth/member/do/login");
        PASS_RES_SET.add("/auth/do/member/register");
        PASS_RES_SET.add("/auth/member/send/short/message.json");
    }

    public static final Set<String> STATIC_RES_SET = new HashSet<>();

    static {
        STATIC_RES_SET.add("bootstrap");
        STATIC_RES_SET.add("css");
        STATIC_RES_SET.add("fonts");
        STATIC_RES_SET.add("img");
        STATIC_RES_SET.add("jquery");
        STATIC_RES_SET.add("layer");
        STATIC_RES_SET.add("script");
        STATIC_RES_SET.add("ztree");
    }

    /**
     * ç”¨äºåˆ¤æ–­æŸä¸ª ServletPath å€¼æ˜¯å¦å¯¹åº”ä¸€ä¸ªé™æ€èµ„æº
     *
     * @param servletPath
     * @return true æ˜¯é™æ€èµ„æº false ä¸æ˜¯é™æ€èµ„æº
     */
    public static boolean judgeCurrentServletPathWetherStaticResource(String servletPath) {
        // 1. æ’é™¤å­—ç¬¦ä¸²æ— æ•ˆçš„æƒ…å†µ
        if (servletPath == null || servletPath.length() == 0) {
            throw new RuntimeException(CrowdConstant.MESSAGE_STRING_INVALIDATE);
        }

        // 2. æ ¹æ® "/" æ‹†åˆ† ServletPath å­—ç¬¦ä¸²
        String[] split = servletPath.split("/");

        // 3. è€ƒè™‘ç¬¬ä¸€ä¸ªæ–œæ å·¦è¾¹ç»è¿‡æ‹†åˆ†åå¾—åˆ°æœ‰ä¸ªç©ºå­—ç¬¦ä¸²æ˜¯æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ , æ‰€ä»¥éœ€è¦ä½¿ç”¨ä¸‹æ ‡ 1 å–ç¬¬äºŒä¸ªå…ƒç´ 
        String firstLevelPath = split[1];

        // 4. åˆ¤æ–­æ˜¯å¦åœ¨è¿™ä¸ªé›†åˆä¸­
        return STATIC_RES_SET.contains(firstLevelPath);
    }

    public static void main(String[] args) {
        String servletPath = "/css/aaa/ccc";
        boolean result = judgeCurrentServletPathWetherStaticResource(servletPath);
        System.out.println(result);
    }

}
```



### 5.3 ä»£ç : `zuul` å·¥ç¨‹

- (å·²é…ç½®) é…ç½® `zuul.sensitive-headers: "*" `# åœ¨ zuul å‘å…¶ä»–å¾®æœåŠ¡é‡å®šå‘æ—¶ä¿æŒåŸæœ¬çš„å¤´ä¿¡æ¯ï¼ˆè¯·æ±‚å¤´ã€å“åº”å¤´ï¼‰



#### 5.3.1 æ–°å»º `CrowdAccessFilter` ç±»

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661823427261-a52e6cab-3061-489f-9c37-0350a4692914.png)

```java
package com.atguigu.crowd.filter;

import com.atguigu.crowd.constant.AccessPassResources;
import com.atguigu.crowd.constant.CrowdConstant;
import com.netflix.zuul.ZuulFilter;
import com.netflix.zuul.context.RequestContext;
import com.netflix.zuul.exception.ZuulException;
import org.springframework.stereotype.Component;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;
import java.io.IOException;

/**
 * @author é™ˆæ±Ÿæ—
 * @date 2022/8/30 09:24
 */
@Component
public class CrowdAccessFilter extends ZuulFilter {

    @Override
    public boolean shouldFilter() {
        // 1. è·å– RequestContext å¯¹è±¡
        RequestContext requestContext = RequestContext.getCurrentContext();

        // 2. é€šè¿‡ RequestContext å¯¹è±¡è·å–å½“å‰è¯·æ±‚å¯¹è±¡
        //ï¼ˆæ¡†æ¶åº•å±‚æ˜¯å€ŸåŠ© ThreadLocal ä»å½“å‰çº¿ç¨‹ä¸Šè·å–äº‹å…ˆç»‘å®šçš„ Request å¯¹è±¡ï¼‰
        HttpServletRequest request = requestContext.getRequest();

        // 3. è·å– ServletPath
        String servletPath = request.getServletPath();

        // 4. æ ¹æ® servletPath åˆ¤æ–­å½“å‰è¯·æ±‚æ˜¯å¦å¯¹åº”å¯ä»¥ç›´æ¥æ”¾è¡Œçš„ç‰¹å®šè¯·æ±‚
        boolean containsResult = AccessPassResources.PASS_RES_SET.contains(servletPath);
        if (containsResult) {
            // å¦‚æœå½“å‰è¯·æ±‚æ˜¯å¯ä»¥ç›´æ¥æ”¾è¡Œçš„ç‰¹å®šåŠŸèƒ½è¯·æ±‚åˆ™è¿”å› false æ”¾è¡Œ
            return false;
        }

        // åˆ¤æ–­å½“å‰è¯·æ±‚æ˜¯å¦ä¸ºé™æ€èµ„æº
        // å·¥å…·æ–¹æ³•è¿”å› true: è¯´æ˜å½“å‰è¯·æ±‚æ˜¯é™æ€èµ„æºè¯·æ±‚, å–åä¸º falseï¼ˆè¡¨ç¤ºæ”¾è¡Œä¸åšç™»å½•æ£€æŸ¥ï¼‰
        // å·¥å…·æ–¹æ³•è¿”å› false: è¡¨ç¤ºå½“å‰è¯·æ±‚è¡¨ç¤ºå¯ä»¥æ”¾è¡Œçš„ç‰¹å®šè¯·æ±‚ä¹Ÿä¸æ˜¯é™æ€èµ„æº, å–åä¸º trueï¼ˆè¡¨ç¤ºéœ€è¦åšç™»å½•æ£€æŸ¥ï¼‰
        return !AccessPassResources.judgeCurrentServletPathWetherStaticResource(servletPath);
    }

    /**
     * ç™»å½•æ£€æŸ¥
     *
     * @return
     * @throws ZuulException
     */
    @Override
    public Object run() throws ZuulException {
        // 1. è·å–å½“å‰è¯·æ±‚å¯¹è±¡
        RequestContext requestContext = RequestContext.getCurrentContext();
        HttpServletRequest request = requestContext.getRequest();

        // 2. è·å–å½“å‰ Session å¯¹è±¡
        HttpSession session = request.getSession();

        // 3. å°è¯•ä» Session å¯¹è±¡ä¸­è·å–å·²ç™»å½•çš„ç”¨æˆ·
        Object loginMember = session.getAttribute(CrowdConstant.ATTR_NAME_LOGIN_MEMBER);

        // 4. åˆ¤æ–­ loginMember æ˜¯å¦ä¸ºç©º
        if (loginMember == null) {
            // 5. æœªç™»å½•çŠ¶æ€, è·³è½¬è‡³ç™»å½•é¡µé¢
            // ä» requestContext å¯¹è±¡ä¸­è·å– Response å¯¹è±¡
            HttpServletResponse response = requestContext.getResponse();

            // 6. å°†æç¤ºæ¶ˆæ¯å­˜å…¥ Session åŸŸ
            session.setAttribute(CrowdConstant.ATTR_NAME_MESSAGE, CrowdConstant.MESSAGE_ACCESS_FORBIDEN);

            // 7. é‡å®šå‘åˆ° auth å·¥ç¨‹ä¸­çš„ç™»å½•é¡µé¢
            try {
                response.sendRedirect("/auth/member/to/login/page");
            } catch (IOException e) {
                e.printStackTrace();
            }
        }

        return null;
    }

    @Override
    public String filterType() {
        // è¿™é‡Œè¿”å› pre æ„æ€æ˜¯åœ¨ç›®æ ‡å¾®æœåŠ¡å‰æ‰§è¡Œè¿‡æ»¤
        return "pre";
    }

    @Override
    public int filterOrder() {
        return 0;
    }

}
```



#### 5.3.2 è¿½åŠ ä¾èµ–

```xml
<!-- ä¸ºäº†èƒ½å¤Ÿä½¿ç”¨å·¥å…·ç±» -->
<dependency>
    <groupId>com.atguigu.crowd</groupId>
    <artifactId>atcrowdfunding05-common-util</artifactId>
    <version>1.0-SNAPSHOT</version>
</dependency>

<!-- ä¸ºèƒ½å¤Ÿä½¿ç”¨å®ä½“ç±» -->
<dependency>
    <groupId>com.atguigu.crowd</groupId>
    <artifactId>atcrowdfunding09-member-entity</artifactId>
    <version>1.0-SNAPSHOT</version>
</dependency>
```



### 5.4 `auth` å·¥ç¨‹

#### 5.4.1 è¿½åŠ ä»£ç  `member-login.html`

```html
<p th:text="${session.message}">è¿™é‡Œæ˜¾ç¤ºçš„æ˜¯ç™»å½•æ£€æŸ¥åå‘ç°ä¸å…è®¸è®¿é—®æ—¶çš„æç¤ºæ¶ˆæ¯</p>
```



## 6 ä¿®æ”¹é‡å®šå‘åœ°å€, ä½¿ç”¨ `zuul`

### 6.1 å› ä¸º `Cookie` é—®é¢˜ä¸èƒ½ä½¿ç”¨é‡å®šå‘è·¨é¡¹ç›®è·³è½¬, æ‰€ä»¥é›†ä¸­è®¿é—® `zuul` æ¥è¿›è¡Œé‡å®šå‘

- æè¿°é—®é¢˜: `http://localhost:4000` å’Œ `http://localhost:80` æ˜¯ä¸¤ä¸ªä¸åŒçš„ç½‘ç«™, æµè§ˆå™¨å·¥ä½œæ—¶ä¸ä¼šä½¿ç”¨ç›¸åŒ `Cookie`
- è§£å†³: é‡å®šå‘çš„åœ°å€éƒ½æŒ‰ç…§é€šè¿‡ `Zuul` è®¿é—®çš„æ–¹å¼å†™åœ°å€



1. è¿½åŠ ä»£ç  `CrowdConstant` å­˜å‚¨åœ°å€ ã€`common` å·¥ç¨‹ã€‘

```java
public static final String ZUUL_PATH_VALUE = "http://localhost";
```

1. ä¿®æ”¹ `redirect` ä»£ç  `MemberHandler`ã€`auth` å·¥ç¨‹ã€‘

```java
package com.atguigu.crowd.handler;

import com.atguigu.crowd.api.MySQLRemoteService;
import com.atguigu.crowd.api.RedisRemoteService;
import com.atguigu.crowd.config.ShortMessageProperties;
import com.atguigu.crowd.constant.CrowdConstant;
import com.atguigu.crowd.entity.po.MemberPO;
import com.atguigu.crowd.entity.vo.MemberLoginVO;
import com.atguigu.crowd.entity.vo.MemberVO;
import com.atguigu.crowd.util.CrowdUtil;
import com.atguigu.crowd.util.ResultEntity;
import org.springframework.beans.BeanUtils;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;
import org.springframework.stereotype.Controller;
import org.springframework.ui.ModelMap;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.ResponseBody;

import javax.servlet.http.HttpSession;
import java.util.Objects;
import java.util.concurrent.TimeUnit;

/**
 * @author é™ˆæ±Ÿæ—
 * @date 2022/8/29 11:21
 */
@Controller
public class MemberHandler {

    @Autowired
    private ShortMessageProperties shortMessageProperties;

    @Autowired
    private RedisRemoteService redisRemoteService;

    @Autowired
    private MySQLRemoteService mySQLRemoteService;

    /**
     * é€€å‡ºç™»å½•
     *
     * @param session
     * @return
     */
    @RequestMapping("/auth/member/logout")
    public String logout(HttpSession session) {

        session.invalidate();

        return "redirect:" + CrowdConstant.ZUUL_PATH_VALUE + "/";
    }

    /**
     * ä¼šå‘˜ç™»å½•
     *
     * @param loginacct è´¦æˆ·
     * @param userpswd  å¯†ç 
     * @param modelMap
     * @param session
     * @return
     */
    @RequestMapping("/auth/member/do/login")
    public String doLogin(
            @RequestParam("loginacct") String loginacct,
            @RequestParam("userpswd") String userpswd,
            ModelMap modelMap,
            HttpSession session) {
        ResultEntity<MemberPO> resultEntity = mySQLRemoteService.getMemberPOByLoginAcctRemote(loginacct);
        if (ResultEntity.FAILED.equals(resultEntity.getResult())) {
            modelMap.addAttribute(CrowdConstant.ATTR_NAME_MESSAGE, resultEntity.getMessage());
            return "member-login";
        }

        MemberPO memberPO = resultEntity.getData();
        if (memberPO == null) {
            modelMap.addAttribute(CrowdConstant.ATTR_NAME_MESSAGE, CrowdConstant.MESSAGE_LOGIN_FAILED);
            return "member-login";
        }

        // 2. æ¯”è¾ƒå¯†ç 
        String userpswdDataBase = memberPO.getUserpswd();

        BCryptPasswordEncoder bCryptPasswordEncoder = new BCryptPasswordEncoder();
        bCryptPasswordEncoder.matches(userpswd, userpswdDataBase);

        // 3. åˆ›å»º MemberLoginVO å¯¹è±¡ä¼ å…¥ Session åŸŸ
        MemberLoginVO memberLoginVO = new MemberLoginVO(memberPO.getId(), memberPO.getUsername(), memberPO.getEmail());
        // ATTR_NAME_LOGIN_MEMBER = loginMember
        session.setAttribute(CrowdConstant.ATTR_NAME_LOGIN_MEMBER, memberLoginVO);

        return "redirect:" + CrowdConstant.ZUUL_PATH_VALUE + "/auth/member/to/conter/page";
    }

    /**
     * æ‰§è¡Œæ³¨å†Œ
     *
     * @param memberVO
     * @param modelMape
     * @return
     */
    @RequestMapping("/auth/do/member/register")
    public String register(MemberVO memberVO, ModelMap modelMape) {
        // 1. è·å–ç”¨æˆ·è¾“å…¥çš„æ‰‹æœºå·ç 
        String phoneNum = memberVO.getPhoneNum();

        // 2. æ‹¼ Redis ä¸­å­˜å‚¨éªŒè¯ç çš„ Key
        String key = CrowdConstant.REDIS_CODE_PREFIX + phoneNum;

        // 3. ä» Redis è¯»å– Key å¯¹åº”çš„ Value
        ResultEntity<String> resultEntity = redisRemoteService.getRedisKeyValueByKey(key);

        // 4. æ£€æŸ¥æŸ¥è¯¢æ“ä½œæ˜¯å¦æœ‰æ•ˆ
        String result = resultEntity.getResult();
        if (ResultEntity.FAILED.equals(result)) {
            modelMape.addAttribute(CrowdConstant.ATTR_NAME_MESSAGE, resultEntity.getMessage());
            return "member-reg";
        }

        String redisCode = resultEntity.getData();

        if (redisCode == null) {
            // MESSAGE_CODE_NOT_EXISTS = éªŒè¯ç å·²è¿‡æœŸ!è¯·æ£€æŸ¥æ‰‹æœºå·ç æ˜¯å¦æ­£ç¡®æˆ–é‡æ–°å‘é€!
            modelMape.addAttribute(CrowdConstant.ATTR_NAME_MESSAGE, CrowdConstant.MESSAGE_CODE_NOT_EXISTS);
            return "member-reg";
        }

        // 5. å¦‚æœä» Redis èƒ½å¤ŸæŸ¥è¯¢åˆ° Value åˆ™æ¯”è¾ƒè¡¨å•çš„éªŒè¯ç å’Œ Redis çš„éªŒè¯ç 
        String formCode = memberVO.getCode();

        if (!Objects.equals(formCode, redisCode)) {
            // MESSAGE_CODE_INVALID = éªŒè¯ç ä¸æ­£ç¡®!
            modelMape.addAttribute(CrowdConstant.ATTR_NAME_MESSAGE, CrowdConstant.MESSAGE_CODE_INVALID);
            return "member-reg";
        }

        // 6. å¦‚æœéªŒè¯ç ä¸€è‡´åˆ™ä» Redis åˆ é™¤
        redisRemoteService.removeRedisKeyRemote(key);

        // 7. æ‰§è¡Œå¯†ç åŠ å¯†
        BCryptPasswordEncoder bCryptPasswordEncoder = new BCryptPasswordEncoder();
        String userpswdBeforeEncode = memberVO.getUserpswd();
        String userpswdAfterEncode = bCryptPasswordEncoder.encode(userpswdBeforeEncode);

        memberVO.setUserpswd(userpswdAfterEncode);
        // 8. æ‰§è¡Œä¿å­˜
        // 8.1 åˆ›å»ºç©ºçš„ memberPO å¯¹è±¡
        MemberPO memberPO = new MemberPO();

        // 8.2 å¤åˆ¶å±æ€§
        BeanUtils.copyProperties(memberVO, memberPO);

        // 8.3 è°ƒç”¨è¿œç¨‹çš„æ–¹æ³•
        ResultEntity<String> saveMemberResultEntity = mySQLRemoteService.saveMember(memberPO);
        if (ResultEntity.FAILED.equals(saveMemberResultEntity.getResult())) {
            modelMape.addAttribute(CrowdConstant.ATTR_NAME_MESSAGE, saveMemberResultEntity.getMessage());
            return "member-reg";
        }

        // ä½¿ç”¨é‡å®šå‘é¿å…åˆ·æ–°æµè§ˆå™¨å¯¼è‡´é‡æ–°æ‰§è¡Œæ³¨å†Œæµç¨‹
        return "redirect:" + CrowdConstant.ZUUL_PATH_VALUE + "/auth/member/to/login/page";
    }

    /**
     * å‘é€çŸ­ä¿¡éªŒè¯ç 
     *
     * @param phoneNum æ‰‹æœºå·ç 
     * @return
     */
    @ResponseBody
    @RequestMapping("/auth/member/send/short/message.json")
    public ResultEntity<String> sendMessage(
            @RequestParam("phoneNum") String phoneNum) {
        try {
            // 1. å‘é€éªŒè¯ç 
            ResultEntity<String> sendMessageResultEntity = CrowdUtil.sendShortMessage(
                    shortMessageProperties.getAppCode(),
                    shortMessageProperties.getTemplateId(),
                    shortMessageProperties.getHost(),
                    shortMessageProperties.getPath(),
                    shortMessageProperties.getMethod(),
                    phoneNum
            );

            // 2. åˆ¤æ–­å‘é€ç»“æœ
            if (ResultEntity.SUCCESS.equals(sendMessageResultEntity.getResult())) {
                // 3. æˆåŠŸ: å°†éªŒè¯ç å­˜å…¥ Redis
                String code = sendMessageResultEntity.getData();
                String key = CrowdConstant.REDIS_CODE_PREFIX + phoneNum;
                ResultEntity<String> saveCodeResultEntity = redisRemoteService.setRedisKeyValueRemoteWithTimeout(key, code, 15, TimeUnit.MINUTES);
                if (ResultEntity.SUCCESS.equals(saveCodeResultEntity.getResult())) {
                    return ResultEntity.successWithoutData();
                } else {
                    return saveCodeResultEntity;
                }
            } else {
                return sendMessageResultEntity;
            }
        } catch (Exception e) {
            return ResultEntity.failed(e.getMessage());
        }
    }
}
```



### 6.2 å‰ç«¯é‡å®šå‘åœ°å€, ä½¿ç”¨ Session å…±äº«å­˜å‚¨ `zuul` åœ°å€è§£å†³

#### 6.2.1 é¡¹ç›®å¯åŠ¨è‡ªåŠ¨å­˜å‚¨ `zuul` åœ°å€

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661859079702-404e4150-be6c-49cb-bef0-8f5b1ddbd4f0.png)

```java
package com.atguigu.crowd.filter;

import com.atguigu.crowd.constant.AccessPassResources;
import com.atguigu.crowd.constant.CrowdConstant;
import com.netflix.zuul.ZuulFilter;
import com.netflix.zuul.context.RequestContext;
import com.netflix.zuul.exception.ZuulException;
import org.springframework.stereotype.Component;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;
import java.io.IOException;

/**
 * @author é™ˆæ±Ÿæ—
 * @date 2022/8/30 09:24
 */
@Component
public class CrowdAccessFilter extends ZuulFilter {

    @Override
    public boolean shouldFilter() {
        // 1. è·å– RequestContext å¯¹è±¡
        RequestContext requestContext = RequestContext.getCurrentContext();

        // 2. é€šè¿‡ RequestContext å¯¹è±¡è·å–å½“å‰è¯·æ±‚å¯¹è±¡
        //ï¼ˆæ¡†æ¶åº•å±‚æ˜¯å€ŸåŠ© ThreadLocal ä»å½“å‰çº¿ç¨‹ä¸Šè·å–äº‹å…ˆç»‘å®šçš„ Request å¯¹è±¡ï¼‰
        HttpServletRequest request = requestContext.getRequest();

        setSessionValue(request.getSession());

        // 3. è·å– ServletPath
        String servletPath = request.getServletPath();

        // 4. æ ¹æ® servletPath åˆ¤æ–­å½“å‰è¯·æ±‚æ˜¯å¦å¯¹åº”å¯ä»¥ç›´æ¥æ”¾è¡Œçš„ç‰¹å®šè¯·æ±‚
        boolean containsResult = AccessPassResources.PASS_RES_SET.contains(servletPath);
        if (containsResult) {
            // å¦‚æœå½“å‰è¯·æ±‚æ˜¯å¯ä»¥ç›´æ¥æ”¾è¡Œçš„ç‰¹å®šåŠŸèƒ½è¯·æ±‚åˆ™è¿”å› false æ”¾è¡Œ
            return false;
        }

        // åˆ¤æ–­å½“å‰è¯·æ±‚æ˜¯å¦ä¸ºé™æ€èµ„æº
        // å·¥å…·æ–¹æ³•è¿”å› true: è¯´æ˜å½“å‰è¯·æ±‚æ˜¯é™æ€èµ„æºè¯·æ±‚, å–åä¸º falseï¼ˆè¡¨ç¤ºæ”¾è¡Œä¸åšç™»å½•æ£€æŸ¥ï¼‰
        // å·¥å…·æ–¹æ³•è¿”å› false: è¡¨ç¤ºå½“å‰è¯·æ±‚è¡¨ç¤ºå¯ä»¥æ”¾è¡Œçš„ç‰¹å®šè¯·æ±‚ä¹Ÿä¸æ˜¯é™æ€èµ„æº, å–åä¸º trueï¼ˆè¡¨ç¤ºéœ€è¦åšç™»å½•æ£€æŸ¥ï¼‰
        return !AccessPassResources.judgeCurrentServletPathWetherStaticResource(servletPath);
    }

    /**
     * å­˜å‚¨ zuul åœ°å€
     *
     * @param session
     */
    public void setSessionValue(HttpSession session) {
        if (!(CrowdConstant.ZUUL_PATH_VALUE.equals(session.getAttribute(CrowdConstant.ZUUL_PATH_KEY)))) {
            session.setAttribute(CrowdConstant.ZUUL_PATH_KEY, CrowdConstant.ZUUL_PATH_VALUE);
        }
    }

    /**
     * ç™»å½•æ£€æŸ¥
     *
     * @return
     * @throws ZuulException
     */
    @Override
    public Object run() throws ZuulException {
        // 1. è·å–å½“å‰è¯·æ±‚å¯¹è±¡
        RequestContext requestContext = RequestContext.getCurrentContext();
        HttpServletRequest request = requestContext.getRequest();

        // 2. è·å–å½“å‰ Session å¯¹è±¡
        HttpSession session = request.getSession();

        // 3. å°è¯•ä» Session å¯¹è±¡ä¸­è·å–å·²ç™»å½•çš„ç”¨æˆ·
        Object loginMember = session.getAttribute(CrowdConstant.ATTR_NAME_LOGIN_MEMBER);

        // 4. åˆ¤æ–­ loginMember æ˜¯å¦ä¸ºç©º
        if (loginMember == null) {
            // 5. æœªç™»å½•çŠ¶æ€, è·³è½¬è‡³ç™»å½•é¡µé¢
            // ä» requestContext å¯¹è±¡ä¸­è·å– Response å¯¹è±¡
            HttpServletResponse response = requestContext.getResponse();

            // 6. å°†æç¤ºæ¶ˆæ¯å­˜å…¥ Session åŸŸ
            session.setAttribute(CrowdConstant.ATTR_NAME_MESSAGE, CrowdConstant.MESSAGE_ACCESS_FORBIDEN);

            // 7. é‡å®šå‘åˆ° auth å·¥ç¨‹ä¸­çš„ç™»å½•é¡µé¢
            try {
                response.sendRedirect("/auth/member/to/login/page");
            } catch (IOException e) {
                e.printStackTrace();
            }
        }

        return null;
    }

    @Override
    public String filterType() {
        // è¿™é‡Œè¿”å› pre æ„æ€æ˜¯åœ¨ç›®æ ‡å¾®æœåŠ¡å‰æ‰§è¡Œè¿‡æ»¤
        return "pre";
    }

    @Override
    public int filterOrder() {
        return 0;
    }

}
```





#### 6.2.2 è¿½åŠ ä»£ç  `CrowdConstant` ã€`common`å·¥ç¨‹ã€‘

```java
public static final String ZUUL_PATH_KEY = "zuulPath";
public static final String ZUUL_PATH_VALUE = "http://localhost";
```



#### 6.2.3 å‰ç«¯é‡å®šå‘å¯ä»¥ä½¿ç”¨ `${session.zuulPath}`è·å–åœ°å€



# åä¹ OSS

```
git checkout -b 19.0.0_oss
```

## 1. é˜¿é‡Œäº‘çš„ OSS å¯¹è±¡å­˜å‚¨

### 1.1 æå‡ºé—®é¢˜

#### 1.1.1 ä»¥å‰ä¸Šä¼ æ–‡ä»¶æ—¶ä¿æŒä½ç½®

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661590226415-d1c0ea66-801e-4043-bd1e-0501ea065afe.png)



#### 1.1.2 é—®é¢˜1: Web åº”ç”¨é‡æ–°éƒ¨ç½²å¯¼è‡´æ–‡ä»¶ä¸¢å¤±

- é‡æ–°éƒ¨ç½² Web åº”ç”¨æ—¶, å¸è½½ï¼ˆåˆ é™¤ï¼‰æ—§çš„ Web åº”ç”¨, è¿åŒç”¨æˆ·ä¸Šä¼ çš„æ–‡ä»¶ä¸€èµ·åˆ é™¤, é‡æ–°åŠ è½½æ–°çš„ Web åº”ç”¨å, ä»¥å‰ç”¨æˆ·ä¸Šä¼ çš„æ–‡ä»¶ä¸ä¼šè‡ªåŠ¨å›å¤
- å±å®³æ€»ç»“: Web åº”ç”¨é‡æ–°éƒ¨ç½²ä¼šå¯¼è‡´ç”¨æˆ·ä¸Šä¼ çš„æ–‡ä»¶ä¸¢å¤±



#### 1.1.3 é—®é¢˜2: é›†ç¾¤ç¯å¢ƒä¸‹æ–‡ä»¶éš¾ä»¥åŒæ­¥

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661590410265-6af2bd84-cab7-4565-837f-1268f7d5bf9a.png)



#### 1.1.4 é—®é¢˜3: Tomcat è¢«æ‹–å®

- ç”¨æˆ·ä¸Šä¼ çš„æ–‡ä»¶å¦‚æœæ•°æ®é‡è†¨èƒ€åˆ°äº†ä¸€ä¸ªéå¸¸åºå¤§çš„ä½“ç§¯, é‚£ä¹ˆå°±ä¼šä¸¥é‡å½±å“ Tomcat çš„è¿è¡Œæ•ˆç‡



#### 1.1.5 é—®é¢˜4: æœåŠ¡å™¨å­˜å‚¨è‡ªåŠ¨æ‰©å®¹é—®é¢˜

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661591010244-37666a6d-9100-4b25-b6b5-f6d5f9dd3fc8.png)

- å±å®³æ€»ç»“: æ‰‹åŠ¨å¯¹æœåŠ¡å™¨è¿›è¡Œæ‰©å®¹, æœ‰å¯èƒ½å¯¼è‡´é¡¹ç›®ä¸­å…¶ä»–åœ°æ–¹éœ€è¦è¿å¸¦ä¿®æ”¹



### 1.2 è§£å†³æ–¹æ¡ˆä»‹ç»

#### 1.2.1 è‡ªå·±æ­å»ºæ–‡ä»¶æœåŠ¡å™¨

- ä¸¾ä¾‹: `FastDFS`
- å¥½å¤„: æœåŠ¡å™¨å¯ä»¥è‡ªå·±ç»´æŠ¤ã€è‡ªå·±å®šåˆ¶
- ç¼ºç‚¹: éœ€è¦æŠ•å…¥çš„äººåŠ›ã€ç‰©åŠ›æ›´å¤š
- é€‚ç”¨: è§„æ¨¡æ¯”è¾ƒå¤§çš„é¡¹ç›®, è¦å­˜å‚¨æµ·é‡çš„æ–‡ä»¶



#### 1.2.2 ä½¿ç”¨ç¬¬ä¸‰æ–¹äº‘æœåŠ¡

- ä¸¾ä¾‹: é˜¿é‡Œäº‘æä¾›çš„ `OSS` å¯¹è±¡å­˜å‚¨æœåŠ¡
- å¥½å¤„: ä¸å¿…è‡ªå·±ç»´æŠ¤æœåŠ¡å™¨çš„è½¯ç¡¬ä»¶èµ„æºã€‚ç›´æ¥è°ƒç”¨ç›¸å…³ `API` å³å¯æ“ä½œ, æ›´åŠ è½»é‡çº§
- ç¼ºç‚¹: æ•°æ®ä¸åœ¨è‡ªå·±æ‰‹é‡Œã€‚æœåŠ¡å™¨ä¸ç”±è‡ªå·±ç»´æŠ¤
- é€‚ç”¨: è¾ƒå°è§„æ¨¡çš„åº”ç”¨, æ–‡ä»¶æ•°æ®ä¸æ˜¯ç»å¯¹ç§å¯†



### 1.3 å¼€é€š OSS æœåŠ¡æ­¥éª¤

1. æ³¨å†Œé˜¿é‡Œäº‘è´¦å·
2. å®Œæˆå®åè®¤è¯
3. æ‰¾åˆ° `å¯¹è±¡å­˜å‚¨ OSS`

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661596511496-e7985f9e-38ec-499f-ab9f-c4a09da821b8.png)



1. ç‚¹å‡» **ç«‹å³å¼€é€š**

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661596572303-c6b1afc4-a2dd-428e-8f9f-5f027f68f002.png)

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661596616072-e966a9e4-5b95-4d43-adc0-3989cfc25ec2.png)



### 1.4 ä½¿ç”¨ `OSS`

1. æ‰“å¼€ `OSS` æ§åˆ¶å°

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661596723883-30eb12f7-d758-4ecb-984c-84a868556f91.png)



1. åˆ›å»º `Bucket`

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661597404537-0acfe3e8-8f9c-4024-8338-e6acf773b181.png)



1. æ–°å»ºç›®å½•

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661597690537-70d6688d-f123-4305-8ebb-6870dc1bf86c.png)



1. ä¸Šä¼ æ–‡ä»¶

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661598175618-19b59af3-1782-4a95-9c09-3ed37267851f.png)

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661598344400-9f6df9d0-35ef-4627-be47-1ee4d1699bb2.png)



1. è·¯å¾„ç»„æˆ `https://åŸŸå/å›¾ç‰‡è·¯å¾„`

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661598451082-5eb9ba28-8ceb-47a1-9f3f-5f8b0ec257df.png)





### 1.5 Java ç¨‹åºè°ƒç”¨ OSS æœåŠ¡æ¥å£

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661598711691-84e9b057-5c13-4342-b64d-ea3449e9682e.png)

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661601017330-abbff1f9-cef8-4cf2-802f-d14e248e77f0.png)

#### 1.5.1 å‚è€ƒæ–‡æ¡£åœ°å€

https://help.aliyun.com/product/31815.html



#### 1.5.2 å®˜ç½‘ä»‹ç»

é˜¿é‡Œäº‘å¯¹è±¡å­˜å‚¨OSSï¼ˆObject Storage Serviceï¼‰æ˜¯ä¸€æ¬¾æµ·é‡ã€å®‰å…¨ã€ä½æˆæœ¬ã€é«˜å¯é çš„äº‘å­˜å‚¨æœåŠ¡ï¼Œå¯æä¾›99.9999999999%ï¼ˆ12ä¸ª9ï¼‰çš„æ•°æ®æŒä¹…æ€§ï¼Œ99.995%çš„æ•°æ®å¯ç”¨æ€§ã€‚å¤šç§å­˜å‚¨ç±»å‹ä¾›é€‰æ‹©ï¼Œå…¨é¢ä¼˜åŒ–å­˜å‚¨æˆæœ¬ã€‚



#### 1.5.3 åˆ›å»ºè®¿é—®ç§˜é’¥ `AccessKey`

- `AccessKey` -> `Java` ç¨‹åºç™»å½• `OSS` è¿›è¡Œæ“ä½œ
- è®¿é—®ç§˜é’¥ `AccessKeyï¼ˆAKï¼‰`ç”¨äºç¨‹åºæ–¹å¼è°ƒç”¨äº‘æœåŠ¡ `API`
- å¯ä»¥ä½¿ç”¨ `AccessKey` æ„é€ ä¸€ä¸ª API è¯·æ±‚ï¼ˆæˆ–è€…ä½¿ç”¨äº‘æœåŠ¡ SDKï¼‰æ¥æ“ä½œèµ„æº
- `AccessKey` åŒ…æ‹¬ `AccessKeyId` å’Œ `AccessKeySecret`
- è­¦å‘Š: ç¦æ­¢ä½¿ç”¨ä¸»è´¦å· `AK`,  å› ä¸ºä¸»è´¦å· `AK` æ³„éœ²ä¼šå¨èƒæ‚¨æ‰€æœ‰èµ„æºçš„å®‰å…¨ã€‚è¯·ä½¿ç”¨å­è´¦å·ï¼ˆ`RAM` ç”¨æˆ·ï¼‰`AK` è¿›è¡Œç™»å½•, å¯æœ‰æ•ˆé™ä½ `AK` æ³„éœ²çš„é£é™©



#### 1.5.4 åˆ›å»ºå­è´¦å· `AK` çš„æ“ä½œ

1. ä½¿ç”¨ä¸»è´¦å·ç™»å½• `RAM` ç®¡ç†æ§åˆ¶å°
2. å¦‚æœæœªåˆ›å»º `RAM` ç”¨æˆ·, åœ¨**å·¦ä¾§å¯¼èˆªæ **, æœç´¢**è®¿é—®æ§åˆ¶**

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661599826708-19abe8c3-cc77-48cc-ae26-7babcba2feda.png)



1. ç„¶åç‚¹å‡»**ç”¨æˆ·**, **åˆ›å»ºç”¨æˆ·**

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661599947651-64ee55fd-c990-45a2-a771-3458339e7d04.png)

æ­¤å¤„ä¸ºè¯­é›€åŠ å¯†æ–‡æœ¬å¡ç‰‡ï¼Œç‚¹å‡»é“¾æ¥æŸ¥çœ‹ï¼šhttps://www.yuque.com/lingchen-bf1rc/hoahc6/mrsgsa#lI0qc



1. é…ç½®æƒé™ `AliyunOSSFullAccess`

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661600659680-8cb94a47-66d1-4e8d-ae6f-d2b119cf99a9.png)



#### 1.5.5 OSS ä¾èµ–

```xml
<!-- OSS Java SDK -->
<dependency>
    <groupId>com.aliyun.oss</groupId>
    <artifactId>aliyun-sdk-oss</artifactId>
    <version>3.5.0</version>
</dependency>
```



### 1.6 å°† `OSS` å¼•å…¥ `project` é¡¹ç›®

#### 1.6.1 `config` åŒ…: `OSSProperties`

```java
package com.atguigu.crowd.config;

import lombok.AllArgsConstructor;
import lombok.Data;
import lombok.NoArgsConstructor;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.stereotype.Component;

/**
 * @author é™ˆæ±Ÿæ—
 * @date 2022/8/30 20:09
 */
@Data
@NoArgsConstructor
@AllArgsConstructor
@Component
@ConfigurationProperties(prefix = "aliyun.oss")
public class OSSProperties {

    /**
     * Bucket åç§°
     */
    private String bucketName;

    /**
     * åœ°åŸŸèŠ‚ç‚¹
     */
    private String endPoint;

    /**
     * Bucket åŸŸå
     */
    private String bucketDomain;

    /**
     * è®¿é—®æ ‡è¯†
     */
    private String accessKeyId;

    /**
     * è®¿é—®ç§˜é’¥
     */
    private String accessKeySecret;

}
```



#### 1.6.2 ä¾èµ–

```xml
<dependencies>
    <dependency>
        <groupId>com.atguigu.crowd</groupId>
        <artifactId>atcrowdfunding17-member-api</artifactId>
        <version>1.0-SNAPSHOT</version>
    </dependency>

    <!-- å¯¼å…¥é…ç½®æ–‡ä»¶å¤„ç†å™¨, é…ç½®æ–‡ä»¶è¿›è¡Œç»‘å®š -->
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-configuration-processor</artifactId>
        <optional>true</optional>
    </dependency>

    <!-- å¯¹å¤–æš´éœ²æœåŠ¡ -->
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-web</artifactId>
    </dependency>

    <!-- æ•´åˆè§†å›¾ -->
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-thymeleaf</artifactId>
    </dependency>

    <!-- ä½œä¸ºå®¢æˆ·ç«¯è®¿é—® Eureka æ³¨å†Œä¸­å¿ƒ -->
    <dependency>
        <groupId>org.springframework.cloud</groupId>
        <artifactId>spring-cloud-starter-netflix-eureka-client</artifactId>
    </dependency>

    <!-- SpringBoot æµ‹è¯• -->
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-test</artifactId>
        <scope>test</scope>
    </dependency>

    <!-- å¼•å…¥ SpringBoot & Redis åœºæ™¯ -->
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-data-redis</artifactId>
    </dependency>

    <!-- å¼•å…¥ SpringBoot & SpringSession åœºæ™¯ -->
    <dependency>
        <groupId>org.springframework.session</groupId>
        <artifactId>spring-session-data-redis</artifactId>
    </dependency>
</dependencies>

<build>
    <plugins>
        <!-- è¿™ä¸ªæ’ä»¶å°† SpringBoot åº”ç”¨æ‰“åŒ…æˆä¸€ä¸ªå¯æ‰§è¡Œçš„ jar åŒ… -->
        <plugin>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-maven-plugin</artifactId>
            <executions>
                <execution>
                    <goals>
                        <goal>repackage</goal>
                    </goals>
                </execution>
            </executions>
        </plugin>
    </plugins>
</build>
```



#### 1.6.3 æ–°å»º `CrowdMainClass`ä¸»å¯åŠ¨ç±»

```java
package com.atguigu.crowd;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.cloud.openfeign.EnableFeignClients;

/**
 * @author é™ˆæ±Ÿæ—
 * @date 2022/8/30 23:09
 */
@EnableFeignClients
@SpringBootApplication
public class CrowdMainClass {

    public static void main(String[] args) {
        SpringApplication.run(CrowdMainClass.class, args);
    }

}
```



#### 1.6.4 æ–°å»º `application.yml` é…ç½®

```yaml
server:
  port: 5000

spring:
  application:
    name: atguigu-crowd-project
  session:
    store-type: redis

eureka:
  client:
    service-url:
      defaultZone: http://localhost:1000/eureka

ribbon:
  # 10ç§’ - å¤„ç†è¯·æ±‚çš„è¶…æ—¶æ—¶é—´ï¼Œé»˜è®¤ä¸º5ç§’
  ReadTimeout: 10000
  # 10ç§’ - è¿æ¥å»ºç«‹çš„è¶…æ—¶æ—¶é•¿ï¼Œé»˜è®¤5ç§’
  ConnectTimeout: 10000

# é˜¿é‡Œäº‘ oss å¯¹è±¡å­˜å‚¨
aliyun:
  oss:
    bucket-name: atguigu220827
    end-point: oss-cn-guangzhou.aliyuncs.com
    bucket-domain: atguigu220827.oss-cn-guangzhou.aliyuncs.com
    access-key-id: LTAI5t5vpW9Fcqk8qBW7nvcV
    access-key-secret: fWxGZing02E6uZKE4NNV9W8RrzjjCT
```



### 1.7 `common` å·¥ç¨‹

#### 1.7.1 è¿½åŠ ä¾èµ–

```xml
<!-- OSS Java SDK -->
<dependency>
    <groupId>com.aliyun.oss</groupId>
    <artifactId>aliyun-sdk-oss</artifactId>
    <version>3.5.0</version>
</dependency>
```



#### 1.7.2 å·¥å…·ç±» `CrowdUtil` ä¸­è¿½åŠ æ–¹æ³•

```java
/**
     * ä¸“é—¨è´Ÿè´£ä¸Šä¼ æ–‡ä»¶åˆ° OSS æœåŠ¡å™¨çš„å·¥å…·æ–¹æ³•
     *
     * @param bucketName
     * @param endpoint
     * @param bucketDomain
     * @param accessKeyId
     * @param accessKeySecret
     * @param inputStream     è¦ä¸Šä¼ æ–‡ä»¶çš„è¾“å…¥æµ
     * @param originalName    è¦ä¸Šä¼ æ–‡ä»¶çš„åŸå§‹æ–‡ä»¶å
     * @return
     */
    public static ResultEntity<String> uploadFilterOss(
            String bucketName,
            String endpoint,
            String bucketDomain,
            String accessKeyId,
            String accessKeySecret,
            InputStream inputStream,
            String originalName) {
        // åˆ›å»º OSSClient å®ä¾‹
        OSS ossClient = new OSSClientBuilder().build(endpoint, accessKeyId, accessKeySecret);

        // ç”Ÿæˆç”Ÿæˆæ–‡ä»¶çš„ç›®å½•
        String folderName = new SimpleDateFormat("yyyyMMdd").format(new Date());

        // ç”Ÿæˆç”Ÿæˆæ–‡ä»¶åœ¨ OSS æœåŠ¡å™¨ä¸Šä¿å­˜æ—¶çš„æ–‡ä»¶å
        // åŸå§‹æ–‡ä»¶å: beaufulgirl.jpg
        // ç”Ÿæˆæ–‡ä»¶å: wer234234efwer235346457dfswet346235.jpg
        // ä½¿ç”¨ UUID ç”Ÿæˆæ–‡ä»¶ä¸»ä½“åç§°
        String fileMainName = UUID.randomUUID().toString().replace("_", "");

        // ä»åŸå§‹æ–‡ä»¶åä¸­è·å–æ–‡ä»¶æ‰©å±•å
        String extensionName = originalName.substring(originalName.lastIndexOf("."));

        // ä½¿ç”¨ç›®å½•ã€æ–‡ä»¶ä¸»ä½“åç§°ã€æ–‡ä»¶æ‰©å±•åç§°æ‹¼æ¥å¾—åˆ°å¯¹è±¡åç§°
        String objectName = folderName + "/" + fileMainName + extensionName;

        try {
            // è°ƒç”¨ OSS å®¢æˆ·ç«¯å¯¹è±¡çš„æ–¹æ³•ç”Ÿæˆæ–‡ä»¶å¹¶è·å–å“åº”ç»“æœæ•°æ®
            // ä¸Šä¼ æ–‡ä»¶
            PutObjectResult putObjectResult = ossClient.putObject(bucketName, objectName, inputStream);

            // ä»å“åº”ç»“æœä¸­è·å–å…·ä½“å“åº”æ¶ˆæ¯
            ResponseMessage responseMessage = putObjectResult.getResponse();

            // æ ¹æ®å“åº”çŠ¶æ€ç åˆ¤æ–­è¯·æ±‚æ˜¯å¦æˆåŠŸ
            if (responseMessage == null) {
                // æˆåŠŸ
                // æ‹¼æ¥è®¿é—®åˆšåˆšä¸Šä¼ çš„æ–‡ä»¶è·¯å¾„
                String ossFileAccessPath = bucketDomain + "/" + objectName;

                return ResultEntity.successWithData(ossFileAccessPath);
            } else {
                // è·å–å“åº”çŠ¶æ€ç 
                int staticCode = responseMessage.getStatusCode();

                // å¦‚æœè¯·æ±‚æ²¡æœ‰æˆåŠŸ, è·å–é”™è¯¯æ¶ˆæ¯
                String errorMessage = responseMessage.getErrorResponseAsString();

                // å½“å‰æ–¹æ³•è¿”å›å¤±è´¥
                return ResultEntity.failed("å½“å‰å“åº”çŠ¶æ€ç : " + staticCode + "é”™è¯¯æ¶ˆæ¯: " + errorMessage);
            }
        } catch (Exception e) {
            return ResultEntity.failed(e.getMessage());
        } finally {
            if (ossClient != null) {
                ossClient.shutdown();
            }
        }
    }
```



#### 1.7.3 æµ‹è¯• OSS

```java
public static void main(String[] args) throws FileNotFoundException {
    FileInputStream inputStream = new FileInputStream("/Users/chenjianglin/Desktop/333.jpg");
    // ResultEntity{result='SUCCESS', message='null', data=atguigu220827.oss-cn-guangzhou.aliyuncs.com/20220830/837093df-ee43-4370-8c44-48180fcb59eb.jpg}
    System.out.println(uploadFilterOss("atguigu220827",
            "oss-cn-guangzhou.aliyuncs.com",
            "atguigu220827.oss-cn-guangzhou.aliyuncs.com",
            "LTAI5t5vpW9Fcqk8qBW7nvcV",
            "fWxGZing02E6uZKE4NNV9W8RrzjjCT",
            inputStream,
            "333.jpg"));
}
```

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661871136021-a5e2cf75-5624-433d-9921-3219af6548b0.png)



#### 1.7.4 å¦‚æœæŠ¥é”™: `Error: A JNI error has occurred, please check your installation and try agai`

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661871030772-b4841106-bd85-4339-a44e-21f1061259eb.png)

- è§£å†³

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661870974600-b84e3c3a-887a-4c88-a465-3c018a9a6c63.png)



# äºŒå å‘èµ·é¡¹ç›®

```
git checkout -b 20.0.0_initiating_project
```

- æ‰©å±•: å®ä½“ç±»ä¸ºä»€ä¹ˆè¦åºåˆ—åŒ–: è¦å­˜å…¥ Seesion ä¸­æ‰€ä»¥éœ€è¦åºåˆ—åŒ–

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661672488857-1d6f3b3d-deae-4fa1-94fd-083ffcc4c308.png)



## 1. å‘èµ·é¡¹ç›® å»ºæ¨¡/å‡†å¤‡

### 1.1 åˆ›å»ºæ•°æ®åº“

```sql
DROP TABLE IF EXISTS `t_type`;
CREATE TABLE `t_type` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `name` varchar(255) DEFAULT NULL COMMENT 'åˆ†ç±»åç§°',
  `remark` varchar(255) DEFAULT NULL COMMENT 'åˆ†ç±»è¯´æ˜',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='åˆ†ç±»è¡¨';

DROP TABLE IF EXISTS `t_project_type`;
CREATE TABLE `t_project_type` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `projectid` int(11) DEFAULT NULL COMMENT 't_project æ ‡è¯†',
  `typeid` int(11) DEFAULT NULL COMMENT 't_type æ ‡è¯†',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='é¡¹ç›®å’Œåˆ†ç±»ä¸­é—´è¡¨';

DROP TABLE IF EXISTS `t_tag`;
CREATE TABLE `t_tag` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `pid` int(11) DEFAULT NULL,
  `name` varchar(255) DEFAULT NULL COMMENT 'æ ‡ç­¾åç§°',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='æ ‡ç­¾è¡¨';

DROP TABLE IF EXISTS `t_project_tag`;
CREATE TABLE `t_project_tag` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `projectid` int(11) DEFAULT NULL COMMENT 't_project æ ‡è¯†',
  `tagid` int(11) DEFAULT NULL COMMENT 't_tag æ ‡è¯†',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='é¡¹ç›®æ ‡ç­¾ä¸­é—´è¡¨';

DROP TABLE IF EXISTS `t_project`;
CREATE TABLE `t_project` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `project_name` varchar(255) DEFAULT NULL COMMENT 'é¡¹ç›®åç§°',
  `project_description` varchar(255) DEFAULT NULL COMMENT 'é¡¹ç›®æè¿°',
  `money` bigint(11) DEFAULT NULL COMMENT 'ç­¹é›†é‡‘é¢',
  `day` int(11) DEFAULT NULL COMMENT 'ç­¹é›†å¤©æ•°',
  `status` int(4) DEFAULT NULL COMMENT '[{0: å³å°†å¼€å§‹}, {1: ä¼—ç­¹ä¸­}, {2: ä¼—ç­¹æˆåŠŸ}, {3: ä¼—ç­¹å¤±è´¥}]',
  `deploydate` varchar(255) DEFAULT NULL COMMENT 'é¡¹ç›®å‘èµ·æ—¶é—´',
  `supportmoney` bigint(11) DEFAULT NULL COMMENT 'å·²ç­¹é›†åˆ°çš„é‡‘é¢',
  `supporter` int(11) DEFAULT NULL COMMENT 'æ”¯æŒäººæ•°',
  `completion` int(3) DEFAULT NULL COMMENT 'ç™¾åˆ†æ¯”å®Œæˆåº¦',
  `memberid` int(11) DEFAULT NULL COMMENT 'å‘èµ·äººçš„ä¼šå‘˜æ ‡è¯†',
  `createdate` varchar(19) DEFAULT NULL COMMENT 'é¡¹ç›®åˆ›å»ºæ—¶é—´',
  `follower` int(11) DEFAULT NULL COMMENT 'å…³æ³¨äººæ•°',
  `header_picture_path` varchar(255) DEFAULT NULL COMMENT 'å¤´å›¾è·¯å¾„',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='é¡¹ç›®è¡¨';

DROP TABLE IF EXISTS `t_project_item_pic`;
CREATE TABLE `t_project_item_pic` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `projectid` int(11) DEFAULT NULL COMMENT 't_project æ ‡è¯†',
  `item_pic_path` varchar(255) DEFAULT NULL COMMENT 'å›¾ç‰‡åç§°',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='é¡¹ç›®è¡¨é¡¹ç›®è¯¦æƒ…å›¾ç‰‡è¡¨';

DROP TABLE IF EXISTS `t_member_launch_info`;
CREATE TABLE `t_member_launch_info` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `memberid` int(11) DEFAULT NULL COMMENT 't_member ä¼šå‘˜æ ‡è¯†',
  `description_simple` varchar(255) DEFAULT NULL COMMENT 'è‡ªæˆ‘ä»‹ç»',
  `description_detail` varchar(255) DEFAULT NULL COMMENT 'è¯¦ç»†ä»‹ç»',
  `phone_num` varchar(255) DEFAULT NULL COMMENT 'è”ç³»ç”µè¯',
  `service_num` varchar(255) DEFAULT NULL COMMENT 'å®¢æœç”µè¯',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='é¡¹ç›®å‘èµ·äººä¿¡æ¯è¡¨';

DROP TABLE IF EXISTS `t_return`;
CREATE TABLE `t_return` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `projectid` int(11) DEFAULT NULL COMMENT 't_projcet é¡¹ç›®æ ‡è¯†',
  `type` int(4) DEFAULT NULL COMMENT '[{0: å®ç‰©å›æŠ¥}, {1: è™šæ‹Ÿç‰©å“å›æŠ¥}]',
  `supportmoney` int(11) DEFAULT NULL COMMENT 'æ”¯æŒé‡‘é¢',
  `content` varchar(255) DEFAULT NULL COMMENT 'å›æŠ¥å†…å®¹',
  `count` int(11) DEFAULT NULL COMMENT 'å›æŠ¥äº§å“é™é¢ {0: ä¸é™é¢å›æŠ¥æ•°é‡}',
  `signalpurchase` int(11) DEFAULT NULL COMMENT 'æ˜¯å¦è®¾ç½®å•ç¬”é™è´­',
  `purchase` int(11) DEFAULT NULL COMMENT 'å…·ä½“é™è´­æ•°é‡',
  `freight` int(11) DEFAULT NULL COMMENT 'è¿è´¹ {0: åŒ…é‚®}',
  `invoice` int(4) DEFAULT NULL COMMENT '[{0: ä¸å¼€å‘ç¥¨}, {1: å¼€å‘ç¥¨}]',
  `returndate` int(11) DEFAULT NULL COMMENT 'é¡¹ç›®ç»“æŸåå¤šå°‘å¤©å‘æ”¯æŒè€…å‘é€å›æŠ¥',
  `describ_pic_path` varchar(255) DEFAULT NULL COMMENT 'è¯´æ˜å›¾ç‰‡è·¯å¾„',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='å›æŠ¥ä¿¡æ¯è¡¨';

DROP TABLE IF EXISTS `t_member_confirm_info`;
CREATE TABLE `t_member_confirm_info` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `memberid` int(11) DEFAULT NULL COMMENT 't_member ä¼šå‘˜æ ‡è¯†',
  `paynum` varchar(255) DEFAULT NULL COMMENT 'æ˜“ä»˜å®ä¼ä¸šè´¦å·',
  `cardnum` varchar(255) DEFAULT NULL COMMENT 'æ³•äººèº«ä»½è¯å·',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='å‘èµ·äººç¡®è®¤ä¿¡æ¯è¡¨';
```



#### 1.1.1 åˆ†ç±»è¡¨

```sql
DROP TABLE IF EXISTS `t_type`;
CREATE TABLE `t_type` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `name` varchar(255) DEFAULT NULL COMMENT 'åˆ†ç±»åç§°',
  `remark` varchar(255) DEFAULT NULL COMMENT 'åˆ†ç±»è¯´æ˜',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='åˆ†ç±»è¡¨';
```

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661656856456-11f99189-7280-4e72-9526-194d3a320cba.png)



#### 1.1.2 é¡¹ç›®åˆ†ç±»ä¸­é—´è¡¨

```sql
DROP TABLE IF EXISTS `t_project_type`;
CREATE TABLE `t_project_type` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `projectid` int(11) DEFAULT NULL COMMENT 't_project æ ‡è¯†',
  `typeid` int(11) DEFAULT NULL COMMENT 't_type æ ‡è¯†',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='é¡¹ç›®å’Œåˆ†ç±»ä¸­é—´è¡¨';
```



#### 1.1.3 æ ‡ç­¾è¡¨

```sql
DROP TABLE IF EXISTS `t_tag`;
CREATE TABLE `t_tag` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `pid` int(11) DEFAULT NULL,
  `name` varchar(255) DEFAULT NULL COMMENT 'æ ‡ç­¾åç§°',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='æ ‡ç­¾è¡¨';
```

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661656985493-8a12fd3f-a72e-49e4-ad4b-ccb066f006bb.png)



#### 1.1.4 é¡¹ç›®æ ‡ç­¾ä¸­é—´è¡¨

```sql
DROP TABLE IF EXISTS `t_project_tag`;
CREATE TABLE `t_project_tag` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `projectid` int(11) DEFAULT NULL COMMENT 't_project æ ‡è¯†',
  `tagid` int(11) DEFAULT NULL COMMENT 't_tag æ ‡è¯†',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='é¡¹ç›®æ ‡ç­¾ä¸­é—´è¡¨';
```



#### 1.1.5 é¡¹ç›®è¡¨

```sql
DROP TABLE IF EXISTS `t_project`;
CREATE TABLE `t_project` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `project_name` varchar(255) DEFAULT NULL COMMENT 'é¡¹ç›®åç§°',
  `project_description` varchar(255) DEFAULT NULL COMMENT 'é¡¹ç›®æè¿°',
  `money` bigint(11) DEFAULT NULL COMMENT 'ç­¹é›†é‡‘é¢',
  `day` int(11) DEFAULT NULL COMMENT 'ç­¹é›†å¤©æ•°',
  `status` int(4) DEFAULT NULL COMMENT '[{0: å³å°†å¼€å§‹}, {1: ä¼—ç­¹ä¸­}, {2: ä¼—ç­¹æˆåŠŸ}, {3: ä¼—ç­¹å¤±è´¥}]',
  `deploydate` varchar(255) DEFAULT NULL COMMENT 'é¡¹ç›®å‘èµ·æ—¶é—´',
  `supportmoney` bigint(11) DEFAULT NULL COMMENT 'å·²ç­¹é›†åˆ°çš„é‡‘é¢',
  `supporter` int(11) DEFAULT NULL COMMENT 'æ”¯æŒäººæ•°',
  `completion` int(3) DEFAULT NULL COMMENT 'ç™¾åˆ†æ¯”å®Œæˆåº¦',
  `memberid` int(11) DEFAULT NULL COMMENT 'å‘èµ·äººçš„ä¼šå‘˜æ ‡è¯†',
  `createdate` varchar(19) DEFAULT NULL COMMENT 'é¡¹ç›®åˆ›å»ºæ—¶é—´',
  `follower` int(11) DEFAULT NULL COMMENT 'å…³æ³¨äººæ•°',
  `header_picture_path` varchar(255) DEFAULT NULL COMMENT 'å¤´å›¾è·¯å¾„',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='é¡¹ç›®è¡¨';
```

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661657194856-b126002e-e1bf-49ef-8c75-c4cd131a51fe.png)



#### 1.1.6 é¡¹ç›®è¡¨é¡¹ç›®è¯¦æƒ…å›¾ç‰‡è¡¨

```sql
DROP TABLE IF EXISTS `t_project_item_pic`;
CREATE TABLE `t_project_item_pic` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `projectid` int(11) DEFAULT NULL COMMENT 't_project æ ‡è¯†',
  `item_pic_path` varchar(255) DEFAULT NULL COMMENT 'å›¾ç‰‡åç§°',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='é¡¹ç›®è¡¨é¡¹ç›®è¯¦æƒ…å›¾ç‰‡è¡¨';
```



#### 1.1.7 é¡¹ç›®å‘èµ·äººä¿¡æ¯è¡¨

```sql
DROP TABLE IF EXISTS `t_member_launch_info`;
CREATE TABLE `t_member_launch_info` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `memberid` int(11) DEFAULT NULL COMMENT 't_member ä¼šå‘˜æ ‡è¯†',
  `description_simple` varchar(255) DEFAULT NULL COMMENT 'è‡ªæˆ‘ä»‹ç»',
  `description_detail` varchar(255) DEFAULT NULL COMMENT 'è¯¦ç»†ä»‹ç»',
  `phone_num` varchar(255) DEFAULT NULL COMMENT 'è”ç³»ç”µè¯',
  `service_num` varchar(255) DEFAULT NULL COMMENT 'å®¢æœç”µè¯',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='é¡¹ç›®å‘èµ·äººä¿¡æ¯è¡¨';
```

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661657828250-53d24dae-a4d9-4661-912f-2e363ce54028.png)



#### 1.1.8 å›æŠ¥ä¿¡æ¯è¡¨

```sql
DROP TABLE IF EXISTS `t_return`;
CREATE TABLE `t_return` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `projectid` int(11) DEFAULT NULL COMMENT 't_projcet é¡¹ç›®æ ‡è¯†',
  `type` int(4) DEFAULT NULL COMMENT '[{0: å®ç‰©å›æŠ¥}, {1: è™šæ‹Ÿç‰©å“å›æŠ¥}]',
  `supportmoney` int(11) DEFAULT NULL COMMENT 'æ”¯æŒé‡‘é¢',
  `content` varchar(255) DEFAULT NULL COMMENT 'å›æŠ¥å†…å®¹',
  `count` int(11) DEFAULT NULL COMMENT 'å›æŠ¥äº§å“é™é¢ {0: ä¸é™é¢å›æŠ¥æ•°é‡}',
  `signalpurchase` int(11) DEFAULT NULL COMMENT 'æ˜¯å¦è®¾ç½®å•ç¬”é™è´­',
  `purchase` int(11) DEFAULT NULL COMMENT 'å…·ä½“é™è´­æ•°é‡',
  `freight` int(11) DEFAULT NULL COMMENT 'è¿è´¹ {0: åŒ…é‚®}',
  `invoice` int(4) DEFAULT NULL COMMENT '[{0: ä¸å¼€å‘ç¥¨}, {1: å¼€å‘ç¥¨}]',
  `returndate` int(11) DEFAULT NULL COMMENT 'é¡¹ç›®ç»“æŸåå¤šå°‘å¤©å‘æ”¯æŒè€…å‘é€å›æŠ¥',
  `describ_pic_path` varchar(255) DEFAULT NULL COMMENT 'è¯´æ˜å›¾ç‰‡è·¯å¾„',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='å›æŠ¥ä¿¡æ¯è¡¨';
```



#### 1.1.9 å‘èµ·äººç¡®è®¤ä¿¡æ¯è¡¨

```sql
DROP TABLE IF EXISTS `t_member_confirm_info`;
CREATE TABLE `t_member_confirm_info` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `memberid` int(11) DEFAULT NULL COMMENT 't_member ä¼šå‘˜æ ‡è¯†',
  `paynum` varchar(255) DEFAULT NULL COMMENT 'æ˜“ä»˜å®ä¼ä¸šè´¦å·',
  `cardnum` varchar(255) DEFAULT NULL COMMENT 'æ³•äººèº«ä»½è¯å·',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='å‘èµ·äººç¡®è®¤ä¿¡æ¯è¡¨';
```





### 1.2. é€†å‘å·¥ç¨‹

- è¿½åŠ é…ç½® `generatorConfig.xml` é™¤ä¸­é—´è¡¨

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661666791177-397b1252-94f2-430c-961e-2333f17b01bb.png)

```xml
<table tableName="t_type" domainObjectName="TypePO"/>
<table tableName="t_tag" domainObjectName="TagPO"/>
<table tableName="t_project" domainObjectName="ProjectPO"/>
<table tableName="t_project_item_pic" domainObjectName="ProjectItemPicPO"/>
<table tableName="t_member_launch_info" domainObjectName="MemberLaunchInfoPO"/>
<table tableName="t_return" domainObjectName="ReturnPO"/>
<table tableName="t_member_confirm_info" domainObjectName="MemberConfirmInfoPO"/>
```

- å°†ç”Ÿæˆçš„æ–‡ä»¶å¤åˆ¶åˆ°ç›¸åº”çš„ä½ç½®



### 1.3. `Mysql` å·¥ç¨‹

#### 1.3.1 æ–°å»º `ProjectProviderHandler`

```java
package com.atguigu.crowd.handler;

import com.atguigu.crowd.service.api.ProjectService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.RestController;

/**
 * @author é™ˆæ±Ÿæ—
 * @date 2022/8/31 11:49
 */
@RestController
public class ProjectProviderHandler {
    
    @Autowired
    private ProjectService projectService;
    
}
```



#### 1.3.2 æ–°å»º `ProjectService`

```java
package com.atguigu.crowd.service.api;

/**
 * @author é™ˆæ±Ÿæ—
 * @date 2022/8/31 11:49
 */
public interface ProjectService {
}
```



#### 1.3.1 æ–°å»º `ProjectServiceImpl`

```java
package com.atguigu.crowd.service.impl;

import com.atguigu.crowd.service.api.ProjectService;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

/**
 * @author é™ˆæ±Ÿæ—
 * @date 2022/8/31 11:49
 */
@Transactional(readOnly = true)
@Service
public class ProjectServiceImpl implements ProjectService {
}
```



### 1.4. åˆ›å»º `VO` å¯¹è±¡

#### 1.4.1 æ–°å»º `ProjcetVO`

```java
package com.atguigu.crowd.entity.vo;

import lombok.AllArgsConstructor;
import lombok.Data;
import lombok.NoArgsConstructor;

import java.io.Serializable;
import java.util.List;

/**
 * @author é™ˆæ±Ÿæ—
 * @date 2022/8/31 11:53
 */
@Data
@NoArgsConstructor
@AllArgsConstructor
public class ProjectVO implements Serializable {

    private static final long serialVersionUID = 1L;

    /**
     * åˆ†ç±» id é›†åˆ
     */
    private List<Integer> typeIdList;

    /**
     * æ ‡ç­¾ id é›†åˆ
     */
    private List<Integer> tagIdList;

    /**
     * é¡¹ç›®åç§°
     */
    private String projectName;

    /**
     * é¡¹ç›®æè¿°
     */
    private String projectDescription;

    /**
     * è®¡åˆ’ç­¹é›†çš„é‡‘é¢
     */
    private Integer money;

    /**
     * è®¡åˆ’ç­¹é›†çš„å¤©æ•°
     */
    private Integer day;

    /**
     * åˆ›å»ºé¡¹ç›®çš„æ—¥æœŸ
     */
    private String createdate;

    /**
     * å¤´å›¾çš„è·¯å¾„
     */
    private String headerPicturePath;

    /**
     * è¯¦æƒ…å›¾ç‰‡çš„è·¯å¾„
     */
    private List<String> detailPicturePathList;

    /**
     * å‘èµ·äººä¿¡æ¯
     */
    private MemberLauchInfoVO memberLauchInfoVO;

    /**
     * å›æŠ¥ä¿¡æ¯é›†åˆ
     */
    private List<ReturnVO> returnVOList;

    /**
     * å‘èµ·äººç¡®è®¤ä¿¡æ¯
     */
    private MemberConfirmInfoVO memberConfirmInfoVO;

}
```



#### 1.4.2 æ–°å»º `MemberLauchInfoVO`

```java
package com.atguigu.crowd.entity.vo;

import lombok.AllArgsConstructor;
import lombok.Data;
import lombok.NoArgsConstructor;

import java.io.Serializable;

/**
 * é¡¹ç›®å‘èµ·äººä¿¡æ¯è¡¨
 *
 * @author é™ˆæ±Ÿæ—
 * @date 2022/8/31 13:23
 */
@Data
@NoArgsConstructor
@AllArgsConstructor
public class MemberLauchInfoVO implements Serializable {

    private static final long serialVersionUID = 1L;

    /**
     * è‡ªæˆ‘ä»‹ç»
     */
    private String descriptionSimple;

    /**
     * è¯¦ç»†ä»‹ç»
     */
    private String descriptionDetail;

    /**
     * è”ç³»ç”µè¯
     */
    private String phoneNum;

    /**
     * å®¢æœç”µè¯
     */
    private String serviceNum;

}
```



#### 1.4.3 æ–°å»º `ReturnVO`

```java
package com.atguigu.crowd.entity.vo;

import lombok.AllArgsConstructor;
import lombok.Data;
import lombok.NoArgsConstructor;

import java.io.Serializable;

/**
 * å›æŠ¥ä¿¡æ¯è¡¨
 *
 * @author é™ˆæ±Ÿæ—
 * @date 2022/8/31 13:23
 */
@Data
@NoArgsConstructor
@AllArgsConstructor
public class ReturnVO implements Serializable {

    private static final long serialVersionUID = 1L;

    /**
     * t_projcet é¡¹ç›®æ ‡è¯†
     */
    private Integer projectid;

    /**
     * [{0: å®ç‰©å›æŠ¥}, {1: è™šæ‹Ÿç‰©å“å›æŠ¥}]
     */
    private Integer type;

    /**
     * æ”¯æŒé‡‘é¢
     */
    private Integer supportmoney;

    /**
     * å›æŠ¥å†…å®¹
     */
    private String content;

    /**
     * å›æŠ¥äº§å“é™é¢ {0: ä¸é™é¢å›æŠ¥æ•°é‡}
     */
    private Integer count;

    /**
     * æ˜¯å¦è®¾ç½®å•ç¬”é™è´­
     */
    private Integer signalpurchase;

    /**
     * å…·ä½“é™è´­æ•°é‡
     */
    private Integer purchase;

    /**
     * è¿è´¹ {0: åŒ…é‚®}
     */
    private Integer freight;

    /**
     * [{0: ä¸å¼€å‘ç¥¨}, {1: å¼€å‘ç¥¨}]
     */
    private Integer invoice;

    /**
     * é¡¹ç›®ç»“æŸåå¤šå°‘å¤©å‘æ”¯æŒè€…å‘é€å›æŠ¥
     */
    private Integer returndate;

    /**
     * è¯´æ˜å›¾ç‰‡è·¯å¾„
     */
    private String describPicPath;

}
```



#### 1.4.4 æ–°å»º `MemberConfirmInfoVO`

```java
package com.atguigu.crowd.entity.vo;

import lombok.AllArgsConstructor;
import lombok.Data;
import lombok.NoArgsConstructor;

import java.io.Serializable;

/**
 * å‘èµ·äººç¡®è®¤ä¿¡æ¯è¡¨
 *
 * @author é™ˆæ±Ÿæ—
 * @date 2022/8/31 13:24
 */
@Data
@NoArgsConstructor
@AllArgsConstructor
public class MemberConfirmInfoVO implements Serializable {

    private static final long serialVersionUID = 1L;

    /**
     * æ˜“ä»˜å®ä¼ä¸šè´¦å·
     */
    private String paynum;

    /**
     * æ³•äººèº«ä»½è¯å·
     */
    private String cardnum;

}
```



### 1.5 ä¿®æ”¹ PO, è®°å¾—åŠ  `@NoArgsConstructor`, `@AllArgsConstructor`, `@Data`

#### 1.5.1 ä¿®æ”¹ `ProjectPO`

- `private Long money;` ä¿®æ”¹ä¸º `private Integer money;` å¹¶ä¿®æ”¹å¯¹åº”çš„

```java
package com.atguigu.crowd.entity.po;

import lombok.AllArgsConstructor;
import lombok.Data;
import lombok.NoArgsConstructor;

@NoArgsConstructor
@AllArgsConstructor
@Data
public class ProjectPO {
    private Integer id;

    private String projectName;

    private String projectDescription;

    private Integer money;

    private Integer day;

    private Integer status;

    private String deploydate;

    private Long supportmoney;

    private Integer supporter;

    private Integer completion;

    private Integer memberid;

    private String createdate;

    private Integer follower;

    private String headerPicturePath;

    public Integer getId() {
        return id;
    }

    public void setId(Integer id) {
        this.id = id;
    }

    public String getProjectName() {
        return projectName;
    }

    public void setProjectName(String projectName) {
        this.projectName = projectName == null ? null : projectName.trim();
    }

    public String getProjectDescription() {
        return projectDescription;
    }

    public void setProjectDescription(String projectDescription) {
        this.projectDescription = projectDescription == null ? null : projectDescription.trim();
    }

    public Integer getMoney() {
        return money;
    }

    public void setMoney(Integer money) {
        this.money = money;
    }

    public Integer getDay() {
        return day;
    }

    public void setDay(Integer day) {
        this.day = day;
    }

    public Integer getStatus() {
        return status;
    }

    public void setStatus(Integer status) {
        this.status = status;
    }

    public String getDeploydate() {
        return deploydate;
    }

    public void setDeploydate(String deploydate) {
        this.deploydate = deploydate == null ? null : deploydate.trim();
    }

    public Long getSupportmoney() {
        return supportmoney;
    }

    public void setSupportmoney(Long supportmoney) {
        this.supportmoney = supportmoney;
    }

    public Integer getSupporter() {
        return supporter;
    }

    public void setSupporter(Integer supporter) {
        this.supporter = supporter;
    }

    public Integer getCompletion() {
        return completion;
    }

    public void setCompletion(Integer completion) {
        this.completion = completion;
    }

    public Integer getMemberid() {
        return memberid;
    }

    public void setMemberid(Integer memberid) {
        this.memberid = memberid;
    }

    public String getCreatedate() {
        return createdate;
    }

    public void setCreatedate(String createdate) {
        this.createdate = createdate == null ? null : createdate.trim();
    }

    public Integer getFollower() {
        return follower;
    }

    public void setFollower(Integer follower) {
        this.follower = follower;
    }

    public String getHeaderPicturePath() {
        return headerPicturePath;
    }

    public void setHeaderPicturePath(String headerPicturePath) {
        this.headerPicturePath = headerPicturePath == null ? null : headerPicturePath.trim();
    }
}
```

## 2. å‘èµ·é¡¹ç›®

### 2.1 æ€»ç›®æ ‡

- å°†å„ä¸ªè¡¨å•é¡µé¢æäº¤çš„æ•°æ®æ±‡æ€»åˆ°ä¸€èµ·ä¿å­˜åˆ°æ•°æ®åº“



### 2.2 æ€è·¯

![img](https://cdn.nlark.com/yuque/0/2022/jpeg/12811585/1661670258820-a7dd2744-82b2-4cef-844d-5f4c48fb9319.jpeg)



### 2.3 è·³è½¬`å‘èµ·ä¼—ç­¹`çš„è¡¨å•é¡µé¢

- ç¤ºä¾‹å›¾:  ![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661913260478-304b6872-4e9f-4620-a57c-95aaa952dd2b.png)
- ä» `auth` é¡¹ç›®é‡å®šå‘åˆ° `project` é¡¹ç›®, ä½¿ç”¨ `/project/**` è®¿é—®



#### 2.3.1 ç‚¹å‡» "æˆ‘çš„ä¼—ç­¹"`member-conter.html`ã€`auth` å·¥ç¨‹ã€‘

```html
<div class="list-group-item " style="cursor:pointer;">
    <a th:href="@{/member/my/crowd}">æˆ‘çš„ä¼—ç­¹</a>
    <span class="badge"><i class="glyphicon glyphicon-chevron-right"></i></span>
</div>
```



#### 2.3.2 è¿½åŠ ä»£ç  `CrowdWebMvcConfig`ã€`auth` å·¥ç¨‹ã€‘

```java
registry.addViewController("/member/my/crowd").setViewName("member-crowd");
```



#### 2.3.3 æ–°å»ºæˆ‘çš„ä¼—ç­¹é¡µé¢ `member-crowd.html`ã€`auth` å·¥ç¨‹ã€‘

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661649775922-695e468c-a439-4107-8306-a40f98b93698.png)

```html
<!DOCTYPE html>
<html lang="zh-CN" xmlns:th="https://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <base th:href="@{/}">
    <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <link rel="stylesheet" href="css/theme.css">
    <script src="jquery/jquery-2.1.1.min.js"></script>
    <script src="bootstrap/js/bootstrap.min.js"></script>
    <script src="script/docs.min.js"></script>
    <script src="script/back-to-top.js"></script>
    <script>
        $(function() {
            $('#myTab1 a').click(function (e) {
                e.preventDefault()
                $(this).tab('show')
            })
        })
    </script>
    <style>
        #footer {
            padding: 15px 0;
            background: #fff;
            border-top: 1px solid #ddd;
            text-align: center;
        }

        #topcontrol {
            color: #fff;
            z-index: 99;
            width: 30px;
            height: 30px;
            font-size: 20px;
            background: #222;
            position: relative;
            right: 14px !important;
            bottom: 11px !important;
            border-radius: 3px !important;
        }

        #topcontrol:after {
            /*top: -2px;*/
            left: 8.5px;
            content: "\f106";
            position: absolute;
            text-align: center;
            font-family: FontAwesome;
        }

        #topcontrol:hover {
            color: #fff;
            background: #18ba9b;
            -webkit-transition: all 0.3s ease-in-out;
            -moz-transition: all 0.3s ease-in-out;
            -o-transition: all 0.3s ease-in-out;
            transition: all 0.3s ease-in-out;
        }

    </style>
</head>
<body>
<div class="navbar-wrapper">
    <div class="container">
        <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand" th:href="@{/}" style="font-size:32px;">å°šç­¹ç½‘-åˆ›æ„äº§å“ä¼—ç­¹å¹³å°</a>
                </div>
                <div id="navbar" class="navbar-collapse collapse" style="float:right;">
                    <ul class="nav navbar-nav">
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i
                                    class="glyphicon glyphicon-user"></i> [[${session.loginMember.username}]]<span
                                    class="caret"></span></a>
                            <ul class="dropdown-menu" role="menu">
                                <li><a href="member.html"><i class="glyphicon glyphicon-scale"></i> ä¼šå‘˜ä¸­å¿ƒ</a></li>
                                <li><a href="#"><i class="glyphicon glyphicon-comment"></i> æ¶ˆæ¯</a></li>
                                <li class="divider"></li>
                                <li><a th:href="@{/auth/member/logout}"><i class="glyphicon glyphicon-off"></i> é€€å‡ºç³»ç»Ÿ</a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>

    </div>
</div>
<div class="container">
    <div class="row clearfix">
        <div class="col-sm-3 col-md-3 column">
            <div class="row">
                <div class="col-md-12">
                    <div class="thumbnail" style="    border-radius: 0px;">
                        <img src="img/services-box1.jpg" class="img-thumbnail"
                             alt="A generic square placeholder image with a white border around it, making it resemble a photograph taken with an old instant camera">
                        <div class="caption" style="text-align:center;">
                            <h3>
                                [[${session.loginMember.username}]]
                            </h3>
                            <span class="label label-danger" style="cursor:pointer;"
                                  onclick="window.location.href='cert.html'">æœªå®åè®¤è¯</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="list-group">
                <div class="list-group-item" style="cursor:pointer;" onclick="window.location.href='member.html'">
                    èµ„äº§æ€»è§ˆ<span class="badge"><i class="glyphicon glyphicon-chevron-right"></i></span>
                </div>
                <div class="list-group-item active">
                    æˆ‘çš„ä¼—ç­¹<span class="badge"><i class="glyphicon glyphicon-chevron-right"></i></span>
                </div>
            </div>
        </div>
        <div class="col-sm-9 col-md-9 column">
            <ul id="myTab" style="" class="nav nav-pills" role="tablist">
                <li role="presentation" class="active"><a href="#home" role="tab" data-toggle="tab" aria-controls="home"
                                                          aria-expanded="true">æˆ‘çš„ä¼—ç­¹</a></li>
                <li role="presentation"><a href="#profile">ä¼—ç­¹èµ„äº§</a></li>
            </ul>
            <div id="myTabContent" class="tab-content" style="margin-top:10px;">
                <div role="tabpanel" class="tab-pane fade active in" id="home" aria-labelledby="home-tab">

                    <ul id="myTab1" class="nav nav-tabs">
                        <li role="presentation" class="active"><a href="#support">æˆ‘æ”¯æŒçš„</a></li>
                        <li role="presentation"><a href="#attension">æˆ‘å…³æ³¨çš„</a></li>
                        <li role="presentation"><a href="#add">æˆ‘å‘èµ·çš„</a></li>
                        <li class=" pull-right">
                            <script type="text/javascript">
                                $(function () {
                                    $("#launchCrowdBtn").click(function () {
                                        window.location.href = "[[${session.zuulPath}]]/project/agree/protocol/page";
                                    })
                                })
                            </script>
                            <button type="button" class="btn btn-warning" id="launchCrowdBtn">å‘èµ·ä¼—ç­¹</button>
                        </li>
                    </ul>
                    <div class="tab-content" style="margin-top:10px;">
                        <div role="tabpanel" class="tab-pane fade active in" id="support" aria-labelledby="home-tab">
                            <div class="container-fluid">
                                <div class="row clearfix">
                                    <div class="col-md-12 column">
                                        <span class="label label-warning">å…¨éƒ¨</span> <span class="label"
                                                                                          style="color:#000;">å·²æ”¯ä»˜</span>
                                        <span class="label " style="color:#000;">æœªæ”¯ä»˜</span>
                                    </div>
                                    <div class="col-md-12 column" style="margin-top:10px;padding:0;">
                                        <table class="table table-bordered" style="text-align:center;">
                                            <thead>
                                            <tr style="background-color:#ddd;">
                                                <td>é¡¹ç›®ä¿¡æ¯</td>
                                                <td width="90">æ”¯æŒæ—¥æœŸ</td>
                                                <td width="120">æ”¯æŒé‡‘é¢ï¼ˆå…ƒï¼‰</td>
                                                <td width="80">å›æŠ¥æ•°é‡</td>
                                                <td width="80">äº¤æ˜“çŠ¶æ€</td>
                                                <td width="120">æ“ä½œ</td>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            <tr>
                                                <td style="vertical-align:middle;">
                                                    <div class="thumbnail">
                                                        <div class="caption">
                                                            <h3>
                                                                æ´»æ€§å¯Œæ°¢å‡€æ°´ç›´é¥®æœº
                                                            </h3>
                                                            <p>
                                                                è®¢å•ç¼–å·:2x002231111
                                                            </p>
                                                            <p>
                                                            <div style="float:left;"><i
                                                                    class="glyphicon glyphicon-screenshot"
                                                                    title="ç›®æ ‡é‡‘é¢"></i> å·²å®Œæˆ 100%
                                                            </div>
                                                            <div style="float:right;"><i title="æˆªè‡³æ—¥æœŸ"
                                                                                         class="glyphicon glyphicon-calendar"></i>
                                                                å‰©ä½™8å¤©
                                                            </div>
                                                            </p>
                                                            <br>
                                                            <div class="progress" style="margin-bottom: 4px;">
                                                                <div class="progress-bar progress-bar-danger"
                                                                     role="progressbar" aria-valuenow="40"
                                                                     aria-valuemin="0" aria-valuemax="100"
                                                                     style="width: 40%">
                                                                    <span>ä¼—ç­¹ä¸­</span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </td>
                                                <td style="vertical-align:middle;">2017-05-23 11:31:22</td>
                                                <td style="vertical-align:middle;">1.00<br>(è¿è´¹ï¼š0.00 )</td>
                                                <td style="vertical-align:middle;">1</td>
                                                <td style="vertical-align:middle;">äº¤æ˜“å…³é—­</td>
                                                <td style="vertical-align:middle;">
                                                    <div class="btn-group-vertical" role="group"
                                                         aria-label="Vertical button group">
                                                        <button type="button" class="btn btn-default">åˆ é™¤è®¢å•</button>
                                                        <button type="button" class="btn btn-default">äº¤æ˜“è¯¦æƒ…</button>
                                                    </div>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="vertical-align:middle;">
                                                    <div class="thumbnail">
                                                        <div class="caption">
                                                            <h3>
                                                                BAVOSNä¾¿æºæŠ˜å ç§»åŠ¨ç”µæºå°ç¯
                                                            </h3>
                                                            <p>
                                                                è®¢å•ç¼–å·:2x002231111
                                                            </p>
                                                            <p>
                                                            <div style="float:left;"><i
                                                                    class="glyphicon glyphicon-screenshot"
                                                                    title="ç›®æ ‡é‡‘é¢"></i> å·²å®Œæˆ 100%
                                                            </div>
                                                            <div style="float:right;"><i title="æˆªè‡³æ—¥æœŸ"
                                                                                         class="glyphicon glyphicon-calendar"></i>
                                                                å‰©ä½™8å¤©
                                                            </div>
                                                            </p>
                                                            <br>
                                                            <div class="progress" style="margin-bottom: 4px;">
                                                                <div class="progress-bar progress-bar-success"
                                                                     role="progressbar" aria-valuenow="40"
                                                                     aria-valuemin="0" aria-valuemax="100"
                                                                     style="width: 40%">
                                                                    <span>ä¼—ç­¹æˆåŠŸ</span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </td>
                                                <td style="vertical-align:middle;">2017-05-23 11:31:22</td>
                                                <td style="vertical-align:middle;">1.00<br>(è¿è´¹ï¼š0.00 )</td>
                                                <td style="vertical-align:middle;">1</td>
                                                <td style="vertical-align:middle;">äº¤æ˜“å…³é—­</td>
                                                <td style="vertical-align:middle;">
                                                    <div class="btn-group-vertical" role="group"
                                                         aria-label="Vertical button group">
                                                        <button type="button" class="btn btn-default">åˆ é™¤è®¢å•</button>
                                                        <button type="button" class="btn btn-default">äº¤æ˜“è¯¦æƒ…</button>
                                                    </div>
                                                </td>
                                            </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div role="tabpanel" class="tab-pane fade" id="attension" aria-labelledby="attension-tab">
                            <div class="container-fluid">
                                <div class="row clearfix">
                                    <div class="col-md-12 column" style="padding:0;">
                                        <table class="table table-bordered" style="text-align:center;">
                                            <thead>
                                            <tr style="background-color:#ddd;">
                                                <td>é¡¹ç›®ä¿¡æ¯</td>
                                                <td width="120">æ”¯æŒäººæ•°</td>
                                                <td width="120">å…³æ³¨äººæ•°</td>
                                                <td width="120">æ“ä½œ</td>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            <tr>
                                                <td style="vertical-align:middle;">
                                                    <div class="thumbnail">
                                                        <div class="caption">
                                                            <p>
                                                                BAVOSNä¾¿æºæŠ˜å ç§»åŠ¨ç”µæºå°ç¯
                                                            </p>
                                                            <p>
                                                                <i class="glyphicon glyphicon-jpy"></i> å·²ç­¹é›† 1000.0å…ƒ
                                                            </p>
                                                            <p>
                                                            <div style="float:left;"><i
                                                                    class="glyphicon glyphicon-screenshot"
                                                                    title="ç›®æ ‡é‡‘é¢"></i> å·²å®Œæˆ 100%
                                                            </div>
                                                            <div style="float:right;"><i
                                                                    class="glyphicon glyphicon-calendar"></i> å‰©ä½™2å¤©
                                                            </div>
                                                            </p>
                                                            <br>
                                                            <div class="progress" style="margin-bottom: 4px;">
                                                                <div class="progress-bar progress-bar-success"
                                                                     role="progressbar" aria-valuenow="40"
                                                                     aria-valuemin="0" aria-valuemax="100"
                                                                     style="width: 40%">
                                                                    <span>ä¼—ç­¹ä¸­</span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </td>
                                                <td style="vertical-align:middle;">1</td>
                                                <td style="vertical-align:middle;">1</td>
                                                <td style="vertical-align:middle;">
                                                    <div class="btn-group-vertical" role="group"
                                                         aria-label="Vertical button group">
                                                        <button type="button" class="btn btn-default">å–æ¶ˆå…³æ³¨</button>
                                                    </div>
                                                </td>
                                            </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div role="tabpanel" class="tab-pane fade  " id="add" aria-labelledby="add-tab">
                            <div class="container-fluid">
                                <div class="row clearfix">
                                    <div class="col-md-12 column">
                                        <span class="label label-warning">å…¨éƒ¨</span> <span class="label"
                                                                                          style="color:#000;">ä¼—ç­¹ä¸­</span>
                                        <span class="label " style="color:#000;">ä¼—ç­¹æˆåŠŸ</span> <span class="label "
                                                                                                   style="color:#000;">ä¼—ç­¹å¤±è´¥</span>
                                    </div>
                                    <div class="col-md-12 column" style="padding:0;margin-top:10px;">
                                        <table class="table table-bordered" style="text-align:center;">
                                            <thead>
                                            <tr style="background-color:#ddd;">
                                                <td>é¡¹ç›®ä¿¡æ¯</td>
                                                <td width="120">å‹Ÿé›†é‡‘é¢ï¼ˆå…ƒï¼‰</td>
                                                <td width="80">å½“å‰çŠ¶æ€</td>
                                                <td width="120">æ“ä½œ</td>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            <tr>
                                                <td style="vertical-align:middle;">
                                                    <div class="thumbnail">
                                                        <div class="caption">
                                                            <p>
                                                                BAVOSNä¾¿æºæŠ˜å ç§»åŠ¨ç”µæºå°ç¯
                                                            </p>
                                                            <p>
                                                            <div style="float:left;"><i
                                                                    class="glyphicon glyphicon-screenshot"
                                                                    title="ç›®æ ‡é‡‘é¢"></i> å·²å®Œæˆ 100%
                                                            </div>
                                                            <div style="float:right;"><i title="æˆªè‡³æ—¥æœŸ"
                                                                                         class="glyphicon glyphicon-calendar"></i>
                                                                å‰©ä½™8å¤©
                                                            </div>
                                                            </p>
                                                            <br>
                                                            <div class="progress" style="margin-bottom: 4px;">
                                                                <div class="progress-bar progress-bar-success"
                                                                     role="progressbar" aria-valuenow="40"
                                                                     aria-valuemin="0" aria-valuemax="100"
                                                                     style="width: 40%">
                                                                    <span>ä¼—ç­¹ä¸­</span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </td>
                                                <td style="vertical-align:middle;">1.00<br>(è¿è´¹ï¼š0.00 )</td>
                                                <td style="vertical-align:middle;">è‰ç¨¿</td>
                                                <td style="vertical-align:middle;">
                                                    <div class="btn-group-vertical" role="group"
                                                         aria-label="Vertical button group">
                                                        <button type="button" class="btn btn-default">é¡¹ç›®é¢„è§ˆ</button>
                                                        <button type="button" class="btn btn-default">ä¿®æ”¹é¡¹ç›®</button>
                                                        <button type="button" class="btn btn-default">åˆ é™¤é¡¹ç›®</button>
                                                        <button type="button" class="btn btn-default">é—®é¢˜ç®¡ç†</button>
                                                    </div>
                                                </td>
                                            </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
                <div role="tabpanel" class="tab-pane fade" id="profile" aria-labelledby="profile-tab">
                    ä¼—ç­¹èµ„äº§
                </div>
            </div>
        </div>
    </div>
</div>
<div class="container" style="margin-top:20px;">
    <div class="row clearfix">
        <div class="col-md-12 column">
            <div id="footer">
                <div class="footerNav">
                    <a rel="nofollow" href="http://www.atguigu.com">å…³äºæˆ‘ä»¬</a> | <a rel="nofollow"
                                                                                  href="http://www.atguigu.com">æœåŠ¡æ¡æ¬¾</a>
                    | <a rel="nofollow" href="http://www.atguigu.com">å…è´£å£°æ˜</a> | <a rel="nofollow"
                                                                                    href="http://www.atguigu.com">ç½‘ç«™åœ°å›¾</a>
                    | <a rel="nofollow" href="http://www.atguigu.com">è”ç³»æˆ‘ä»¬</a>
                </div>
                <div class="copyRight">
                    Copyright ?2017-2017atguigu.com ç‰ˆæƒæ‰€æœ‰
                </div>
            </div>

        </div>
    </div>
</div>


</body>
</html>
```



#### 2.3.4 è¿½åŠ é…ç½® `application.yml`ã€`zuul` å·¥ç¨‹ã€‘

```yaml
zuul:
  routers:
    crowd-project:
      service-id: atguigu-crowd-project
      path: /project/**
```



#### 2.3.5 æ–°å»º `CrowdWebMvcConfig` é…ç½®ç±»ã€`project` å·¥ç¨‹ã€‘

```java
package com.atguigu.crowd.config;

import org.springframework.context.annotation.Configuration;
import org.springframework.web.servlet.config.annotation.ViewControllerRegistry;
import org.springframework.web.servlet.config.annotation.WebMvcConfigurer;

/**
 * @author é™ˆæ±Ÿæ—
 * @date 2022/8/31 14:12
 */
@Configuration
public class CrowdWebMvcConfig implements WebMvcConfigurer {

    @Override
    public void addViewControllers(ViewControllerRegistry registry) {
        // view-controller æ˜¯åœ¨ project-consumer å†…éƒ¨å®šä¹‰çš„, æ‰€ä»¥è¿™é‡Œæ˜¯ä¸€ä¸ªä¸ä»…è¿‡ zuul è®¿é—®çš„åœ°å€
        registry.addViewController("/agree/protocol/page").setViewName("project-agree");
        registry.addViewController("/launch/protocol/page").setViewName("project-launch");
    }

}
```

- `project-agree`

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661913850513-54dc9336-714b-47b6-8f75-70bd4fb599e8.png)

- `project-launch`

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661916452699-fbca0129-75f4-4cf0-b87f-5c7a7721214b.png)



#### 2.3.5 é¡µé¢ä¸Šå†™åœ°å€éœ€è¦æ³¨æ„

- å‰é¢è¦å†™ä¸ŠåŸŸåï¼ˆå¦‚æœæ²¡æœ‰é…ç½®åŸŸåå†™ `localhost` ä¸€æ ·ï¼‰, ç¡®ä¿é€šè¿‡ zuul è®¿é—®å…·ä½“åŠŸèƒ½
- å› ä¸ºå¿…é¡»é€šè¿‡ `zuul` è®¿é—®å…·ä½“åŠŸèƒ½æ‰èƒ½ä¿æŒ `Cookie`, è¿›è€Œä¿æŒ `Session` ä¸€è‡´

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661914227431-e4f3c4ef-6168-4582-b4f0-94093112092f.png)



#### 2.3.6 æ–°å»º `templates` >`project-agree.html`ã€`project` å·¥ç¨‹ã€‘

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661928891990-19965d78-7118-455b-af21-c7ebe3ece103.png)

```html
<!DOCTYPE html>
<html lang="zh-CN" xmlns:th="https://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <base th:href="@{/}">
    <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <link rel="stylesheet" href="css/theme.css">
    <script src="jquery/jquery-2.1.1.min.js"></script>
    <script src="bootstrap/js/bootstrap.min.js"></script>
    <script src="script/docs.min.js"></script>
    <script src="script/back-to-top.js"></script>
    <script>
        $('#myTab a').click(function (e) {
            e.preventDefault()
            $(this).tab('show')
        })
    </script>
    <style>
        #footer {
            padding: 15px 0;
            background: #fff;
            border-top: 1px solid #ddd;
            text-align: center;
        }

        #topcontrol {
            color: #fff;
            z-index: 99;
            width: 30px;
            height: 30px;
            font-size: 20px;
            background: #222;
            position: relative;
            right: 14px !important;
            bottom: 11px !important;
            border-radius: 3px !important;
        }

        #topcontrol:after {
            /*top: -2px;*/
            left: 8.5px;
            content: "\f106";
            position: absolute;
            text-align: center;
            font-family: FontAwesome;
        }

        #topcontrol:hover {
            color: #fff;
            background: #18ba9b;
            -webkit-transition: all 0.3s ease-in-out;
            -moz-transition: all 0.3s ease-in-out;
            -o-transition: all 0.3s ease-in-out;
            transition: all 0.3s ease-in-out;
        }

        .label-type, .label-status, .label-order {
            background-color: #fff;
            color: #f60;
            padding: 5px;
            border: 1px #f60 solid;
        }

        #typeList :not(:first-child) {
            margin-top: 20px;
        }

        .label-text {
            margin: 0 10px;
        }

        .panel {
            border-radius: 0;
        }
    </style>
</head>
<body>
<div class="navbar-wrapper">
    <div class="container">
        <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand" href="index.html" style="font-size: 32px;">å°šç­¹ç½‘-åˆ›æ„äº§å“ä¼—ç­¹å¹³å°</a>
                </div>
                <div id="navbar" class="navbar-collapse collapse"
                     style="float: right;">
                    <ul class="nav navbar-nav">
                        <li class="dropdown"><a href="#" class="dropdown-toggle"
                                                data-toggle="dropdown"><i class="glyphicon glyphicon-user"></i>
                            [[${session.loginMember.username}]]<span class="caret"></span></a>
                            <ul class="dropdown-menu" role="menu">
                                <li><a href="member.html"><i
                                        class="glyphicon glyphicon-scale"></i> ä¼šå‘˜ä¸­å¿ƒ</a></li>
                                <li><a href="#"><i class="glyphicon glyphicon-comment"></i>
                                    æ¶ˆæ¯</a></li>
                                <li class="divider"></li>
                                <li><a th:href="@{/auth/member/logout}"><i
                                        class="glyphicon glyphicon-off"></i> é€€å‡ºç³»ç»Ÿ</a></li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    </div>
</div>

<div class="container theme-showcase" role="main">

    <div class="container">
        <div class="row clearfix">
            <div class="col-md-12 column">
                <nav class="navbar navbar-default" role="navigation">
                    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                        <ul class="nav navbar-nav">
                            <li>
                                <a rel="nofollow" href="index.html"><i class="glyphicon glyphicon-home"></i> ä¼—ç­¹é¦–é¡µ</a>
                            </li>
                            <li>
                                <a rel="nofollow" href="projects.html"><i class="glyphicon glyphicon-th-large"></i> é¡¹ç›®æ€»è§ˆ</a>
                            </li>
                            <li class="active">
                                <a rel="nofollow" href="javascript:;"><i class="glyphicon glyphicon-edit"></i> å‘èµ·é¡¹ç›®</a>
                            </li>
                            <li>
                                <a rel="nofollow" href="minecrowdfunding.html"><i class="glyphicon glyphicon-user"></i>
                                    æˆ‘çš„ä¼—ç­¹</a>
                            </li>
                        </ul>
                    </div>
                </nav>
            </div>
        </div>
    </div>


    <div class="container">
        <div class="row clearfix">
            <div class="col-md-12 column">
                <div class="panel panel-default">
                    <div class="panel-heading" style="text-align:center;">
                        <h3>
                            ä¼—ç­¹å¹³å°é¡¹ç›®å‘èµ·äººåè®®
                        </h3>
                    </div>
                    <div class="panel-body" style="height:400px;overflow-y:auto;padding:10px;">
                        <div class="test-box">
                            <p><b>åœ¨å‘èµ·äººä½¿ç”¨å°šç­¹ç½‘ä¼—ç­¹å¹³å°æä¾›çš„æœåŠ¡ä¹‹å‰ï¼Œè¯·åŠ¡å¿…è®¤çœŸé˜…è¯»æœ¬åè®®çš„å…¨éƒ¨å†…å®¹ã€‚é˜…è¯»æœ¬åè®®çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æ‚¨ä¸åŒæ„æœ¬åè®®æˆ–å…¶ä¸­ä»»ä½•æ¡æ¬¾çº¦å®šï¼Œæ‚¨åº”ç«‹å³åœæ­¢æ³¨å†Œï¼ˆå¦‚ï¼šç‚¹å‡»ç¡®è®¤ç­‰åç»­æ“ä½œï¼‰ï¼Œæ’¤é”€æ³¨å†Œæµç¨‹ã€‚æœ¬åè®®ä¸€ç»å‘èµ·äººç‚¹å‡»ç¡®è®¤å¹¶åŒæ„æ¥å—ï¼Œå³äº§ç”Ÿæ³•å¾‹æ•ˆåŠ›ã€‚
                            </b></p>
                            <h5>ç¬¬1æ¡ ç­¾çº¦ä¸»ä½“</h5>
                            <p>
                                æœ¬åè®®ç”±å°šç­¹ç½‘ç½‘ç«™ï¼ˆåŒ…æ‹¬ä½†ä¸é™äºwww.atcrowd.comåŠå°šç­¹ç½‘ä¼—ç­¹å¹³å°ï¼‰çš„æ‰€æœ‰è€…åŠå…¶å…³è”å…¬å¸ï¼ˆä»¥ä¸‹ç®€ç§°ä¸ºâ€œå°šç­¹ç½‘â€ï¼‰ï¼Œåœ¨å°šç­¹ç½‘ä¼—ç­¹å¹³å°ï¼ˆzc.atcrowd.comï¼‰ä¸ç™»å½•ã€ä½¿ç”¨å°šç­¹ç½‘ä¼—ç­¹å¹³å°çš„é¡¹ç›®å‘èµ·äººï¼ˆä»¥ä¸‹ç®€ç§°
                                â€œå‘èµ·äººâ€ï¼‰å…±åŒç­¾ç½²ï¼ˆç­¾çº¦åœ°ï¼šæ±Ÿè‹çœå—äº¬å¸‚ï¼‰ã€‚</p>
                            <h5>ç¬¬2æ¡ å®š ä¹‰</h5>
                            <p>2.1
                                å°šç­¹ç½‘ä¼—ç­¹å¹³å°ï¼šå°šç­¹ç½‘ä¼—ç­¹å¹³å°æ˜¯ä¸€ä¸ªå¯ä»¥è®©å‘èµ·äººçš„é¡¹ç›®è®¡åˆ’å˜ä¸ºç°å®çš„æ¢¦æƒ³å¹³å°ï¼Œæ˜¯â€œè‡´åŠ›äºä¸­å›½åˆ›é€ ï¼Œå®ç°åˆ›æ–°åˆ›ä¸šè€…æ¢¦æƒ³â€çš„å¹³å°ï¼Œå‘èµ·äººå¯ä»¥åœ¨å°šç­¹ç½‘ä¼—ç­¹å¹³å°ä¸Šå‘èµ·åˆ›æ–°é¡¹ç›®çš„ç­¹æ¬¾éœ€æ±‚ï¼Œå¹¶æ‰¿è¯ºæä¾›ä¸åŒå½¢å¼çš„å›æŠ¥ç»™é¡¹ç›®çš„æ”¯æŒè€…ï¼Œæ”¯æŒè€…å¯é€šè¿‡é¢„è´­å‘èµ·äººçš„é¡¹ç›®æˆæœæˆ–ç›¸å…³äº§å“æ¥è¡¨è¾¾å¯¹å‘èµ·äººçš„æ”¯æŒã€‚</p>
                            <p>2.2å‘èµ·äººï¼šæŒ‡åœ¨å°šç­¹ç½‘ä¼—ç­¹å¹³å°ä¸Šå‘èµ·é¡¹ç›®çš„æ³•äººã€‚</p>
                            <p>2.3æ”¯æŒè€…ï¼šæŒ‡å¯¹å‘èµ·äººçš„é¡¹ç›®è¡¨ç¤ºæ”¯æŒçš„å°šç­¹ç½‘ç”¨æˆ·ï¼Œæ”¯æŒè€…é€šè¿‡æ”¯ä»˜ä¸€å®šé‡‘é¢çš„é¢„è´­æ¬¾çš„æ–¹å¼ï¼Œé¢„è´­é¡¹ç›®çš„è¡ç”ŸæˆæœåŠ/æˆ–ç›¸å…³äº§å“ã€‚</p>
                            <p>2.4ç­¹æ¬¾æˆåŠŸï¼šæŒ‡åœ¨å‘èµ·äººè®¾å®šçš„æ—¶é—´å†…ï¼Œå‘èµ·äººä¸æ”¯æŒè€…è®¢ç«‹çš„ä»¥é¡¹ç›®æˆæœåŠ/æˆ–ç›¸å…³äº§å“ä¸ºå›æŠ¥æ ‡çš„çš„åˆåŒé‡‘é¢è¾¾åˆ°æˆ–è¶…è¿‡äº†å‘èµ·äººè®¾å®šçš„ç­¹æ¬¾é‡‘é¢ã€‚</p>
                            <p>2.5é¡¹ç›®æˆåŠŸï¼šæŒ‡é¡¹ç›®ç­¹æ¬¾æˆåŠŸåï¼Œå‘èµ·äººæ‰§è¡Œé¡¹ç›®è®¡åˆ’å¹¶æœ€ç»ˆå½¢æˆé¡¹ç›®æˆæœï¼Œå¹¶æŒ‰ç…§æ”¯æŒè€…é¢„è´­è®¢å•çš„çº¦å®šå‘æ”¯æŒè€…äº¤ä»˜é¡¹ç›®æˆæœåŠ/æˆ–ç›¸å…³äº§å“ã€‚</p>
                            <p>
                            </p><h5>ç¬¬3æ¡ ç«‹çº¦èƒŒæ™¯</h5>
                            <p>3.1ä¸ºä¿æŠ¤æ”¯æŒè€…çš„åˆæ³•æƒç›Šï¼Œè§„èŒƒå‘èµ·äººçš„è¡Œä¸ºï¼Œç»´æŠ¤å°šç­¹ç½‘ä¼—ç­¹å¹³å°çš„ç§©åºï¼Œç‰¹æ‹Ÿå®šæœ¬åè®®ã€‚</p>
                            <p>
                                3.2å°šç­¹ç½‘ä¸ºå‘èµ·äººä¸æ”¯æŒè€…ä¹‹é—´çš„äº¤æ˜“è¡Œä¸ºæä¾›å¹³å°ç½‘ç»œç©ºé—´ã€æŠ€æœ¯æœåŠ¡å’Œæ”¯æŒï¼Œå°šç­¹ç½‘å¹¶ä¸æ˜¯å‘èµ·äººæˆ–æ”¯æŒè€…ä¸­çš„ä»»ä½•ä¸€æ–¹ï¼Œæ‰€æœ‰äº¤æ˜“ä»…å­˜åœ¨äºå‘èµ·äººå’Œæ”¯æŒè€…ä¹‹é—´ï¼Œä½¿ç”¨å°šç­¹ç½‘ä¼—ç­¹å¹³å°äº§ç”Ÿçš„æ³•å¾‹åæœç”±å‘èµ·äººä¸æ”¯æŒè€…è‡ªè¡Œæ‰¿æ‹…ã€‚</p>
                            <p>
                                3.3å°šç­¹ç½‘ä¼šå¯¹æ‰€å‘èµ·çš„é¡¹ç›®çš„åˆç†æ€§ã€é¡¹ç›®å†…å®¹ä¸å›æŠ¥çš„åŒ¹é…åº¦ç­‰è¿›è¡Œå½¢å¼å®¡æ ¸ï¼Œå®¡æ ¸é€šè¿‡åæ‰å¯å‘å¸ƒåˆ°å°šç­¹ç½‘ä¼—ç­¹å¹³å°ï¼Œä½†æ˜¯é¡¹ç›®é€šè¿‡å°šç­¹ç½‘çš„å®¡æ ¸å¹¶ä¸ä»£è¡¨å°šç­¹ç½‘ä¿è¯é¡¹ç›®åˆæ³•æˆ–ä¸ä¾µçŠ¯ä»»ä½•ç¬¬ä¸‰æ–¹çš„æƒåˆ©ï¼Œå‘èµ·äººä»éœ€å¯¹æ‰€å‘èµ·çš„é¡¹ç›®ç‹¬ç«‹æ‰¿æ‹…æ³•å¾‹è´£ä»»ã€‚</p>
                            <h5>ç¬¬4æ¡ åè®®ç”Ÿæ•ˆå’Œé€‚ç”¨èŒƒå›´</h5>
                            <p>4.1æœ¬åè®®å†…å®¹åŒ…æ‹¬åè®®æ­£æ–‡ä»¥åŠå°šç­¹ç½‘ç½‘ç«™å·²ç»å‘å¸ƒçš„æˆ–å°†æ¥å¯èƒ½å‘å¸ƒçš„å„ç±»è§„åˆ™ã€æ“ä½œæµç¨‹ã€‚æ‰€æœ‰è§„åˆ™ä¸ºæœ¬åè®®ä¸å¯åˆ†å‰²çš„ä¸€éƒ¨åˆ†ï¼Œä¸åè®®æ­£æ–‡å…·æœ‰åŒç­‰çš„æ³•å¾‹æ•ˆåŠ›ã€‚</p>
                            <p>
                                4.2å½“å‘èµ·äººåœ¨å°šç­¹ç½‘ä¼—ç­¹å¹³å°å‘èµ·é¡¹ç›®æ—¶ï¼Œé€šè¿‡ç½‘ç»œé¡µé¢ç‚¹å‡»ç¡®è®¤æˆ–ä»¥å…¶ä»–æ–¹å¼é€‰æ‹©æ¥å—æœ¬åè®®ï¼Œå³è¡¨ç¤ºä¸å°šç­¹ç½‘è¾¾æˆåè®®å¹¶æ¥å—æœ¬åè®®çš„å…¨éƒ¨çº¦å®šå†…å®¹ï¼Œæœ¬åè®®è‡ªå‘èµ·äººé€šè¿‡ç½‘ç»œé¡µé¢ç‚¹å‡»ç¡®è®¤æˆ–ä»¥å…¶ä»–æ–¹å¼é€‰æ‹©æ¥å—æœ¬åè®®ä¹‹æ—¶èµ·ç”Ÿæ•ˆã€‚æœ¬åè®®ç”Ÿæ•ˆåï¼Œå‘èµ·äººä¸åº”ä»¥æœªé˜…è¯»æˆ–ä¸æ¥å—æœ¬åè®®çš„å†…å®¹ä¸ºç”±ï¼Œä¸»å¼ æœ¬åè®®æ— æ•ˆæˆ–è¦æ±‚æ’¤é”€æœ¬åè®®ã€‚</p>
                            <p>
                                4.3å°šç­¹ç½‘æœ‰æƒæ ¹æ®éœ€è¦ä¸å®šæ—¶ä¿®æ”¹æœ¬åè®®æˆ–å„ç±»è§„åˆ™ã€æ“ä½œæµç¨‹ï¼Œå¦‚æœ¬åè®®æœ‰ä»»ä½•å˜æ›´ï¼Œå°šç­¹ç½‘å°†åœ¨ç½‘ç«™ä¸Šä»¥å…¬ç¤ºå½¢å¼é€šçŸ¥ï¼Œä¸”æ— éœ€å¾å¾—å‘èµ·äººçš„äº‹å…ˆåŒæ„ã€‚ä¿®æ”¹åçš„åè®®åŠè§„åˆ™ä¸€ç»å…¬ç¤ºå³ç”Ÿæ•ˆï¼Œæˆä¸ºæœ¬åè®®çš„ä¸€éƒ¨åˆ†ã€‚å¦‚å‘èµ·äººç»§ç»­ç™»å½•æˆ–ä½¿ç”¨å°šç­¹ç½‘ä¼—ç­¹å¹³å°çš„ï¼Œå³è§†ä¸ºå·²é˜…è¯»å¹¶æ¥å—ä¿®æ”¹åçš„åè®®ã€‚</p>
                            <p>
                                4.4å‘èµ·äººåº”è¯¥æŒ‰ç…§æœ¬åè®®çº¦å®šè¡Œä½¿æƒåˆ©å¹¶å±¥è¡Œä¹‰åŠ¡ã€‚å¦‚ä¸èƒ½æ¥å—æœ¬åè®®çš„çº¦å®šï¼ŒåŒ…æ‹¬ä½†ä¸é™äºä¸èƒ½æ¥å—ä¿®è®¢åçš„åè®®åŠå„ç±»è§„åˆ™ï¼Œåˆ™åº”ç«‹å³åœæ­¢ä½¿ç”¨å°šç­¹ç½‘ä¼—ç­¹å¹³å°æä¾›çš„æœåŠ¡ã€‚å¦‚å‘èµ·äººç»§ç»­ä½¿ç”¨æœåŠ¡ï¼Œåˆ™è¡¨ç¤ºåŒæ„å¹¶æ¥å—æœ¬åè®®åŠå„ç±»è§„åˆ™çš„çº¦æŸã€‚</p>
                            <h5>ç¬¬5æ¡ é¡¹ç›®å‘èµ·äººèµ„æ ¼</h5>
                            <p>5.1é¡¹ç›®å‘èµ·äººåº”ä¸ºå°šç­¹ç½‘ä¼—ç­¹å¹³å°çš„æ³¨å†Œç”¨æˆ·ï¼Œå®Œå…¨ç†è§£å¹¶æ¥å—æœ¬åè®®ã€‚</p>
                            <p>5.2å‘èµ·äººå¯ä»¥ä¸ºæ³•äººæˆ–å…¶ä»–ç»„ç»‡ä¸”åº”æ˜¯åœ¨ä¸­å›½å¢ƒå†…åˆæ³•æˆç«‹ã€æ³¨å†Œå¯ç‹¬ç«‹æ‰¿æ‹…æ³•å¾‹è´£ä»»çš„æ³•å¾‹å®ä½“ã€‚</p>
                            <p>
                                5.3å‘èµ·äººåœ¨å‘èµ·é¡¹ç›®å‰ï¼Œåº”é€šè¿‡å°šç­¹ç½‘æ˜“ä»˜å®å®Œæˆå¿…è¦çš„èº«ä»½è®¤è¯å’Œèµ„è´¨è®¤è¯ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºè¥ä¸šæ‰§ç…§ã€æ³•äººèº«ä»½è¯ç­‰çš„å®åè®¤è¯ã€‚å‘èµ·äººåœ¨å‘èµ·é¡¹ç›®æ—¶åŒæ„å¹¶æˆæƒå°šç­¹ç½‘ä¼—ç­¹å¹³å°å…¬ç¤ºè®¤è¯ä¿¡æ¯ã€‚</p>
                            <p>5.4å‘èµ·äººåº”æŒ‰ç…§å°šç­¹ç½‘çš„è¦æ±‚å¼€ç«‹è´¦æˆ·ï¼Œä»¥æ¥æ”¶æ”¯æŒè€…çš„æ”¯æŒæ¬¾ã€‚</p>
                            <p>5.5å¦‚å‘èµ·äººç”³è¯·å‘èµ·çš„é¡¹ç›®ä¸ºå¸¦æœ‰å…¬ç›Šæ€§è´¨çš„é¡¹ç›®ï¼Œåˆ™å‘èµ·äººåº”æ˜¯åˆæ³•æˆç«‹çš„å…¬ç›Šç»„ç»‡æˆ–ä¸åˆæ³•æˆç«‹çš„å…¬ç›Šç»„ç»‡å…±åŒå‘èµ·é¡¹ç›®ã€‚</p>
                            <p>5.6å°šç­¹ç½‘ä¼—ç­¹å¹³å°å°†æ ¹æ®ç”³è¯·å‘èµ·çš„é¡¹ç›®ç±»å‹ä¸åŒï¼Œå¯¹å‘èµ·äººéœ€è¦æ»¡è¶³çš„å…¶ä»–èµ„æ ¼è¿›è¡Œé™å®šå’Œè¦æ±‚ã€‚</p>
                            <h5>ç¬¬6æ¡ é¡¹ç›®å†…å®¹è§„èŒƒ</h5>
                            <p>
                                6.1åœ¨å°šç­¹ç½‘ä¼—ç­¹å¹³å°ä¸Šå‘èµ·çš„é¡¹ç›®åº”ä¸ºå…·æœ‰åˆ›æ–°æ€§è´¨ä¸”å…·æœ‰å¯æ‰§è¡Œæ€§çš„é¡¹ç›®ï¼Œä¸”é¡¹ç›®ç›®æ ‡é¡»æ˜¯æ˜ç¡®ã€å…·ä½“ã€å¯è¡¡é‡çš„ï¼Œå¦‚åˆ¶ä½œä¸€ä¸ªå®ç‰©äº§å“ã€æ‹ä¸€éƒ¨å¾®ç”µå½±æˆ–å®Œæˆä¸€ä»¶è‰ºæœ¯åˆ›ä½œç­‰ã€‚ä¸å¾—åœ¨æ— å®è´¨é¡¹ç›®å†…å®¹çš„æƒ…å†µä¸‹çº¯ç²¹ä¸ºå…¬ç›Šç»„ç»‡å‘èµ·å‹Ÿææˆ–ä»¥å‘èµ·ç±»ä¼¼â€œèµ„åŠ©å¥–å­¦é‡‘â€ã€â€œèµ„åŠ©æˆ‘å»æ—…æ¸¸â€ç­‰ä¸ºæ»¡è¶³å‘èµ·äººä¸ªäººéœ€æ±‚ä¹‹ç›®çš„ç­¹æ¬¾ã€‚</p>
                            <p>6.2é¡¹ç›®å†…å®¹é¡»ç¬¦åˆæ³•å¾‹æ³•è§„åŠå°šç­¹ç½‘ç½‘ç«™çš„ç›¸å…³è§„å®šï¼›å°šç­¹ç½‘ä¼—ç­¹å¹³å°æœ‰æƒå¯¹é¡¹ç›®æå‡ºç‰¹æ®Šè¦æ±‚ã€‚ä¸å¾—æŠ„è¢­ã€ç›—ç”¨ä»–äººçš„æˆæœå‘èµ·ä¼—ç­¹é¡¹ç›®ï¼Œåˆ›æ„ç±»äº§å“å¿…é¡»ä¸ºåŸåˆ›ã€‚</p>
                            <p>
                                6.3é¡¹ç›®çš„å†…å®¹å¿…é¡»åŒ…å«â€œæˆ‘æƒ³è¦åšä»€ä¹ˆäº‹æƒ…â€ã€â€œé¡¹ç›®é£é™©â€ã€â€œé¡¹ç›®å›æŠ¥â€ã€â€œä¸ºä»€ä¹ˆéœ€è¦æ”¯æŒâ€ç­‰ä¿¡æ¯ã€‚åŒæ—¶ï¼Œåº”å‘é¡¹ç›®æ”¯æŒè€…å……åˆ†è¯´æ˜é¡¹ç›®å­˜åœ¨çš„é£é™©åŠæŒ‘æˆ˜ï¼Œä»¥ä¾¿äºé¡¹ç›®æ”¯æŒè€…å¯¹é¡¹ç›®æœ‰å…¨é¢å……åˆ†çš„äº†è§£ï¼Œä»è€Œç‹¬ç«‹æ…é‡åšå‡ºæ˜¯å¦æŠ•èµ„çš„å†³å®šã€‚</p>
                            <p>
                                6.4é¡¹ç›®å†…å®¹åŠå‘èµ·äººä¸Šä¼ çš„ç›¸å…³é¡¹ç›®ä¿¡æ¯ï¼ˆåŒ…å«ä½†ä¸é™äºæ–‡å­—ã€å›¾ç‰‡ã€è§†é¢‘ç­‰ï¼‰é¡»ä¸ºå‘èµ·äººåŸåˆ›ï¼Œå¦‚éå‘èµ·äººåŸåˆ›ï¼Œåˆ™å‘èµ·äººåº”å·²è·å¾—æƒåˆ©äººçš„ç›¸åº”æˆæƒï¼Œä¸”æƒåˆ©äººå…è®¸å‘èµ·äººè½¬æˆæƒç»™å°šç­¹ç½‘åŠå°šç­¹ç½‘çš„å…³è”å…¬å¸åœ¨å°šç­¹ç½‘ç½‘ç«™åŠå°šç­¹ç½‘å…³è”å…¬å¸çš„å…¶ä»–å®˜æ–¹ç½‘ç«™åŠçº¿ä¸‹åª’ä½“å‡ºäºå®£ä¼ å°šç­¹ç½‘ä¼—ç­¹å¹³å°çš„ç›®çš„è€Œè¿›è¡Œæ°¸ä¹…çš„å…è´¹å®£ä¼ ã€æ¨å¹¿ã€ä½¿ç”¨ã€‚</p>
                            <p>6.5é¡¹ç›®ä¸å¾—å«æœ‰æ”»å‡»æ€§ã€ä¾®è¾±æ€§è¨€è®ºï¼Œä¸å¾—å«æœ‰è¿åå›½å®¶æ³•å¾‹æ³•è§„ã€æ”¿ç­–çš„å†…å®¹åŠå…¶ä»–å°šç­¹ç½‘è®¤ä¸ºä¸é€‚å®œçš„å†…å®¹ã€‚åŒ…æ‹¬ä½†ä¸é™äºä»¥ä¸‹å†…å®¹ï¼š</p>
                            <p>6.5.1è¿åå›½å®¶æ³•å¾‹è§„å®šçš„è¿ç¦å“ï¼Œå¦‚æ¯’å“ã€æªæ”¯å¼¹è¯åŠç®¡åˆ¶åˆ€å…·ç›¸å…³ï¼›</p>
                            <p>6.5.2éæ³•ã€è‰²æƒ…ã€æ·«ç§½ã€èµŒåšã€æš´åŠ›ã€ææ€–ã€ååŠ¨ã€æ”¿æ²»ä¸å®—æ•™ç›¸å…³ï¼›</p>
                            <p>6.5.3å¼€åŠå…¬å¸ã€ç½‘ç«™ã€åº—é“ºç­‰ç›¸å…³ï¼›</p>
                            <p>6.5.4å…¶ä»–å›½å®¶æ³•å¾‹è§„å®šå’Œå°šç­¹ç½‘ç½‘ç«™è§„å®šçš„ç¦é™å”®ç­‰è¿ç¦å“ä¿¡æ¯ã€‚</p>
                            <p>6.6é¡¹ç›®å›æŠ¥å‘æ”¾å®Œæˆå‰ä¸å…è®¸å¯¹å·²ç»å®Œæˆç”Ÿäº§çš„å•†å“è¿›è¡Œé”€å”®ï¼Œå…¬ç›Šç›¸å…³é¡¹ç›®é™¤å¤–ã€‚</p>
                            <p>6.7 é¡¹ç›®çš„æ’ä»–æ€§ï¼Œé¡¹ç›®åœ¨å°šç­¹ç½‘ä¼—ç­¹å¹³å°å‹Ÿé›†æœŸå†…ä¸å¾—åœ¨å…¶ä»–ä»»æ„å¹³å°åŒæ—¶å‘èµ·ç±»ä¼¼é¡¹ç›®æˆ–è¿›è¡Œé”€å”®ã€‚ä¸€ç»å‘ç°ï¼Œé¡¹ç›®å¼ºè¡Œä¸‹æ¶ï¼Œå¹¶è¿½ç©¶è¿çº¦è´£ä»»ã€‚</p>
                            <p>6.8å°šç­¹ç½‘ä¼—ç­¹å¹³å°å¯¹é¡¹ç›®çš„å®¡æ ¸ä»…é’ˆå¯¹é¡¹ç›®çš„åˆç†æ€§ã€é¡¹ç›®å†…å®¹ä¸å›æŠ¥çš„åŒ¹é…åº¦ç­‰è¿›è¡Œå®¡æ ¸ï¼Œå‘èµ·äººåº”ä¿è¯å‘èµ·çš„é¡¹ç›®å†…å®¹åˆæ³•ï¼Œä¸”ä¸ä¾µçŠ¯ä»–äººåˆæ³•æƒç›Šã€‚</p>
                            <p>
                                6.9åœ¨å°šç­¹ç½‘ä¼—ç­¹å¹³å°ä¸Šå‘èµ·é¡¹ç›®æ—¶ï¼Œåº”æ˜ç¡®ä¼—ç­¹å¼€å§‹æ—¶é—´å’Œç»“æŸæ—¶é—´ï¼Œä»¥åŠé¡¹ç›®ä¼—ç­¹æˆåŠŸåçš„å›æŠ¥æ—¶é—´ã€‚æˆªæ­¢é¡¹ç›®ç»“æŸæ—¶é—´ï¼Œå¦‚é¡¹ç›®ä¼—ç­¹é‡‘é¢ç­‰äºæˆ–å¤§äºé¢„å®šä¼—ç­¹é‡‘é¢ï¼Œåˆ™é¡¹ç›®ä¼—ç­¹æˆåŠŸï¼›å¦‚é¡¹ç›®ä¼—ç­¹é‡‘é¢ä½äºé¢„å®šä¼—ç­¹é‡‘é¢ï¼Œåˆ™é¡¹ç›®ä¼—ç­¹å¤±è´¥ã€‚</p>
                            <h5>ç¬¬7æ¡ é¡¹ç›®å›æŠ¥è§„èŒƒ</h5>
                            <p>7.1é¡¹ç›®å›æŠ¥å¿…é¡»ä¸é¡¹ç›®å…·æœ‰å…³è”æ€§ã€‚å›æŠ¥åº”ä¸ºé¡¹ç›®è¿›è¡Œè¿‡ç¨‹ä¸­å‘èµ·äººäº§å‡ºçš„è¡ç”Ÿæˆæœæˆ–ç›¸å…³å•†å“ï¼Œå…¬ç›Šç›¸å…³é¡¹ç›®é™¤å¤–ã€‚</p>
                            <p>7.2
                                å‘èµ·äººæ‰¿è¯ºï¼Œå¦‚é¡¹ç›®ä¼—ç­¹æˆåŠŸï¼ŒåŠæ—¶å…‘ç°å¯¹é¡¹ç›®æ”¯æŒè€…æ‰¿è¯ºçš„å›æŠ¥ï¼›å¦‚é¡¹ç›®ä¼—ç­¹å¤±è´¥ï¼ŒåŒæ„å°šç­¹ç½‘å°†ä¼—ç­¹æ¬¾é¡¹åŠæ—¶é€€è¿˜é¡¹ç›®æ”¯æŒè€…ï¼Œå¹¶ç”±å‘èµ·äººå°±é¡¹ç›®ä¼—ç­¹å¤±è´¥çš„åŸå› ç­‰å¯¹é¡¹ç›®æ”¯æŒè€…åšå‡ºè§£é‡Šã€‚</p>
                            <p>7.3é¡¹ç›®å›æŠ¥äº§å“åœ¨å°šç­¹ç½‘ä¼—ç­¹å¹³å°è®¾ç½®çš„æœ€é«˜å•ä»·åº”ä½äºé¡¹ç›®æˆåŠŸç»“æŸå<b>ä¸¤ä¸ªæœˆå†…</b>çš„äº§å“å¸‚åœºå”®ä»·çš„<b>90%</b> ï¼Œå¦åˆ™åº”å°†å”®ä»·å·®é¢å‘è¿˜æ”¯æŒè€…ã€‚</p>
                            <p>7.4é¡¹ç›®å›æŠ¥ä¸ºå®ç‰©çš„ï¼Œäº§å“é‡äº§åï¼Œåº”æœ€å…ˆå‘æ”¾ç»™å°šç­¹ç½‘ä¼—ç­¹å¹³å°æ”¯æŒè¯¥é¡¹ç›®çš„æ”¯æŒè€…ï¼Œå¦åˆ™å°†è§†ä¸ºå‘èµ·äººè¿çº¦ï¼Œéœ€æ‰¿æ‹…è¿çº¦è´£ä»»åŠç½šé‡‘ã€‚</p>
                            <p>7.5å¦‚å‘èµ·äººä¸é¡¹ç›®æ”¯æŒè€…åœ¨å…‘ç°å›æŠ¥è¿‡ç¨‹ä¸­å‘ç”Ÿçº çº·ï¼Œä¸€åˆ‡è´£ä»»ç”±å‘èµ·äººæ‰¿æ‹…ï¼Œå¦‚å› æ­¤ç»™å°šç­¹ç½‘é€ æˆç»æµæˆ–åèª‰æŸå¤±ï¼Œå‘èµ·äººåº”èµ”å¿å°šç­¹ç½‘ç›¸å…³æŸå¤±ã€‚</p>
                            <p>7.6å¦‚å‘èµ·äººåœ¨å…‘ç°å¯¹é¡¹ç›®æ”¯æŒè€…çš„å›æŠ¥çš„è¿‡ç¨‹ä¸­ï¼Œä¸ç¬¬ä¸‰æ–¹ï¼ˆåŒ…æ‹¬ä½†ä¸é™äºç‰©æµå…¬å¸ï¼‰å‘ç”Ÿçº çº·ï¼Œä¸€åˆ‡è´£ä»»ç”±å‘èµ·äººæ‰¿æ‹…ã€‚</p>
                            <h5>ç¬¬8æ¡ å‘èµ·äººè¡Œä¸ºè§„èŒƒ</h5>
                            <p>8.1é¡¹ç›®å®¡æ ¸é€šè¿‡åï¼Œå‘èµ·äººé™¤å¯ä¿®æ”¹é¡¹ç›®å¯åŠ¨æ—¶é—´å¤–ï¼Œä¸å¾—ç¼–è¾‘ã€ä¿®æ”¹å…¶ä»–é¡¹ç›®å†…å®¹ã€‚</p>
                            <p>8.2é¡¹ç›®ç­¹æ¬¾æˆåŠŸå‰ï¼Œå‘èµ·äººå¦‚å› æ•…éœ€å–æ¶ˆé¡¹ç›®çš„ï¼Œéœ€å‘å°šç­¹ç½‘ä¼—ç­¹å¹³å°æäº¤å–æ¶ˆç”³è¯·ï¼Œå°šç­¹ç½‘ä¼—ç­¹å¹³å°å®¡æ ¸é€šè¿‡åé¡¹ç›®å–æ¶ˆï¼Œæ‰€æœ‰ç­¹é›†åˆ°çš„æ¬¾é¡¹ç”±å°šç­¹ç½‘é€€å›ç»™æ”¯æŒè€…ã€‚</p>
                            <p>8.3é¡¹ç›®ç­¹æ¬¾æˆåŠŸåï¼Œå‘èµ·äººåº”ä¸¥æ ¼æŒ‰ç…§é¡¹ç›®è®¡åˆ’æ‰§è¡Œï¼Œå¹¶åœ¨é¡¹ç›®è®¡åˆ’æ‰§è¡Œè¿‡ç¨‹ä¸­ç§¯æä¸æ”¯æŒè€…äº’åŠ¨ã€‚</p>
                            <p>
                                8.4é¡¹ç›®ç­¹æ¬¾æˆåŠŸåï¼Œå¦‚é¡¹ç›®å› æ•…å»¶æœŸæˆ–æ— æ³•æŒ‰åŸå®šé¡¹ç›®è®¡åˆ’æ‰§è¡Œçš„ï¼Œæˆ–è€…å› ä»»ä½•ä¸»è§‚æˆ–å®¢è§‚å› ç´ å¯¼è‡´é¡¹ç›®æœ€ç»ˆæ— æ³•å®Œæˆçš„ï¼Œå‘èµ·äººåº”ç¬¬ä¸€æ—¶é—´é€šçŸ¥å°šç­¹ç½‘ä¼—ç­¹å¹³å°ï¼Œå¹¶åŠæ—¶é€šè¿‡å°šç­¹ç½‘ä¼—ç­¹å¹³å°åŠå…¶ä»–é€”å¾„å‘ŠçŸ¥æ”¯æŒè€…ï¼Œå‘æ”¯æŒè€…æ”¯ä»˜è¿çº¦é‡‘ï¼Œå…¨é¢é€€è¿˜æœªå±¥è¡Œè®¢å•çš„é¡¹ç›®æ”¯æŒæ¬¾ã€‚</p>
                            <p>8.5å‘èµ·äººåœ¨é¡¹ç›®å‹Ÿé›†æœŸé—´ï¼Œä¸èƒ½ä»¥ä»»ä½•å½¢å¼åœ¨å…¶ä»–å¹³å°ä¸Šå‘èµ·è¯¥é¡¹ç›®ã€‚å¦‚è¿åè¯¥è§„å®šï¼Œå°šç­¹ç½‘æœ‰æƒå¯¹å‘èµ·äººè¿½ç©¶è´£ä»»ã€‚</p>
                            <p>
                                8.6å‘èµ·äººåº”æŒ‰ç…§æ‰¿è¯ºå‘æ”¾é¡¹ç›®å›æŠ¥ï¼ˆé¡¹ç›®è¡ç”ŸæˆæœåŠ/æˆ–ç›¸å…³å•†å“ï¼‰ï¼Œå‘æ”¾çš„é¡¹ç›®å›æŠ¥åº”æ— è´¨é‡æˆ–æƒåˆ©ç‘•ç–µï¼Œå¦‚å› é¡¹ç›®å›æŠ¥å‘ç”Ÿçº çº·ï¼Œå‚ç…§å›½å®¶ç›¸å…³æ³•è§„å¤„ç†(ä¾‹å¦‚:ã€Šæ¶ˆè´¹è€…æƒç›Šä¿æŠ¤æ³•ã€‹)ã€‚</p>
                            <p>8.7å‘èµ·äººåœ¨é¡¹ç›®å›æŠ¥æ—¥å‰æœªå®Œæˆå›æŠ¥ï¼Œä¸”æ— åˆç†ç†ç”±çš„ï¼Œè§†ä¸ºé¡¹ç›®å»¶æœŸã€‚<b>é¡¹ç›®å»¶æœŸ30å¤©ï¼ˆå«ï¼‰ä»¥ä¸Šçš„ï¼Œè§†ä¸ºé¡¹ç›®å¤±è´¥</b>ã€‚å°šç­¹ç½‘ä¼—ç­¹å¹³å°æœ‰æƒé€šè¿‡ç³»ç»Ÿç›´æ¥å‘æœªç¡®è®¤æ”¶è´§çš„æ”¯æŒè€…é€€è¿˜æ”¯æŒæ¬¾ï¼Œå‘èµ·äººåº”å½“å°†æ”¯æŒæ¬¾å…¨é¢è¿”è¿˜å°šç­¹ç½‘ä¼—ç­¹å¹³å°ã€‚
                            </p>
                            <p>8.8å…¬ç›Šç›¸å…³é¡¹ç›®å‘èµ·äººåº”åœ¨å®Œæˆé¡¹ç›®åçš„åˆç†æ—¶é—´å†…ä¸Šä¼ ç­¹æ¬¾é¡¹ç”¨äºå…¬ç›Šç”¨é€”çš„ç›¸å…³å‡­è¯ã€‚</p>
                            <p>8.9å‘èµ·äººåº”æäº¤çœŸå®ã€å‡†ç¡®çš„é¡¹ç›®ä¿¡æ¯ï¼ˆé¡¹ç›®ä¿¡æ¯å¦‚æœ‰ä»»ä½•æ›´æ–°ï¼Œåº”åŠæ—¶å‘å°šç­¹ç½‘ä¼—ç­¹å¹³å°æäº¤æ›´æ–°åçš„ä¿¡æ¯ï¼‰ï¼Œå¹¶è‡ªä¸»ä¸Šä¼ ã€æäº¤é¡¹ç›®ã€‚</p>
                            <p>8.10å‘èµ·äººåº”è‡ªè¡Œæ‰¿æ‹…å‡†å¤‡æˆ–æäº¤ã€å®Œæˆé¡¹ç›®è€Œå‘ç”Ÿçš„è´¹ç”¨ï¼Œè‡ªè¡Œç¼´çº³å› ä»äº‹æœ¬åè®®é¡¹ä¸‹è¡Œä¸ºè€Œäº§ç”Ÿçš„ç›¸åº”ç¨æ¬¾ã€‚</p>
                            <p>
                                8.11å‘èµ·äººåº”å¦¥å–„ä¿ç®¡å°šç­¹ç½‘ä¼—ç­¹å¹³å°çš„è´¦å·å’Œå¯†ç ï¼Œä»»ä½•æƒ…å†µä¸‹å‘èµ·äººé¡»å¯¹åœ¨è¯¥è´¦å·ä¸‹å‘ç”Ÿçš„æ‰€æœ‰æ´»åŠ¨ï¼ˆåŒ…æ‹¬ä½†ä¸é™äºä¿¡æ¯æŠ«éœ²ã€å‘å¸ƒä¿¡æ¯ã€ä¸Šä¼ å›¾ç‰‡æˆ–è§†é¢‘ã€ç½‘ä¸Šç‚¹å‡»åŒæ„æˆ–æäº¤å„ç±»è§„åˆ™åè®®ç­‰ï¼‰æ‰¿æ‹…æ³•å¾‹è´£ä»»ã€‚</p>
                            <p>8.12å‘èµ·äººäº†è§£å¹¶åŒæ„ï¼Œä¸å¾—è‡ªè¡Œæˆ–å…è®¸ä»»ä½•ç¬¬ä¸‰æ–¹ä½¿ç”¨å‘èµ·äººçš„è´¦å·é€šè¿‡å°šç­¹ç½‘ä¼—ç­¹å¹³å°ä»äº‹ä»»ä½•è¿åæ³•å¾‹æ³•è§„æˆ–ä¾µçŠ¯ç¬¬ä¸‰æ–¹æƒåˆ©çš„è¡Œä¸ºï¼ŒåŒ…å«ä½†ä¸é™äºï¼š</p>
                            <p>8.12.1ä¾µçŠ¯ä»»ä½•ç¬¬ä¸‰æ–¹çš„ä¸“åˆ©ã€å•†æ ‡ã€è‘—ä½œæƒã€å•†ä¸šç§˜å¯†æˆ–å…¶ä»–åˆæ³•æƒåˆ©ï¼Œæˆ–è¿åä»»ä½•æ³•å¾‹æˆ–åˆåŒçš„ï¼›</p>
                            <p>8.12.2å‘èµ·äººçš„è¡Œä¸ºæˆ–é¡¹ç›®ä¿¡æ¯æ˜¯è™šå‡çš„ã€è¯¯å¯¼æ€§çš„ã€ä¸å‡†ç¡®çš„ï¼›</p>
                            <p>8.12.3å‘èµ·äººçš„è¡Œä¸ºæˆ–é¡¹ç›®ä¿¡æ¯æ¶‰å«Œéæ³•ã€å¨èƒã€è¾±éª‚ã€éªšæ‰°ã€è¯½è°¤ã€ä¸­ä¼¤ã€æ¬ºéª—ã€æ¬ºè¯ˆã€ä¾µæƒã€æ·«ç§½ã€å†’çŠ¯ã€äºµæ¸æˆ–ä¾µçŠ¯ä»–äººéšç§çš„ï¼›</p>
                            <p>8.12.4æœªç»æ¥æ”¶æ–¹å…è®¸è€Œå‘æ¥æ”¶æ–¹å‘å¸ƒä»»ä½•é‚®ä»¶ã€å®£ä¼ ææ–™æˆ–å¹¿å‘Šä¿¡æ¯ï¼›</p>
                            <p>8.12.5è¿›è¡Œä»»ä½•å±å®³ä¿¡æ¯ç½‘ç»œå®‰å…¨çš„è¡Œä¸ºï¼Œæ•…æ„ä¼ æ’­æ¶æ„ç¨‹åºæˆ–ç—…æ¯’ä»¥åŠå…¶ä»–ç ´åã€å¹²æ‰°æ­£å¸¸ç½‘ç»œä¿¡æ¯æœåŠ¡çš„è¡Œä¸ºã€‚</p>
                            <p>8.13å¯¹äºå‘èµ·äººé€šè¿‡å°šç­¹ç½‘ä¼—ç­¹å¹³å°å‘å¸ƒçš„æ¶‰å«Œè¿æ³•æˆ–æ¶‰å«Œä¾µçŠ¯ä»–äººåˆæ³•æƒåˆ©æˆ–è¿åæœ¬åè®®çš„ä¿¡æ¯ï¼Œå°šç­¹ç½‘æœ‰æƒä¾æ®å°šç­¹ç½‘çš„åˆ¤æ–­ä¸ç»é€šçŸ¥å‘èµ·äººå³äºˆä»¥ä¿®æ”¹ã€ç¼–è¾‘ã€åˆ é™¤ç­‰ã€‚</p>
                            <p>8.14å®ç‰©å›æŠ¥ç±»é¡¹ç›®ä¸Šçº¿ä¹‹å‰ï¼Œå‘èµ·äººæœ‰ä¹‰åŠ¡ä¸»åŠ¨æä¾›æ ·å“è¿›è¡Œè¯„ä¼°å®¡æ ¸ï¼Œä¸”é¡¹ç›®ä¸€ç»ä¸Šçº¿æ— è®ºä¼—ç­¹æˆåŠŸä¸å¦ï¼Œæ ·æœºä¸äºˆé€€è¿˜ã€‚</p>
                            <p>
                                8.15å‘èµ·äººæ‰¿è¯ºä¸å¾—æœªç»å°šç­¹ç½‘ä¼—ç­¹å¹³å°åŒæ„æ“…è‡ªä½¿ç”¨å°šç­¹ç½‘ä¼—ç­¹åŠå…¶å…³è”å…¬å¸çš„ä»»ä½•çŸ¥è¯†äº§æƒã€‚ç‰¹åˆ«åœ°ï¼Œé™¤éç»å°šç­¹ç½‘ä¼—ç­¹å¹³å°ä¹¦é¢æ‰¹å‡†ï¼Œå‘èµ·äººåœ¨ä»»ä½•æƒ…å½¢ä¸‹éƒ½ä¸åœ¨ä»»ä½•å›½å®¶æˆ–åœ°åŒºå°†å°šç­¹ç½‘ä¼—ç­¹åŠå…¶å…³è”å…¬å¸çš„å•†æ ‡åŠå…¶ç±»ä¼¼å•†æ ‡ã€æ ‡è¯†çš„å…¨éƒ¨æˆ–éƒ¨åˆ†å•ç‹¬åœ°æˆ–ä¸å…¶ä»–ä»»ä½•å•†æ ‡ã€å•†å·ã€æ–‡å­—æˆ–ç¬¦å·ã€åŸŸååˆå¹¶ä½¿ç”¨æˆ–è¿›è¡Œç”³è¯·ã€æ³¨å†Œç­‰æƒåŠ›åŒ–è¡Œä¸ºã€‚åˆä½œè¿‡ç¨‹ä¸­ï¼Œå‘èµ·äººåº”å½“åœ¨å…¶çŸ¥æ™“ä»»ä½•ç¬¬ä¸‰æ–¹å¯èƒ½ä¾µçŠ¯å°šç­¹ç½‘ä¼—ç­¹å¹³å°çŸ¥è¯†äº§æƒæ—¶åŠæ—¶é€šçŸ¥å°šç­¹ç½‘ä¼—ç­¹å¹³å°ã€‚</p>
                            <p>8.16å‘èµ·äººè¿åä¸Šè¿°è¡Œä¸ºè§„èŒƒå¯¹ä»»ä½•ç¬¬ä¸‰æ–¹é€ æˆæŸå®³çš„ï¼Œå‘èµ·äººå‡åº”å½“ä»¥è‡ªå·±çš„åä¹‰ç‹¬ç«‹æ‰¿æ‹…æ‰€æœ‰çš„æ³•å¾‹è´£ä»»ï¼Œå¹¶èµ”å¿å°šç­¹ç½‘å› æ­¤äº§ç”Ÿçš„æŸå¤±æˆ–è´¹ç”¨ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºå•†èª‰æŸå¤±ç­‰ã€‚</p>
                            <h5>ç¬¬9æ¡ æ”¯æŒæ¬¾äº¤ä»˜åŠå¹³å°æœåŠ¡è´¹</h5>
                            <p>9.1å°šç­¹ç½‘ä¼—ç­¹å¹³å°å¯¹æ”¯æŒæ¬¾çš„äº¤ä»˜åŠå¹³å°æœåŠ¡è´¹çš„æ”¶å–å‡é€šè¿‡ç¬¬ä¸‰æ–¹æ”¯ä»˜å¹³å°<b>å°šç­¹ç½‘æ˜“ä»˜å®</b>è¿›è¡Œæ”¶ä»˜ã€‚</p>
                            <p>9.2å‘èµ·äººä½¿ç”¨å°šç­¹ç½‘ä¼—ç­¹å¹³å°æœåŠ¡ï¼Œå°šç­¹ç½‘å°†å‘å‘èµ·äººæ”¶å–å‹Ÿé›†æ€»é‡‘é¢3%çš„å¹³å°æœåŠ¡è´¹ï¼Œå‘èµ·äººä¸å°šç­¹ç½‘å¦æœ‰çº¦å®šçš„é™¤å¤–ã€‚</p>
                            <p>
                                9.3ç­¹æ¬¾æˆåŠŸåå°šç­¹ç½‘ä¼—ç­¹å¹³å°å°†åœ¨<b>3</b>ä¸ªå·¥ä½œæ—¥å†…å°†å‹Ÿé›†æ€»é‡‘é¢æ‰£é™¤å¹³å°æœåŠ¡è´¹ä»¥åŠè´¨é‡ä¿è¯é‡‘ï¼ˆå¦‚æœ‰ï¼‰åå‰©ä½™æ¬¾é¡¹çš„<b>60%</b>äº¤ä»˜ç»™å‘èµ·äººï¼Œå¹¶é¢„ç•™ä½™ä¸‹çš„<b>40%</b>ä½œä¸ºç¡®ä¿é¡¹ç›®æˆåŠŸå¹¶ä¿è¯æ”¯æŒè€…è·å¾—å›æŠ¥çš„ä¿è¯é‡‘(ä»¥ä¸‹ç®€ç§°â€œä¿è¯é‡‘â€)ã€‚åœ¨é¡¹ç›®æˆåŠŸã€æ— çº çº·ä¸”æ‰€æœ‰æ”¯æŒè€…å¾—åˆ°æ‰¿è¯ºå›æŠ¥çš„æƒ…å†µä¸‹ï¼Œå°šç­¹ç½‘å°†æŠŠè¿™éƒ¨åˆ†æ¬¾é¡¹äº¤ä»˜ç»™å‘èµ·äººã€‚å‘èµ·äººä¸å°šç­¹ç½‘å¦æœ‰çº¦å®šçš„é™¤å¤–ã€‚
                            </p>
                            <p>
                                9.4æ ¹æ®å¸‚åœºä¸æŠ€æœ¯çš„å‘å±•ï¼Œå°šç­¹ç½‘ä¿ç•™å˜æ›´ä¿è¯é‡‘åŠå¹³å°æœåŠ¡è´¹æ¯”ä¾‹çš„æƒåˆ©ã€‚åœ¨å˜æ›´å‰ï¼Œå°šç­¹ç½‘å°†ä»¥é€‚å½“çš„æ–¹å¼é€šçŸ¥å‘èµ·äººå˜æ›´æƒ…å†µï¼ŒåŒ…æ‹¬ä½†ä¸é™äºåœ¨å°šç­¹ç½‘ç½‘ç«™ä¸Šå…¬ç¤ºã€‚å‘èµ·äººæœ‰æƒé€‰æ‹©æ¥å—æˆ–æ‹’ç»æ¥å—ï¼Œå¦‚æœå‘èµ·äººé€‰æ‹©æ‹’ç»çš„ï¼Œåº”ç«‹å³åœæ­¢ä½¿ç”¨å°šç­¹ç½‘ä¼—ç­¹å¹³å°çš„æœåŠ¡ï¼›å‘èµ·äººç»§ç»­ä½¿ç”¨å°šç­¹ç½‘ä¼—ç­¹å¹³å°çš„ï¼Œå³è§†ä¸ºå‘èµ·äººåŒæ„å°šç­¹ç½‘çš„è´¹ç”¨å˜æ›´ã€‚å˜æ›´åçš„æ”¶è´¹æ¯”ä¾‹å¯¹å·²ç»å‘å¸ƒçš„é¡¹ç›®æ— æº¯åŠåŠ›ã€‚</p>
                            <h5>ç¬¬10æ¡ çŸ¥è¯†äº§æƒ</h5>
                            <p>10.1å‘èµ·äººæ‰¿è¯ºï¼Œå¯¹äºé€šè¿‡å°šç­¹ç½‘ä¼—ç­¹å¹³å°å‘å¸ƒã€ä¸Šä¼ çš„æ‰€æœ‰å†…å®¹å‡æ‹¥æœ‰åˆæ³•æƒåˆ©ï¼Œä¸ä¾µçŠ¯ä»»ä½•ç¬¬ä¸‰æ–¹çš„è‚–åƒæƒã€éšç§æƒã€ä¸“åˆ©æƒã€å•†æ ‡æƒã€è‘—ä½œæƒç­‰åˆæ³•æƒåˆ©åŠå…¶ä»–åˆåŒæƒåˆ©ã€‚</p>
                            <p>
                                10.2å‘èµ·äººé€šè¿‡å°šç­¹ç½‘ä¼—ç­¹å¹³å°å‘å¸ƒã€ä¸Šä¼ çš„ä»»ä½•å†…å®¹ï¼Œå‘èµ·äººæˆäºˆå°šç­¹ç½‘åŠå…¶å…³è”å…¬å¸éç‹¬å®¶çš„ã€å¯è½¬æˆæƒçš„ã€ä¸å¯æ’¤é”€çš„ã€å…¨çƒé€šç”¨çš„ã€æ°¸ä¹…çš„ã€å…è´¹çš„è®¸å¯ä½¿ç”¨æƒåˆ©ï¼Œå¹¶å¯å¯¹ä¸Šè¿°å†…å®¹è¿›è¡Œä¿®æ”¹ã€æ”¹å†™ã€æ”¹ç¼–ã€å‘è¡Œã€ç¿»è¯‘ã€åˆ›é€ è¡ç”Ÿæ€§å†…å®¹åŠ/æˆ–å¯ä»¥å°†å‰è¿°éƒ¨åˆ†æˆ–å…¨éƒ¨å†…å®¹åŠ ä»¥ä¼ æ’­ã€è¡¨æ¼”ã€å±•ç¤ºï¼ŒåŠ/æˆ–å¯ä»¥å°†å‰è¿°éƒ¨åˆ†æˆ–å…¨éƒ¨å†…å®¹æ”¾å…¥ä»»ä½•ç°åœ¨å·²çŸ¥å’Œæœªæ¥å¼€å‘å‡ºçš„ä»¥ä»»ä½•å½¢å¼ã€åª’ä½“æˆ–ç§‘æŠ€æ‰¿è½½çš„ä½œå“å½“ä¸­ã€‚</p>
                            <p>
                                10.3å°šç­¹ç½‘ä¼—ç­¹å¹³å°å‘å‘èµ·äººæä¾›çš„æœåŠ¡å«æœ‰å—åˆ°ç›¸å…³çŸ¥è¯†äº§æƒåŠå…¶ä»–æ³•å¾‹ä¿æŠ¤çš„ä¸“æœ‰ä¿å¯†èµ„æ–™æˆ–ä¿¡æ¯ï¼Œäº¦å¯èƒ½å—åˆ°è‘—ä½œæƒã€å•†æ ‡ã€ä¸“åˆ©ç­‰ç›¸å…³æ³•å¾‹çš„ä¿æŠ¤ã€‚æœªç»å°šç­¹ç½‘æˆ–ç›¸å…³æƒåˆ©äººä¹¦é¢æˆæƒï¼Œå‘èµ·äººä¸å¾—ä¿®æ”¹ã€å‡ºå”®ã€ä¼ æ’­éƒ¨åˆ†æˆ–å…¨éƒ¨è¯¥ç­‰ä¿¡æ¯ï¼Œæˆ–åŠ ä»¥åˆ¶ä½œè¡ç”ŸæœåŠ¡æˆ–è½¯ä»¶ï¼Œæˆ–é€šè¿‡è¿›è¡Œè¿˜åŸå·¥ç¨‹ã€åå‘ç»„è¯‘åŠå…¶ä»–æ–¹å¼ç ´è¯‘åŸä»£ç ã€‚</p>
                            <h5>ç¬¬11æ¡ çº çº·å¤„ç†</h5>
                            <p>11.1è™šæ‹Ÿç±»å›æŠ¥ä¸æ”¯æŒé€€æ¢è´§ï¼Œä¹Ÿä¸æ”¯æŒé€€æ¬¾ï¼Œå¦‚æœ‰å‘è´§é”™è¯¯ã€æ¼å‘æˆ–æ”¯æŒè€…æ”¶åˆ°çš„è™šæ‹Ÿç±»å›æŠ¥å­˜åœ¨è´¨é‡é—®é¢˜çš„ï¼Œå‘èµ·äººåº”åœ¨ä¸ƒæ—¥å†…å…è´¹äºˆä»¥é‡å‘æˆ–è¡¥å‘ã€‚</p>
                            <p>11.2å®ç‰©ç±»å›æŠ¥å¦‚æœ‰é”™å‘ã€æ¼å‘çš„ï¼Œå‘èµ·äººåº”åœ¨ä¸ƒæ—¥å†…å…è´¹äºˆä»¥é‡å‘æˆ–è¡¥å‘ï¼Œå‘èµ·äººæ— æ³•é‡å‘æˆ–è¡¥å‘çš„ï¼Œåº”é€€ç›¸åº”æ¬¾é¡¹ç»™æ”¯æŒè€…ã€‚</p>
                            <p>11.3é¡¹ç›®å›æŠ¥æœ‰è´¨é‡é—®é¢˜çš„ï¼Œå‚ç…§å›½å®¶ç›¸å…³æ³•è§„å¤„ç†(ä¾‹å¦‚:ã€Šæ¶ˆè´¹è€…æƒç›Šä¿æŠ¤æ³•ã€‹)ã€‚</p>
                            <p>
                                11.4å‘èµ·äººæ€ äºå¤„ç†çº çº·æˆ–å¤„ç†çº çº·ä¸ç¬¦åˆå°šç­¹ç½‘ç›¸å…³è§„å®šçš„ï¼Œå°šç­¹ç½‘ä¼—ç­¹å¹³å°æœ‰æƒåˆ©ç”¨é¢„ç•™çš„ä¿è¯é‡‘/è´¨ä¿é‡‘å¤„ç†æ”¯æŒè€…çº çº·ã€‚å¦‚ä¿è¯é‡‘ä¸è¶³ä»¥å¤„ç†çº çº·ï¼Œå‘èµ·äººæœ‰ä¹‰åŠ¡å‘å°šç­¹ç½‘æ”¯ä»˜å¤„ç†çº çº·æ‰€äº§ç”Ÿçš„è´¹ç”¨ã€‚</p>
                            <h5>ç¬¬12æ¡ è¿è§„å¤„ç†</h5>
                            <p>12.1å¯¹äºè¿åæœ¬åè®®æˆ–å°šç­¹ç½‘ç½‘ç«™è§„åˆ™çš„å‘èµ·äººï¼Œå°šç­¹ç½‘æœ‰æƒè¿›è¡Œè¿è§„å¤„ç†ï¼Œæ¶‰åŠçš„ç½šæ¬¾å¯ä»¥ä»ä¿è¯é‡‘/è´¨ä¿é‡‘ä¸­æ‰£é™¤ã€‚</p>
                            <p>12.2å¦‚å‘èµ·äººåœ¨ç­¹æ¬¾æ—¶é—´æˆªæ­¢å‰éå› ä¸å¯æŠ—åŠ›ä¸»åŠ¨å–æ¶ˆé¡¹ç›®çš„ï¼Œåˆ™å‘èµ·äººåœ¨ä¸€ä¸ªæœˆå†…ä¸å¾—å†æ¬¡å‘èµ·é¡¹ç›®ã€‚</p>
                            <p>
                                12.3å¦‚å‘èµ·äººåœ¨é¡¹ç›®ç­¹æ¬¾æˆåŠŸåã€å‘æ”¾å›æŠ¥å‰ï¼Œéå› ä¸å¯æŠ—åŠ›å®£å¸ƒé¡¹ç›®å¤±è´¥æˆ–å› é¡¹ç›®å»¶æœŸè€Œè¢«è®¤å®šä¸ºé¡¹ç›®å¤±è´¥çš„ï¼Œåˆ™å‘èµ·äººåœ¨ä¸‰ä¸ªæœˆå†…ä¸å¾—å†æ¬¡å‘èµ·é¡¹ç›®ï¼Œä½†å¦‚å‘èµ·äººå·²å°†æ”¯æŒè€…æ‰€æ”¯ä»˜çš„æ¬¾é¡¹å…¨é¢é€€å›çš„ï¼Œå†æ¬¡å‘èµ·é¡¹ç›®çš„æ—¶é—´å¯ä»¥ä¸å—é™åˆ¶ã€‚</p>
                            <p>12.4å°šç­¹ç½‘æœ‰æƒå¯¹å‘èµ·äººæ˜¯å¦æ¶‰å«Œè¿è§„åšå‡ºå•æ–¹è®¤å®šï¼Œå¹¶æ ¹æ®å•æ–¹è®¤å®šç»“æœä¸­æ­¢ã€ç»ˆæ­¢å¯¹å‘èµ·äººçš„å¹³å°ä½¿ç”¨è®¸å¯æˆ–é‡‡å–å…¶ä»–é™åˆ¶æªæ–½ã€‚</p>
                            <p>12.5å¦‚å‘èµ·äººä¸¥é‡è¿åæœ¬åè®®ã€å°šç­¹ç½‘ç½‘ç«™è§„åˆ™æˆ–è¿åå›½å®¶æ³•å¾‹æ³•è§„è§„å®šçš„ï¼Œå°†è¢«æ¸…é€€å‡ºå°šç­¹ç½‘ä¼—ç­¹å¹³å°ï¼Œæ¶‰å«ŒçŠ¯ç½ªçš„å°šç­¹ç½‘å°†ç§»é€å¸æ³•æœºå…³å¤„ç†ã€‚</p>
                            <h5>ç¬¬13æ¡ è¿çº¦è´£ä»»</h5>
                            <p>
                                13.1å¦‚å‘èµ·äººæ¶‰å«Œè¿åæœ‰å…³æ³•å¾‹æˆ–è€…æœ¬åè®®ä¹‹çº¦å®šï¼Œä½¿å°šç­¹ç½‘åŠ/æˆ–å°šç­¹ç½‘çš„å…³è”å…¬å¸é­å—ä»»ä½•æŸå¤±ï¼Œæˆ–å—åˆ°ä»»ä½•ç¬¬ä¸‰æ–¹çš„ç´¢èµ”ï¼Œæˆ–å—åˆ°ä»»ä½•è¡Œæ”¿ç®¡ç†éƒ¨é—¨çš„å¤„ç½šï¼Œå‘èµ·äººåº”å½“èµ”å¿å°šç­¹ç½‘å› æ­¤é­å—çš„æŸå¤±åŠ/æˆ–å‘ç”Ÿçš„è´¹ç”¨ï¼ŒåŒ…æ‹¬åˆç†çš„å¾‹å¸ˆè´¹ç”¨ã€è°ƒæŸ¥å–è¯è´¹ç”¨ç­‰ï¼Œç›¸å…³è´¹ç”¨å°šç­¹ç½‘æœ‰æƒä»ä¿è¯é‡‘/è´¨ä¿é‡‘ä¸­æ‰£é™¤ï¼Œä¸è¶³éƒ¨åˆ†ï¼Œç”±å‘èµ·äººå¦è¡Œæ”¯ä»˜è¡¥è¶³ã€‚</p>
                            <p>
                                13.2ä»»ä½•ä¸€æ–¹è¿åå…¶äºæœ¬åè®®é¡¹ä¸‹çš„é™ˆè¿°ã€ä¿è¯æˆ–æ‰¿è¯ºï¼Œè€Œä½¿å¦ä¸€æ–¹é­å—ä»»ä½•è¯‰è®¼ã€çº çº·ã€ç´¢èµ”ã€å¤„ç½šç­‰çš„ï¼Œè¿çº¦æ–¹åº”è´Ÿè´£è§£å†³ï¼Œä½¿å¦ä¸€æ–¹å‘ç”Ÿä»»ä½•è´¹ç”¨ã€é¢å¤–è´£ä»»æˆ–é­å—ç»æµæŸå¤±çš„ï¼Œåº”å½“è´Ÿè´£èµ”å¿ã€‚å¦‚ä¸€æ–¹å‘ç”Ÿè¿çº¦è¡Œä¸ºï¼Œå®ˆçº¦æ–¹å¯ä»¥ä¹¦é¢é€šçŸ¥æ–¹å¼è¦æ±‚è¿çº¦æ–¹åœ¨æŒ‡å®šçš„æ—¶é™å†…åœæ­¢è¿çº¦è¡Œä¸ºï¼Œè¦æ±‚å…¶æ¶ˆé™¤å½±å“ã€‚å¦‚è¿çº¦æ–¹æœªèƒ½æŒ‰æ—¶åœæ­¢è¿çº¦è¡Œä¸ºï¼Œåˆ™å®ˆçº¦æ–¹æœ‰æƒç«‹å³ç»ˆæ­¢æœ¬åè®®ã€‚å¦‚å› å°šç­¹ç½‘è‡ªèº«åŸå› é€ æˆå‘èµ·äººçš„æŸå¤±ï¼Œå°šç­¹ç½‘å‘å‘èµ·äººæ‰¿æ‹…çš„æœ€å¤§æ€»ä½“è´£ä»»å’Œèµ”å¿é™é¢ä¸åº”è¶…è¿‡åœ¨æœ¬åè®®é¡¹ä¸‹å°šç­¹ç½‘å·²å‘å‘èµ·äººæ”¶å–çš„æœåŠ¡è´¹æ€»é¢ã€‚</p>
                            <p>13.3å¯¹äºå‘èµ·äººåº”å½“æ‰¿æ‹…çš„è¿çº¦é‡‘ï¼Œå°šç­¹ç½‘æœ‰æƒä»ä¿è¯é‡‘/è´¨ä¿é‡‘ä¸­æ‰£é™¤ï¼Œä¸äºˆè¿”è¿˜ã€‚</p>
                            <h5>ç¬¬14æ¡ åè®®ç»ˆæ­¢åŠäº‰è®®è§£å†³</h5>
                            <p>14.1åœ¨ä¸‹åˆ—æƒ…å†µä¸‹ï¼Œå°šç­¹ç½‘å¯ä»¥éšæ—¶æ— é¡»æ‰¿æ‹…ä»»ä½•ä¹‰åŠ¡å’Œè´£ä»»åœ°å…¨éƒ¨æˆ–éƒ¨åˆ†æš‚åœã€ä¸­æ­¢æˆ–ç»ˆæ­¢å±¥è¡Œæœ¬åè®®çš„ä¹‰åŠ¡æˆ–æä¾›æœ¬åè®®é¡¹ä¸‹çš„æœåŠ¡ï¼Œç›´è‡³è§£é™¤æœ¬åè®®ï¼Œä¸”æ— é¡»å¾å¾—å‘èµ·äººçš„åŒæ„ï¼š</p>
                            <p>14.1.1å‘èµ·çš„é¡¹ç›®è¿åå°šç­¹ç½‘ä¼—ç­¹å¹³å°ä½¿ç”¨è§„åˆ™æˆ–æœ¬åè®®çº¦å®šæ¡æ¬¾ï¼›</p>
                            <p>14.1.2å‘èµ·äººä¸åŒæ„æ¥å—æœ¬åè®®çº¦å®šï¼ˆå«å°šç­¹ç½‘å‘å¸ƒçš„å„ç±»è§„åˆ™ï¼‰ï¼Œä¸”å·²åœæ­¢ä½¿ç”¨å°šç­¹ç½‘ä¼—ç­¹å¹³å°é’ˆå¯¹é¡¹ç›®å‘èµ·äººæä¾›çš„æœåŠ¡ï¼›</p>
                            <p>14.1.3å‘èµ·äººä¸ç¬¦åˆæœ¬åè®®çº¦å®šçš„é¡¹ç›®å‘èµ·äººåº”å…·å¤‡çš„èµ„æ ¼çš„ï¼›</p>
                            <p>14.1.4å‘èµ·çš„é¡¹ç›®è¿åæ³•å¾‹æ³•è§„ã€ç›‘ç®¡æ”¿ç­–æˆ–å…¶ä»–ç›¸å…³è§„å®šï¼›</p>
                            <p>14.1.5å‘èµ·çš„é¡¹ç›®å°†å¼•å‘æˆ–å¯èƒ½å¼•å‘å°šç­¹ç½‘è¿è¥çš„é‡å¤§é£é™©ï¼›</p>
                            <p>14.1.6å‘èµ·çš„é¡¹ç›®å­˜åœ¨æˆ–å¯èƒ½å­˜åœ¨æ˜æ˜¾å±å®³æ”¯æŒè€…åˆ©ç›Šçš„é£é™©ï¼›</p>
                            <p>14.1.7å› ä¸å¯å½’è´£äºå°šç­¹ç½‘çš„åŸå› é€ æˆé¡¹ç›®æ— æ³•ç»§ç»­è¿›è¡Œæˆ–é¡¹ç›®å›æŠ¥æ— æ³•å®ç°çš„ã€‚</p>
                            <p>14.2å› ä¸å¯å½’è´£äºå°šç­¹ç½‘çš„åŸå› é€ æˆåè®®ç»ˆæ­¢ï¼Œåœ¨åè®®ç»ˆæ­¢å‰çš„è¡Œä¸ºæ‰€å¯¼è‡´çš„ä»»ä½•èµ”å¿å’Œè´£ä»»ï¼Œå‘èµ·äººå¿…é¡»å®Œå…¨ä¸”ç‹¬ç«‹åœ°æ‰¿æ‹…è´£ä»»ã€‚</p>
                            <p>14.3æ— è®ºæœ¬åè®®å› ä½•ç§åŸå› ç»ˆæ­¢ï¼Œå¹¶ä¸å½±å“æœ¬åè®®ç»ˆæ­¢å‰å·²ç»ç­¹æ¬¾æˆåŠŸé¡¹ç›®çš„æ•ˆåŠ›ï¼Œå‘èµ·äººå‡åº”å°†ç­¹æ¬¾æˆåŠŸçš„é¡¹ç›®å±¥è¡Œå®Œæ¯•ï¼Œæˆ–ä¾ç…§çº¦å®šæˆ–æœ¬åè®®çš„è§„å®šå¯¹æ”¯æŒè€…æ‰¿æ‹…è´£ä»»ã€‚</p>
                            <p>14.4æœ¬åè®®åŠæœ¬åè®®é¡¹ä¸‹çš„æ‰€æœ‰è¡Œä¸ºå‡é€‚ç”¨ä¸­åäººæ°‘å…±å’Œå›½æ³•å¾‹ã€‚</p>
                            <p>14.5åè®®å„æ–¹å› æœ¬åè®®çš„ç­¾è®¢ã€å±¥è¡Œæˆ–è§£é‡Šå‘ç”Ÿäº‰è®®çš„ï¼Œå„æ–¹åº”å‹å¥½åå•†è§£å†³ã€‚å¦‚åå•†ä¸æˆï¼Œä»»ä½•ä¸€æ–¹å‡åº”å‘åˆåŒç­¾è®¢åœ°æ³•é™¢ï¼ˆå³ï¼šå—äº¬å¸‚ç„æ­¦åŒºäººæ°‘æ³•é™¢ï¼‰æèµ·è¯‰è®¼ã€‚</p>
                            <p>14.6æœ¬åè®®çš„è§£é‡Šæƒå½’å°šç­¹ç½‘ä¼—ç­¹å¹³å°æ‰€æœ‰ã€‚</p>
                            <p>
                                <b>é™„ä»¶ï¼š</b>
                            </p>
                            <h5>ã€Šå°šç­¹ç½‘ä¼—ç­¹å›æŠ¥æœåŠ¡åè®®ã€‹</h5>
                            <h5>ï¼ˆæ³¨ï¼šæœ¬åè®®åªé€‚ç”¨äºå°šç­¹ç½‘ä¼—ç­¹å¹³å°å‘å¸ƒçš„ç§‘æŠ€ã€è®¾è®¡ç±»ä¼—ç­¹ï¼‰</h5>
                            <p>é‰´äºï¼š</p>
                            <p>
                                å‘èµ·äººåœ¨éš¶å±äºå°šç­¹ç½‘ï¼ˆwww.atcrowd.comï¼‰ç½‘ç«™æ——ä¸‹å°šç­¹ç½‘ä¼—ç­¹å¹³å°ï¼ˆä»¥ä¸‹ç®€ç§°â€œå°šç­¹ç½‘â€ï¼‰ä¸Šå‘èµ·é¡¹ç›®ç­¹æ¬¾éœ€æ±‚ï¼Œå¹¶æ‰¿è¯ºç»™é¡¹ç›®æ”¯æŒè€…æä¾›å›æŠ¥ã€‚ä¸ºä¿æŠ¤æ”¯æŒè€…çš„åˆæ³•æƒç›Šï¼Œè§„èŒƒå‘èµ·äººçš„è¡Œä¸ºï¼Œç»´æŠ¤ä¼—ç­¹å¹³å°ç§©åºï¼Œç‰¹æ‹Ÿå®šæœ¬åè®®ã€‚å‘èµ·äººæ‰¿è¯ºä¸¥æ ¼å±¥è¡Œæœ¬åè®®çº¦å®šï¼ŒæŒ‰ç…§é¡¹ç›®æ‰¿è¯ºä¸ºå®¢æˆ·æä¾›å›æŠ¥åŠç›¸å…³æœåŠ¡ã€‚</p>
                            <h5>1ã€ å›æŠ¥äº§å“çš„é€€æ¢æœåŠ¡</h5>
                            <p>
                                1.1å‘èµ·äººæ‰¿è¯ºè‡ªæ”¯æŒè€…æ”¶åˆ°å›æŠ¥äº§å“çš„15å¤©å†…æä¾›æ— ç†ç”±é€€æ¢è´§æœåŠ¡ï¼Œé€€æ¢è´§è¿‡ç¨‹ä¸­äº§ç”Ÿçš„å¿«é€’è´¹ç”¨ï¼Œç”±å‘èµ·äººæ‰¿æ‹…ã€‚å¦‚æ”¯æŒè€…é€‰æ‹©é€€è´§çš„ï¼Œå‘èµ·äººåº”äºæ”¶åˆ°é€€å›è´§ç‰©ä¹‹æ—¥èµ·3ä¸ªå·¥ä½œæ—¥å†…ä¸ºæ”¯æŒè€…å…¨é¢é€€æ¬¾ã€‚å¦‚æ”¯æŒè€…é€‰æ‹©æ¢è´§çš„ï¼Œå‘èµ·äººåº”äºæ”¶åˆ°æ›´æ¢è´§ç‰©ä¹‹æ—¥èµ·5ä¸ªå·¥ä½œæ—¥å†…å®Œæˆæ¢è´§å¤„ç†ã€‚</p>
                            <p>
                                1.2å‘èµ·äººæ‰¿è¯ºè‡ªæ”¯æŒè€…æ”¶åˆ°å›æŠ¥äº§å“çš„ç¬¬16å¤©è‡³1å¹´å†…ï¼Œæä¾›å…è´¹ç»´ä¿®æˆ–æ¢æ–°æœåŠ¡ã€‚å¦‚å›æŠ¥äº§å“å‡ºç°è´¨é‡é—®é¢˜æˆ–å› éäººä¸ºåŸå› æ— æ³•æ­£å¸¸ä½¿ç”¨ï¼Œå‘èµ·äººåº”åœ¨æ”¶åˆ°æ”¯æŒè€…æ‰€æ›´æ¢è´§ç‰©ä¹‹æ—¥èµ·5ä¸ªå·¥ä½œæ—¥å†…å®Œæˆæ¢è´§å¤„ç†ã€‚è´§ç‰©æ›´æ¢è¿‡ç¨‹ä¸­äº§ç”Ÿçš„å¿«é€’è´¹ç”¨ï¼Œç”±å‘èµ·äººæ‰¿æ‹…ã€‚</p>
                            <p>1.3ä»¥ä¸‹äº§å“ä¸é€‚ç”¨äºæ— ç†ç”±é€€æ¢è´§:</p>
                            <p class="indent">1.3.1 ä¸ªäººå®šåšç±»äº§å“ï¼›</p>
                            <p class="indent">1.3.2 æ–‡åŒ–ç±»äº§å“ï¼›</p>
                            <p class="indent">1.3.3 åœ¨çº¿ä¸‹è½½æˆ–è€…å·²ç»æ‹†å°çš„éŸ³åƒåˆ¶å“ï¼Œè®¡ç®—æœºè½¯ä»¶ç­‰æ•°å­—åŒ–å•†å“ï¼›</p>
                            <p class="indent">1.3.4 äº¤ä»˜çš„æŠ¥çº¸æœŸåˆŠç±»å•†å“ï¼›</p>
                            <p class="indent">1.3.5
                                æœªç»æˆæƒçš„ç»´ä¿®ã€è¯¯ç”¨ã€ç¢°æ’ã€ç–å¿½ã€æ»¥ç”¨ã€è¿›æ¶²ã€äº‹æ•…ã€æ”¹åŠ¨ã€ä¸æ­£ç¡®çš„å®‰è£…æ‰€é€ æˆçš„äº§å“è´¨é‡é—®é¢˜ï¼Œæˆ–æ’•æ¯ã€æ¶‚æ”¹æ ‡è´´ã€æœºå™¨åºå·ã€é˜²ä¼ªæ ‡è®°ï¼›</p>
                            <p class="indent">1.3.6å…¶ä»–æ ¹æ®äº§å“æ€§è´¨ä¸é€‚å®œé€€æ¢è´§ï¼Œæˆ–åœ¨ä¼—ç­¹é¡¹ç›®å‘èµ·æ—¶å·²ç»æ˜ç¡®è¡¨ç¤ºä¸é€‚ç”¨é€€æ¢è´§çš„äº§å“ã€‚</p>

                            <p>1.4ä¸ºä¿è¯äº§å“åœ¨<strong><u>1å¹´ä¿ä¿®æœŸ</u></strong>å†…çš„å”®åæœåŠ¡è´¨é‡ï¼Œå‘èµ·äººé¡»å‘å°šç­¹ç½‘ç¼´çº³è´¨é‡ä¿è¯é‡‘ï¼ˆç®€ç§°â€œè´¨ä¿é‡‘â€ï¼‰ï¼Œä½œä¸ºå°šç­¹ç½‘å¤„ç†å®¢æˆ·æŠ•è¯‰æˆ–äº§å“è´¨é‡é—®é¢˜ç”¨ï¼š
                            </p>
                            <p> è‹¥å‘èµ·äººä¸ºå°šç­¹ç½‘ï¼ˆæˆ–å°šç­¹ç½‘å…³è”å…¬å¸ï¼‰å·²æœ‰åˆä½œæ–¹çš„ï¼Œä¸å·²æœ‰åˆä½œä¸šåŠ¡å…³è”ï¼Œä»¥å°šç­¹ç½‘ï¼ˆæˆ–å°šç­¹ç½‘å…³è”å…¬å¸ï¼‰å¯¹å‘èµ·äººçš„åº”ä»˜è´¦æ¬¾ä½œä¸ºè´¨æŠ¼ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºè´§æ¬¾ã€ä¿è¯é‡‘ç­‰ã€‚
                            </p>
                            <p>è‹¥å‘èµ·äººéå°šç­¹ç½‘ï¼ˆæˆ–å°šç­¹ç½‘å…³è”å…¬å¸ï¼‰å·²æœ‰åˆä½œæ–¹çš„ï¼Œåœ¨é¡¹ç›®ç­¹æ¬¾æˆåŠŸåï¼Œå°šç­¹ç½‘ä»é¡¹ç›®æ‰€ç­¹å¾—æ¬¾é¡¹ä¸­è‡ªåŠ¨æ‰£å–ä¸‹è¿°çº¦å®šé‡‘é¢ä½œä¸ºè´¨é‡ä¿è¯é‡‘ï¼Œè‡ªæ‰€æœ‰æ”¯æŒè€…æ”¶åˆ°å›æŠ¥äº§å“<strong><u>
                                1å¹´</u></strong>ä»¥åï¼Œä¸”å‘èµ·äººå·²ç»å¦¥å–„å¤„ç†æ‰€æœ‰å®¢æˆ·æŠ•è¯‰åï¼Œå°šç­¹ç½‘å°†æ­¤è´¨ä¿é‡‘è¿”è¿˜å‘èµ·äººï¼Œå…·ä½“é‡‘é¢è¦æ±‚å¦‚ä¸‹ï¼š</p>
                            <table class="table-initiate">
                                <tbody>
                                <tr>
                                    <th align="center"><strong>ä¼—ç­¹é¡¹ç›®åˆ†ç±» </strong></th>
                                    <th align="center"><strong>è´¨ä¿é‡‘ </strong></th>
                                    <th align="center"><strong>è´¨ä¿é‡‘ä¸Šä¸‹é™ </strong></th>
                                </tr>
                                <tr>
                                    <td>æ‰‹æœºã€ç”µè„‘ã€æ•°ç ã€åŠå…¬è®¾å¤‡ã€ç½‘ç»œè®¾å¤‡ã€æ™ºèƒ½è®¾å¤‡ç­‰</td>
                                    <td rowspan="2">æ‰€ç­¹é‡‘é¢Ã—2.5%</td>
                                    <td rowspan="9">ä¸‹é™ï¼š1000å…ƒ<br>
                                        ä¸Šé™ï¼š10ä¸‡å…ƒ<br>
                                        ï¼ˆå³ï¼šæœ€ä½æ”¶å–1000å…ƒï¼Œæœ€é«˜æ”¶å–10ä¸‡å…ƒï¼‰
                                    </td>
                                </tr>
                                <tr>
                                    <td>å­•å©´ç”¨å“ã€å„¿ç«¥ç”¨å“ï¼ˆç«¥è£…ã€ç«¥é‹ã€ç©å…·ï¼‰ç­‰</td>
                                </tr>
                                <tr>
                                    <td>ç©ºè°ƒã€ç”µè§†ã€å†°ç®±ã€æ´—è¡£æœºã€å½±éŸ³äº§å“ç­‰</td>
                                    <td rowspan="4">æ‰€ç­¹é‡‘é¢Ã—2%</td>
                                </tr>
                                <tr>
                                    <td>å¨å«å¤§å®¶ç”µã€å¨æˆ¿å°å®¶ç”µã€è¥¿å¼å¨æˆ¿ç”µå™¨ã€ç”Ÿæ´»å°å®¶ç”µã€ä¸ªäººæŠ¤ç†ç­‰</td>
                                </tr>
                                <tr>
                                    <td>æˆ·å¤–è£…å¤‡ã€ä½“è‚²å™¨æã€éª‘è¡Œè£…å¤‡ã€å¥èº«å™¨æã€å‚é’“ç”¨å“ã€è½¦è½½ç”µå™¨ã€æ±½è½¦é…ä»¶ç­‰</td>
                                </tr>
                                <tr>
                                    <td>å®¶çººã€å®¶å…·ã€ç¯å…·ã€å»ºæã€å¨æˆ¿å«æµ´ç”¨å“ã€æ¸…æ´ç”¨å“ã€é¤å¨ç”¨å…·ã€ç”Ÿæ´»æ—¥ç”¨ã€æˆäººç”¨å“ã€å® ç‰©ç”¨å“ç­‰</td>
                                </tr>
                                <tr>
                                    <td>æ—¥åŒ–ç”¨å“ï¼ˆç¾å¦†ã€æŠ¤è‚¤ã€æ´—æŠ¤ç”¨å“ï¼‰ç­‰</td>
                                    <td rowspan="3">æ‰€ç­¹é‡‘é¢Ã—1%</td>
                                </tr>
                                <tr>
                                    <td>å›¾ä¹¦ã€æ–‡åŒ–ç”¨å“ç±»</td>
                                </tr>
                                <tr>
                                    <td>å…¶å®ƒ</td>
                                </tr>
                                </tbody>
                            </table>
                            <h5>2ã€ å»¶è¿Ÿå›æŠ¥ï¼ˆå‘è´§ï¼‰è¡¥å¿</h5>
                            <p>
                                ä¼—ç­¹é¡¹ç›®æˆåŠŸåï¼Œå‘èµ·äººåº”ç¡®ä¿æŒ‰ç…§é¡¹ç›®æ‰¿è¯ºåŠæ—¶ä¸ºæ”¯æŒè€…æä¾›å›æŠ¥ã€‚å¦‚å‡ºç°å›æŠ¥å»¶è¿Ÿæˆ–æœªåŠæ—¶å‘è´§çš„æƒ…å†µï¼Œå‘èµ·äººåº”æŒ‰ç…§ä»¥ä¸‹æ ‡å‡†å¯¹æ”¯æŒè€…è¿›è¡Œè¡¥å¿ã€‚é™¤é¡¹ç›®å¤±è´¥é€ æˆçš„å…¨é¢é€€æ¬¾çš„æƒ…å½¢å¤–ï¼Œå…¶ä½™æƒ…å†µçš„è¡¥å¿é‡‘æ”¯ä»˜æ—¶é—´ä¸å¾—æ™šäºæ”¯æŒè€…æ”¶åˆ°è´§ç‰©çš„æ—¶é—´ã€‚</p>
                            <p>
                            </p>
                            <table class="table-initiate">
                                <tbody>
                                <tr>
                                    <th>å»¶è¿Ÿå‘è´§å¤©æ•°ï¼ˆå•ä½ï¼šæ—¥ï¼‰</th>
                                    <th>å»¶è¿Ÿäº¤ä»˜è¿çº¦é‡‘/å…¶ä»–å¤„ç†æªæ–½</th>
                                </tr>
                                <tr>
                                    <td>Xâ‰¤30</td>
                                    <td>è¿çº¦é‡‘ä¸ºï¼šæœªå±¥è¡Œè®¢å•æ€»é‡‘é¢çš„5%</td>
                                </tr>
                                <tr>
                                    <td>X&gt;30</td>
                                    <td>é¡¹ç›®å¤±è´¥ï¼ŒæŒ‰ç…§å·²å±¥è¡Œè®¢å•æ€»é‡‘é¢çš„5%æ”¯ä»˜è¿çº¦é‡‘ï¼Œå¹¶å…¨é¢é€€è¿˜æœªå±¥è¡Œè®¢å•çš„ä¼—ç­¹æ¬¾ç»™æ”¯æŒè€…ï¼Œæœªå±¥è¡Œè®¢å•å–æ¶ˆ</td>
                                </tr>
                                </tbody>
                            </table>
                            <p></p>
                            <p>
                                Xä¸ºå»¶è¿Ÿå‘è´§å¤©æ•°ï¼Œè‡ªæ‰¿è¯ºå›æŠ¥æœŸé™çš„æœ€åä¸€å¤©çš„æ¬¡æ—¥èµ·ç®—ã€‚å¦‚å»¶è¿Ÿå¤©æ•°è¾¾åˆ°30æ—¥ï¼Œå³è§†ä¸ºå‘èµ·äººå·²ç»æ— æ³•æä¾›å›æŠ¥ï¼Œé¡¹ç›®å¤±è´¥ï¼Œå‘èµ·äººåº”å‘æ‰€æœ‰æ”¯æŒè€…å‘è¡¨è‡´æ­‰å£°æ˜æˆ–é˜è¿°è¯´æ˜ï¼Œå¹¶åœ¨3æ—¥å†…å®Œæˆæœªå±¥è¡Œè®¢å•çš„é€€æ¬¾ã€‚è‹¥å‘èµ·äººåœ¨å»¶è¿Ÿå¤©æ•°æœªæ»¡30å¤©æ—¶ï¼Œä¸æ”¯æŒè€…è¾¾æˆä¸€è‡´ï¼Œå¹¶å¦è¡Œçº¦å®šå‘è´§æ—¶é—´çš„é™¤å¤–ã€‚</p>
                            <h5>3ã€ æœåŠ¡å“åº”æ—¶æ•ˆ</h5>
                            <p>
                                åœ¨é¡¹ç›®å›æŠ¥è¿‡ç¨‹ä¸­ï¼Œå‘èµ·äººåº”ç§¯æå“åº”æ”¯æŒè€…ã€å°šç­¹ç½‘æˆ–å°šç­¹ç½‘ä¼—ç­¹å¹³å°æå‡ºçš„å„é¡¹é—®é¢˜å’Œéœ€æ±‚ã€‚å¯¹äºæé—®é‚®ä»¶æˆ–å„é¡¹éœ€æ±‚é‚®ä»¶ï¼Œåº”äº2ä¸ªå·¥ä½œæ—¥å†…å›å¤å¤„ç†æ„è§æˆ–å¯¹ç”³è¯·è¿›è¡Œå¤„ç†ã€‚å¦‚å‘èµ·äººæœªæŒ‰ä»¥ä¸Šè§„å®šæ—¶é—´å›å¤æ„è§æˆ–è¿›è¡Œç›¸åº”å¤„ç†ï¼Œå°šç­¹ç½‘æˆ–å°šç­¹ç½‘ä¼—ç­¹å¹³å°å‡æœ‰æƒä»å®¢æˆ·ä¸ºå…ˆç†å¿µè§’åº¦ä»£å‘èµ·äººå›å¤æˆ–å¤„ç†ï¼Œå‘èµ·äººåº”æŒ‰ç…§å°šç­¹ç½‘æˆ–å°šç­¹ç½‘ä¼—ç­¹å¹³å°çš„å¤„ç†æ„è§ä¸ºå®¢æˆ·æä¾›ç›¸å…³æœåŠ¡ï¼Œå› æ­¤é€ æˆçš„æŸå¤±æˆ–äº§ç”Ÿçš„è´¹ç”¨ç”±å‘èµ·äººæ‰¿æ‹…ã€‚</p>
                            <h5>4ã€ è¿çº¦è´£ä»»</h5>
                            <p>
                                4.1å¦‚å‘èµ·äººæ¶‰å«Œè¿åæœ‰å…³æ³•å¾‹æˆ–è€…æœ¬åè®®ä¹‹çº¦å®šï¼Œä½¿å°šç­¹ç½‘æˆ–å°šç­¹ç½‘ä¼—ç­¹å¹³å°é­å—ä»»ä½•æŸå¤±åŒ…æ‹¬ä½†ä¸é™äºï¼Œå—åˆ°ä»»ä½•ç¬¬ä¸‰æ–¹çš„è¯‰è®¼ã€çº çº·ã€ç´¢èµ”ï¼Œå—åˆ°ä»»ä½•è¡Œæ”¿ç®¡ç†éƒ¨é—¨çš„å¤„ç½šï¼Œå‘èµ·äººåº”å½“èµ”å¿å°šç­¹ç½‘æˆ–å°šç­¹ç½‘ä¼—ç­¹å¹³å°å› æ­¤é­å—çš„æŸå¤±åŠ/æˆ–å‘ç”Ÿçš„è´¹ç”¨ï¼ŒåŒ…æ‹¬åˆç†çš„å¾‹å¸ˆè´¹ç”¨ã€è°ƒæŸ¥å–è¯è´¹ç”¨ç­‰ã€‚</p>
                            <p>4.2å¯¹äºå‘èµ·äººåº”å½“æ‰¿æ‹…çš„è¿çº¦é‡‘ï¼Œå°šç­¹ç½‘æˆ–å°šç­¹ç½‘ä¼—ç­¹å¹³å°æœ‰æƒä»å‘èµ·äººçš„ä¿è¯é‡‘åŠè´¨ä¿é‡‘æˆ–å…¶ä»–ç”±å°šç­¹ç½‘æˆ–å°šç­¹ç½‘ä¼—ç­¹å¹³å°æ§åˆ¶çš„æ¬¾é¡¹ä¸­ç›´æ¥æŠµæ‰£ï¼Œä¸äºˆè¿”è¿˜ã€‚<b>ä¿è¯é‡‘åŠè´¨ä¿é‡‘ä¸è¶³ä»¥æ”¯ä»˜çš„ï¼Œå°šç­¹ç½‘æˆ–å°šç­¹ç½‘ä¼—ç­¹å¹³å°å‡æœ‰æƒç»§ç»­å‘å‘èµ·äººè¿½å¿ã€‚</b>
                            </p>
                            <h5>5ã€ å…¶ä»–</h5>
                            <p>
                                5.1å‘èµ·äººåŒæ„éµå®ˆå°šç­¹ç½‘ç½‘ç«™ï¼ˆwww.atcrowd.comï¼‰åŠå…¶æ——ä¸‹ä»»ä½•ç½‘ç«™å·²ç»å‘å¸ƒçš„æˆ–å°†æ¥å¯èƒ½å‘å¸ƒçš„å„ç±»è§„åˆ™ã€æ“ä½œæµç¨‹ã€‚å¯¹è¿åçº¦å®šæˆ–è§„å®šç»™å®¢æˆ·é€ æˆæŸå¤±çš„ï¼Œå‘èµ·äººæ„¿æ„æ¥å—å°šç­¹ç½‘æˆ–å°šç­¹ç½‘ä¼—ç­¹å¹³å°çš„å„é¡¹å¤„ç½šã€‚</p>
                            <p>5.2å‡¡å› æœ¬åè®®å¼•èµ·çš„æˆ–ä¸æœ¬åè®®æœ‰å…³çš„ä»»ä½•äº‰è®®ï¼Œç”±åŒæ–¹å‹å¥½åå•†è§£å†³ã€‚åå•†ä¸æˆæ—¶ï¼Œä»»ä½•ä¸€æ–¹å‡åº”å‘åˆåŒç­¾è®¢åœ°æ³•é™¢ï¼ˆå³ï¼šå—äº¬å¸‚ç„æ­¦åŒºäººæ°‘æ³•é™¢ï¼‰æèµ·è¯‰è®¼ã€‚</p>
                        </div>
                    </div>
                    <div class="panel-footer" style="text-align:center;">
                        <script type="text/javascript">
                            $(function () {
                                $("#toLaunchPage").click(function () {
                                    window.location.href = '[[${session.zuulPath}]]/project/launch/protocol/page';
                                })
                            })
                        </script>
                        <button type="button" class="btn  btn-warning btn-lg"
                                id="toLaunchPage">é˜…è¯»å¹¶åŒæ„åè®®
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <div class="container" style="margin-top:20px;">
        <div class="row clearfix">
            <div class="col-md-12 column">
                <div id="footer">
                    <div class="footerNav">
                        <a rel="nofollow" href="http://www.layoutit.cn">å…³äºæˆ‘ä»¬</a> | <a rel="nofollow"
                                                                                      href="http://www.layoutit.cn">æœåŠ¡æ¡æ¬¾</a>
                        | <a rel="nofollow" href="http://www.layoutit.cn">å…è´£å£°æ˜</a> | <a rel="nofollow"
                                                                                        href="http://www.layoutit.cn">ç½‘ç«™åœ°å›¾</a>
                        | <a rel="nofollow" href="http://www.layoutit.cn">è”ç³»æˆ‘ä»¬</a>
                    </div>
                    <div class="copyRight">
                        Copyright ?2017-2017layoutit.cn ç‰ˆæƒæ‰€æœ‰
                    </div>
                </div>

            </div>
        </div>
    </div>

</div> <!-- /container -->

</body>
</html>
```



#### 2.3.7 æ–°å»º `project-launch.html`ã€`project` å·¥ç¨‹ã€‘

```html
<!DOCTYPE html>
<html lang="zh-CN" xmlns:th="https://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <base th:href="@{/}">
    <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <link rel="stylesheet" href="css/theme.css">
    <script src="jquery/jquery-2.1.1.min.js"></script>
    <script src="bootstrap/js/bootstrap.min.js"></script>
    <script src="script/docs.min.js"></script>
    <script src="script/back-to-top.js"></script>
    <script type="text/javascript" src="layer/layer.js"></script>
    <script>
        function checkExitsts(arr, id) {
            for (var i = 0; i < arr.length; i++) {
                if (arr[i] === id) {
                    // ä»æ•°ç»„ä¸­åˆ é™¤å…ƒç´ , iæ˜¯å…ƒç´ ç´¢å¼•, 1æ˜¯åˆ é™¤æ•°é‡
                    arr.splice(i, 1)
                    return;
                }
            }

            // å°†å½“å‰æ ‡ç­¾çš„ id åŠ å…¥å¤§æˆ·ç»„
            arr.push(id);
        }

        // å£°æ˜å…¨å±€å˜é‡ç”¨äºå­˜å‚¨é€‰ä¸­çš„æ ‡ç­¾çš„ id
        var tagIdList = [];

        $(function () {
            var message = "[[${message}]]";
            if (message !== "") {
                layer.msg(message);
            }

            $('#myTab a').click(function (e) {
                e.preventDefault()
                $(this).tab('show')
            })

            $(".tagLable").click(function () {
                // æ ‡ç­¾æ–‡æœ¬æ˜¾ç¤ºæ¡†å¦‚æœæœ‰ selected å°±å»æ‰, å¦‚æœæ²¡æœ‰å°±åŠ ä¸Š
                $(this).toggleClass("selected");

                // è·å–å½“å‰æ–‡æœ¬æ˜¾ç¤ºæ¡†çš„ id ï¼ˆä¹Ÿå°±æ˜¯æ ‡ç­¾çš„ idï¼‰
                var tagId = this.id;

                // åˆ¤å®š tagId æ˜¯å¦åœ¨æ•°ç»„ä¸­, å¦‚æœåœ¨åˆ™åˆ é™¤, å¦‚æœä¸åœ¨åˆ™æ·»åŠ 
                checkExitsts(tagIdList, tagId);
            })

            // ä¸Šä¼ å›¾ç‰‡æŒ‰é’® è§¦å‘ æ–‡ä»¶é€‰æ‹©æ¡†
            $("#uploadHeadBtn").click(function () {
                // è°ƒç”¨  click() å‡½æ•°, ç›¸å½“äºè¢«å•å‡»äº†ä¸€ä¸‹
                $("[name=headerPicture]").click();
            })

            // ã€é¡¹ç›®å¤´å›¾ã€‘æ–‡ä»¶é€‰æ‹©æ¡†, åªé€‰æ‹©å¤´ä¸€ä¸ªæ–‡ä»¶
            $("[name=headerPicture]").change(function (event) {
                // è·å–ç”¨æˆ·é€‰ä¸­çš„æ–‡ä»¶
                var files = event.target.files;

                // è·å–å°æ ‡ 0, é€‰æ‹©å”¯ä¸€çš„ä¸€ä¸ªæ–‡ä»¶
                var file = files[0];

                // è·å– URL å¯¹è±¡
                var url = window.url || window.webkitURL;

                // è°ƒç”¨ url å¯¹è±¡é¢ createObjectURL() æ–¹æ³•è·å–å½“é€‰ä¸­çš„æ–‡ä»¶åœ¨ç³»ç»Ÿçš„è·¯å¾„
                var path = url.createObjectURL(file);

                // ä½¿ç”¨ path ä¿®æ”¹ img æ ‡ç­¾çš„ src å±æ€§
                $(this).next().next().next().next().attr("src", path).show();
            })

            //ã€é¡¹ç›®è¯¦æƒ…ã€‘ ç‚¹å‡»ä¸Šä¼ è¯¦æƒ…æŒ‰é’® è§¦å‘ æ–‡ä»¶é€‰æ‹©æ¡†
            $("#uploadDetailBtn").click(function () {
                $("[name=detailPictureList]").click();
            })

            // æ–‡ä»¶é€‰æ‹©æ¡†, å¯ä»¥é€‰æ‹©å¤šä¸ªæ–‡ä»¶
            $("[name=detailPictureList]").change(function (event) {
                $("#showDetailPicture").empty();

                // è·å–ç”¨æˆ·é€‰ä¸­çš„æ–‡ä»¶
                var files = event.target.files;

                // è·å– URL å¯¹è±¡
                var url = window.url || window.webkitURL;

                for (var i = 0; i < files.length; i++) {
                    var file = files[i];

                    var path = url.createObjectURL(file);

                    var imgHtml = "<img src='" + path + "' /><br/>";

                    $("#showDetailPicture").append(imgHtml);
                }
            })

            // ç‚¹å‡»ä¸‹ä¸€æ­¥æŒ‰é’®æäº¤è¡¨å•
            $("#submitBtn").click(function () {
                // å°†è¡¨å•ä¸­æ ‡ç­¾ id çš„å€¼ç»„æˆçš„æ•°ç»„è½¬æ¢æˆè¡¨å•å†…çš„éšè—åŸŸ
                for (var i = 0; i < tagIdList.length; i++) {
                    var tagId = tagIdList[i];

                    var hiddenInputHTML = "<input type='hidden' name='tagIdList' value='" + tagId + "'/>";

                    $("#projectForm").append(hiddenInputHTML);
                }

                // æäº¤è¡¨å•
                $("#projectForm").submit();
            })
        })
    </script>
    <style>
        .selected {
            color: yellow;
            background-color: green;
        }

        #footer {
            padding: 15px 0;
            background: #fff;
            border-top: 1px solid #ddd;
            text-align: center;
        }

        #topcontrol {
            color: #fff;
            z-index: 99;
            width: 30px;
            height: 30px;
            font-size: 20px;
            background: #222;
            position: relative;
            right: 14px !important;
            bottom: 11px !important;
            border-radius: 3px !important;
        }

        #topcontrol:after {
            /*top: -2px;*/
            left: 8.5px;
            content: "\f106";
            position: absolute;
            text-align: center;
            font-family: FontAwesome;
        }

        #topcontrol:hover {
            color: #fff;
            background: #18ba9b;
            -webkit-transition: all 0.3s ease-in-out;
            -moz-transition: all 0.3s ease-in-out;
            -o-transition: all 0.3s ease-in-out;
            transition: all 0.3s ease-in-out;
        }

        .label-type, .label-status, .label-order {
            background-color: #fff;
            color: #f60;
            padding: 5px;
            border: 1px #f60 solid;
        }

        #typeList :not(:first-child) {
            margin-top: 20px;
        }

        .label-txt {
            margin: 10px 10px;
            border: 1px solid #ddd;
            padding: 4px;
            font-size: 14px;
        }

        .panel {
            border-radius: 0;
        }

        .progress-bar-default {
            background-color: #ddd;
        }
    </style>
</head>
<body>
<div class="navbar-wrapper">
    <div class="container">
        <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand" href="index.html" style="font-size: 32px;">å°šç­¹ç½‘-åˆ›æ„äº§å“ä¼—ç­¹å¹³å°</a>
                </div>
                <div id="navbar" class="navbar-collapse collapse"
                     style="float: right;">
                    <ul class="nav navbar-nav">
                        <li class="dropdown"><a href="#" class="dropdown-toggle"
                                                data-toggle="dropdown"><i class="glyphicon glyphicon-user"></i>
                            [[${session.loginMember.username}]]<span class="caret"></span></a>
                            <ul class="dropdown-menu" role="menu">
                                <li><a href="member.html"><i
                                        class="glyphicon glyphicon-scale"></i> ä¼šå‘˜ä¸­å¿ƒ</a></li>
                                <li><a href="#"><i class="glyphicon glyphicon-comment"></i>
                                    æ¶ˆæ¯</a></li>
                                <li class="divider"></li>
                                <li><a th:href="@{/auth/member/logout}"><i
                                        class="glyphicon glyphicon-off"></i> é€€å‡ºç³»ç»Ÿ</a></li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    </div>
</div>

<div class="container theme-showcase" role="main">

    <div class="container">
        <div class="row clearfix">
            <div class="col-md-12 column">
                <nav class="navbar navbar-default" role="navigation">
                    <div class="collapse navbar-collapse"
                         id="bs-example-navbar-collapse-1">
                        <ul class="nav navbar-nav">
                            <li><a rel="nofollow" href="index.html"><i
                                    class="glyphicon glyphicon-home"></i> ä¼—ç­¹é¦–é¡µ</a></li>
                            <li><a rel="nofollow" href="projects.html"><i
                                    class="glyphicon glyphicon-th-large"></i> é¡¹ç›®æ€»è§ˆ</a></li>
                            <li class="active"><a rel="nofollow" href="javascript:;"><i
                                    class="glyphicon glyphicon-edit"></i> å‘èµ·é¡¹ç›®</a></li>
                            <li><a rel="nofollow" href="minecrowdfunding.html"><i
                                    class="glyphicon glyphicon-user"></i> æˆ‘çš„ä¼—ç­¹</a></li>
                        </ul>
                    </div>
                </nav>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="row clearfix">
            <div class="col-md-12 column">
                <form id="projectForm" th:action="@{/project/create/project/information}" method="post"
                      enctype="multipart/form-data" class="form-horizontal">
                    <p th:text="${message}"></p>
                    <div class="panel panel-default">
                        <div class="panel-heading" style="text-align: center;">
                            <div class="container-fluid">
                                <div class="row clearfix">
                                    <div class="col-md-3 column">
                                        <div class="progress"
                                             style="height: 50px; border-radius: 0; position: absolute; width: 75%; right: 49px;">
                                            <div class="progress-bar progress-bar-success"
                                                 role="progressbar" aria-valuenow="60" aria-valuemin="0"
                                                 aria-valuemax="100" style="width: 100%; height: 50px;">
                                                <div style="font-size: 16px; margin-top: 15px;">1.
                                                    é¡¹ç›®åŠå‘èµ·äººä¿¡æ¯
                                                </div>
                                            </div>
                                        </div>
                                        <div
                                                style="right: 0; border: 10px solid #ddd; border-left-color: #88b7d5; border-width: 25px; position: absolute; border-left-color: rgba(92, 184, 92, 1); border-top-color: rgba(92, 184, 92, 0); border-bottom-color: rgba(92, 184, 92, 0); border-right-color: rgba(92, 184, 92, 0);">
                                        </div>
                                    </div>
                                    <div class="col-md-3 column">
                                        <div class="progress"
                                             style="height: 50px; border-radius: 0; position: absolute; width: 75%; right: 49px;">
                                            <div class="progress-bar progress-bar-default"
                                                 role="progressbar" aria-valuenow="60" aria-valuemin="0"
                                                 aria-valuemax="100" style="width: 100%; height: 50px;">
                                                <div style="font-size: 16px; margin-top: 15px;">2.
                                                    å›æŠ¥è®¾ç½®
                                                </div>
                                            </div>
                                        </div>
                                        <div
                                                style="right: 0; border: 10px solid #ddd; border-left-color: #88b7d5; border-width: 25px; position: absolute; border-left-color: rgba(221, 221, 221, 1); border-top-color: rgba(221, 221, 221, 0); border-bottom-color: rgba(221, 221, 221, 0); border-right-color: rgba(221, 221, 221, 0);">
                                        </div>
                                    </div>
                                    <div class="col-md-3 column">
                                        <div class="progress"
                                             style="height: 50px; border-radius: 0; position: absolute; width: 75%; right: 49px;">
                                            <div class="progress-bar progress-bar-default"
                                                 role="progressbar" aria-valuenow="60" aria-valuemin="0"
                                                 aria-valuemax="100" style="width: 100%; height: 50px;">
                                                <div style="font-size: 16px; margin-top: 15px;">3.
                                                    ç¡®è®¤ä¿¡æ¯
                                                </div>
                                            </div>
                                        </div>
                                        <div
                                                style="right: 0; border: 10px solid #ddd; border-left-color: #88b7d5; border-width: 25px; position: absolute; border-left-color: rgba(221, 221, 221, 1); border-top-color: rgba(221, 221, 221, 0); border-bottom-color: rgba(221, 221, 221, 0); border-right-color: rgba(221, 221, 221, 0);">
                                        </div>
                                    </div>
                                    <div class="col-md-3 column">
                                        <div class="progress" style="height: 50px; border-radius: 0;">
                                            <div class="progress-bar progress-bar-default"
                                                 role="progressbar" aria-valuenow="60" aria-valuemin="0"
                                                 aria-valuemax="100" style="width: 100%; height: 50px;">
                                                <div style="font-size: 16px; margin-top: 15px;">4. å®Œæˆ</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="panel-body">
                            <div class="container-fluid">
                                <div class="row clearfix">
                                    <div class="col-md-12 column">
                                        <blockquote
                                                style="border-left: 5px solid #f60; color: #f60; padding: 0 0 0 20px;">
                                            <b> é¡¹ç›®åŠå‘èµ·äººä¿¡æ¯ </b>
                                        </blockquote>
                                    </div>
                                    <div class="col-md-12 column">
                                        <div class="page-header" style="border-bottom-style: dashed;">
                                            <h3>é¡¹ç›®ä¿¡æ¯</h3>
                                        </div>
                                        <div class="form-group">
                                            <label class="col-sm-2 control-label">åˆ†ç±»ä¿¡æ¯</label>
                                            <div class="col-sm-10">
                                                <label class="radio-inline">
                                                    <input type="checkbox" name="typeIdList"
                                                           id="inlineRadio1"
                                                           value="1"> ç§‘æŠ€
                                                </label>
                                                <label class="radio-inline">
                                                    <input
                                                            type="checkbox" name="typeIdList"
                                                            id="inlineRadio2" value="2" checked="checked"> è®¾è®¡
                                                </label>
                                                <label class="radio-inline">
                                                    <input
                                                            type="checkbox" name="typeIdList"
                                                            id="inlineRadio3" value="3"> å…¬ç›Š
                                                </label>
                                                <label class="radio-inline">
                                                    <input
                                                            type="checkbox" name="typeIdList"
                                                            id="inlineRadio4" value="4" checked="checked"> å†œä¸š
                                                </label>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label class="col-sm-2 control-label">æ ‡ç­¾</label>
                                            <div class="col-sm-10">
                                                <ul style="list-style: none; padding-left: 0;">
                                                    <li style="margin: 10px 0">[æ‰‹æœº] <span
                                                            class="tagLable label-txt" id="4">å¤§å±</span> <span
                                                            class="tagLable label-txt" id="5">ç¾é¢œ</span> <span
                                                            class="tagLable label-txt" id="6">ç»­èˆª</span>
                                                    </li>
                                                    <li style="margin: 10px 0">[æ•°ç ] <span
                                                            class="tagLable label-txt" id="7">é«˜è§£æåº¦</span> <span
                                                            class="tagLable label-txt" id="8">é«˜æ¸…</span>
                                                    </li>
                                                    <li style="margin: 10px 0">[ç”µè„‘] <span
                                                            class="tagLable label-txt" id="9">å¤§å†…å­˜</span> <span
                                                            class="tagLable label-txt" id="10">å›ºæ€</span>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label class="col-sm-2 control-label">é¡¹ç›®åç§°</label>
                                            <div class="col-sm-10">
                                                <input type="text" name="projectName" value="brotherMao"
                                                       class="form-control">
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label class="col-sm-2 control-label">ä¸€å¥è¯ç®€ä»‹</label>
                                            <div class="col-sm-10">
                                                <textarea name="projectDescription" class="form-control"
                                                          rows="5">å°±æ˜¯å¸…ï¼</textarea>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label class="col-sm-2 control-label">ç­¹èµ„é‡‘é¢ï¼ˆå…ƒï¼‰</label>
                                            <div class="col-sm-10">
                                                <input type="text" name="money" value="100000" class="form-control"
                                                       style="width: 100px;"> <label
                                                    class="control-label">ç­¹èµ„é‡‘é¢ä¸èƒ½ä½äº100å…ƒ,ä¸èƒ½é«˜äº1000000000å…ƒ</label>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label class="col-sm-2 control-label">ç­¹èµ„å¤©æ•°ï¼ˆå¤©ï¼‰</label>
                                            <div class="col-sm-10">
                                                <input type="text" name="day" value="30" class="form-control"
                                                       style="width: 100px;"> <label
                                                    class="control-label">ä¸€èˆ¬10-90å¤©ï¼Œå»ºè®®30å¤©</label>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label class="col-sm-2 control-label">é¡¹ç›®å¤´å›¾</label>
                                            <div class="col-sm-10">
                                                <input type="file" name="headerPicture"
                                                       style="display: none;"/>
                                                <button id="uploadHeadBtn" type="button"
                                                        class="btn btn-primary btn-lg active">ä¸Šä¼ å›¾ç‰‡
                                                </button>
                                                <label class="control-label">å›¾ç‰‡ä¸Šæ— æ–‡å­—,æ”¯æŒjpgã€jpegã€pngã€gifæ ¼å¼ï¼Œå¤§å°ä¸è¶…è¿‡2Mï¼Œå»ºè®®å°ºå¯¸ï¼š740*457px</label>
                                                <br/><img style="display: none;"/>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label class="col-sm-2 control-label">é¡¹ç›®è¯¦æƒ…</label>
                                            <div class="col-sm-10">
                                                <input type="file" multiple="multiple" name="detailPictureList"
                                                       style="display: none;"/>
                                                <button id="uploadDetailBtn" type="button"
                                                        class="btn btn-primary btn-lg active">ä¸Šä¼ å›¾ç‰‡
                                                </button>
                                                <label class="control-label">æ”¯æŒjpgã€jpegã€pngã€gifæ ¼å¼ï¼Œå¤§å°ä¸è¶…è¿‡2Mï¼Œå»ºè®®å°ºå¯¸ï¼šå®½740px</label>
                                                <div id="showDetailPicture"></div>
                                            </div>
                                        </div>
                                        <!-- </form> -->
                                    </div>
                                    <div class="col-md-12 column">
                                        <div class="page-header" style="border-bottom-style: dashed;">
                                            <h3>å‘èµ·äººä¿¡æ¯</h3>
                                        </div>
                                        <!-- <form class="form-horizontal"> -->
                                        <div class="form-group">
                                            <label class="col-sm-2 control-label">è‡ªæˆ‘ä»‹ç»</label>
                                            <div class="col-sm-10">
                                                <input type="text" name="memberLauchInfoVO.descriptionSimple"
                                                       value="i am mao" class="form-control"
                                                       placeholder="ä¸€å¥è¯è‡ªæˆ‘ä»‹ç»ï¼Œä¸è¶…è¿‡40å­—">
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label class="col-sm-2 control-label">è¯¦ç»†è‡ªæˆ‘ä»‹ç»</label>
                                            <div class="col-sm-10">
													<textarea name="memberLauchInfoVO.descriptionDetail"
                                                              class="form-control" rows="5"
                                                              placeholder="å‘æ”¯æŒè€…è¯¦ç»†ä»‹ç»ä½ è‡ªå·±æˆ–ä½ çš„å›¢é˜ŸåŠé¡¹ç›®èƒŒæ™¯ï¼Œè®©æ”¯æŒè€…åœ¨æœ€çŸ­æ—¶é—´å†…äº†è§£ä½ ï¼Œä¸è¶…è¿‡160å­—">æˆ‘æ˜¯çŒ«å“¥</textarea>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label class="col-sm-2 control-label">è”ç³»ç”µè¯</label>
                                            <div class="col-sm-10">
                                                <input type="text" name="memberLauchInfoVO.phoneNum" value="123456"
                                                       class="form-control"
                                                       placeholder="æ­¤ä¿¡æ¯ä¸ä¼šæ˜¾ç¤ºåœ¨é¡¹ç›®é¡µé¢">
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label class="col-sm-2 control-label">å®¢æœç”µè¯</label>
                                            <div class="col-sm-10">
                                                <input type="text" name="memberLauchInfoVO.serviceNum" value="654321"
                                                       class="form-control"
                                                       placeholder="æ­¤ä¿¡æ¯æ˜¾ç¤ºåœ¨é¡¹ç›®é¡µé¢">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="panel-footer" style="text-align: center;">
                            <!--<a  href="http://localhost:80/project/return/info/page" type="button" class="btn  btn-warning btn-lg">ä¸‹ä¸€æ­¥</a>-->
                            <button id="submitBtn" type="button" class="btn  btn-warning btn-lg">ä¸‹ä¸€æ­¥</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div class="container" style="margin-top:20px;">
        <div class="row clearfix">
            <div class="col-md-12 column">
                <div id="footer">
                    <div class="footerNav">
                        <a rel="nofollow" href="http://www.layoutit.cn">å…³äºæˆ‘ä»¬</a> | <a rel="nofollow"
                                                                                      href="http://www.layoutit.cn">æœåŠ¡æ¡æ¬¾</a>
                        | <a rel="nofollow" href="http://www.layoutit.cn">å…è´£å£°æ˜</a> | <a rel="nofollow"
                                                                                        href="http://www.layoutit.cn">ç½‘ç«™åœ°å›¾</a>
                        | <a rel="nofollow" href="http://www.layoutit.cn">è”ç³»æˆ‘ä»¬</a>
                    </div>
                    <div class="copyRight">
                        Copyright ?2017-2017layoutit.cn ç‰ˆæƒæ‰€æœ‰
                    </div>
                </div>

            </div>
        </div>
    </div>

</div> <!-- /container -->

</body>
</html>
```





### 2.4 å¤„ç† `1. é¡¹ç›®åŠå‘èµ·äººä¿¡æ¯` çš„è¡¨å•è¯·æ±‚

#### 2.4.1 æ–°å»º `ProjectConsumerHandler` ç±» ã€`project` å·¥ç¨‹ã€‘

```java
package com.atguigu.crowd.handler;

import com.atguigu.crowd.config.OSSProperties;
import com.atguigu.crowd.constant.CrowdConstant;
import com.atguigu.crowd.entity.vo.ProjectVO;
import com.atguigu.crowd.util.CrowdUtil;
import com.atguigu.crowd.util.ResultEntity;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.ui.ModelMap;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.multipart.MultipartFile;

import javax.servlet.http.HttpSession;
import java.io.IOException;
import java.util.ArrayList;
import java.util.List;

/**
 * @author é™ˆæ±Ÿæ—
 * @date 2022/8/31 16:25
 */
@Controller
public class ProjectConsumerHandler {

    @Autowired
    private OSSProperties ossProperties;

    /**
     * @param projectVO         æ¥æ”¶é™¤äº†ä¸Šä¼ å›¾ç‰‡ä¹‹å¤–çš„å…¶ä»–putæ™®é€šæ•°æ®
     * @param headerPicture     ä¸Šä¼ çš„å¤´å›¾
     * @param detailPictureList ä¸Šä¼ çš„è¯¦æƒ…å›¾ç‰‡
     * @param session           ç”¨æ¥å°†æ”¶é›†äº†ä¸€éƒ¨åˆ†æ•°æ®çš„ ProjectVO å¯¹è±¡å­˜å…¥ session åŸŸ
     * @param modelMap          ç”¨æ¥åœ¨å½“å‰æ“ä½œå¤±è´¥åè¿”å›ä¸Šä¸€ä¸ªè¡¨å•é¡µé¢æ—¶æºå¸¦æç¤ºæ¶ˆæ¯
     * @return
     */
    @RequestMapping("/create/project/information")
    public String saveProjectBasicInfo(
            ProjectVO projectVO,
            MultipartFile headerPicture,
            List<MultipartFile> detailPictureList,
            HttpSession session,
            ModelMap modelMap) {
        try {
            // 1. å¤„ç† projectVO å¤´å›¾, å®Œæˆå¤´å›¾ä¸Šä¼ 
            boolean headerPictureEmpty = headerPicture.isEmpty();

            // 1.1 å¦‚æœæ²¡æœ‰å¤´å›¾
            if (headerPictureEmpty) {
                // å¦‚æœæ²¡æœ‰å¤´å›¾åˆ™è¿”å›åˆ°è¡¨å•é¡µé¢å¹¶æ˜¾ç¤ºæç¤ºæ¶ˆæ¯
                modelMap.addAttribute(CrowdConstant.ATTR_NAME_MESSAGE, CrowdConstant.MESSAGE_HEADER_PIC_EMPTY);
                return "project-launch";
            }

            // 1.2 å¦‚æœæœ‰å¤´å›¾, åˆ™æ‰§è¡Œä¸Šä¼ 
            if (!headerPictureEmpty) {
                ResultEntity<String> uploadHeaderPictureResultEntity = CrowdUtil.uploadFilterOss(ossProperties.getBucketName(),
                        ossProperties.getEndPoint(),
                        ossProperties.getBucketDomain(),
                        ossProperties.getAccessKeyId(),
                        ossProperties.getAccessKeySecret(),
                        headerPicture.getInputStream(),
                        headerPicture.getOriginalFilename());

                String result = uploadHeaderPictureResultEntity.getResult();

                // 1.2.1 åˆ¤æ–­å¤´å›¾æ˜¯å¦ä¸Šä¼ æˆåŠŸ
                if (ResultEntity.SUCCESS.equals(result)) {
                    // 1.2.2 ä»è¿”å›çš„æ•°æ®ä¸­è·å–å›¾ç‰‡è®¿é—®è·¯å¾„
                    String headerPicturePath = uploadHeaderPictureResultEntity.getData();

                    // 1.2.3 å­˜å…¥ ProjectVO å¯¹è±¡ä¸­
                    projectVO.setHeaderPicturePath(headerPicturePath);
                } else {
                    // 1.2.4 å¦‚æœä¸Šä¼ å¤±è´¥åˆ™è¿”å›åˆ°è¡¨å•é¡µé¢, è¿”å›æç¤ºæ¶ˆæ¯
                    modelMap.addAttribute(CrowdConstant.ATTR_NAME_MESSAGE, CrowdConstant.MESSAGE_HEADER_PIC_UPLOAD_FAILED);
                    return "project-launch";
                }
            }

            // 2. å¤„ç† projectVO ç±»ä¸­çš„ detailPicturePathList è¯¦æƒ…å›¾ç‰‡çš„è·¯å¾„
            // åˆ›å»ºä¸€ä¸ªç”¨æ¥å­˜æ”¾è¯¦æƒ…å›¾ç‰‡è·¯å¾„çš„é›†åˆ
            List<String> detailPicturePathList = new ArrayList<>();

            // 2.1 å¦‚æœé›†åˆä¸ºç©º
            if (!(detailPictureList != null && detailPictureList.size() > 0)) {
                modelMap.addAttribute(CrowdConstant.ATTR_NAME_MESSAGE, CrowdConstant.MESSAGE_DETAIL_PIC_EMPTY);
                return "project-launch";
            }

            // 2.2 å¦‚æœé›†åˆä¸ä¸ºç©ºåˆ™éå†é›†åˆ
            for (MultipartFile detailPicture : detailPictureList) {
                // 2.2.1 å¦‚æœä¸ºç©º
                if (detailPicture.isEmpty()) {
                    // æ£€æµ‹åˆ°è¯¦æƒ…å›¾ç‰‡ä¸­å•ä¸ªæ–‡ä»¶ä¸ºç©ºåˆ™è¿”å›é”™è¯¯ä¿¡æ¯
                    modelMap.addAttribute(CrowdConstant.ATTR_NAME_MESSAGE, CrowdConstant.MESSAGE_DETAIL_PIC_EMPTY);
                    return "project-launch";
                }

                // 2.2.2 å¦‚æœä¸ä¸ºç©º
                if (!detailPicture.isEmpty()) {
                    // 2.2.3 æ‰§è¡Œä¸Šä¼ 
                    ResultEntity<String> detailUploadResultEntity = CrowdUtil.uploadFilterOss(ossProperties.getBucketName(),
                            ossProperties.getEndPoint(),
                            ossProperties.getBucketDomain(),
                            ossProperties.getAccessKeyId(),
                            ossProperties.getAccessKeySecret(),
                            detailPicture.getInputStream(),
                            detailPicture.getOriginalFilename());

                    // 2.2.4 æ£€æŸ¥ä¸Šä¼ ç»“æœ
                    String detailUploadResult = detailUploadResultEntity.getResult();
                    if (ResultEntity.SUCCESS.equals(detailUploadResult)) {
                        String detailPicturePath = detailUploadResultEntity.getData();
                        // 2.2.5 å°†ä¸Šä¼ æˆåŠŸçš„å›¾ç‰‡çš„è®¿é—®è·¯å¾„å­˜å…¥é›†åˆä¸­
                        detailPicturePathList.add(detailPicturePath);
                    } else {
                        // å¦‚æœä¸Šä¼ å¤±è´¥åˆ™è¿”å›åˆ°è¡¨å•é¡µé¢å¹¶æ˜¾ç¤ºæç¤ºæ¶ˆæ¯
                        modelMap.addAttribute(CrowdConstant.ATTR_NAME_MESSAGE, CrowdConstant.MESSAGE_DETAIL_PIC_UPLOAD_FAILED);
                        return "project-launch";
                    }
                }
            }

            // 2.3 å°†å¤„ç†å¥½çš„é›†åˆå­˜å…¥ projectVO ä¸­
            projectVO.setDetailPicturePathList(detailPicturePathList);

            // 3. å°†æ”¶é›†çš„éƒ¨åˆ†æ•°æ®å­˜å…¥ session ä¸­
            session.setAttribute(CrowdConstant.ATTR_NAME_TEMPLE_PROJECT, projectVO);
        } catch (IOException e) {
            modelMap.addAttribute(CrowdConstant.ATTR_NAME_MESSAGE, e.getMessage());
            return "project-launch";
        }

        // ä»¥å®Œæ•´çš„è·¯å¾„å‰å¾€ä¸‹ä¸€ä¸ª `2. å›æŠ¥è®¾ç½®` çš„é¡µé¢
        return "redirect:" + CrowdConstant.ZUUL_PATH_VALUE + "/project/return/info/page";
    }

}
```



#### 2.4.2 è¿½åŠ è·³è½¬ä»£ç  `CrowdWebMvcConfig` ã€`project` å·¥ç¨‹ã€‘

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661944068010-b0be7c3e-61a4-4e4e-bb7b-2bf948b01e5b.png)

```html
registry.addViewController("/return/info/page").setViewName("project-return");
    
```



#### 2.4.3 æ–°å»º  `project-return.html`é¡µé¢`2. å›æŠ¥è®¾ç½®`ã€`project` å·¥ç¨‹ã€‘

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1661944165910-50f4e71a-21af-48b4-98c7-23994994e0c9.png)



```html
<!DOCTYPE html>
<html lang="zh-CN" xmlns:th="https://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <base th:href="@{/}">
    <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <link rel="stylesheet" href="css/theme.css">
    <script src="jquery/jquery-2.1.1.min.js"></script>
    <script src="bootstrap/js/bootstrap.min.js"></script>
    <script src="script/docs.min.js"></script>
    <script src="script/back-to-top.js"></script>
    <script type="text/javascript" src="layer/layer.js"></script>
    <script>
        // å£°æ˜ä¸€ä¸ªå…¨å±€çš„ returnObj å¯¹è±¡ç”¨äºå­˜å‚¨æ•´ä¸ªè¡¨å•çš„æ•°æ®ï¼ˆåŒ…æ‹¬ä¸Šä¼ åˆ° OSS çš„å›¾ç‰‡è®¿é—®è·¯å¾„ï¼‰
        var returnObj = {};

        $(function () {
            // å›æŠ¥ä¿¡æ¯çš„è¡¨å•éƒ¨åˆ†éšè—
            $(".returnFormDiv").hide();

            $('#myTab a').click(function (e) {
                e.preventDefault()
                $(this).tab('show')
            })

            // ç‚¹å‡» æ·»åŠ å›æŠ¥æŒ‰é’® åˆ‡æ¢è¡¨å•éƒ¨åˆ†çš„å½¢å¼çŠ¶æ€
            $("#addReturnBtn").click(function () {
                // toggle æŠŠæ˜¾ç¤ºçš„å…ƒç´ éšè—, æŠŠæ˜¾ç¤ºçš„å…ƒç´ æ˜¾ç¤º
                $(".returnFormDiv").toggle();
            })

            // ç‚¹å‡»ä¸Šä¼ å›¾ç‰‡æŒ‰é’®æ‰“å¼€æ–‡ä»¶é€‰æ‹©æ¡†
            $("#uploadBtn").click(function () {
                // toggle æŠŠæ˜¾ç¤ºçš„å…ƒç´ éšè—, æŠŠæ˜¾ç¤ºçš„å…ƒç´ æ˜¾ç¤º
                // <input type="file" name="returnPicture" style="display: none;" />
                $("[name=returnPicture]").click();
            })

            // åœ¨æ–‡ä»¶ä¸Šä¼ æ¡†çš„å€¼æ”¹å˜äº‹ä»¶å“åº”å‡½æ•°ä¸­é¢„è§ˆå¹¶ä¸Šä¼ å›¾ç‰‡
            $("[name=returnPicture]").change(function (event) {
                var file = event.target.files[0];

                var url = window.url || window.webkitURL;

                var path = url.createObjectURL(file);

                $(this).next().next().next().next().attr("src", path).show();;

                // å°†ä¸Šä¼ çš„æ–‡ä»¶å°è£…åˆ° FormData å¯¹è±¡ä¸­
                var formData = new FormData();
                formData.append("returnPicture", file);

                // å‘ç”Ÿ Ajax è¯·æ±‚ä¸Šä¼ æ–‡ä»¶
                $.ajax({
                    "url": "[[@{/project/create/upload/return/picture.json}]]",
                    "type": "post",
                    "data": formData,
                    "contentType": false,
                    "processData": false,
                    "dataType": "json",
                    "success": function (response) {
                        var result = response.result;
                        if (result === "SUCCESS") {
                            layer.msg("ä¸Šä¼ æˆåŠŸ!");

                            // å¦‚æœä¸Šä¼ æˆåŠŸ, åˆ™ä»å“åº”ä½“æ•°æ®ä¸­è·å–
                            returnObj.describPicPath = response.data;
                        }

                        if (result === "FAILED") {
                            layer.msg(response.message);
                        }
                    },
                    "error": function (response) {
                        layer.msg(response.status + " " + response.statusText);
                    }
                })
            })

            // è¯´æ˜åºå·ä¿å­˜è¡¨æ ¼ä¸­æ•°æ®çš„åºå·
            var order = 0;

            // ç‚¹å‡»ç¡®è®¤æŒ‰é’®, ç»‘å®šç»‘å®šå•å‡»å“åº”å‡½æ•°
            $("#okBtn").click(function () {
                // 1. æ”¶é›†è¡¨å•æ•°æ®
                returnObj.type = $("[name=type]:checked").val();
                returnObj.supportmoney = $("[name=supportmoney]").val();
                returnObj.content = $("[name=content]").val();
                returnObj.count = $("[name=count]").val();
                returnObj.signalpurchase = $("[name=signalpurchase]:checked").val();
                returnObj.purchase = $("[name=purchase]").val();
                returnObj.freight = $("[name=freight]").val();
                returnObj.invoice = $("[name=invoice]:checked").val();
                returnObj.returndate = $("[name=returndate]").val();

                // 2. å‘é€ Ajax è¯·æ±‚
                $.ajax({
                    "url": "[[@{/project/create/save/return.json}]]",
                    "type": "post",
                    "data": returnObj,
                    "dataType": "json",
                    "success": function (response) {
                        var result = response.result;
                        if (result === "SUCCESS") {
                            layer.msg("è¿™ä¸€æ¡ä¿å­˜æˆåŠŸ!!");

                            // ä½¿ç”¨ returnObj å¡«å……è¡¨æ ¼
                            var orderId = "<td>" + (++order) + "</td>";
                            var supportmoneyId = "<td>" + returnObj.supportmoney + "</td>";
                            var countId = "<td>" + returnObj.count + "</td>";
                            var signalpurchaseId = "<td>" + (returnObj.signalpurchase === 0 ? "ä¸é™è´­" : ("é™è´­" + returnObj.purchase)) + "</td>";
                            var contentId = "<td>" + returnObj.content + "</td>";
                            var returndateId = "<td>" + returnObj.returndate + "å¤©ä»¥åè¿”è¿˜</td>";
                            var freightId = "<td>" + (returnObj.freight === 0 ? "åŒ…é‚®" : returnObj.freight) + "</td>";
                            var operationTd = "<td><button type='button' class='btn btn-primary btn-xs'><i class=' glyphicon glyphicon-pencil'></i></button>&nbsp;<button type='button' class='btn btn-danger btn-xs'><i class=' glyphicon glyphicon-remove'></i></button></td>";
                            var trHTML = "<tr>" + orderId + supportmoneyId + countId + signalpurchaseId + contentId + returndateId + freightId + operationTd + "</tr>";

                            $("#returnTableBody").append(trHTML);

                            $("#returnPictureImage").hide();
                        }

                        if (result === "FAILED") {
                            layer.msg("è¿™ä¸€æ¡ä¿å­˜å¤±è´¥!");
                        }

                        // åç»­æ“ä½œ
                        // ä»…ä»…è°ƒç”¨ click() å‡½æ•°è€Œä¸ä¼ å…¥å›è°ƒå‡½æ•°è¡¨ç¤ºç‚¹å‡»ä¸€ä¸‹è¿™ä¸ªæŒ‰é’®
                        $("#resetBtn").click();

                        // å°†è¡¨å•éƒ¨åˆ† div éšè—
                        $(".returnFormDiv").hide();

                    },
                    "error": function () {
                        layer.msg(response.status + " " + response.statusText);
                    }
                })
            })
        })
    </script>
    <style>
        #footer {
            padding: 15px 0;
            background: #fff;
            border-top: 1px solid #ddd;
            text-align: center;
        }

        #topcontrol {
            color: #fff;
            z-index: 99;
            width: 30px;
            height: 30px;
            font-size: 20px;
            background: #222;
            position: relative;
            right: 14px !important;
            bottom: 11px !important;
            border-radius: 3px !important;
        }

        #topcontrol:after {
            /*top: -2px;*/
            left: 8.5px;
            content: "\f106";
            position: absolute;
            text-align: center;
            font-family: FontAwesome;
        }

        #topcontrol:hover {
            color: #fff;
            background: #18ba9b;
            -webkit-transition: all 0.3s ease-in-out;
            -moz-transition: all 0.3s ease-in-out;
            -o-transition: all 0.3s ease-in-out;
            transition: all 0.3s ease-in-out;
        }

        .label-type, .label-status, .label-order {
            background-color: #fff;
            color: #f60;
            padding: 5px;
            border: 1px #f60 solid;
        }

        #typeList :not(:first-child) {
            margin-top: 20px;
        }

        .label-txt {
            margin: 10px 10px;
            border: 1px solid #ddd;
            padding: 4px;
            font-size: 14px;
        }

        .panel {
            border-radius: 0;
        }

        .progress-bar-default {
            background-color: #ddd;
        }
    </style>
</head>
<body>
<div class="navbar-wrapper">
    <div class="container">
        <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand" href="index.html" style="font-size: 32px;">å°šç­¹ç½‘-åˆ›æ„äº§å“ä¼—ç­¹å¹³å°</a>
                </div>
                <div id="navbar" class="navbar-collapse collapse"
                     style="float: right;">
                    <ul class="nav navbar-nav">
                        <li class="dropdown"><a href="#" class="dropdown-toggle"
                                                data-toggle="dropdown"><i class="glyphicon glyphicon-user"></i>
                            [[${session.loginMember.username}]]<span class="caret"></span></a>
                            <ul class="dropdown-menu" role="menu">
                                <li><a href="member.html"><i
                                        class="glyphicon glyphicon-scale"></i> ä¼šå‘˜ä¸­å¿ƒ</a></li>
                                <li><a href="#"><i class="glyphicon glyphicon-comment"></i>
                                    æ¶ˆæ¯</a></li>
                                <li class="divider"></li>
                                <li><a th:href="@{/auth/member/logout}"><i
                                        class="glyphicon glyphicon-off"></i> é€€å‡ºç³»ç»Ÿ</a></li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    </div>
</div>

<div class="container theme-showcase" role="main">

    <div class="container">
        <div class="row clearfix">
            <div class="col-md-12 column">
                <nav class="navbar navbar-default" role="navigation">
                    <div class="collapse navbar-collapse"
                         id="bs-example-navbar-collapse-1">
                        <ul class="nav navbar-nav">
                            <li><a rel="nofollow" href="index.html"><i
                                    class="glyphicon glyphicon-home"></i> ä¼—ç­¹é¦–é¡µ</a></li>
                            <li><a rel="nofollow" href="projects.html"><i
                                    class="glyphicon glyphicon-th-large"></i> é¡¹ç›®æ€»è§ˆ</a></li>
                            <li class="active"><a rel="nofollow" href="javascript:;"><i
                                    class="glyphicon glyphicon-edit"></i> å‘èµ·é¡¹ç›®</a></li>
                            <li><a rel="nofollow" href="minecrowdfunding.html"><i
                                    class="glyphicon glyphicon-user"></i> æˆ‘çš„ä¼—ç­¹</a></li>
                        </ul>
                    </div>
                </nav>
            </div>
        </div>
    </div>


    <div class="container">
        <div class="row clearfix">
            <div class="col-md-12 column">
                <div class="panel panel-default">
                    <div class="panel-heading" style="text-align: center;">
                        <div class="container-fluid">
                            <div class="row clearfix">
                                <div class="col-md-3 column">
                                    <div class="progress"
                                         style="height: 50px; border-radius: 0; position: absolute; width: 75%; right: 49px;">
                                        <div class="progress-bar progress-bar-default"
                                             role="progressbar" aria-valuenow="60" aria-valuemin="0"
                                             aria-valuemax="100" style="width: 100%; height: 50px;">
                                            <div style="font-size: 16px; margin-top: 15px;">1.
                                                é¡¹ç›®åŠå‘èµ·äººä¿¡æ¯
                                            </div>
                                        </div>
                                    </div>
                                    <div
                                            style="right: 0; border: 10px solid #ddd; border-left-color: #88b7d5; border-width: 25px; position: absolute; border-left-color: rgba(221, 221, 221, 1); border-top-color: rgba(221, 221, 221, 0); border-bottom-color: rgba(221, 221, 221, 0); border-right-color: rgba(221, 221, 221, 0);">
                                    </div>
                                </div>
                                <div class="col-md-3 column">
                                    <div class="progress"
                                         style="height: 50px; border-radius: 0; position: absolute; width: 75%; right: 49px;">
                                        <div class="progress-bar progress-bar-success"
                                             role="progressbar" aria-valuenow="60" aria-valuemin="0"
                                             aria-valuemax="100" style="width: 100%; height: 50px;">
                                            <div style="font-size: 16px; margin-top: 15px;">2.
                                                å›æŠ¥è®¾ç½®
                                            </div>
                                        </div>
                                    </div>
                                    <div
                                            style="right: 0; border: 10px solid #ddd; border-left-color: #88b7d5; border-width: 25px; position: absolute; border-left-color: rgba(92, 184, 92, 1); border-top-color: rgba(92, 184, 92, 0); border-bottom-color: rgba(92, 184, 92, 0); border-right-color: rgba(92, 184, 92, 0);">
                                    </div>
                                </div>
                                <div class="col-md-3 column">
                                    <div class="progress"
                                         style="height: 50px; border-radius: 0; position: absolute; width: 75%; right: 49px;">
                                        <div class="progress-bar progress-bar-default"
                                             role="progressbar" aria-valuenow="60" aria-valuemin="0"
                                             aria-valuemax="100" style="width: 100%; height: 50px;">
                                            <div style="font-size: 16px; margin-top: 15px;">3.
                                                ç¡®è®¤ä¿¡æ¯
                                            </div>
                                        </div>
                                    </div>
                                    <div
                                            style="right: 0; border: 10px solid #ddd; border-left-color: #88b7d5; border-width: 25px; position: absolute; border-left-color: rgba(221, 221, 221, 1); border-top-color: rgba(221, 221, 221, 0); border-bottom-color: rgba(221, 221, 221, 0); border-right-color: rgba(221, 221, 221, 0);">
                                    </div>
                                </div>
                                <div class="col-md-3 column">
                                    <div class="progress" style="height: 50px; border-radius: 0;">
                                        <div class="progress-bar progress-bar-default"
                                             role="progressbar" aria-valuenow="60" aria-valuemin="0"
                                             aria-valuemax="100" style="width: 100%; height: 50px;">
                                            <div style="font-size: 16px; margin-top: 15px;">4. å®Œæˆ</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="panel-body">

                        <div class="container-fluid">
                            <div class="row clearfix">
                                <div class="col-md-12 column">
                                    <blockquote
                                            style="border-left: 5px solid #f60; color: #f60; padding: 0 0 0 20px;">
                                        <b> å›æŠ¥è®¾ç½® </b>
                                    </blockquote>
                                </div>
                                <div class="col-md-12 column">
                                    <table class="table table-bordered"
                                           style="text-align: center;">
                                        <thead>
                                        <tr style="background-color: #ddd;">
                                            <td>åºå·</td>
                                            <td>æ”¯ä»˜é‡‘é¢</td>
                                            <td>åé¢</td>
                                            <td>å•ç¬”é™è´­</td>
                                            <td>å›æŠ¥å†…å®¹</td>
                                            <td>å›æŠ¥æ—¶é—´</td>
                                            <td>è¿è´¹</td>
                                            <td>æ“ä½œ</td>
                                        </tr>
                                        </thead>
                                        <tbody id="returnTableBody">
                                        <!-- <tr>
                                            <td scope="row">1</td>
                                            <td>ï¿¥1.00</td>
                                            <td>æ— é™åˆ¶</td>
                                            <td>1</td>
                                            <td>1</td>
                                            <td>é¡¹ç›®ç»“æŸåçš„30å¤©</td>
                                            <td>åŒ…é‚®</td>
                                            <td>
                                                <button type="button" class="btn btn-primary btn-xs">
                                                    <i class=" glyphicon glyphicon-pencil"></i>
                                                </button>
                                                <button type="button" class="btn btn-danger btn-xs">
                                                    <i class=" glyphicon glyphicon-remove"></i>
                                                </button>
                                            </td>
                                        </tr> -->
                                        </tbody>
                                    </table>
                                    <button id="addReturnBtn" type="button" class="btn btn-primary btn-lg">
                                        <i class="glyphicon glyphicon-plus"></i> æ·»åŠ å›æŠ¥
                                    </button>
                                    <div class="returnFormDiv"
                                         style="border: 10px solid #f60; border-bottom-color: #eceeef; border-width: 10px; width: 20px; margin-left: 20px; border-left-color: rgba(221, 221, 221, 0); border-top-color: rgba(221, 221, 221, 0); border-right-color: rgba(221, 221, 221, 0);"></div>
                                    <div class="panel panel-default returnFormDiv"
                                         style="border-style: dashed; background-color: #eceeef">
                                        <div class="panel-body">

                                            <div class="col-md-12 column">
                                                <form class="form-horizontal">
                                                    <div class="form-group">
                                                        <label class="col-sm-2 control-label">å›æŠ¥ç±»å‹</label>
                                                        <div class="col-sm-10">
                                                            <label class="radio-inline"> <input type="radio"
                                                                                                name="type"
                                                                                                id="inlineRadio1"
                                                                                                value="0"> å®ç‰©å›æŠ¥
                                                            </label> <label class="radio-inline"> <input
                                                                type="radio" name="type"
                                                                id="inlineRadio2" value="1"> è™šæ‹Ÿç‰©å“å›æŠ¥
                                                        </label>
                                                        </div>
                                                    </div>
                                                    <div class="form-group">
                                                        <label class="col-sm-2 control-label">æ”¯æŒé‡‘é¢ï¼ˆå…ƒï¼‰</label>
                                                        <div class="col-sm-10">
                                                            <input type="text" name="supportmoney" value="10"
                                                                   class="form-control"
                                                                   style="width: 100px;">
                                                        </div>
                                                    </div>
                                                    <div class="form-group">
                                                        <label class="col-sm-2 control-label">å›æŠ¥å†…å®¹</label>
                                                        <div class="col-sm-10">
																<textarea class="form-control" name="content" rows="5"
                                                                          placeholder="ç®€å•æè¿°å›æŠ¥å†…å®¹ï¼Œä¸è¶…è¿‡200å­—">ä»¥èº«ç›¸è®¸</textarea>
                                                        </div>
                                                    </div>
                                                    <div class="form-group">
                                                        <label class="col-sm-2 control-label">è¯´æ˜å›¾ç‰‡</label>
                                                        <div class="col-sm-10">
                                                            <input type="file" name="returnPicture" style="display: none;"/>
                                                            <button type="button" id="uploadBtn" class="btn btn-primary btn-lg active">ä¸Šä¼ å›¾ç‰‡
                                                            </button>
                                                            <label class="control-label">æ”¯æŒjpgã€jpegã€pngã€gifæ ¼å¼ï¼Œå¤§å°ä¸è¶…è¿‡2Mï¼Œå»ºè®®å°ºå¯¸ï¼š760*510pxé€‰æ‹©æ–‡ä»¶</label>
                                                            <br/>
                                                            <img style="display: none"/>
                                                        </div>
                                                    </div>
                                                    <div class="form-group">
                                                        <label class="col-sm-2 control-label">å›æŠ¥æ•°é‡ï¼ˆåï¼‰</label>
                                                        <div class="col-sm-10">
                                                            <input type="text" name="count" value="5"
                                                                   class="form-control"
                                                                   style="width: 100px; display: inline"> <label
                                                                class="control-label">â€œ0â€ä¸ºä¸é™å›æŠ¥æ•°é‡</label>
                                                        </div>
                                                    </div>
                                                    <div class="form-group">
                                                        <label class="col-sm-2 control-label">å•ç¬”é™è´­</label>
                                                        <div class="col-sm-10">
                                                            <label class="radio-inline"> <input type="radio"
                                                                                                name="signalpurchase"
                                                                                                id="inlineRadio3"
                                                                                                value="0"> ä¸é™è´­
                                                            </label> <label class="radio-inline"> <input
                                                                type="radio" name="signalpurchase"
                                                                id="inlineRadio4" value="1"> é™è´­
                                                        </label> <input type="text" name="purchase" value="8"
                                                                        class="form-control"
                                                                        style="width: 100px; display: inline"> <label
                                                                class="radio-inline">é»˜è®¤æ•°é‡ä¸º1ï¼Œä¸”ä¸è¶…è¿‡ä¸Šæ–¹å·²è®¾ç½®çš„å›æŠ¥æ•°é‡</label>
                                                        </div>
                                                    </div>
                                                    <div class="form-group">
                                                        <label class="col-sm-2 control-label">è¿è´¹(å…ƒ)</label>
                                                        <div class="col-sm-10">
                                                            <input type="text" name="freight" value="0"
                                                                   class="form-control"
                                                                   style="width: 100px; display: inline">
                                                            <label class="control-label">â€œ0â€ä¸ºåŒ…é‚®</label>
                                                        </div>
                                                    </div>
                                                    <div class="form-group">
                                                        <label class="col-sm-2 control-label">å‘ç¥¨</label>
                                                        <div class="col-sm-10">
                                                            <label class="radio-inline"> <input type="radio"
                                                                                                name="invoice"
                                                                                                id="inlineRadio5"
                                                                                                value="0"> ä¸å¯å¼€å‘ç¥¨
                                                            </label> <label class="radio-inline"> <input
                                                                type="radio" name="invoice"
                                                                id="inlineRadio6" value="1">
                                                            å¯å¼€å‘ç¥¨ï¼ˆåŒ…æ‹¬ä¸ªäººå‘ç¥¨å’Œè‡ªå®šä¹‰æŠ¬å¤´å‘ç¥¨ï¼‰
                                                        </label>
                                                        </div>
                                                    </div>
                                                    <div class="form-group">
                                                        <label class="col-sm-2 control-label">å›æŠ¥æ—¶é—´</label>
                                                        <div class="col-sm-10">
                                                            <label class="radio-inline"> é¡¹ç›®ç»“æŸå </label> <input
                                                                type="text" name="returndate" value="15"
                                                                class="form-control"
                                                                style="width: 100px; display: inline"> <label
                                                                class="radio-inline">å¤©ï¼Œå‘æ”¯æŒè€…å‘é€å›æŠ¥</label>
                                                        </div>
                                                    </div>
                                                    <div class="form-group">
                                                        <label class="col-sm-2 control-label"></label>
                                                        <div class="col-sm-10">
                                                            <button type="button" class="btn btn-primary" id="okBtn">
                                                                ç¡®å®š
                                                            </button>
                                                            <button type="button" class="btn btn-default">å–æ¶ˆ</button>
                                                        </div>
                                                    </div>

                                                </form>
                                            </div>


                                        </div>
                                    </div>
                                </div>

                                <div class="container">
                                    <div class="row clearfix">
                                        <div class="col-md-12 column">
                                            <blockquote>
                                                <p>
                                                    <i class="glyphicon glyphicon-info-sign"
                                                       style="color: #2a6496;"></i> æç¤º
                                                </p>
                                                <small>
                                                    3ä¸ªä»¥ä¸Šçš„å›æŠ¥ï¼šå¤šäº›é€‰æ‹©èƒ½æé«˜é¡¹ç›®çš„æ”¯æŒç‡ã€‚å‡ åã€å‡ ç™¾ã€ä¸Šåƒå…ƒçš„æ”¯æŒï¼š3ä¸ªä¸åŒæ¡£æ¬¡çš„å›æŠ¥ï¼Œèƒ½è®©ä½ çš„é¡¹ç›®æ›´å¿«æˆåŠŸã€‚å›æŠ¥æœ€å¥½æ˜¯é¡¹ç›®çš„è¡ç”Ÿå“ï¼š<br>ä¸é¡¹ç›®å†…å®¹æœ‰å…³çš„å›æŠ¥æ›´èƒ½å¸å¼•åˆ°å¤§å®¶çš„æ”¯æŒã€‚
                                                </small>
                                            </blockquote>
                                        </div>
                                    </div>
                                </div>


                            </div>
                        </div>
                    </div>
                    <div class="panel-footer" style="text-align: center;">
                        <button type="button" class="btn  btn-default btn-lg"
                                onclick="window.location.href='start-step-1.html'">ä¸Šä¸€æ­¥
                        </button>
                        <!-- <button type="button" class="btn  btn-warning btn-lg"
                            onclick="window.location.href='start-step-3.html'">ä¸‹ä¸€æ­¥</button> -->
                        <a th:href="@{/project/create/confirm/page}" class="btn btn-warning btn-lg">ä¸‹ä¸€æ­¥</a>
                        <a class="btn"> é¢„è§ˆ </a>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <div class="container" style="margin-top: 20px;">
        <div class="row clearfix">
            <div class="col-md-12 column">
                <div id="footer">
                    <div class="footerNav">
                        <a rel="nofollow" href="http://www.layoutit.cn">å…³äºæˆ‘ä»¬</a> | <a
                            rel="nofollow" href="http://www.layoutit.cn">æœåŠ¡æ¡æ¬¾</a> | <a
                            rel="nofollow" href="http://www.layoutit.cn">å…è´£å£°æ˜</a> | <a
                            rel="nofollow" href="http://www.layoutit.cn">ç½‘ç«™åœ°å›¾</a> | <a
                            rel="nofollow" href="http://www.layoutit.cn">è”ç³»æˆ‘ä»¬</a>
                    </div>
                    <div class="copyRight">Copyright ?2017-2017layoutit.cn ç‰ˆæƒæ‰€æœ‰
                    </div>
                </div>

            </div>
        </div>
    </div>

</div>

</body>
</html>
```



### 2.5 å¤„ç†  `2. å›æŠ¥è®¾ç½®` é¡µé¢çš„è¡¨å•è¯·æ±‚

#### 2.5.1 è¿½åŠ å›¾ç‰‡ä¸Šä¼ ä»£ç  `ProjectConsumerHandler ç±»` ã€`project` å·¥ç¨‹ã€‘

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662012728299-55bb2f49-f2c8-4302-88da-9fcdc9794bc1.png)

```java
    /**
     * JavaScript ä»£ç : formData.append("returnPicture", file);
     * - returnPicture: æ˜¯è¯·æ±‚å‚æ•°çš„åå­—
     * - file æ˜¯è¯·æ±‚å‚æ•°çš„å€¼, ä¹Ÿå°±æ˜¯è¦ä¸Šä¼ çš„æ–‡ä»¶
     *
     * @param returnPicture æ¥æ”¶ç”¨æˆ·ä¸Šä¼ çš„æ–‡ä»¶
     * @return
     */
    @ResponseBody
    @RequestMapping("/create/upload/return/picture.json")
    public ResultEntity<String> uploadReturnPicture(
            @RequestParam("returnPicture") MultipartFile returnPicture
    ) {
        try {
            // 1. æ‰§è¡Œæ–‡ä»¶ä¸Šä¼ 
            ResultEntity<String> returnPictureResultEntity = CrowdUtil.uploadFilterOss(ossProperties.getBucketName(),
                    ossProperties.getEndPoint(),
                    ossProperties.getBucketDomain(),
                    ossProperties.getAccessKeyId(),
                    ossProperties.getAccessKeySecret(),
                    returnPicture.getInputStream(),
                    returnPicture.getOriginalFilename());

            // 2. è¿”å›ä¸Šä¼ çš„ç»“æœ
            return returnPictureResultEntity;
        } catch (IOException e) {
            return ResultEntity.failed(e.getMessage());
        }
    }
```



#### 2.5.2 è¿½åŠ  `æ·»åŠ å›æŠ¥ä¿¡æ¯` ä»£ç  `ProjectConsumerHandler ç±»` ã€`project` å·¥ç¨‹ã€‘

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662012733051-00581c66-6175-4581-85b0-572b3c634749.png)

```java
    /**
     * å‘ ProjectVO å¯¹è±¡å­˜å…¥å›æŠ¥ä¿¡æ¯
     *
     * @param returnVO
     * @param session
     * @return
     */
    @ResponseBody
    @RequestMapping("/create/save/return.json")
    public ResultEntity<String> returnPicture(
            ReturnVO returnVO,
            HttpSession session
    ) {
        try {
            // ä» session åŸŸä¸­è·å–ä¹‹å‰ç¼“å­˜çš„ ProjectVO å¯¹è±¡
            ProjectVO projectVO = (ProjectVO) session.getAttribute(CrowdConstant.ATTR_NAME_TEMPLE_PROJECT);
            if (null == projectVO) {
                // MESSAGE_TEMPLE_PROJECT_MISSING = ä¸´æ—¶å­˜å‚¨çš„ projectVO å¯¹è±¡ä¸¢å¤±
                return ResultEntity.failed(CrowdConstant.MESSAGE_TEMPLE_PROJECT_MISSING);
            }

            // ä» projectVO å¯¹è±¡ä¸­å­˜å‚¨å›æŠ¥ä¿¡æ¯çš„é›†åˆ
            List<ReturnVO> returnVOList = projectVO.getReturnVOList();

            // åˆ¤æ–­ returnVOList é›†åˆæ˜¯å¦æœ‰æ•ˆ
            if (returnVOList == null) {
                returnVOList = new ArrayList<>();
            }

            returnVOList.add(returnVO);

            projectVO.setReturnVOList(returnVOList);
            // å°†æ•°æ®æœ‰å˜åŒ–çš„ ProjectVO å¯¹è±¡é‡æ–°å­˜å…¥ session åŸŸ, ä»¥ç¡®ä¿æ–°çš„æ•°æ®æœ€ç»ˆèƒ½å¤Ÿå­˜å…¥ Redis
            session.setAttribute(CrowdConstant.ATTR_NAME_TEMPLE_PROJECT, projectVO);
            return ResultEntity.successWithoutData();
        } catch (Exception e) {
            return ResultEntity.failed(e.getMessage());
        }
    }
```



### 2.6 å¤„ç†3: ç¬¬ä¸‰æ­¥ `ç¡®è®¤ä¿¡æ¯` é¡µé¢ ã€`project` å·¥ç¨‹ã€‘

#### 2.6.1 æ·»åŠ  `view-comtorller` ä»£ç 

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662026729062-60115985-3b91-4399-92f0-4ee846aa8f58.png)

```java
registry.addViewController("/create/confirm/page").setViewName("project-confirm");
```

#### 

#### 2.6.2 æ–°å»º `project-confirm.html` ç¬¬ä¸‰æ­¥: ç¡®è®¤ä¿¡æ¯é¡µé¢

```html
<!DOCTYPE html>
<html lang="zh-CN" xmlns:th="https://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <base th:href="@{/}"/>
    <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <link rel="stylesheet" href="css/theme.css">
    <style>
        #footer {
            padding: 15px 0;
            background: #fff;
            border-top: 1px solid #ddd;
            text-align: center;
        }
        #topcontrol {
            color: #fff;
            z-index: 99;
            width: 30px;
            height: 30px;
            font-size: 20px;
            background: #222;
            position: relative;
            right: 14px !important;
            bottom: 11px !important;
            border-radius: 3px !important;
        }

        #topcontrol:after {
            /*top: -2px;*/
            left: 8.5px;
            content: "\f106";
            position: absolute;
            text-align: center;
            font-family: FontAwesome;
        }

        #topcontrol:hover {
            color: #fff;
            background: #18ba9b;
            -webkit-transition: all 0.3s ease-in-out;
            -moz-transition: all 0.3s ease-in-out;
            -o-transition: all 0.3s ease-in-out;
            transition: all 0.3s ease-in-out;
        }

        .label-type, .label-status, .label-order {
            background-color: #fff;
            color: #f60;
            padding : 5px;
            border: 1px #f60 solid;
        }
        #typeList  :not(:first-child) {
            margin-top:20px;
        }
        .label-txt {
            margin:10px 10px;
            border:1px solid #ddd;
            padding : 4px;
            font-size:14px;
        }
        .panel {
            border-radius:0;
        }

        .progress-bar-default {
            background-color: #ddd;
        }
    </style>
    <script src="jquery/jquery-2.1.1.min.js"></script>
    <script src="bootstrap/js/bootstrap.min.js"></script>
    <script src="script/docs.min.js"></script>
    <script src="script/back-to-top.js"></script>
    <script>
        $(function() {
            var message = "[[${message}]]";
            if (message !== "") {
                layer.msg(message);
            }

            $('#myTab a').click(function (e) {
                e.preventDefault()
                $(this).tab('show')
            })
        })
    </script>
</head>
<body>
<div class="navbar-wrapper">
    <div class="container">
        <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand" href="index.html" style="font-size:32px;">å°šç­¹ç½‘-åˆ›æ„äº§å“ä¼—ç­¹å¹³å°</a>
                </div>
                <div id="navbar" class="navbar-collapse collapse" style="float:right;">
                    <ul class="nav navbar-nav">
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="glyphicon glyphicon-user"></i> [[${session.loginMember.username}]]<span class="caret"></span></a>
                            <ul class="dropdown-menu" role="menu">
                                <li><a href="member.html"><i class="glyphicon glyphicon-scale"></i> ä¼šå‘˜ä¸­å¿ƒ</a></li>
                                <li><a href="#"><i class="glyphicon glyphicon-comment"></i> æ¶ˆæ¯</a></li>
                                <li class="divider"></li>
                                <li><a th:href="@{/auth/member/logout}"><i class="glyphicon glyphicon-off"></i> é€€å‡ºç³»ç»Ÿ</a></li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    </div>
</div>

<div class="container theme-showcase" role="main">

    <div class="container">
        <div class="row clearfix">
            <div class="col-md-12 column">
                <nav class="navbar navbar-default" role="navigation">
                    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                        <ul class="nav navbar-nav">
                            <li>
                                <a rel="nofollow" href="index.html"><i class="glyphicon glyphicon-home"></i> ä¼—ç­¹é¦–é¡µ</a>
                            </li>
                            <li >
                                <a rel="nofollow" href="projects.html"><i class="glyphicon glyphicon-th-large"></i> é¡¹ç›®æ€»è§ˆ</a>
                            </li>
                            <li class="active">
                                <a rel="nofollow" href="javascript:;"><i class="glyphicon glyphicon-edit"></i> å‘èµ·é¡¹ç›®</a>
                            </li>
                            <li>
                                <a rel="nofollow" href="minecrowdfunding.html"><i class="glyphicon glyphicon-user"></i> æˆ‘çš„ä¼—ç­¹</a>
                            </li>
                        </ul>
                    </div>
                </nav>
            </div>
        </div>
    </div>


    <div class="container">
        <div class="row clearfix">
            <div class="col-md-12 column">
                <div class="panel panel-default" >
                    <div class="panel-heading" style="text-align:center;">
                        <div class="container-fluid">
                            <div class="row clearfix">
                                <div class="col-md-3 column">
                                    <div class="progress" style="height:50px;border-radius:0;    position: absolute;width: 75%;right:49px;">
                                        <div class="progress-bar progress-bar-default" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 100%;height:50px;">
                                            <div style="font-size:16px;margin-top:15px;">1. é¡¹ç›®åŠå‘èµ·äººä¿¡æ¯</div>
                                        </div>
                                    </div>
                                    <div style="right: 0;border:10px solid #ddd;border-left-color: #88b7d5;border-width: 25px;position: absolute;
                                             border-left-color: rgba(221, 221, 221, 1);
                                             border-top-color: rgba(221, 221, 221, 0);
                                             border-bottom-color: rgba(221, 221, 221, 0);
                                             border-right-color: rgba(221, 221, 221, 0);
                                        ">
                                    </div>
                                </div>
                                <div class="col-md-3 column">
                                    <div class="progress" style="height:50px;border-radius:0;position: absolute;width: 75%;right:49px;">
                                        <div class="progress-bar progress-bar-default" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 100%;height:50px;">
                                            <div style="font-size:16px;margin-top:15px;">2. å›æŠ¥è®¾ç½®</div>
                                        </div>
                                    </div>
                                    <div style="right: 0;border:10px solid #ddd;border-left-color: #88b7d5;border-width: 25px;position: absolute;
                                             border-left-color: rgba(221, 221, 221, 1);
                                             border-top-color: rgba(221, 221, 221, 0);
                                             border-bottom-color: rgba(221, 221, 221, 0);
                                             border-right-color: rgba(221, 221, 221, 0);
                                        ">
                                    </div>
                                </div>
                                <div class="col-md-3 column">
                                    <div class="progress" style="height:50px;border-radius:0;position: absolute;width: 75%;right:49px;">
                                        <div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 100%;height:50px;">
                                            <div style="font-size:16px;margin-top:15px;">3. ç¡®è®¤ä¿¡æ¯</div>
                                        </div>
                                    </div>
                                    <div style="right: 0;border:10px solid #ddd;border-left-color: #88b7d5;border-width: 25px;position: absolute;
                                             border-left-color: rgba(92, 184, 92, 1);
                                             border-top-color: rgba(92, 184, 92, 0);
                                             border-bottom-color: rgba(92, 184, 92, 0);
                                             border-right-color: rgba(92, 184, 92, 0);
                                        ">
                                    </div>
                                </div>
                                <div class="col-md-3 column">
                                    <div class="progress" style="height:50px;border-radius:0;">
                                        <div class="progress-bar progress-bar-default" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 100%;height:50px;">
                                            <div style="font-size:16px;margin-top:15px;">4. å®Œæˆ</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="panel-body">

                        <div class="container-fluid">
                            <div class="row clearfix">
                                <div class="col-md-12 column">
                                    <blockquote style="border-left: 5px solid #f60;color:#f60;padding: 0 0 0 20px;">
                                        <b>
                                            ç¡®è®¤ä¿¡æ¯ï¼ˆè¯·å¡«å†™æ˜“ä»˜å®ä¼ä¸šè´¦å·ç”¨äºæ”¶æ¬¾åŠèº«ä»½æ ¸å®ï¼‰
                                        </b>
                                    </blockquote>
                                </div>
                                <div class="col-md-12 column">


                                    <div class="row clearfix">
                                        <div class="col-md-6 column">
                                            <form id="confirmFomr" th:action="@{/project/create/confirm}" method="post" role="form">
                                                <div class="form-group">
                                                    <label for="exampleInputEmail1">æ˜“ä»˜å®ä¼ä¸šè´¦å·ï¼š</label><input type="email" name="paynum" class="form-control" id="exampleInputEmail1" />
                                                </div>
                                                <div class="form-group">
                                                    <label for="exampleInputPassword1">æ³•äººèº«ä»½è¯å·ï¼š</label><input type="password" name="cardnum" class="form-control" id="exampleInputPassword1" />
                                                </div>
                                            </form>
                                        </div>
                                        <div class="col-md-6 column">
                                            <div class="panel panel-default">
                                                <div class="panel-body" style="padding:40px;">
                                                    <i class="glyphicon glyphicon-user"></i> æ˜“è´­è´¦æˆ·åï¼š18801282948<br><br><span style="margin-left:60px;">æ‚¨æ­£åœ¨ä½¿ç”¨è¯¥è´¦å·å‘èµ·ä¼—ç­¹é¡¹ç›®</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="panel-footer" style="text-align:center;">
                        <button type="button" class="btn  btn-default btn-lg">ä¸Šä¸€æ­¥</button>

                        <script type="text/javascript">
                            $(function(){
                                $("#submitBtn").click(function(){
                                    $("#confirmFomr").submit();
                                });
                            });
                        </script>
                        <button type="button" id="submitBtn" class="btn  btn-warning btn-lg">æäº¤</button>
                        <a class="btn" > ä¿å­˜è‰ç¨¿ </a>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <div class="container" style="margin-top:20px;">
        <div class="row clearfix">
            <div class="col-md-12 column">
                <div id="footer">
                    <div class="footerNav">
                        <a rel="nofollow" href="http://www.layoutit.cn">å…³äºæˆ‘ä»¬</a> | <a rel="nofollow" href="http://www.layoutit.cn">æœåŠ¡æ¡æ¬¾</a> | <a rel="nofollow" href="http://www.layoutit.cn">å…è´£å£°æ˜</a> | <a rel="nofollow" href="http://www.layoutit.cn">ç½‘ç«™åœ°å›¾</a> | <a rel="nofollow" href="http://www.layoutit.cn">è”ç³»æˆ‘ä»¬</a>
                    </div>
                    <div class="copyRight">
                        Copyright ?2017-2017layoutit.cn ç‰ˆæƒæ‰€æœ‰
                    </div>
                </div>

            </div>
        </div>
    </div>

</div> <!-- /container -->
</body>
</html>
```



#### 2.6.3 è¿½åŠ å¤„ç† `ç¡®è®¤ä¿¡æ¯è¡¨å•æäº¤` çš„ä»£ç 

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662029120299-9e8f1a6e-5d34-4dfe-9706-bc13c3d58b59.png)

```java
    /**
     * ä¿å­˜ä¼šå‘˜å‘èµ·çš„ä¼—ç­¹ä¿¡æ¯
     *
     * @param memberConfirmInfoVO
     * @param session
     * @param modelMap
     * @return
     */
    @RequestMapping("/create/confirm")
    public String saveConfirm(
            MemberConfirmInfoVO memberConfirmInfoVO,
            HttpSession session,
            ModelMap modelMap
    ) {
        // ä» Session åŸŸè¯»å–ä¹‹å‰ä¸´æ—¶å­˜å‚¨çš„ ProjectVO å¯¹è±¡
        ProjectVO projectVO = (ProjectVO) session.getAttribute(CrowdConstant.ATTR_NAME_TEMPLE_PROJECT);

        // åˆ¤æ–­ projectVO
        if (projectVO == null) {
            // å¦‚æœä¸ºç©ºè·³è½¬åˆ°ç¬¬ä¸€æ­¥
            // MESSAGE_DETAIL_CONFIRM = "ç¡®è®¤ä¿¡æ¯å¤±è´¥! è¯·å…ˆå¡«å†™é¡¹ç›®åŠå‘èµ·äººä¿¡æ¯"
            modelMap.addAttribute(CrowdConstant.ATTR_NAME_MESSAGE, CrowdConstant.MESSAGE_DETAIL_CONFIRM);
            return "project-launch";
        }

        // å°†ç¡®è®¤ä¿¡æ¯æ•°æ®å­˜å‚¨åˆ° ProjectVO å¯¹è±¡ä¸­
        projectVO.setMemberConfirmInfoVO(memberConfirmInfoVO);

        // ä» session ä¸­è¯»å–å½“å‰ç™»å½•çš„ç”¨æˆ·
        MemberLoginVO memberLoginVO = (MemberLoginVO) session.getAttribute(CrowdConstant.ATTR_NAME_LOGIN_MEMBER);
        Integer memberId = memberLoginVO.getId();

        // è°ƒç”¨è¿œç¨‹æ–¹æ³•ä¿å­˜æ•°æ®
        ResultEntity<String> saveResultEntity = mySQLRemoteService.saveProjectVORemote(projectVO, memberId);
        // åˆ¤æ–­è¿œç¨‹çš„ä¿å­˜æ“ä½œæ˜¯å¦æˆåŠŸ
        if (ResultEntity.FAILED.equals(saveResultEntity.getResult())) {
            modelMap.addAttribute(CrowdConstant.ATTR_NAME_MESSAGE, saveResultEntity.getMessage());
            return "project-confirm";
        }

        // å°†ä¸´æ—¶çš„ ProjectVO å¯¹è±¡ä» session ä¸­ç§»é™¤
        session.removeAttribute(CrowdConstant.ATTR_NAME_TEMPLE_PROJECT);

        // è·³è½¬åˆ°å®Œæˆé¡µé¢
        return "redirect:" + CrowdConstant.ZUUL_PATH_VALUE + "/project/create/success";
    }
```



#### 2.6.4 è¿½åŠ è·³è½¬å®Œæˆé¡µé¢çš„ä»£ç 

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662029242099-4cdfa5cb-74ec-4681-bd02-063c18d3affb.png)

```java
registry.addViewController("/create/success").setViewName("project-success");
```



#### 2.6.5 æ–°å»ºå®Œæˆé¡µé¢ `project-success.html`

```html
<!DOCTYPE html>
<html lang="zh-CN" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <base th:href="@{/}"/>
    <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <link rel="stylesheet" href="css/theme.css">
    <script src="jquery/jquery-2.1.1.min.js"></script>
    <script src="bootstrap/js/bootstrap.min.js"></script>
    <script src="script/docs.min.js"></script>
    <script src="script/back-to-top.js"></script>
    <script>
        $(function () {
            $('#myTab a').click(function (e) {
                e.preventDefault()
                $(this).tab('show')
            })
        })
    </script>
    <style>
        #footer {
            padding: 15px 0;
            background: #fff;
            border-top: 1px solid #ddd;
            text-align: center;
        }

        #topcontrol {
            color: #fff;
            z-index: 99;
            width: 30px;
            height: 30px;
            font-size: 20px;
            background: #222;
            position: relative;
            right: 14px !important;
            bottom: 11px !important;
            border-radius: 3px !important;
        }

        #topcontrol:after {
            /*top: -2px;*/
            left: 8.5px;
            content: "\f106";
            position: absolute;
            text-align: center;
            font-family: FontAwesome;
        }

        #topcontrol:hover {
            color: #fff;
            background: #18ba9b;
            -webkit-transition: all 0.3s ease-in-out;
            -moz-transition: all 0.3s ease-in-out;
            -o-transition: all 0.3s ease-in-out;
            transition: all 0.3s ease-in-out;
        }

        .label-type, .label-status, .label-order {
            background-color: #fff;
            color: #f60;
            padding: 5px;
            border: 1px #f60 solid;
        }

        #typeList :not(:first-child) {
            margin-top: 20px;
        }

        .label-txt {
            margin: 10px 10px;
            border: 1px solid #ddd;
            padding: 4px;
            font-size: 14px;
        }

        .panel {
            border-radius: 0;
        }

        .progress-bar-default {
            background-color: #ddd;
        }
    </style>
</head>
<body>
<div class="navbar-wrapper">
    <div class="container">
        <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand" href="index.html" style="font-size: 32px;">å°šç­¹ç½‘-åˆ›æ„äº§å“ä¼—ç­¹å¹³å°</a>
                </div>
                <div id="navbar" class="navbar-collapse collapse"
                     style="float: right;">
                    <ul class="nav navbar-nav">
                        <li class="dropdown"><a href="#" class="dropdown-toggle"
                                                data-toggle="dropdown"><i class="glyphicon glyphicon-user"></i>
                            [[${session.loginMember.username}]]<span class="caret"></span></a>
                            <ul class="dropdown-menu" role="menu">
                                <li><a href="member.html"><i
                                        class="glyphicon glyphicon-scale"></i> ä¼šå‘˜ä¸­å¿ƒ</a></li>
                                <li><a href="#"><i class="glyphicon glyphicon-comment"></i>
                                    æ¶ˆæ¯</a></li>
                                <li class="divider"></li>
                                <li><a th:href="@{/auth/member/logout}"><i
                                        class="glyphicon glyphicon-off"></i> é€€å‡ºç³»ç»Ÿ</a></li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    </div>
</div>

<div class="container theme-showcase" role="main">

    <div class="container">
        <div class="row clearfix">
            <div class="col-md-12 column">
                <nav class="navbar navbar-default" role="navigation">
                    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                        <ul class="nav navbar-nav">
                            <li>
                                <a rel="nofollow" href="index.html"><i class="glyphicon glyphicon-home"></i> ä¼—ç­¹é¦–é¡µ</a>
                            </li>
                            <li>
                                <a rel="nofollow" href="projects.html"><i class="glyphicon glyphicon-th-large"></i> é¡¹ç›®æ€»è§ˆ</a>
                            </li>
                            <li class="active">
                                <a rel="nofollow" href="javascript:;"><i class="glyphicon glyphicon-edit"></i> å‘èµ·é¡¹ç›®</a>
                            </li>
                            <li>
                                <a rel="nofollow" href="minecrowdfunding.html"><i class="glyphicon glyphicon-user"></i>
                                    æˆ‘çš„ä¼—ç­¹</a>
                            </li>
                        </ul>
                    </div>
                </nav>
            </div>
        </div>
    </div>


    <div class="container">
        <div class="row clearfix">
            <div class="col-md-12 column">
                <div class="panel panel-default">
                    <div class="panel-heading" style="text-align:center;">
                        <div class="container-fluid">
                            <div class="row clearfix">
                                <div class="col-md-3 column">
                                    <div class="progress"
                                         style="height:50px;border-radius:0;    position: absolute;width: 75%;right:49px;">
                                        <div class="progress-bar progress-bar-default" role="progressbar"
                                             aria-valuenow="60" aria-valuemin="0" aria-valuemax="100"
                                             style="width: 100%;height:50px;">
                                            <div style="font-size:16px;margin-top:15px;">1. é¡¹ç›®åŠå‘èµ·äººä¿¡æ¯</div>
                                        </div>
                                    </div>
                                    <div style="right: 0;border:10px solid #ddd;border-left-color: #88b7d5;border-width: 25px;position: absolute;
                                             border-left-color: rgba(221, 221, 221, 1);
                                             border-top-color: rgba(221, 221, 221, 0);
                                             border-bottom-color: rgba(221, 221, 221, 0);
                                             border-right-color: rgba(221, 221, 221, 0);
                                        ">
                                    </div>
                                </div>
                                <div class="col-md-3 column">
                                    <div class="progress"
                                         style="height:50px;border-radius:0;position: absolute;width: 75%;right:49px;">
                                        <div class="progress-bar progress-bar-default" role="progressbar"
                                             aria-valuenow="60" aria-valuemin="0" aria-valuemax="100"
                                             style="width: 100%;height:50px;">
                                            <div style="font-size:16px;margin-top:15px;">2. å›æŠ¥è®¾ç½®</div>
                                        </div>
                                    </div>
                                    <div style="right: 0;border:10px solid #ddd;border-left-color: #88b7d5;border-width: 25px;position: absolute;
                                             border-left-color: rgba(221, 221, 221, 1);
                                             border-top-color: rgba(221, 221, 221, 0);
                                             border-bottom-color: rgba(221, 221, 221, 0);
                                             border-right-color: rgba(221, 221, 221, 0);
                                        ">
                                    </div>
                                </div>
                                <div class="col-md-3 column">
                                    <div class="progress"
                                         style="height:50px;border-radius:0;position: absolute;width: 75%;right:49px;">
                                        <div class="progress-bar progress-bar-default" role="progressbar"
                                             aria-valuenow="60" aria-valuemin="0" aria-valuemax="100"
                                             style="width: 100%;height:50px;">
                                            <div style="font-size:16px;margin-top:15px;">3. ç¡®è®¤ä¿¡æ¯</div>
                                        </div>
                                    </div>
                                    <div style="right: 0;border:10px solid #ddd;border-left-color: #88b7d5;border-width: 25px;position: absolute;
                                              border-left-color: rgba(221, 221, 221, 1);
                                             border-top-color: rgba(221, 221, 221, 0);
                                             border-bottom-color: rgba(221, 221, 221, 0);
                                             border-right-color: rgba(221, 221, 221, 0);
                                        ">
                                    </div>
                                </div>
                                <div class="col-md-3 column">
                                    <div class="progress" style="height:50px;border-radius:0;">
                                        <div class="progress-bar progress-bar-success" role="progressbar"
                                             aria-valuenow="60" aria-valuemin="0" aria-valuemax="100"
                                             style="width: 100%;height:50px;">
                                            <div style="font-size:16px;margin-top:15px;">4. å®Œæˆ</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="panel-body">

                        <div class="container-fluid">
                            <div class="row clearfix">
                                <div class="col-md-12 column">
                                    <blockquote style="border-left: 5px solid #f60;color:#f60;padding: 0 0 0 20px;">
                                        <b>
                                            å®Œæˆ
                                        </b>
                                    </blockquote>
                                </div>
                                <div class="col-md-12 column">


                                    <div class="row clearfix">
                                        <div class="col-md-12 column">
                                            <div class="panel panel-default">
                                                <div class="panel-body" style="padding:60px;">
                                                    <i class="glyphicon glyphicon-ok"
                                                       style="color:green;font-size:40px;"></i> <span
                                                        style="margin-left:20px;">ä½ å‘èµ·çš„ä¼—ç­¹é¡¹ç›®ä¿¡æ¯å·²ç»æäº¤å®Œæ¯•ï¼Œæˆ‘ä»¬ä¼šåœ¨5~7ä¸ªå·¥ä½œæ—¥å†…å¯¹é¡¹ç›®è¿›è¡Œå®¡æ ¸ï¼Œè¯·è€å¿ƒç­‰å€™</span>
                                                    <p style="margin-left:60px;">ä½ èƒ½åœ¨ä¼šå‘˜ä¸­å¿ƒ-æˆ‘çš„ä¼—ç­¹- å‘èµ·çš„é¡¹ç›®ä¸­æŸ¥çœ‹</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="panel-footer" style="text-align:center;">
                        <script type="text/javascript">
                            $(function () {
                                $("#toMyCrowd").click(function () {
                                    window.location.href = '[[${session.zuulPath}]]/member/my/crowd';
                                })
                            })
                        </script>
                        <button type="button" class="btn  btn-warning btn-lg"
                                id="toMyCrowd">æˆ‘çš„ä¼—ç­¹
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <div class="container" style="margin-top:20px;">
        <div class="row clearfix">
            <div class="col-md-12 column">
                <div id="footer">
                    <div class="footerNav">
                        <a rel="nofollow" href="http://www.atguigu.com">å…³äºæˆ‘ä»¬</a> | <a rel="nofollow"
                                                                                      href="http://www.atguigu.com">æœåŠ¡æ¡æ¬¾</a>
                        | <a rel="nofollow" href="http://www.atguigu.com">å…è´£å£°æ˜</a> | <a rel="nofollow"
                                                                                        href="http://www.atguigu.com">ç½‘ç«™åœ°å›¾</a>
                        | <a rel="nofollow" href="http://www.atguigu.com">è”ç³»æˆ‘ä»¬</a>
                    </div>
                    <div class="copyRight">
                        Copyright ?2017-2017atguigu.com ç‰ˆæƒæ‰€æœ‰
                    </div>
                </div>

            </div>
        </div>
    </div>

</div> <!-- /container -->

</body>
</html>
```



### 2.7 ä¿å­˜ä¼šå‘˜å‘èµ·çš„ä¼—ç­¹ä¿¡æ¯

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662029874401-11a46787-659f-494d-b5b8-1d6c4b8cf463.png)



#### 2.7.1 è¿½åŠ  `mysql çš„ Feign æ¥å£` ä»£ç ã€`api` å·¥ç¨‹ã€‘

- å®ä½“ç±»ä¸€å®šè¦åŠ  `@RequestBody`

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662029387821-25c5b3cc-5a52-487c-8289-7fa6a88b1f0b.png)

```java
    /**
     * ä¿å­˜ä¼šå‘˜å‘èµ·çš„ä¼—ç­¹ä¿¡æ¯
     *
     * @param projectVO ä¼—ç­¹ä¿¡æ¯
     * @param memberId  ä¼šå‘˜ id
     * @return
     */
    @RequestMapping("/save/project/vo/remote")
    ResultEntity<String> saveProjectVORemote(@RequestBody ProjectVO projectVO, @RequestParam("memberId") Integer memberId);
```



#### 2.7.2 ä¿å­˜ä¼šå‘˜å‘èµ·çš„ä¼—ç­¹ä¿¡æ¯ ã€`mysql` å·¥ç¨‹ã€‘

- `handler`

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662032361779-d274a66b-ad86-4895-a3c7-8cdba8435b5d.png)

```java
package com.atguigu.crowd.handler;

import com.atguigu.crowd.entity.vo.ProjectVO;
import com.atguigu.crowd.service.api.ProjectService;
import com.atguigu.crowd.util.ResultEntity;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RestController;

/**
 * @author é™ˆæ±Ÿæ—
 * @date 2022/8/31 11:49
 */
@RestController
public class ProjectProviderHandler {

    @Autowired
    private ProjectService projectService;

    /**
     * ä¿å­˜ä¼šå‘˜å‘èµ·çš„ä¼—ç­¹ä¿¡æ¯
     *
     * @param projectVO ä¼—ç­¹ä¿¡æ¯
     * @param memberId ä¼šå‘˜ id
     * @return
     */
    @RequestMapping("/save/project/vo/remote")
    public ResultEntity<String> saveProjectVORemote(@RequestBody ProjectVO projectVO, @RequestParam("memberId") Integer memberId) {
        try {
            projectService.saveProject(projectVO, memberId);
            return ResultEntity.successWithoutData();
        } catch (Exception e) {
            e.printStackTrace();
            return ResultEntity.failed(e.getMessage());
        }
    }

}
```



- `service`

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662032390044-ccafda11-9428-413c-8576-42ca993fd02c.png)

```java
package com.atguigu.crowd.service.api;

import com.atguigu.crowd.entity.vo.ProjectVO;

/**
 * @author é™ˆæ±Ÿæ—
 * @date 2022/8/31 11:49
 */
public interface ProjectService {

    /**
     * ä¿å­˜ä¼šå‘˜å‘èµ·çš„ä¼—ç­¹ä¿¡æ¯
     *
     * @param projectVO ä¼—ç­¹ä¿¡æ¯
     * @param memberId ä¼šå‘˜ id
     * @return
     */
    void saveProject(ProjectVO projectVO, Integer memberId);

}
```



- `serviceimpl`

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662032404320-3323940e-dd39-4e4e-ac53-8fc4e84f729e.png)

```java
package com.atguigu.crowd.service.impl;

import com.atguigu.crowd.entity.po.MemberConfirmInfoPO;
import com.atguigu.crowd.entity.po.MemberLaunchInfoPO;
import com.atguigu.crowd.entity.po.ProjectPO;
import com.atguigu.crowd.entity.po.ReturnPO;
import com.atguigu.crowd.entity.vo.MemberConfirmInfoVO;
import com.atguigu.crowd.entity.vo.MemberLauchInfoVO;
import com.atguigu.crowd.entity.vo.ProjectVO;
import com.atguigu.crowd.entity.vo.ReturnVO;
import com.atguigu.crowd.mapper.*;
import com.atguigu.crowd.service.api.ProjectService;
import org.springframework.beans.BeanUtils;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Propagation;
import org.springframework.transaction.annotation.Transactional;

import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Date;
import java.util.List;

/**
 * @author é™ˆæ±Ÿæ—
 * @date 2022/8/31 11:49
 */
@Transactional(readOnly = true)
@Service
public class ProjectServiceImpl implements ProjectService {

    @Autowired
    private ProjectPOMapper projectPOMapper;

    @Autowired
    private ProjectItemPicPOMapper projectItemPicPOMapper;

    @Autowired
    private MemberLaunchInfoPOMapper memberLaunchInfoPOMapper;

    @Autowired
    private MemberConfirmInfoPOMapper memberConfirmInfoPOMapper;

    @Autowired
    private ReturnPOMapper returnPOMapper;

    @Transactional(
            propagation = Propagation.REQUIRES_NEW, rollbackFor = Exception.class
    )
    @Override
    public void saveProject(ProjectVO projectVO, Integer memberId) {
        // ä¸€ã€ä¿å­˜ ProjectPO å¯¹è±¡
        // 1. åˆ›å»º ProjectPO å¯¹è±¡
        ProjectPO projectPO = new ProjectPO();

        // 2. æŠŠ projectVO ä¸­çš„å±æ€§å¤åˆ¶åˆ° ProjectPO ä¸­
        BeanUtils.copyProperties(projectVO, projectPO);

        // æŠŠ memberId å­˜å‚¨åˆ° projectPO ä¸­
        projectPO.setMemberid(memberId);
        // å­˜å‚¨åˆ›å»ºæ—¶é—´
        String createdate = new SimpleDateFormat("yyyy-MM-dd").format(new Date());
        projectPO.setCreatedate(createdate);
        // status=0 å³å°†å¼€å§‹
        projectPO.setStatus(0);

        // 3. ä¿å­˜ projectPO
        // 3.1 ä¸ºäº†èƒ½å¤Ÿè·å–åˆ° projectPO ä¿å­˜åçš„ä¸»é”®, éœ€è¦åˆ° ProjectPOMapper.xml æ–‡ä»¶ä¸­è¿›è¡Œç›¸å…³çš„è®¾ç½®
        // 3.1.1 è¿½åŠ  useGeneratedKeys="true" keyProperty="id"
        // - <insert id="insertSelective" useGeneratedKeys="true" keyProperty="id"
        projectPOMapper.insertSelective(projectPO);

        // 4. è·å– projectPO çš„ id
        Integer projectId = projectPO.getId();

        // äºŒã€ä¿å­˜é¡¹ç›®åˆ†ç±»çš„å…³è”å…³ç³»ä¿¡æ¯
        // 1. ä» ProjectVO å¯¹è±¡è·å– typeIdList
        List<Integer> typeIdList = projectVO.getTypeIdList();
        projectPOMapper.insertTypeRelationship(typeIdList, projectId);

        // ä¸‰ã€ä¿å­˜é¡¹ç›®æ ‡ç­¾å…³è”å…³ç³»ä¿¡æ¯
        List<Integer> tagIdList = projectVO.getTagIdList();
        projectPOMapper.insertTagRelationship(tagIdList, projectId);

        // å››ã€ä¿å­˜é¡¹ç›®ä¸­è¯¦æƒ…å›¾ç‰‡è·¯å¾„ä¿¡æ¯
        List<String> detailPicturePathList = projectVO.getDetailPicturePathList();
        projectItemPicPOMapper.insertPathList(detailPicturePathList, projectId);

        // äº”ã€é¡¹ç›®å‘èµ·äººä¿¡æ¯
        MemberLauchInfoVO memberLauchInfoVO = projectVO.getMemberLauchInfoVO();
        MemberLaunchInfoPO memberLaunchInfoPO = new MemberLaunchInfoPO();
        BeanUtils.copyProperties(memberLauchInfoVO, memberLaunchInfoPO);
        memberLaunchInfoPO.setMemberid(memberId);
        memberLaunchInfoPOMapper.insertSelective(memberLaunchInfoPO);

        // å…­ã€ä¿å­˜é¡¹ç›®å›æŠ¥ä¿¡æ¯
        List<ReturnVO> returnVOList = projectVO.getReturnVOList();
        List<ReturnPO> returnPOList = new ArrayList<>();
        for (ReturnVO returnVO : returnVOList) {
            ReturnPO returnPO = new ReturnPO();
            BeanUtils.copyProperties(returnVO, returnPO);
            returnPOList.add(returnPO);
        }

        returnPOMapper.insertReturnPOBatch(returnPOList, projectId);

        // ä¸ƒã€ä¿å­˜é¡¹ç›®ç¡®è®¤ä¿¡æ¯
        MemberConfirmInfoVO memberConfirmInfoVO = projectVO.getMemberConfirmInfoVO();
        MemberConfirmInfoPO memberConfirmInfoPO = new MemberConfirmInfoPO();
        BeanUtils.copyProperties(memberConfirmInfoVO, memberConfirmInfoPO);
        memberConfirmInfoPO.setMemberid(memberId);
        memberConfirmInfoPOMapper.insert(memberConfirmInfoPO);
    }

}
```



- è¿½åŠ ä»£ç  `ProjectPOMapper`

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662032418420-db72a50b-121b-4ff6-bf90-d1bddc09ee8e.png)

```java
    /**
     * ä¿å­˜ é¡¹ç›®åˆ†ç±»ä¸­é—´è¡¨ æ•°æ®
     *
     * @param typeIdList
     * @param projectId
     */
    void insertTypeRelationship(
            @Param("typeIdList") List<Integer> typeIdList,
            @Param("projectId") Integer projectId
    );

    /**
     * ä¿å­˜ é¡¹ç›®æ ‡ç­¾ä¸­é—´è¡¨ æ•°æ®
     *
     * @param tagIdList
     * @param projectId
     */
    void insertTagRelationship(
            @Param("tagIdList") List<Integer> tagIdList,
            @Param("projectId") Integer projectId
    );
```



- è¿½åŠ ä»£ç  `ProjectPOMapper.xml`

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662032454179-38c0a261-b9d3-47ac-b975-1c594978ea84.png)

```xml
  <!--
    void insertTypeRelationship(
         @Param("typeIdList") List<Integer> typeIdList,
         @Param("projectId") Integer projectId
    );
  -->
  <insert id="insertTypeRelationship">
    insert into t_project_type (projectid, typeid) values
    <foreach collection="typeIdList" item="typeId" separator=",">
       (#{projectId}, #{typeId})
    </foreach>
  </insert>

  <!--
    void insertTagRelationship(
         @Param("tagIdList") List<Integer> tagIdList,
         @Param("projectId") Integer projectId
    );
  -->
  <insert id="insertTagRelationship">
    insert into t_project_tag (projectid, tagid) values
    <foreach collection="tagIdList" item="tagId" separator=",">
      (#{projectId}, #{tagId})
    </foreach>
  </insert>
```



- è¿½åŠ ä»£ç  `ProjectItemPicPOMapper`

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662035245026-b8176d55-87dc-484e-9d35-04212d992942.png)

```java
    /**
     * ä¿å­˜ é¡¹ç›®è¡¨é¡¹ç›®è¯¦æƒ…å›¾ç‰‡è¡¨ æ•°æ®
     *
     * @param detailPicturePathList
     * @param projectId
     */
    void insertPathList(
            @Param("detailPicturePathList") List<String> detailPicturePathList,
            @Param("projectId") Integer projectId
    );
```



- è¿½åŠ ä»£ç  `ProjectItemPicPOMapper.xml`

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662035288065-1097a76f-66d9-47cd-bfe3-12879519a427.png)

```xml
    <!--
        void insertPathList(
              @Param("detailPicturePathList") List<String> detailPicturePathList,
              @Param("projectId") Integer projectId
      );
    -->
    <insert id="insertPathList">
        insert into t_project_item_pic (item_pic_path ,projectid) values
        <foreach collection="detailPicturePathList" item="detailPicturePath" separator=",">
            (#{detailPicturePath}, #{projectId})
        </foreach>
    </insert>
```



- è¿½åŠ ä»£ç  `ReturnPOMapper`

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662035594047-979b8a5b-af05-429c-93f7-050f8f5307b2.png)

```java
    /**
     * ä¿å­˜ å›æŠ¥ä¿¡æ¯è¡¨ æ•°æ®
     *
     * @param returnPOList
     * @param projectId
     */
    void insertReturnPOBatch(
            @Param("returnPOList") List<ReturnPO> returnPOList,
            @Param("projectId") Integer projectId
    );
```



- è¿½åŠ ä»£ç  `ReturnPOMapper.xml`

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662035517426-a583b1de-af9b-49f8-9c2a-bbce193a55b0.png)

```xml
    <!--
        void insertReturnPOBatch(
              @Param("returnPOList") List<ReturnPO> returnPOList,
              @Param("projectId") Integer projectId
      );
    -->
    <insert id="insertReturnPOBatch">
        insert into t_return (
        projectid,
        type,
        supportmoney,
        content,
        count,
        signalpurchase,
        purchase,
        freight,
        invoice,
        returndate,
        describ_pic_path) values
        <foreach collection="returnPOList" item="returnPO" separator=",">
            (
            #{projectId},
            #{returnPO.type},
            #{returnPO.supportmoney},
            #{returnPO.content},
            #{returnPO.count},
            #{returnPO.signalpurchase},
            #{returnPO.purchase},
            #{returnPO.freight},
            #{returnPO.invoice},
            #{returnPO.returndate},
            #{returnPO.describPicPath}
            )
        </foreach>
    </insert>
```

# äºŒåä¸€ å‰å°-é¦–é¡µæ˜¾ç¤ºé¡¹ç›®

```
git checkout -b 21.0.0_show_project
```

![img](https://cdn.nlark.com/yuque/0/2022/jpeg/12811585/1662398142885-802924ba-8cb7-4a81-943e-8864a80d408f.jpeg)



## 1. é¦–é¡µæ˜¾ç¤ºé¡¹ç›®

### 1.1 ç›®æ ‡

- åœ¨é¦–é¡µä¸ŠåŠ è½½çœŸå®ä¿å­˜åˆ°æ•°æ®åº“çš„é¡¹ç›®æ•°æ®, æŒ‰åˆ†ç±»æ˜¾ç¤º

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662126573723-a2bef104-c20d-4ab7-b42f-305e54ed86a7.png)



### 1.2 æ€è·¯

![img](https://cdn.nlark.com/yuque/0/2022/jpeg/12811585/1662127706792-3bce335e-7868-4c90-a9a1-e71f5f34d4fa.jpeg)



### 1.3 æ•°æ®åº“

#### 1.3.1 åˆ†ç±»è¡¨æ•°æ®

```plsql
SET NAMES utf8mb4;
SET FOREIGN_KEY_CHECKS = 0;

-- ----------------------------
-- Table structure for t_type
-- ----------------------------
DROP TABLE IF EXISTS `t_type`;
CREATE TABLE `t_type` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `name` varchar(255) DEFAULT NULL COMMENT 'åˆ†ç±»åç§°',
  `remark` varchar(255) DEFAULT NULL COMMENT 'åˆ†ç±»è¯´æ˜',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=5 DEFAULT CHARSET=utf8 COMMENT='åˆ†ç±»è¡¨';

-- ----------------------------
-- Records of t_type
-- ----------------------------
BEGIN;
INSERT INTO `t_type` (`id`, `name`, `remark`) VALUES (1, 'ç§‘æŠ€', 'å¼€å¯ç§‘æŠ€æœªæ¥');
INSERT INTO `t_type` (`id`, `name`, `remark`) VALUES (2, 'è®¾è®¡', 'åˆ›å»ºæ”¹å˜æœªæ¥');
INSERT INTO `t_type` (`id`, `name`, `remark`) VALUES (3, 'å…¬ç›Š', 'æ±‡é›†ç‚¹ç‚¹çˆ±å¿ƒ');
INSERT INTO `t_type` (`id`, `name`, `remark`) VALUES (4, 'å†œä¸š', 'ç½‘ç»œå¤©ä¸‹è‚¥ç¾');
COMMIT;

SET FOREIGN_KEY_CHECKS = 1;
```



#### 1.3.2 æ ‡ç­¾è¡¨æ•°æ®

```plsql
SET NAMES utf8mb4;
SET FOREIGN_KEY_CHECKS = 0;

-- ----------------------------
-- Table structure for t_tag
-- ----------------------------
DROP TABLE IF EXISTS `t_tag`;
CREATE TABLE `t_tag` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `pid` int(11) DEFAULT NULL,
  `name` varchar(255) DEFAULT NULL COMMENT 'æ ‡ç­¾åç§°',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=11 DEFAULT CHARSET=utf8 COMMENT='æ ‡ç­¾è¡¨';

-- ----------------------------
-- Records of t_tag
-- ----------------------------
BEGIN;
INSERT INTO `t_tag` (`id`, `pid`, `name`) VALUES (1, NULL, 'æ‰‹æœº');
INSERT INTO `t_tag` (`id`, `pid`, `name`) VALUES (2, NULL, 'æ•°ç ');
INSERT INTO `t_tag` (`id`, `pid`, `name`) VALUES (3, NULL, 'ç”µè„‘');
INSERT INTO `t_tag` (`id`, `pid`, `name`) VALUES (4, 1, 'å¤§å±');
INSERT INTO `t_tag` (`id`, `pid`, `name`) VALUES (5, 1, 'ç¾é¢œ');
INSERT INTO `t_tag` (`id`, `pid`, `name`) VALUES (6, 1, 'ç»­èˆª');
INSERT INTO `t_tag` (`id`, `pid`, `name`) VALUES (7, 2, 'é«˜è§£æåº¦');
INSERT INTO `t_tag` (`id`, `pid`, `name`) VALUES (8, 2, 'é«˜æ¸…');
INSERT INTO `t_tag` (`id`, `pid`, `name`) VALUES (9, 3, 'å¤§å†…å­˜');
INSERT INTO `t_tag` (`id`, `pid`, `name`) VALUES (10, 3, 'å›ºæ€');
COMMIT;

SET FOREIGN_KEY_CHECKS = 1;
```



#### 1.3.3 æ•°æ®åº“å¤‡ä»½

```plsql
SET NAMES utf8mb4;
SET FOREIGN_KEY_CHECKS = 0;

-- ----------------------------
-- Table structure for inner_admin_role
-- ----------------------------
DROP TABLE IF EXISTS `inner_admin_role`;
CREATE TABLE `inner_admin_role` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `admin_id` int(11) DEFAULT NULL,
  `role_id` int(11) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=6 DEFAULT CHARSET=utf8 COMMENT='ç”¨æˆ·å’Œæƒé™ä¸­é—´è¡¨';

-- ----------------------------
-- Records of inner_admin_role
-- ----------------------------
BEGIN;
INSERT INTO `inner_admin_role` (`id`, `admin_id`, `role_id`) VALUES (1, 2, 2);
INSERT INTO `inner_admin_role` (`id`, `admin_id`, `role_id`) VALUES (2, 2, 4);
INSERT INTO `inner_admin_role` (`id`, `admin_id`, `role_id`) VALUES (3, 1, 1);
INSERT INTO `inner_admin_role` (`id`, `admin_id`, `role_id`) VALUES (4, 1, 3);
INSERT INTO `inner_admin_role` (`id`, `admin_id`, `role_id`) VALUES (5, 7, 5);
COMMIT;

-- ----------------------------
-- Table structure for inner_role_auth
-- ----------------------------
DROP TABLE IF EXISTS `inner_role_auth`;
CREATE TABLE `inner_role_auth` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `role_id` int(11) DEFAULT NULL,
  `auth_id` int(11) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=4 DEFAULT CHARSET=utf8 COMMENT='è§’è‰²å’Œæƒé™ä¸­é—´è¡¨';

-- ----------------------------
-- Records of inner_role_auth
-- ----------------------------
BEGIN;
INSERT INTO `inner_role_auth` (`id`, `role_id`, `auth_id`) VALUES (1, 3, 4);
INSERT INTO `inner_role_auth` (`id`, `role_id`, `auth_id`) VALUES (2, 4, 6);
INSERT INTO `inner_role_auth` (`id`, `role_id`, `auth_id`) VALUES (3, 4, 3);
COMMIT;

-- ----------------------------
-- Table structure for t_admin
-- ----------------------------
DROP TABLE IF EXISTS `t_admin`;
CREATE TABLE `t_admin` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `login_acct` varchar(255) NOT NULL,
  `user_pswd` varchar(255) NOT NULL,
  `user_name` varchar(255) NOT NULL,
  `email` varchar(255) NOT NULL,
  `create_time` datetime DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=8 DEFAULT CHARSET=utf8;

-- ----------------------------
-- Records of t_admin
-- ----------------------------
BEGIN;
INSERT INTO `t_admin` (`id`, `login_acct`, `user_pswd`, `user_name`, `email`, `create_time`) VALUES (1, 'adminOperator', '$2a$10$YlFApwsuOTRxvVlzIKJ1IO20wPftE57QovWuBsKoh2NEYZWKLT6jK', 'ç»ç†', '1@qq.com', '2022-08-06 15:50:25');
INSERT INTO `t_admin` (`id`, `login_acct`, `user_pswd`, `user_name`, `email`, `create_time`) VALUES (2, 'roleOperator', '$2a$10$YlFApwsuOTRxvVlzIKJ1IO20wPftE57QovWuBsKoh2NEYZWKLT6jK', 'éƒ¨é•¿', '2@qq.com', '2022-08-06 15:50:25');
INSERT INTO `t_admin` (`id`, `login_acct`, `user_pswd`, `user_name`, `email`, `create_time`) VALUES (3, 'admin01', '$2a$10$YlFApwsuOTRxvVlzIKJ1IO20wPftE57QovWuBsKoh2NEYZWKLT6jK', 'è·¯äººç”²', '3@qq.com', '2022-08-06 15:50:25');
INSERT INTO `t_admin` (`id`, `login_acct`, `user_pswd`, `user_name`, `email`, `create_time`) VALUES (4, 'admin02', '2a$10$YlFApwsuOTRxvVlzIKJ1IO20wPftE57QovWuBsKoh2NEYZWKLT6jK', 'è·¯äººç”²', '3@qq.com', '2022-08-06 15:50:25');
INSERT INTO `t_admin` (`id`, `login_acct`, `user_pswd`, `user_name`, `email`, `create_time`) VALUES (5, 'admin03', '$2a$10$YlFApwsuOTRxvVlzIKJ1IO20wPftE57QovWuBsKoh2NEYZWKLT6jK', 'è·¯äººç”²', '3@qq.com', '2022-08-06 15:50:25');
INSERT INTO `t_admin` (`id`, `login_acct`, `user_pswd`, `user_name`, `email`, `create_time`) VALUES (6, 'CS3', '$2a$10$elqat0c.KxAlnRV58VOBfuCMboRRNnKG4Qs1bcc4qJDAQTqPLDRTi', 'æµ‹è¯•3', '1912623646@qq.com', '2022-08-08 01:46:56');
INSERT INTO `t_admin` (`id`, `login_acct`, `user_pswd`, `user_name`, `email`, `create_time`) VALUES (7, 'root', '$2a$10$YlFApwsuOTRxvVlzIKJ1IO20wPftE57QovWuBsKoh2NEYZWKLT6jK', 'è¶…çº§ç®¡ç†å‘˜', '0@qq.com', '2022-08-08 03:10:44');
COMMIT;

-- ----------------------------
-- Table structure for t_auth
-- ----------------------------
DROP TABLE IF EXISTS `t_auth`;
CREATE TABLE `t_auth` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `name` varchar(200) DEFAULT NULL,
  `title` varchar(200) DEFAULT NULL,
  `category_id` int(11) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=9 DEFAULT CHARSET=utf8 COMMENT='æƒé™è¡¨';

-- ----------------------------
-- Records of t_auth
-- ----------------------------
BEGIN;
INSERT INTO `t_auth` (`id`, `name`, `title`, `category_id`) VALUES (1, '', 'ç”¨æˆ·æ¨¡å—', NULL);
INSERT INTO `t_auth` (`id`, `name`, `title`, `category_id`) VALUES (2, 'user:delete', 'åˆ é™¤', 1);
INSERT INTO `t_auth` (`id`, `name`, `title`, `category_id`) VALUES (3, 'user:get', 'æŸ¥è¯¢', 1);
INSERT INTO `t_auth` (`id`, `name`, `title`, `category_id`) VALUES (4, 'user:save', 'ä¿å­˜', 1);
INSERT INTO `t_auth` (`id`, `name`, `title`, `category_id`) VALUES (5, '', 'è§’è‰²æ¨¡å—', NULL);
INSERT INTO `t_auth` (`id`, `name`, `title`, `category_id`) VALUES (6, 'role:delete', 'åˆ é™¤', 4);
INSERT INTO `t_auth` (`id`, `name`, `title`, `category_id`) VALUES (7, 'role:get', 'æŸ¥è¯¢', 4);
INSERT INTO `t_auth` (`id`, `name`, `title`, `category_id`) VALUES (8, 'role:save', 'ä¿å­˜', 4);
COMMIT;

-- ----------------------------
-- Table structure for t_member
-- ----------------------------
DROP TABLE IF EXISTS `t_member`;
CREATE TABLE `t_member` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `loginacct` varchar(255) NOT NULL,
  `userpswd` varchar(255) NOT NULL,
  `username` varchar(255) DEFAULT NULL,
  `email` varchar(255) DEFAULT NULL,
  `authstatus` int(4) DEFAULT NULL COMMENT 'å®åè®¤è¯çŠ¶æ€ [{0: æœªå®åè®¤è¯}, {1: å®åè®¤è¯ç”³è¯·ä¸­}, {2: å·²å®åè®¤è¯}]',
  `usertype` int(4) DEFAULT NULL COMMENT '[{0: ä¸ªäºº}, {1: ä¼ä¸š}]',
  `realname` varchar(255) DEFAULT NULL COMMENT 'çœŸå®å§“å',
  `cardnum` varchar(255) DEFAULT NULL COMMENT 'å¡å·',
  `accttype` int(4) DEFAULT NULL COMMENT '[{0: ä¼ä¸š}, {1: ä¸ªä½“}, {2: ä¸ªäºº}, {3: æ”¿åºœ}]',
  PRIMARY KEY (`id`),
  UNIQUE KEY `t_member_pk` (`loginacct`)
) ENGINE=InnoDB AUTO_INCREMENT=10 DEFAULT CHARSET=utf8;

-- ----------------------------
-- Records of t_member
-- ----------------------------
BEGIN;
INSERT INTO `t_member` (`id`, `loginacct`, `userpswd`, `username`, `email`, `authstatus`, `usertype`, `realname`, `cardnum`, `accttype`) VALUES (1, 'jack', '$2a$10$L/7qsHMpVsCRePdhzF7mbuGw2VBCbPd4oOR7I3W6TF04DFHUyb3Qe', 'æ°å…‹', 'jack@qq.com', 1, 1, 'æ°å…‹', '430626220104045821', 2);
INSERT INTO `t_member` (`id`, `loginacct`, `userpswd`, `username`, `email`, `authstatus`, `usertype`, `realname`, `cardnum`, `accttype`) VALUES (5, 'tom', '123', NULL, NULL, NULL, NULL, NULL, NULL, NULL);
INSERT INTO `t_member` (`id`, `loginacct`, `userpswd`, `username`, `email`, `authstatus`, `usertype`, `realname`, `cardnum`, `accttype`) VALUES (6, 'qq', '$2a$10$qX4Dk3KHBnLo.AnkY4ngaeFkn0FBJcX3a3IWmFIjdFsv1rTifePD6', 'user', '123456@qq.com', NULL, NULL, NULL, NULL, NULL);
INSERT INTO `t_member` (`id`, `loginacct`, `userpswd`, `username`, `email`, `authstatus`, `usertype`, `realname`, `cardnum`, `accttype`) VALUES (9, 'www', '$2a$10$fiOPIrd3LqtgpGxnAuPbsu0NUoz02RQLomTUCBLmsH/aqSHvDPEqO', 'eav', '123123@qq.com', NULL, NULL, NULL, NULL, NULL);
COMMIT;

-- ----------------------------
-- Table structure for t_member_confirm_info
-- ----------------------------
DROP TABLE IF EXISTS `t_member_confirm_info`;
CREATE TABLE `t_member_confirm_info` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `memberid` int(11) DEFAULT NULL COMMENT 't_member ä¼šå‘˜æ ‡è¯†',
  `paynum` varchar(255) DEFAULT NULL COMMENT 'æ˜“ä»˜å®ä¼ä¸šè´¦å·',
  `cardnum` varchar(255) DEFAULT NULL COMMENT 'æ³•äººèº«ä»½è¯å·',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=7 DEFAULT CHARSET=utf8 COMMENT='å‘èµ·äººç¡®è®¤ä¿¡æ¯è¡¨';

-- ----------------------------
-- Records of t_member_confirm_info
-- ----------------------------
BEGIN;
INSERT INTO `t_member_confirm_info` (`id`, `memberid`, `paynum`, `cardnum`) VALUES (1, 1, '24123', '41234123');
INSERT INTO `t_member_confirm_info` (`id`, `memberid`, `paynum`, `cardnum`) VALUES (2, 1, '3123432', '31241324');
INSERT INTO `t_member_confirm_info` (`id`, `memberid`, `paynum`, `cardnum`) VALUES (3, 1, '4535', '3453453');
INSERT INTO `t_member_confirm_info` (`id`, `memberid`, `paynum`, `cardnum`) VALUES (4, 1, 'jack', '123123');
INSERT INTO `t_member_confirm_info` (`id`, `memberid`, `paynum`, `cardnum`) VALUES (5, 1, '234234', '23423423423');
INSERT INTO `t_member_confirm_info` (`id`, `memberid`, `paynum`, `cardnum`) VALUES (6, 1, '312312', '123123');
COMMIT;

-- ----------------------------
-- Table structure for t_member_copy1
-- ----------------------------
DROP TABLE IF EXISTS `t_member_copy1`;
CREATE TABLE `t_member_copy1` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `loginacct` varchar(255) NOT NULL,
  `userpswd` varchar(255) NOT NULL,
  `username` varchar(255) DEFAULT NULL,
  `email` varchar(255) DEFAULT NULL,
  `authstatus` int(4) DEFAULT NULL COMMENT 'å®åè®¤è¯çŠ¶æ€ [{0: æœªå®åè®¤è¯}, {1: å®åè®¤è¯ç”³è¯·ä¸­}, {2: å·²å®åè®¤è¯}]',
  `usertype` int(4) DEFAULT NULL COMMENT '[{0: ä¸ªäºº}, {1: ä¼ä¸š}]',
  `realname` varchar(255) DEFAULT NULL COMMENT 'çœŸå®å§“å',
  `cardnum` varchar(255) DEFAULT NULL COMMENT 'å¡å·',
  `accttype` int(4) DEFAULT NULL COMMENT '[{0: ä¼ä¸š}, {1: ä¸ªä½“}, {2: ä¸ªäºº}, {3: æ”¿åºœ}]',
  PRIMARY KEY (`id`),
  UNIQUE KEY `t_member_pk` (`loginacct`)
) ENGINE=InnoDB AUTO_INCREMENT=9 DEFAULT CHARSET=utf8;

-- ----------------------------
-- Records of t_member_copy1
-- ----------------------------
BEGIN;
INSERT INTO `t_member_copy1` (`id`, `loginacct`, `userpswd`, `username`, `email`, `authstatus`, `usertype`, `realname`, `cardnum`, `accttype`) VALUES (1, 'jack', '$2a$10$L/7qsHMpVsCRePdhzF7mbuGw2VBCbPd4oOR7I3W6TF04DFHUyb3Qe', 'æ°å…‹', 'jack@qq.com', 1, 1, 'æ°å…‹', '430626220104045821', 2);
INSERT INTO `t_member_copy1` (`id`, `loginacct`, `userpswd`, `username`, `email`, `authstatus`, `usertype`, `realname`, `cardnum`, `accttype`) VALUES (5, 'tom', '123', NULL, NULL, NULL, NULL, NULL, NULL, NULL);
INSERT INTO `t_member_copy1` (`id`, `loginacct`, `userpswd`, `username`, `email`, `authstatus`, `usertype`, `realname`, `cardnum`, `accttype`) VALUES (6, 'qq', '$2a$10$qX4Dk3KHBnLo.AnkY4ngaeFkn0FBJcX3a3IWmFIjdFsv1rTifePD6', 'user', '123456@qq.com', NULL, NULL, NULL, NULL, NULL);
COMMIT;

-- ----------------------------
-- Table structure for t_member_launch_info
-- ----------------------------
DROP TABLE IF EXISTS `t_member_launch_info`;
CREATE TABLE `t_member_launch_info` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `memberid` int(11) DEFAULT NULL COMMENT 't_member ä¼šå‘˜æ ‡è¯†',
  `description_simple` varchar(255) DEFAULT NULL COMMENT 'è‡ªæˆ‘ä»‹ç»',
  `description_detail` varchar(255) DEFAULT NULL COMMENT 'è¯¦ç»†ä»‹ç»',
  `phone_num` varchar(255) DEFAULT NULL COMMENT 'è”ç³»ç”µè¯',
  `service_num` varchar(255) DEFAULT NULL COMMENT 'å®¢æœç”µè¯',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=15 DEFAULT CHARSET=utf8 COMMENT='é¡¹ç›®å‘èµ·äººä¿¡æ¯è¡¨';

-- ----------------------------
-- Records of t_member_launch_info
-- ----------------------------
BEGIN;
INSERT INTO `t_member_launch_info` (`id`, `memberid`, `description_simple`, `description_detail`, `phone_num`, `service_num`) VALUES (9, 1, 'i am mao', 'æˆ‘æ˜¯çŒ«å“¥', '123456', '654321');
INSERT INTO `t_member_launch_info` (`id`, `memberid`, `description_simple`, `description_detail`, `phone_num`, `service_num`) VALUES (10, 1, 'i am mao', 'æˆ‘æ˜¯çŒ«å“¥', '123456', '654321');
INSERT INTO `t_member_launch_info` (`id`, `memberid`, `description_simple`, `description_detail`, `phone_num`, `service_num`) VALUES (11, 1, 'i am mao', 'æˆ‘æ˜¯çŒ«å“¥', '123456', '654321');
INSERT INTO `t_member_launch_info` (`id`, `memberid`, `description_simple`, `description_detail`, `phone_num`, `service_num`) VALUES (12, 1, 'i am mao', 'æˆ‘æ˜¯çŒ«å“¥', '123456', '654321');
INSERT INTO `t_member_launch_info` (`id`, `memberid`, `description_simple`, `description_detail`, `phone_num`, `service_num`) VALUES (13, 1, 'i am mao', 'æˆ‘æ˜¯çŒ«å“¥', '123456', '654321');
INSERT INTO `t_member_launch_info` (`id`, `memberid`, `description_simple`, `description_detail`, `phone_num`, `service_num`) VALUES (14, 1, 'i am mao', 'æˆ‘æ˜¯çŒ«å“¥', '123456', '654321');
COMMIT;

-- ----------------------------
-- Table structure for t_menu
-- ----------------------------
DROP TABLE IF EXISTS `t_menu`;
CREATE TABLE `t_menu` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `pid` int(11) DEFAULT NULL,
  `name` varchar(200) DEFAULT NULL,
  `url` varchar(200) DEFAULT NULL,
  `icon` varchar(200) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=21 DEFAULT CHARSET=utf8;

-- ----------------------------
-- Records of t_menu
-- ----------------------------
BEGIN;
INSERT INTO `t_menu` (`id`, `pid`, `name`, `url`, `icon`) VALUES (1, NULL, 'ç³»ç»Ÿæƒé™èœå•', NULL, 'glyphicon glyphicon-th-list');
INSERT INTO `t_menu` (`id`, `pid`, `name`, `url`, `icon`) VALUES (2, 1, ' æ§ åˆ¶ é¢ æ¿ ', 'main.htm', 'glyphicon glyphicon-dashboard');
INSERT INTO `t_menu` (`id`, `pid`, `name`, `url`, `icon`) VALUES (3, 1, 'æƒé™ç®¡ç†', NULL, 'glyphicon glyphicon glyphicon-tasks');
INSERT INTO `t_menu` (`id`, `pid`, `name`, `url`, `icon`) VALUES (4, 3, ' ç”¨ æˆ· ç»´ æŠ¤ ', 'user/index.htm', 'glyphicon glyphicon-user');
INSERT INTO `t_menu` (`id`, `pid`, `name`, `url`, `icon`) VALUES (5, 3, ' è§’ è‰² ç»´ æŠ¤ ', 'role/index.htm', 'glyphicon glyphicon-king');
INSERT INTO `t_menu` (`id`, `pid`, `name`, `url`, `icon`) VALUES (6, 3, ' èœ å• ç»´ æŠ¤ ', 'permission/index.htm', 'glyphicon glyphicon-lock');
INSERT INTO `t_menu` (`id`, `pid`, `name`, `url`, `icon`) VALUES (7, 1, ' ä¸š åŠ¡ å®¡ æ ¸ ', NULL, 'glyphicon glyphicon-ok');
INSERT INTO `t_menu` (`id`, `pid`, `name`, `url`, `icon`) VALUES (8, 7, ' å® å è®¤ è¯ å®¡ æ ¸ ', 'auth_cert/index.htm', 'glyphicon glyphicon-check');
INSERT INTO `t_menu` (`id`, `pid`, `name`, `url`, `icon`) VALUES (9, 7, ' å¹¿ å‘Š å®¡ æ ¸ ', 'auth_adv/index.htm', 'glyphicon glyphicon-check');
INSERT INTO `t_menu` (`id`, `pid`, `name`, `url`, `icon`) VALUES (10, 7, ' é¡¹ ç›® å®¡ æ ¸ ', 'auth_project/index.htm', 'glyphicon glyphicon-check');
INSERT INTO `t_menu` (`id`, `pid`, `name`, `url`, `icon`) VALUES (11, 1, ' ä¸š åŠ¡ ç®¡ ç† ', NULL, 'glyphicon glyphicon-th-large');
INSERT INTO `t_menu` (`id`, `pid`, `name`, `url`, `icon`) VALUES (12, 11, ' èµ„ è´¨ ç»´ æŠ¤ ', 'cert/index.htm', 'glyphicon glyphicon-picture');
INSERT INTO `t_menu` (`id`, `pid`, `name`, `url`, `icon`) VALUES (13, 11, ' åˆ† ç±» ç®¡ ç† ', 'certtype/index.htm', 'glyphicon glyphicon-equalizer');
INSERT INTO `t_menu` (`id`, `pid`, `name`, `url`, `icon`) VALUES (14, 11, ' æµ ç¨‹ ç®¡ ç† ', 'process/index.htm', 'glyphicon glyphicon-random');
INSERT INTO `t_menu` (`id`, `pid`, `name`, `url`, `icon`) VALUES (15, 11, ' å¹¿ å‘Š ç®¡ ç† ', 'advert/index.htm', 'glyphicon glyphicon-hdd');
INSERT INTO `t_menu` (`id`, `pid`, `name`, `url`, `icon`) VALUES (16, 11, ' æ¶ˆ æ¯ æ¨¡ æ¿ ', 'message/index.htm', 'glyphicon glyphicon-comment');
INSERT INTO `t_menu` (`id`, `pid`, `name`, `url`, `icon`) VALUES (17, 11, ' é¡¹ ç›® åˆ† ç±» ', 'projectType/index.htm', 'glyphicon glyphicon-list');
INSERT INTO `t_menu` (`id`, `pid`, `name`, `url`, `icon`) VALUES (18, 11, ' é¡¹ ç›® æ ‡ ç­¾ ', 'tag/index.htm', 'glyphicon glyphicon-tags');
INSERT INTO `t_menu` (`id`, `pid`, `name`, `url`, `icon`) VALUES (19, 1, ' å‚ æ•° ç®¡ ç† ', 'param/index.htm', 'glyphicon glyphicon-list-alt');
INSERT INTO `t_menu` (`id`, `pid`, `name`, `url`, `icon`) VALUES (20, 1, 'A', 'A', 'glyphicon glyphicon-list-alt');
COMMIT;

-- ----------------------------
-- Table structure for t_project
-- ----------------------------
DROP TABLE IF EXISTS `t_project`;
CREATE TABLE `t_project` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `project_name` varchar(255) DEFAULT NULL COMMENT 'é¡¹ç›®åç§°',
  `project_description` varchar(255) DEFAULT NULL COMMENT 'é¡¹ç›®æè¿°',
  `money` bigint(11) DEFAULT NULL COMMENT 'ç­¹é›†é‡‘é¢',
  `day` int(11) DEFAULT NULL COMMENT 'ç­¹é›†å¤©æ•°',
  `status` int(4) DEFAULT NULL COMMENT '[{0: å®¡æ ¸ä¸­}, {1: ä¼—ç­¹ä¸­}, {2: ä¼—ç­¹æˆåŠŸ}, {3: ä¼—ç­¹å¤±è´¥}]',
  `deploydate` varchar(255) DEFAULT NULL COMMENT 'é¡¹ç›®å‘èµ·æ—¶é—´',
  `supportmoney` bigint(11) DEFAULT NULL COMMENT 'å·²ç­¹é›†åˆ°çš„é‡‘é¢',
  `supporter` int(11) DEFAULT NULL COMMENT 'æ”¯æŒäººæ•°',
  `completion` int(3) DEFAULT NULL COMMENT 'ç™¾åˆ†æ¯”å®Œæˆåº¦',
  `memberid` int(11) DEFAULT NULL COMMENT 'å‘èµ·äººçš„ä¼šå‘˜æ ‡è¯†',
  `createdate` varchar(19) DEFAULT NULL COMMENT 'é¡¹ç›®åˆ›å»ºæ—¶é—´',
  `follower` int(11) DEFAULT NULL COMMENT 'å…³æ³¨äººæ•°',
  `header_picture_path` varchar(255) DEFAULT NULL COMMENT 'å¤´å›¾è·¯å¾„',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=21 DEFAULT CHARSET=utf8 COMMENT='é¡¹ç›®è¡¨';

-- ----------------------------
-- Records of t_project
-- ----------------------------
BEGIN;
INSERT INTO `t_project` (`id`, `project_name`, `project_description`, `money`, `day`, `status`, `deploydate`, `supportmoney`, `supporter`, `completion`, `memberid`, `createdate`, `follower`, `header_picture_path`) VALUES (15, 'brotherMao', 'å°±æ˜¯å¸…ï¼', 100, 30, 0, '2022-09-04', 11, 1, 11, 1, '2022-09-03', 11, 'https://atguigu220827.oss-cn-guangzhou.aliyuncs.com/20220904/4fcaa821-f0b7-46f8-aebc-825bb1e208b2.jpg');
INSERT INTO `t_project` (`id`, `project_name`, `project_description`, `money`, `day`, `status`, `deploydate`, `supportmoney`, `supporter`, `completion`, `memberid`, `createdate`, `follower`, `header_picture_path`) VALUES (16, 'brotherMao', 'å°±æ˜¯å¸…ï¼', 100, 30, 0, '2022-09-04', 11, 2, 11, 1, '2022-09-03', 12, 'https://atguigu220827.oss-cn-guangzhou.aliyuncs.com/20220904/4fcaa821-f0b7-46f8-aebc-825bb1e208b2.jpg');
INSERT INTO `t_project` (`id`, `project_name`, `project_description`, `money`, `day`, `status`, `deploydate`, `supportmoney`, `supporter`, `completion`, `memberid`, `createdate`, `follower`, `header_picture_path`) VALUES (17, 'brotherMao', 'å°±æ˜¯å¸…ï¼', 100, 30, 0, '2022-09-04', 11, 3, 11, 1, '2022-09-03', 13, 'https://atguigu220827.oss-cn-guangzhou.aliyuncs.com/20220904/4fcaa821-f0b7-46f8-aebc-825bb1e208b2.jpg');
INSERT INTO `t_project` (`id`, `project_name`, `project_description`, `money`, `day`, `status`, `deploydate`, `supportmoney`, `supporter`, `completion`, `memberid`, `createdate`, `follower`, `header_picture_path`) VALUES (18, 'brotherMao', 'å°±æ˜¯å¸…ï¼', 100, 30, 0, '2022-09-04', 11, 4, 11, 1, '2022-09-03', 14, 'https://atguigu220827.oss-cn-guangzhou.aliyuncs.com/20220904/4fcaa821-f0b7-46f8-aebc-825bb1e208b2.jpg');
INSERT INTO `t_project` (`id`, `project_name`, `project_description`, `money`, `day`, `status`, `deploydate`, `supportmoney`, `supporter`, `completion`, `memberid`, `createdate`, `follower`, `header_picture_path`) VALUES (19, 'brotherMao', 'å°±æ˜¯å¸…ï¼', 100, 30, 0, '2022-09-01', 11, 5, 11, 1, '2022-09-03', 15, 'https://atguigu220827.oss-cn-guangzhou.aliyuncs.com/20220904/4fcaa821-f0b7-46f8-aebc-825bb1e208b2.jpg');
INSERT INTO `t_project` (`id`, `project_name`, `project_description`, `money`, `day`, `status`, `deploydate`, `supportmoney`, `supporter`, `completion`, `memberid`, `createdate`, `follower`, `header_picture_path`) VALUES (20, 'brotherMao', 'å°±æ˜¯å¸…ï¼', 100, 30, 0, '2022-09-04', 11, 6, 11, 1, '2022-09-04', 16, 'https://atguigu220827.oss-cn-guangzhou.aliyuncs.com/20220904/4fcaa821-f0b7-46f8-aebc-825bb1e208b2.jpg');
COMMIT;

-- ----------------------------
-- Table structure for t_project_item_pic
-- ----------------------------
DROP TABLE IF EXISTS `t_project_item_pic`;
CREATE TABLE `t_project_item_pic` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `projectid` int(11) DEFAULT NULL COMMENT 't_project æ ‡è¯†',
  `item_pic_path` varchar(255) DEFAULT NULL COMMENT 'å›¾ç‰‡åç§°',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=15 DEFAULT CHARSET=utf8 COMMENT='é¡¹ç›®è¡¨é¡¹ç›®è¯¦æƒ…å›¾ç‰‡è¡¨';

-- ----------------------------
-- Records of t_project_item_pic
-- ----------------------------
BEGIN;
INSERT INTO `t_project_item_pic` (`id`, `projectid`, `item_pic_path`) VALUES (9, 15, 'https://atguigu220827.oss-cn-guangzhou.aliyuncs.com/20220904/deb8461d-cdb4-4652-9aed-096a63671bdb.jpg');
INSERT INTO `t_project_item_pic` (`id`, `projectid`, `item_pic_path`) VALUES (10, 16, 'https://atguigu220827.oss-cn-guangzhou.aliyuncs.com/20220904/deb8461d-cdb4-4652-9aed-096a63671bdb.jpg');
INSERT INTO `t_project_item_pic` (`id`, `projectid`, `item_pic_path`) VALUES (11, 17, 'https://atguigu220827.oss-cn-guangzhou.aliyuncs.com/20220904/deb8461d-cdb4-4652-9aed-096a63671bdb.jpg');
INSERT INTO `t_project_item_pic` (`id`, `projectid`, `item_pic_path`) VALUES (12, 18, 'https://atguigu220827.oss-cn-guangzhou.aliyuncs.com/20220904/deb8461d-cdb4-4652-9aed-096a63671bdb.jpg');
INSERT INTO `t_project_item_pic` (`id`, `projectid`, `item_pic_path`) VALUES (13, 19, 'https://atguigu220827.oss-cn-guangzhou.aliyuncs.com/20220904/deb8461d-cdb4-4652-9aed-096a63671bdb.jpg');
INSERT INTO `t_project_item_pic` (`id`, `projectid`, `item_pic_path`) VALUES (14, 20, 'https://atguigu220827.oss-cn-guangzhou.aliyuncs.com/20220904/deb8461d-cdb4-4652-9aed-096a63671bdb.jpg');
COMMIT;

-- ----------------------------
-- Table structure for t_project_tag
-- ----------------------------
DROP TABLE IF EXISTS `t_project_tag`;
CREATE TABLE `t_project_tag` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `projectid` int(11) DEFAULT NULL COMMENT 't_project æ ‡è¯†',
  `tagid` int(11) DEFAULT NULL COMMENT 't_tag æ ‡è¯†',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=38 DEFAULT CHARSET=utf8 COMMENT='é¡¹ç›®æ ‡ç­¾ä¸­é—´è¡¨';

-- ----------------------------
-- Records of t_project_tag
-- ----------------------------
BEGIN;
INSERT INTO `t_project_tag` (`id`, `projectid`, `tagid`) VALUES (19, 15, 4);
INSERT INTO `t_project_tag` (`id`, `projectid`, `tagid`) VALUES (20, 15, 7);
INSERT INTO `t_project_tag` (`id`, `projectid`, `tagid`) VALUES (21, 16, 9);
INSERT INTO `t_project_tag` (`id`, `projectid`, `tagid`) VALUES (22, 16, 7);
INSERT INTO `t_project_tag` (`id`, `projectid`, `tagid`) VALUES (23, 17, 4);
INSERT INTO `t_project_tag` (`id`, `projectid`, `tagid`) VALUES (24, 17, 7);
INSERT INTO `t_project_tag` (`id`, `projectid`, `tagid`) VALUES (25, 17, 9);
INSERT INTO `t_project_tag` (`id`, `projectid`, `tagid`) VALUES (26, 18, 7);
INSERT INTO `t_project_tag` (`id`, `projectid`, `tagid`) VALUES (27, 18, 9);
INSERT INTO `t_project_tag` (`id`, `projectid`, `tagid`) VALUES (28, 18, 7);
INSERT INTO `t_project_tag` (`id`, `projectid`, `tagid`) VALUES (29, 18, 9);
INSERT INTO `t_project_tag` (`id`, `projectid`, `tagid`) VALUES (30, 18, 7);
INSERT INTO `t_project_tag` (`id`, `projectid`, `tagid`) VALUES (31, 18, 9);
INSERT INTO `t_project_tag` (`id`, `projectid`, `tagid`) VALUES (32, 19, 4);
INSERT INTO `t_project_tag` (`id`, `projectid`, `tagid`) VALUES (33, 19, 7);
INSERT INTO `t_project_tag` (`id`, `projectid`, `tagid`) VALUES (34, 19, 9);
INSERT INTO `t_project_tag` (`id`, `projectid`, `tagid`) VALUES (35, 20, 6);
INSERT INTO `t_project_tag` (`id`, `projectid`, `tagid`) VALUES (36, 20, 8);
INSERT INTO `t_project_tag` (`id`, `projectid`, `tagid`) VALUES (37, 20, 10);
COMMIT;

-- ----------------------------
-- Table structure for t_project_type
-- ----------------------------
DROP TABLE IF EXISTS `t_project_type`;
CREATE TABLE `t_project_type` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `projectid` int(11) DEFAULT NULL COMMENT 't_project æ ‡è¯†',
  `typeid` int(11) DEFAULT NULL COMMENT 't_type æ ‡è¯†',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=39 DEFAULT CHARSET=utf8 COMMENT='é¡¹ç›®å’Œåˆ†ç±»ä¸­é—´è¡¨';

-- ----------------------------
-- Records of t_project_type
-- ----------------------------
BEGIN;
INSERT INTO `t_project_type` (`id`, `projectid`, `typeid`) VALUES (29, 15, 2);
INSERT INTO `t_project_type` (`id`, `projectid`, `typeid`) VALUES (30, 15, 4);
INSERT INTO `t_project_type` (`id`, `projectid`, `typeid`) VALUES (31, 16, 2);
INSERT INTO `t_project_type` (`id`, `projectid`, `typeid`) VALUES (32, 16, 4);
INSERT INTO `t_project_type` (`id`, `projectid`, `typeid`) VALUES (33, 17, 2);
INSERT INTO `t_project_type` (`id`, `projectid`, `typeid`) VALUES (34, 17, 4);
INSERT INTO `t_project_type` (`id`, `projectid`, `typeid`) VALUES (35, 18, 2);
INSERT INTO `t_project_type` (`id`, `projectid`, `typeid`) VALUES (36, 18, 4);
INSERT INTO `t_project_type` (`id`, `projectid`, `typeid`) VALUES (37, 19, 1);
INSERT INTO `t_project_type` (`id`, `projectid`, `typeid`) VALUES (38, 20, 3);
COMMIT;

-- ----------------------------
-- Table structure for t_return
-- ----------------------------
DROP TABLE IF EXISTS `t_return`;
CREATE TABLE `t_return` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `projectid` int(11) DEFAULT NULL COMMENT 't_projcet é¡¹ç›®æ ‡è¯†',
  `type` int(4) DEFAULT NULL COMMENT '[{0: å®ç‰©å›æŠ¥}, {1: è™šæ‹Ÿç‰©å“å›æŠ¥}]',
  `supportmoney` int(11) DEFAULT NULL COMMENT 'æ”¯æŒé‡‘é¢',
  `content` varchar(255) DEFAULT NULL COMMENT 'å›æŠ¥å†…å®¹',
  `count` int(11) DEFAULT NULL COMMENT 'å›æŠ¥äº§å“é™é¢ {0: ä¸é™é¢å›æŠ¥æ•°é‡}',
  `signalpurchase` int(11) DEFAULT NULL COMMENT 'æ˜¯å¦è®¾ç½®å•ç¬”é™è´­',
  `purchase` int(11) DEFAULT NULL COMMENT 'å…·ä½“é™è´­æ•°é‡',
  `freight` int(11) DEFAULT NULL COMMENT 'è¿è´¹ {0: åŒ…é‚®}',
  `invoice` int(4) DEFAULT NULL COMMENT '[{0: ä¸å¼€å‘ç¥¨}, {1: å¼€å‘ç¥¨}]',
  `returndate` int(11) DEFAULT NULL COMMENT 'é¡¹ç›®ç»“æŸåå¤šå°‘å¤©å‘æ”¯æŒè€…å‘é€å›æŠ¥',
  `describ_pic_path` varchar(255) DEFAULT NULL COMMENT 'è¯´æ˜å›¾ç‰‡è·¯å¾„',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=7 DEFAULT CHARSET=utf8 COMMENT='å›æŠ¥ä¿¡æ¯è¡¨';

-- ----------------------------
-- Records of t_return
-- ----------------------------
BEGIN;
INSERT INTO `t_return` (`id`, `projectid`, `type`, `supportmoney`, `content`, `count`, `signalpurchase`, `purchase`, `freight`, `invoice`, `returndate`, `describ_pic_path`) VALUES (1, 15, 1, 10, 'ä»¥èº«ç›¸è®¸', 5, 1, 8, 0, 1, 15, 'https://atguigu220827.oss-cn-guangzhou.aliyuncs.com/20220904/56c4d3ca-cb1f-4cfb-9bff-64fec98e131b.jpg');
INSERT INTO `t_return` (`id`, `projectid`, `type`, `supportmoney`, `content`, `count`, `signalpurchase`, `purchase`, `freight`, `invoice`, `returndate`, `describ_pic_path`) VALUES (2, 16, 1, 10, 'ä»¥èº«ç›¸è®¸', 5, 1, 8, 0, 1, 15, 'https://atguigu220827.oss-cn-guangzhou.aliyuncs.com/20220904/56c4d3ca-cb1f-4cfb-9bff-64fec98e131b.jpg');
INSERT INTO `t_return` (`id`, `projectid`, `type`, `supportmoney`, `content`, `count`, `signalpurchase`, `purchase`, `freight`, `invoice`, `returndate`, `describ_pic_path`) VALUES (3, 17, 0, 10, 'ä»¥èº«ç›¸è®¸', 5, 1, 8, 0, 1, 15, 'https://atguigu220827.oss-cn-guangzhou.aliyuncs.com/20220904/56c4d3ca-cb1f-4cfb-9bff-64fec98e131b.jpg');
INSERT INTO `t_return` (`id`, `projectid`, `type`, `supportmoney`, `content`, `count`, `signalpurchase`, `purchase`, `freight`, `invoice`, `returndate`, `describ_pic_path`) VALUES (4, 18, 0, 10, 'ä»¥èº«ç›¸è®¸', 5, 1, 8, 0, 1, 15, 'https://atguigu220827.oss-cn-guangzhou.aliyuncs.com/20220904/56c4d3ca-cb1f-4cfb-9bff-64fec98e131b.jpg');
INSERT INTO `t_return` (`id`, `projectid`, `type`, `supportmoney`, `content`, `count`, `signalpurchase`, `purchase`, `freight`, `invoice`, `returndate`, `describ_pic_path`) VALUES (5, 19, 0, 10, 'ä»¥èº«ç›¸è®¸', 5, 1, 8, 0, 1, 15, 'https://atguigu220827.oss-cn-guangzhou.aliyuncs.com/20220904/56c4d3ca-cb1f-4cfb-9bff-64fec98e131b.jpg');
INSERT INTO `t_return` (`id`, `projectid`, `type`, `supportmoney`, `content`, `count`, `signalpurchase`, `purchase`, `freight`, `invoice`, `returndate`, `describ_pic_path`) VALUES (6, 20, 1, 10, 'ä»¥èº«ç›¸è®¸', 5, 1, 8, 0, 1, 15, 'https://atguigu220827.oss-cn-guangzhou.aliyuncs.com/20220904/56c4d3ca-cb1f-4cfb-9bff-64fec98e131b.jpg');
COMMIT;

-- ----------------------------
-- Table structure for t_role
-- ----------------------------
DROP TABLE IF EXISTS `t_role`;
CREATE TABLE `t_role` (
  `id` int(11) NOT NULL AUTO_INCREMENT COMMENT 'è§’è‰² ID',
  `name` varchar(255) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=6 DEFAULT CHARSET=utf8;

-- ----------------------------
-- Records of t_role
-- ----------------------------
BEGIN;
INSERT INTO `t_role` (`id`, `name`) VALUES (1, 'ç»ç†');
INSERT INTO `t_role` (`id`, `name`) VALUES (2, 'éƒ¨é•¿');
INSERT INTO `t_role` (`id`, `name`) VALUES (3, 'ç»ç†æ“ä½œè€…');
INSERT INTO `t_role` (`id`, `name`) VALUES (4, 'éƒ¨é•¿æ“ä½œè€…');
INSERT INTO `t_role` (`id`, `name`) VALUES (5, 'Admin');
COMMIT;

-- ----------------------------
-- Table structure for t_tag
-- ----------------------------
DROP TABLE IF EXISTS `t_tag`;
CREATE TABLE `t_tag` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `pid` int(11) DEFAULT NULL,
  `name` varchar(255) DEFAULT NULL COMMENT 'æ ‡ç­¾åç§°',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=11 DEFAULT CHARSET=utf8 COMMENT='æ ‡ç­¾è¡¨';

-- ----------------------------
-- Records of t_tag
-- ----------------------------
BEGIN;
INSERT INTO `t_tag` (`id`, `pid`, `name`) VALUES (1, NULL, 'æ‰‹æœº');
INSERT INTO `t_tag` (`id`, `pid`, `name`) VALUES (2, NULL, 'æ•°ç ');
INSERT INTO `t_tag` (`id`, `pid`, `name`) VALUES (3, NULL, 'ç”µè„‘');
INSERT INTO `t_tag` (`id`, `pid`, `name`) VALUES (4, 1, 'å¤§å±');
INSERT INTO `t_tag` (`id`, `pid`, `name`) VALUES (5, 1, 'ç¾é¢œ');
INSERT INTO `t_tag` (`id`, `pid`, `name`) VALUES (6, 1, 'ç»­èˆª');
INSERT INTO `t_tag` (`id`, `pid`, `name`) VALUES (7, 2, 'é«˜è§£æåº¦');
INSERT INTO `t_tag` (`id`, `pid`, `name`) VALUES (8, 2, 'é«˜æ¸…');
INSERT INTO `t_tag` (`id`, `pid`, `name`) VALUES (9, 3, 'å¤§å†…å­˜');
INSERT INTO `t_tag` (`id`, `pid`, `name`) VALUES (10, 3, 'å›ºæ€');
COMMIT;

-- ----------------------------
-- Table structure for t_type
-- ----------------------------
DROP TABLE IF EXISTS `t_type`;
CREATE TABLE `t_type` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `name` varchar(255) DEFAULT NULL COMMENT 'åˆ†ç±»åç§°',
  `remark` varchar(255) DEFAULT NULL COMMENT 'åˆ†ç±»è¯´æ˜',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=5 DEFAULT CHARSET=utf8 COMMENT='åˆ†ç±»è¡¨';

-- ----------------------------
-- Records of t_type
-- ----------------------------
BEGIN;
INSERT INTO `t_type` (`id`, `name`, `remark`) VALUES (1, 'ç§‘æŠ€', 'å¼€å¯ç§‘æŠ€æœªæ¥');
INSERT INTO `t_type` (`id`, `name`, `remark`) VALUES (2, 'è®¾è®¡', 'åˆ›å»ºæ”¹å˜æœªæ¥');
INSERT INTO `t_type` (`id`, `name`, `remark`) VALUES (3, 'å…¬ç›Š', 'æ±‡é›†ç‚¹ç‚¹çˆ±å¿ƒ');
INSERT INTO `t_type` (`id`, `name`, `remark`) VALUES (4, 'å†œä¸š', 'ç½‘ç»œå¤©ä¸‹è‚¥ç¾');
COMMIT;

SET FOREIGN_KEY_CHECKS = 1;
```



### 1.4 ä»£ç 

![img](https://cdn.nlark.com/yuque/0/2022/jpeg/12811585/1662176485334-62e21d4d-9c93-4d28-97af-0ae006c0c9cf.jpeg)

#### 1.4.1 æ–°å»º `PortalTypeVO` å®ä½“ç±»ã€`entity` å·¥ç¨‹ã€‘

```java
package com.atguigu.crowd.entity.vo;

import lombok.AllArgsConstructor;
import lombok.Data;
import lombok.NoArgsConstructor;

import java.util.List;

/**
 * é¦–é¡µå±•ç¤ºæ•°æ®
 *
 * @author é™ˆæ±Ÿæ—
 * @date 2022/9/3 20:10
 */
@AllArgsConstructor
@NoArgsConstructor
@Data
public class PortalTypeVO {

    private Integer id;

    /**
     * åˆ†ç±»åç§°
     */
    private String name;

    /**
     * åˆ†ç±»è¯´æ˜
     */
    private String remark;

    /**
     * é¦–é¡µå±•ç¤ºæ•°æ®-åˆ†ç±»ä¸­çš„é¡¹ç›®ä¿¡æ¯
     */
    private List<PortalProjectVO> portalProjectVO;

}
```



#### 1.4.2 æ–°å»º `PortalProjectVO` å®ä½“ç±»ã€`entity` å·¥ç¨‹ã€‘

```java
package com.atguigu.crowd.entity.vo;

import lombok.AllArgsConstructor;
import lombok.Data;
import lombok.NoArgsConstructor;

/**
 * é¦–é¡µå±•ç¤ºæ•°æ®-åˆ†ç±»ä¸­çš„é¡¹ç›®ä¿¡æ¯
 *
 * @author é™ˆæ±Ÿæ—
 * @date 2022/9/3 20:11
 */
@AllArgsConstructor
@NoArgsConstructor
@Data
public class PortalProjectVO {

    private Integer projectId;

    /**
     * é¡¹ç›®åç§°
     */
    private String projectName;

    /**
     * å¤´å›¾è·¯å¾„
     */
    private String headerPicturePath;

    /**
     * ç­¹é›†é‡‘é¢
     */
    private Integer money;

    /**
     * é¡¹ç›®å‘èµ·æ—¶é—´
     */
    private String deployDate;

    /**
     * å·²ç­¹é›†åˆ°çš„é‡‘é¢/ç­¹é›†é‡‘é¢ ç™¾åˆ†æ¯”
     */
    private String percentage;

    /**
     * æ”¯æŒäººæ•°
     */
    private Integer supporter;

}
```



#### 1.4.3  æš´éœ²æ•°æ®æŸ¥è¯¢çš„æ¥å£ã€`mysql` å·¥ç¨‹ã€‘

- `ProjectPOMapper.xml` ä¸­ç¼–å†™æŸ¥è¯¢æ•°æ®çš„ SQL è¯­å¥

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662208001634-ae6cf459-d1ff-482b-9fb2-89654506e57c.png)

```xml
    <!-- é¦–é¡µæ•°æ® start -->
    <select id="selectPortalTypeVOList" resultMap="LoadPortalProjectListResultMap">
        select id, name, remark
        from t_type
    </select>

    <resultMap type="com.atguigu.crowd.entity.vo.PortalTypeVO" id="LoadPortalProjectListResultMap">
        <!-- åˆ†ç±»æ•°æ®çš„å¸¸è§„å±æ€§ -->
        <id column="id" property="id"/>
        <id column="name" property="name"/>
        <id column="remark" property="remark"/>

        <!-- åˆ†ç±»æ•°æ®ä¸­åŒ…å«çš„é¡¹ç›®æ•°æ®çš„ List -->
        <!-- property å±æ€§: å¯¹åº” PortalTypeVO ä¸­åˆ†ç±»æ•°æ®ä¸­é¡¹ç›®æ•°æ®çš„ List å±æ€§ -->
        <!-- column å±æ€§: æ¥ä¸‹æ¥æŸ¥è¯¢é¡¹ç›®æ—¶éœ€è¦ç”¨åˆ°çš„åˆ†ç±» id, å°±æ˜¯é€šè¿‡ column å±æ€§æŠŠå€¼ä¼ å…¥ -->
        <!-- ofType å±æ€§: é¡¹ç›®æ•°æ®çš„å®ä½“ç±»å‹ PortalProjectVO -->
        <collection
                property="portalProjectVO"
                column="id"
                ofType="com.atguigu.crowd.entity.vo.PortalProjectVO"
                select="com.atguigu.crowd.mapper.ProjectPOMapper.selectPortalProjectVOList"
        >
        </collection>
    </resultMap>

    <select id="selectPortalProjectVOList" resultType="com.atguigu.crowd.entity.vo.PortalProjectVO">
        SELECT t_project.id                         projectId,
               project_name                         projectName,
               header_picture_path                  headerPicturePath,
               money,
               deploydate                           deployDate,
               supportmoney / t_project.money * 100 percentage,
               supporter
        FROM t_project
                 LEFT JOIN t_project_type ON t_project.id = t_project_type.projectid
        WHERE t_project_type.typeid = #{id}
        ORDER BY t_project.id DESC
        LIMIT 0,4
    </select>
    <!-- é¦–é¡µæ•°æ® end -->
```



- åœ¨ `ProjectPOMapper` æ¥å£ä¸­å£°æ˜æŸ¥è¯¢æ•°æ®çš„æ–¹æ³•

```java
    /**
     * æŸ¥è¯¢é¦–é¡µæ•°æ®
     * 
     * @return
     */
    List<PortalTypeVO> selectPortalTypeVOList();
```



- æµ‹è¯•

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662208785344-d0c14f89-795c-49f3-bf73-e22a5ce4270a.png)

```java
    @Autowired
    private ProjectPOMapper projectPOMapper;

	/**
     * æµ‹è¯•é¦–é¡µæ•°æ®
     */
    @Test
    public void testPortData() {
        List<PortalTypeVO> typeVOList = projectPOMapper.selectPortalTypeVOList();
        typeVOList.forEach(portalTypeVO -> {
            String name = portalTypeVO.getName();
            String remark = portalTypeVO.getRemark();
            logger.info("name = " + name + " remark = " + remark);

            List<PortalProjectVO> portalProjectVOList = portalTypeVO.getPortalProjectVO();
            portalProjectVOList.forEach(portalProjectVO -> {
                logger.info(portalProjectVO.toString());
            });
        });
    }
```



- åœ¨ `ProjectService` ä¸­è°ƒç”¨ `Mapper` æ–¹æ³•, æ‹¿åˆ°æ•°æ®

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662208933835-f945684c-4106-46f3-ae7f-7ff61007b375.png)

```java
    /**
     * æŸ¥è¯¢é¦–é¡µæ•°æ®
     * 
     * @return
     */
    List<PortalTypeVO> getPortalTypeVO();
```

- `ProjectServiceImpl`

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662208945520-8b10835b-0cec-4bc6-832b-a79294ff9638.png)

```java
    @Override
    public List<PortalTypeVO> getPortalTypeVO() {
        return projectPOMapper.selectPortalTypeVOList();
    }
```



- åœ¨ `ProjectHandler` ä¸­è°ƒç”¨ `Service` æ–¹æ³•æ‹¿åˆ°æ•°æ®

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662208957489-7ed49363-95d9-4d8e-b4ca-ca60395a5e3e.png)

```java
    @RequestMapping("/get/portal/type/project/data/remote")
    public ResultEntity<List<PortalTypeVO>> getPortalTypeProjectDataRemote() {

        try {
            List<PortalTypeVO> portalTypeVOList = projectService.getPortalTypeVO();
            return ResultEntity.successWithData(portalTypeVOList);
        } catch (Exception e) {
            return ResultEntity.failed(e.getMessage());
        }

    }
```



#### 1.4.4 å£°æ˜ä¸€ä¸ª Feign çš„æ¥å£ ã€`api` å·¥ç¨‹ã€‘

```java
    /**
     * æŸ¥è¯¢é¦–é¡µæ•°æ®
     * 
     * @return
     */
    @RequestMapping("/get/portal/type/project/data/remote")
    ResultEntity<List<PortalTypeVO>> getPortalTypeProjectDataRemote();
```



#### 1.4.5 è°ƒç”¨ `mysql` æš´éœ²çš„æ¥å£æ‹¿åˆ°æ•°æ®å­˜å…¥åˆ°æ¨¡å‹ ã€`auth` å·¥ç¨‹ã€‘

```java
package com.atguigu.crowd.handler;

import com.atguigu.crowd.api.MySQLRemoteService;
import com.atguigu.crowd.constant.CrowdConstant;
import com.atguigu.crowd.entity.vo.PortalTypeVO;
import com.atguigu.crowd.util.ResultEntity;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.RequestMapping;

import java.util.List;

/**
 * @author é™ˆæ±Ÿæ—
 * @date 2022/8/28 22:14
 */
@Controller
public class PortalHandler {

    @Autowired
    private MySQLRemoteService mySQLRemoteService;

    /**
     * æ˜¾ç¤ºé¦–é¡µ
     *
     * @return
     */
    @RequestMapping("/")
    public String toPortalPage(Model model) {
        // æŸ¥è¯¢é¦–é¡µè¦æ˜¾ç¤ºçš„æ•°æ®
        ResultEntity<List<PortalTypeVO>> resultEntity = mySQLRemoteService.getPortalTypeProjectDataRemote();

        // æ£€æŸ¥æŸ¥è¯¢ç»“æœ
        String result = resultEntity.getResult();
        if(ResultEntity.SUCCESS.equals(result)) {
            // è·å–æŸ¥è¯¢ç»“æœæ•°æ®
            List<PortalTypeVO> list = resultEntity.getData();

            // å­˜å…¥æ¨¡å‹ä¸­
            // ATTR_NAME_PORTAL_DATA = portal_data
            model.addAttribute(CrowdConstant.ATTR_NAME_PORTAL_DATA, list);
        }

        return "portal";
    }

}
```



#### 1.4.6 åœ¨ `portal.html` ä¸­æ˜¾ç¤ºæ¨¡å‹ä¸­çš„æ•°æ®ã€`auth` å·¥ç¨‹ã€‘

```html
<!DOCTYPE html>
<html lang="zh-CN" xmlns:th="https://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <base th:href="@{/}">
    <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <link rel="stylesheet" href="css/carousel.css">
    <script src="jquery/jquery-2.1.1.min.js"></script>
    <script src="bootstrap/js/bootstrap.min.js"></script>
    <script src="script/docs.min.js"></script>
    <script src="script/back-to-top.js"></script>
    <script>
        $(function () {
            $(".thumbnail img").css("cursor", "pointer");
            $(".thumbnail img").click(function () {
                window.location.href = "project.html";
            });
        })
    </script>
    <style>
        h3 {
            font-weight: bold;
        }

        #footer {
            padding: 15px 0;
            background: #fff;
            border-top: 1px solid #ddd;
            text-align: center;
        }

        #topcontrol {
            color: #fff;
            z-index: 99;
            width: 30px;
            height: 30px;
            font-size: 20px;
            background: #222;
            position: relative;
            right: 14px !important;
            bottom: 11px !important;
            border-radius: 3px !important;
        }

        #topcontrol:after {
            /*top: -2px;*/
            left: 8.5px;
            content: "\f106";
            position: absolute;
            text-align: center;
            font-family: FontAwesome;
        }

        #topcontrol:hover {
            color: #fff;
            background: #18ba9b;
            -webkit-transition: all 0.3s ease-in-out;
            -moz-transition: all 0.3s ease-in-out;
            -o-transition: all 0.3s ease-in-out;
            transition: all 0.3s ease-in-out;
        }

        /* ä¾§æ å¯¼èˆª */
        .sideBox {
            padding: 10px;
            height: 220px;
            background: #fff;
            margin-bottom: 10px;
            overflow: hidden;
        }

        .sideBox .hd {
            height: 30px;
            line-height: 30px;
            background: #f60;
            padding: 0 10px;
            text-align: center;
            overflow: hidden;
        }

        .sideBox .hd .more {
            color: #fff;
        }

        .sideBox .hd h3 span {
            font-weight: bold;
            font-size: 14px;
            color: #fff;
        }

        .sideBox .bd {
            padding: 5px 0 0;
        }

        #sideMenu .bd li {
            margin-bottom: 2px;
            height: 30px;
            line-height: 30px;
            text-align: center;
            overflow: hidden;
        }

        #sideMenu .bd li a {
            display: block;
            background: #EAE6DD;
        }

        #sideMenu .bd li a:hover {
            background: #D5CFBF;
        }

        /* åˆ—è¡¨é¡µ */
        #mainBox {
            margin-bottom: 10px;
            padding: 10px;
            background: #fff;
            overflow: hidden;
        }

        #mainBox .mHd {
            border-bottom: 2px solid #09c;
            height: 30px;
            line-height: 30px;
        }

        #mainBox .mHd h3 {
            display: initial;
            *display: inline;
            zoom: 1;
            padding: 0 15px;
            background: #09c;
            color: #fff;
        }

        #mainBox .mHd h3 span {
            color: #fff;
            font-size: 14px;
            font-weight: bold;
        }

        #mainBox .path {
            float: right;
        }

        /* ä½ç½®å¯¼èˆª */
        .path {
            height: 30px;
            line-height: 30px;
            padding-left: 10px;
        }

        .path a, .path span {
            margin: 0 5px;
        }

        /* æ–‡ç« åˆ—è¡¨ */
        .newsList {
            padding: 10px;
            text-align: left;
        }

        .newsList li {
            background: url("../images/share/point.png") no-repeat 2px 14px;
            padding-left: 10px;
            height: 30px;
            line-height: 30px;
        }

        .newsList li a {
            display: inline-block;
            *display: inline;
            zoom: 1;
            font-size: 14px;
        }

        .newsList li .date {
            float: right;
            color: #999;
        }

        .newsList li.split {
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px dotted #ddd;
            height: 0px;
            line-height: 0px;
            overflow: hidden;
        }

        /* é€šç”¨å¸¦å›¾ç‰‡çš„ä¿¡æ¯åˆ—è¡¨_æ™®é€šå¼ */
        .picList {
            padding: 10px;
            text-align: left;
        }

        .picList li {
            margin: 0 5px;
            height: 190px;
        }

        h3.break {
            font-size: 16px;
            display: block;
            white-space: nowrap;
            word-wrap: normal;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        h3.break > a {
            text-decoration: none;
        }

    </style>
</head>
<body>
<div class="navbar-wrapper">
    <div class="container">
        <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand" href="index.html" style="font-size:32px;">å°šç­¹ç½‘-åˆ›æ„äº§å“ä¼—ç­¹å¹³å°</a>
                </div>
                <div id="navbar" class="navbar-collapse collapse" style="float:right;">
                    <ul class="nav navbar-nav navbar-right">
                        <!--                        <li><a href="login.html">ç™»å½•</a></li>-->
                        <!--                        <li><a href="reg.html">æ³¨å†Œ</a></li>-->
                        <li><a th:href="@{/auth/member/to/login/page}">ç™»å½•</a></li>
                        <li><a th:href="@{/auth/member/to/reg/page}">æ³¨å†Œ</a></li>
                        <li><a>|</a></li>
                        <li><a href="admin-login.html">ç®¡ç†å‘˜å…¥å£</a></li>
                    </ul>
                </div>
            </div>
        </nav>
    </div>
</div>


<!-- Carousel
================================================== -->
<div id="myCarousel" class="carousel slide" data-ride="carousel">
    <!-- Indicators -->
    <ol class="carousel-indicators">
        <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
        <li data-target="#myCarousel" data-slide-to="1"></li>
        <li data-target="#myCarousel" data-slide-to="2"></li>
    </ol>
    <div class="carousel-inner" role="listbox">
        <div class="item active" onclick="window.location.href='project.html'" style="cursor:pointer;">
            <img src="img/carousel-1.jpg" alt="First slide">
        </div>
        <div class="item" onclick="window.location.href='project.html'" style="cursor:pointer;">
            <img src="img/carousel-2.jpg" alt="Second slide">
        </div>
        <div class="item" onclick="window.location.href='project.html'" style="cursor:pointer;">
            <img src="img/carousel-3.jpg" alt="Third slide">
        </div>
    </div>
    <a class="left carousel-control" href="#myCarousel" role="button" data-slide="prev">
        <span class="glyphicon glyphicon-chevron-left"></span>
        <span class="sr-only">Previous</span>
    </a>
    <a class="right carousel-control" href="#myCarousel" role="button" data-slide="next">
        <span class="glyphicon glyphicon-chevron-right"></span>
        <span class="sr-only">Next</span>
    </a>
</div><!-- /.carousel -->


<!-- Marketing messaging and featurettes
================================================== -->
<!-- Wrap the rest of the page in another container to center all the content. -->

<div class="container marketing">

    <!-- Three columns of text below the carousel -->
    <div class="row">
        <div class="col-lg-4">
            <img class="img-circle" src="img/p1.jpg" alt="Generic placeholder image"
                 style="width: 140px; height: 140px;">
            <h2>æ™ºèƒ½é«˜æ¸…ç›‘æ§æœºå™¨äºº</h2>
            <p>å¯çˆ±çš„é€ å‹ï¼Œæ‘„åƒå®‰é˜²è¿œç¨‹äº’è”çš„å…¨èƒ½è®¾è®¡ï¼Œè®©ä½ éšæ—¶éšåœ°å®ˆæŠ¤æ‚¨çš„å®¶äººï¼Œé™ªä¼´ä½ çš„ç”Ÿæ´»ã€‚</p>
            <p><a class="btn btn-default" href="project.html" role="button">é¡¹ç›®è¯¦æƒ… &raquo;</a></p>
        </div><!-- /.col-lg-4 -->
        <div class="col-lg-4">
            <img class="img-circle" src="img/p2.jpg" alt="Generic placeholder image"
                 style="width: 140px; height: 140px;">
            <h2>NEOKAæ™ºèƒ½æ‰‹ç¯</h2>
            <p>è¦è¿åŠ¨æ›´è¦å®‰å…¨ï¼Œè¿™æ¬¾ã€åä¸ºâ€œè¶èˆâ€çš„NEOKA-V9100æ™ºèƒ½è¿åŠ¨æ‰‹ç¯ä¸ºâ€œå®‰å…¨è¿åŠ¨è€Œç”Ÿâ€ã€‚</p>
            <p><a class="btn btn-default" href="project.html" role="button">é¡¹ç›®è¯¦æƒ… &raquo;</a></p>
        </div><!-- /.col-lg-4 -->
        <div class="col-lg-4">
            <img class="img-circle" src="img/p3.png" alt="Generic placeholder image"
                 style="width: 140px; height: 140px;">
            <h2>é©±èšŠæ‰£</h2>
            <p>éšå¤„ä½¿ç”¨çš„é©±èšŠçº½æ‰£ï¼Œ<br>è§£å†³å¤å­£èšŠè™«é—®é¢˜ã€‚</p>
            <p><a class="btn btn-default" href="project.html" role="button">é¡¹ç›®è¯¦æƒ… &raquo;</a></p>
        </div><!-- /.col-lg-4 -->
    </div><!-- /.row -->

    <div th:if="${#lists.isEmpty(portal_data)}">è¯¥åˆ†ç±»ä¸‹è¿˜æ²¡æœ‰ä»»ä½•çš„é¡¹ç›®</div>
    <div th:unless="${#lists.isEmpty(portal_data)}">
        <div th:each="type : ${portal_data}" class="container">
            <div class="row clearfix">
                <div class="col-md-12 column">
                    <div class="box ui-draggable">
                        <div class="mHd" style="">
                            <div class="path">
                                <a href="projects.html">æ›´å¤š...</a>
                            </div>
                            <h3>
                                <label th:text="${type.name}">ç§‘æŠ€</label>
                                <small th:text="${type.remark}" style="color:#FFF;">å¼€å¯æ™ºæ…§æœªæ¥</small>
                            </h3>
                        </div>
                        <div class="mBd" style="padding-top:10px;">
                            <div class="row">
                                <div th:if="${#lists.isEmpty(type.portalProjectVO)}">è¯¥åˆ†ç±»ä¸‹è¿˜æ²¡æœ‰ä»»ä½•çš„é¡¹ç›®</div>
                                <div th:unless="${#lists.isEmpty(type.portalProjectVO)}">
                                    <div th:each="project : ${type.portalProjectVO}" class="col-md-3">
                                        <div class="thumbnail">
                                            <img alt="300x200" th:src="${project.headerPicturePath}"
                                                 src="img/product-1.jpg"/>
                                            <div class="caption">
                                                <h3 class="break">
                                                    <!--                                                    <a th:href="@{'/portal/show/project/detail/'+${project.projectId}}"-->
                                                    <a th:href="@{/portal/show/project/detail/{projectId}(projectId=${project.projectId})}"
                                                       th:text="${project.projectName}">æ´»æ€§å¯Œæ°¢å‡€æ°´ç›´é¥®æœº</a>
                                                </h3>
                                                <p>
                                                <div style="float:left;">
                                                    <i class="glyphicon glyphicon-screenshot" title="ç›®æ ‡é‡‘é¢"></i>
                                                    $<span th:text="${project.money}">20,000</span>
                                                </div>
                                                <div style="float:right;">
                                                    <i title="æˆªè‡³æ—¥æœŸ" class="glyphicon glyphicon-calendar"></i>
                                                    <span th:text="${project.deployDate}">2017-20-20</span>
                                                </div>
                                                </p>
                                                <br>
                                                <div class="progress" style="margin-bottom: 4px;">
                                                    <div class="progress-bar progress-bar-success" role="progressbar"
                                                         th:aria-valuenow="${project.percentage}" aria-valuemin="0"
                                                         aria-valuemax="100"
                                                         th:style="'width: ' + ${project.percentage} + '%'">
                                                        <span th:text="${project.percentage} + '%'">40%</span>
                                                    </div>
                                                </div>
                                                <div><span style="float:right;">
                                                    <i class="glyphicon glyphicon-star-empty"></i>
                                                </span>
                                                    <span>
                                                        <i class="glyphicon glyphicon-user" title="æ”¯æŒäººæ•°"></i>
                                                    <span th:text="${project.supporter}">12345</span>
                                                </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>
    <!-- FOOTER -->
    <div class="container">
        <div class="row clearfix">
            <div class="col-md-12 column">
                <div id="footer">
                    <div class="footerNav">
                        <a rel="nofollow" href="http://www.atguigu.com">å…³äºæˆ‘ä»¬</a> | <a rel="nofollow"
                                                                                      href="http://www.atguigu.com">æœåŠ¡æ¡æ¬¾</a>
                        | <a rel="nofollow" href="http://www.atguigu.com">å…è´£å£°æ˜</a> | <a rel="nofollow"
                                                                                        href="http://www.atguigu.com">ç½‘ç«™åœ°å›¾</a>
                        | <a rel="nofollow" href="http://www.atguigu.com">è”ç³»æˆ‘ä»¬</a>
                    </div>
                    <div class="copyRight">
                        Copyright ?2017-2017atguigu.com ç‰ˆæƒæ‰€æœ‰
                    </div>
                </div>

            </div>
        </div>
    </div>

</div><!-- /.container -->
</body>
</html>
```



## 2. æ˜¾ç¤ºé¡¹ç›®è¯¦æƒ…

### 2.1 ç›®æ ‡

- åœ¨é¦–é¡µç‚¹å‡»é¡¹ç›®åç§°è·³è½¬æ˜¾ç¤ºé¡¹ç›®è¯¦æƒ…ä¿¡æ¯

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662398003558-d70971de-47a7-4c79-adec-f44893069965.png)



### 2.2 æ€è·¯

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662288003965-54f5ca25-780e-496e-b189-5e610e94aafa.png)



### 2.3 ä»£ç 

![img](https://cdn.nlark.com/yuque/0/2022/jpeg/12811585/1662400650709-e17e108b-5698-45c0-9db8-002c9b01ad6f.jpeg)



#### 2.3.1 åˆ›å»º `DetailProjectVO`å®ä½“ç±»ã€`entity` å·¥ç¨‹ã€‘

```java
package com.atguigu.crowd.entity.vo;

import lombok.AllArgsConstructor;
import lombok.Data;
import lombok.NoArgsConstructor;

import java.io.Serializable;
import java.util.List;

/**
 * é¡¹ç›®æ•°æ®:
 * - é¦–é¡µ > é¡¹ç›®è¯¦æƒ…é¡µé¢ {é¡¹ç›®æ•°æ®: [å›æŠ¥æ•°æ®]}
 *
 * @author é™ˆæ±Ÿæ—
 * @date 2022/9/4 21:52
 */
@NoArgsConstructor
@AllArgsConstructor
@Data
public class DetailProjectVO implements Serializable {

    private static final long serialVersionUID = 1L;

    /**
     * é¡¹ç›®ä¸»é”®
     */
    private Integer projectId;

    /**
     * é¡¹ç›®åç§°
     */
    private String projectName;

    /**
     * é¡¹ç›®ç®€ä»‹
     */
    private String projectDesc;

    /**
     * å¤šå°‘äººå…³æ³¨
     */
    private Integer followerCount;

    /**
     * ç­¹é›†å¤©æ•°
     */
    private Integer day;

    /**
     * [{0: å®¡æ ¸ä¸­}, {1: ä¼—ç­¹ä¸­}, {2: ä¼—ç­¹æˆåŠŸ}, {3: ä¼—ç­¹å¤±è´¥}]
     */
    private Integer status;

    /**
     * å¯¹åº” status å¯¹è±¡å€¼
     */
    private String statusText;

    /**
     * ç­¹é›†å¤šå°‘é’±
     */
    private Integer money;

    /**
     * å·²ç»ç­¹é›†å¤šå°‘é’±
     */
    private Integer supportMoney;

    /**
     * ç­¹é›†ç™¾åˆ†æ¯”
     */
    private Integer percentage;

    /**
     * é¡¹ç›®å‘èµ·æ—¶é—´
     */
    private String deployDate;

    /**
     * è¿˜å‰©å¤šå°‘å¤©
     */
    private Integer lastDay;

    /**
     * æœ‰å¤šå°‘äººæ”¯æŒ
     */
    private Integer supporterCount;

    /**
     * å¤´å›¾è·¯å¾„
     */
    private String headerPicturePath;

    /**
     * è¯¦æƒ…å›¾ç‰‡è·¯å¾„
     */
    private List<String> detailPicturePathList;

    /**
     * å›æŠ¥ä¿¡æ¯
     */
    private List<DetailReturnVO> detailReturnVOList;

}
```



#### 2.3.2 åˆ›å»º `DetailReturnVO`å®ä½“ç±»ã€`entity` å·¥ç¨‹ã€‘

```java
package com.atguigu.crowd.entity.vo;

import lombok.AllArgsConstructor;
import lombok.Data;
import lombok.NoArgsConstructor;

import java.io.Serializable;

/**
 * å›æŠ¥æ•°æ®:
 * - é¦–é¡µ > é¡¹ç›®è¯¦æƒ…é¡µé¢ {é¡¹ç›®æ•°æ®: [å›æŠ¥æ•°æ®]}
 *
 * @author é™ˆæ±Ÿæ—
 * @date 2022/9/4 21:47
 */
@NoArgsConstructor
@AllArgsConstructor
@Data
public class DetailReturnVO implements Serializable {

    private static final long serialVersionUID = 1L;

    /**
     * å›æŠ¥ä¿¡æ¯ä¸»é”®
     */
    private Integer returnId;

    /**
     * å½“å‰æ¡£ä½éœ€æ”¯æŒçš„é‡‘é¢
     */
    private Integer supportMoney;

    /**
     * å•ç¬”é™è´­, [{0: æ— é™é¢}, {1, æœ‰é™é¢}]
     */
    private Integer signalPurchase;

    /**
     * å…·ä½“é™é¢æ•°é‡
     */
    private Integer purchase;

    /**
     * å½“å‰è¯¥æ¡£ä½æ”¯æŒè€…æ•°é‡
     */
    private Integer supporterCount;

    /**
     * è¿è´¹, å–å€¼ä¸º0æ—¶åŒ…é‚®
     */
    private Integer freight;

    /**
     * ä¼—ç­¹æˆåŠŸåå¤šå°‘å¤©å‘è´§
     */
    private Integer returnDate;

    /**
     * å›æŠ¥å†…å®¹
     */
    private String content;

}
```



#### 2.3.3 æš´éœ²æ•°æ®æŸ¥è¯¢çš„æ¥å£ã€`mysql` å·¥ç¨‹ã€‘

- `ProjectPOMapper.xml` ä¸­ç¼–å†™æŸ¥è¯¢æ•°æ®çš„ SQL è¯­å¥

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662302982594-eec98638-41f4-44cd-8af8-8359e992fb31.png)

```xml
    <!-- é¦–é¡µ > é¡¹ç›®è¯¦æƒ…é¡µé¢æ•°æ® start -->
    <!--
        create table t_project
        (
            id                  int auto_increment primary key,
            project_name        varchar(255) null comment 'é¡¹ç›®åç§°',
            project_description varchar(255) null comment 'é¡¹ç›®æè¿°',
            money               bigint(11)   null comment 'ç­¹é›†é‡‘é¢',
            day                 int          null comment 'ç­¹é›†å¤©æ•°',
            status              int(4)       null comment '[{0: å®¡æ ¸ä¸­}, {1: ä¼—ç­¹ä¸­}, {2: ä¼—ç­¹æˆåŠŸ}, {3: ä¼—ç­¹å¤±è´¥}]',
            deploydate          varchar(255) null comment 'é¡¹ç›®å‘èµ·æ—¶é—´',
            supportmoney        bigint(11)   null comment 'å·²ç­¹é›†åˆ°çš„é‡‘é¢',
            supporter           int          null comment 'æ”¯æŒäººæ•°',
            completion          int(3)       null comment 'ç™¾åˆ†æ¯”å®Œæˆåº¦',
            memberid            int          null comment 'å‘èµ·äººçš„ä¼šå‘˜æ ‡è¯†',
            createdate          varchar(19)  null comment 'é¡¹ç›®åˆ›å»ºæ—¶é—´',
            follower            int          null comment 'å…³æ³¨äººæ•°',
            header_picture_path varchar(255) null comment 'å¤´å›¾è·¯å¾„'
        ) comment 'é¡¹ç›®è¡¨';
     -->
    <select id="selectDetailProjectVO" resultMap="loadPortalProjectListResultMap">
        select id ,
        project_name ,
        project_description ,
        money ,
               day,
        status ,
        deploydate ,
        supportmoney ,
        supporter ,
        supportmoney/money*100 percentage,
        follower ,
        header_picture_path
        <!--List<String> detailPicturePathList-->
        <!-- List<DetailReturnVO> detailReturnVOList-->
        from t_project where id = #{id}
    </select>

    <resultMap id="loadPortalProjectListResultMap" type="com.atguigu.crowd.entity.vo.DetailProjectVO">
        <id column="id" property="projectId"/>
        <result column="project_name" property="projectName"/>
        <result column="project_description" property="projectDesc"/>
        <result column="money" property="money"/>
        <result column="day" property="day"/>
        <result column="status" property="status"/>
        <result column="deploydate" property="deployDate"/>
        <result column="supportmoney" property="supportMoney"/>
        <result column="supporter" property="supporterCount"/>
        <result column="percentage" property="percentage"/>
        <result column="follower" property="followerCount"/>
        <result column="header_picture_path" property="headerPicturePath"/>
        <collection property="detailPicturePathList" select="com.atguigu.crowd.mapper.ProjectPOMapper.selectDetailPicturePathList"
                    column="id"/>
        <collection property="detailReturnVOList" select="com.atguigu.crowd.mapper.ProjectPOMapper.selectDetailReturnVOList"
                    column="id"/>
    </resultMap>

    <!-- é¦–é¡µ > é¡¹ç›®è¯¦æƒ…ä¸­ > è¯¦æƒ…å›¾ç‰‡ -->
    <select id="selectDetailPicturePathList" resultType="string">
        select item_pic_path
        from t_project_item_pic
        where projectid = #{id}
    </select>

    <!-- é¦–é¡µ > é¡¹ç›®è¯¦æƒ…ä¸­ > å›æŠ¥æ•°æ® -->
    <!--
        create table t_return
        (
            id               int auto_increment primary key,
            projectid        int          null comment 't_projcet é¡¹ç›®æ ‡è¯†',
            type             int(4)       null comment '[{0: å®ç‰©å›æŠ¥}, {1: è™šæ‹Ÿç‰©å“å›æŠ¥}]',
            supportmoney     int          null comment 'æ”¯æŒé‡‘é¢',
            content          varchar(255) null comment 'å›æŠ¥å†…å®¹',
            count            int          null comment 'å›æŠ¥äº§å“é™é¢ {0: ä¸é™é¢å›æŠ¥æ•°é‡}',
            signalpurchase   int          null comment 'æ˜¯å¦è®¾ç½®å•ç¬”é™è´­  [{0: æ— é™é¢}, {1, æœ‰é™é¢}]',
            purchase         int          null comment 'å…·ä½“é™è´­æ•°é‡',
            freight          int          null comment 'è¿è´¹ {0: åŒ…é‚®}',
            invoice          int(4)       null comment '[{0: ä¸å¼€å‘ç¥¨}, {1: å¼€å‘ç¥¨}]',
            returndate       int          null comment 'é¡¹ç›®ç»“æŸåå¤šå°‘å¤©å‘æ”¯æŒè€…å‘é€å›æŠ¥',
            describ_pic_path varchar(255) null comment 'è¯´æ˜å›¾ç‰‡è·¯å¾„'
        ) comment 'å›æŠ¥ä¿¡æ¯è¡¨';
    -->
    <select id="selectDetailReturnVOList" resultType="com.atguigu.crowd.entity.vo.DetailReturnVO">
        select id             returnId,
               supportmoney   supportMoney,
               content,
               signalpurchase signalPurchase,
               purchase,
               freight,
               returndate     returnDate
        from t_return
        where projectid = #{id}
    </select>
    <!-- é¦–é¡µ > é¡¹ç›®è¯¦æƒ…é¡µé¢æ•°æ® end -->
```

- åœ¨ `ProjectPOMapper` æ¥å£ä¸­å£°æ˜æŸ¥è¯¢æ•°æ®çš„æ–¹æ³•

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662303219782-c27506a9-40e2-4051-9706-8163d3598446.png)

```java
    /**
     * æŸ¥è¯¢é¦–é¡µ > é¡¹ç›®è¯¦æƒ…é¡µé¢æ•°æ®
     *
     * @param projectId
     * @return
     */
    DetailProjectVO selectDetailProjectVO(Integer projectId);

    /**
     * é¦–é¡µ > é¡¹ç›®è¯¦æƒ…ä¸­ > è¯¦æƒ…å›¾ç‰‡
     *
     * @param projectId
     * @return
     */
    List<String> selectDetailPicturePathList(Integer projectId);

    /**
     * é¦–é¡µ > é¡¹ç›®è¯¦æƒ…ä¸­ > å›æŠ¥æ•°æ®
     *
     * @param projectId
     * @return
     */
    List<DetailReturnVO> selectDetailReturnVOList(Integer projectId);
```

- æµ‹è¯•

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662208785344-d0c14f89-795c-49f3-bf73-e22a5ce4270a.png)

```java
    /**
     * æµ‹è¯• é¦–é¡µ > é¡¹ç›®è¯¦æƒ…é¡µé¢ æ•°æ®
     */
    @Test
    public void testSelectDetailProjectVO() {
        DetailProjectVO detailProjectVO = projectPOMapper.selectDetailProjectVO(20);
        logger.info(detailProjectVO.getProjectId() + "");
        logger.info(detailProjectVO.getProjectName() + "");
        logger.info(detailProjectVO.getProjectDesc() + "");
        logger.info(detailProjectVO.getFollowerCount() + "");
        logger.info(detailProjectVO.getStatus() + "");
        logger.info(detailProjectVO.getMoney() + "");
        logger.info(detailProjectVO.getSupportMoney() + "");
        logger.info(detailProjectVO.getPercentage() + "");
        logger.info(detailProjectVO.getDeployDate() + "");
        logger.info(detailProjectVO.getLastDay() + "");
        logger.info(detailProjectVO.getSupporterCount() + "");
        logger.info(detailProjectVO.getHeaderPicturePath() + "");

        detailProjectVO.getDetailPicturePathList().forEach(detailPicturePath -> logger.info("è¯¦æƒ…å›¾ç‰‡è·¯å¾„: " + detailPicturePath));
        detailProjectVO.getDetailReturnVOList().forEach(detailReturnVO -> {
            logger.info("" + detailReturnVO.getReturnId());
            logger.info("" + detailReturnVO.getSupportMoney());
            logger.info("" + detailReturnVO.getSignalPurchase());
            logger.info("" + detailReturnVO.getPurchase());
            logger.info("" + detailReturnVO.getSupporterCount());
            logger.info("" + detailReturnVO.getFreight());
            logger.info("" + detailReturnVO.getReturnDate());
            logger.info("" + detailReturnVO.getContent());
        });
    }
```

- åœ¨ `ProjectService` ä¸­è°ƒç”¨ `Mapper` æ–¹æ³•, æ‹¿åˆ°æ•°æ®

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662208933835-f945684c-4106-46f3-ae7f-7ff61007b375.png)

```java
    /**
     * æŸ¥è¯¢é¦–é¡µ > é¡¹ç›®è¯¦æƒ…é¡µé¢æ•°æ®
     *
     * @param projectId
     * @return
     */
    DetailProjectVO getDetailProjectVO(Integer projectId);
```

- `ProjectServiceImpl`

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662208945520-8b10835b-0cec-4bc6-832b-a79294ff9638.png)

```java
    @Override
    public DetailProjectVO getDetailProjectVO(Integer projectId) {
        // æŸ¥è¯¢å¾—åˆ° DetailProjectVO å¯¹è±¡
        DetailProjectVO detailProjectVO = projectPOMapper.selectDetailProjectVO(projectId);
        // æ ¹æ® status ç¡®å®š statusText
        Integer status = detailProjectVO.getStatus();
        switch (status) {
            case 0:
                detailProjectVO.setStatusText("å®¡æ ¸ä¸­");
                break;
            case 1:
                detailProjectVO.setStatusText("ä¼—ç­¹ä¸­");
                break;
            case 2:
                detailProjectVO.setStatusText("ä¼—ç­¹æˆåŠŸ");
                break;
            case 3:
                detailProjectVO.setStatusText("ä¼—ç­¹å¤±è´¥");
                break;
            default:
                break;
        }

        // 3. æ ¹æ® deployDate è®¡ç®— lastDay
        // æ ¼å¼: xxxx-xx-xx
        String deployDate = detailProjectVO.getDeployDate();

        // è·å–å½“å‰æ—¥æœŸ
        Date currentDay = new Date();

        // æŠŠä¼—ç­¹æ—¥æœŸè§£ææˆ Date ç±»å‹
        SimpleDateFormat format = new SimpleDateFormat("yyyy-MM-dd");
        try {
            Date deployDay = format.parse(deployDate);

            // è·å–å½“å‰æ—¥æœŸçš„æ—¶é—´æˆ³
            long currentTimeStamp = currentDay.getTime();

            // è·å–ä¼—ç­¹æ—¥æœŸçš„æ—¶é—´æˆ³
            long deployTimeStamp = deployDay.getTime();

            // ä¸¤ä¸ªæ—¶é—´æˆ³ç›¸å‡è®¡ç®—å½“å‰å·²ç»è¿‡å»çš„æ—¶é—´
            long pastDays = (currentTimeStamp - deployTimeStamp) / 1000 / 60 / 60 / 24;

            // è·å–æ€»çš„ä¼—ç­¹å¤©æ•°
            Integer totalDays = detailProjectVO.getDay();

            // ä½¿ç”¨æ€»çš„ä¼—ç­¹å¤©æ•°å‡å»å·²ç»è¿‡å»çš„å¤©æ•°å¾—åˆ°å‰©ä½™å¤©æ•°
            Integer lastDay = (int) (totalDays - pastDays);
            detailProjectVO.setLastDay(lastDay);
        } catch (Exception e) {
            e.printStackTrace();
        }

        return detailProjectVO;
    }
```



- åœ¨ `ProjectHandler` ä¸­è°ƒç”¨ `Service` æ–¹æ³•æ‹¿åˆ°æ•°æ®

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662208957489-7ed49363-95d9-4d8e-b4ca-ca60395a5e3e.png)

```java
    @RequestMapping("/get/project/detail/remote/{projectId}")
    ResultEntity<DetailProjectVO> getDetailProjectVORemote(@PathVariable("projectId") Integer projectId) {

        try {
            DetailProjectVO detailProjectVOById = projectService.getDetailProjectVO(projectId);
            return ResultEntity.successWithData(detailProjectVOById);
        } catch (Exception e) {
            e.printStackTrace();
            return ResultEntity.failed(e.getMessage());
        }

    }
```



#### 2.3.4 å£°æ˜ä¸€ä¸ª Feign çš„æ¥å£ ã€`api` å·¥ç¨‹ã€‘

```java
    /**
     * æŸ¥è¯¢é¦–é¡µ > é¡¹ç›®è¯¦æƒ…é¡µé¢æ•°æ®
     *
     * @param projectId é¡¹ç›® id
     * @return
     */
    @RequestMapping("/get/project/detail/remote/{projectId}")
    ResultEntity<DetailProjectVO> getDetailProjectVORemote(@PathVariable("projectId") Integer projectId);
```



#### 2.3.5 é¦–é¡µè·³è½¬åˆ°é¡¹ç›®è¯¦æƒ… `portal.html`ã€`auth` å·¥ç¨‹ã€‘

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662400497019-db5493ae-a5cf-4643-ab68-88ee4edec8ee.png)

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662346354370-64276f32-c193-4edc-b81f-9bf1bf0baf03.png)

```html
<!DOCTYPE html>
<html lang="zh-CN" xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <base th:href="@{/}">
    <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <link rel="stylesheet" href="css/carousel.css">
    <script src="jquery/jquery-2.1.1.min.js"></script>
    <script src="bootstrap/js/bootstrap.min.js"></script>
    <script src="script/docs.min.js"></script>
    <script src="script/back-to-top.js"></script>
    <script>
        $(function () {
            $(".thumbnail img").css("cursor", "pointer");
            $(".thumbnail img").click(function () {
                window.location.href = "project.html";
            });
        })
    </script>
    <style>
        h3 {
            font-weight: bold;
        }

        #footer {
            padding: 15px 0;
            background: #fff;
            border-top: 1px solid #ddd;
            text-align: center;
        }

        #topcontrol {
            color: #fff;
            z-index: 99;
            width: 30px;
            height: 30px;
            font-size: 20px;
            background: #222;
            position: relative;
            right: 14px !important;
            bottom: 11px !important;
            border-radius: 3px !important;
        }

        #topcontrol:after {
            /*top: -2px;*/
            left: 8.5px;
            content: "\f106";
            position: absolute;
            text-align: center;
            font-family: FontAwesome;
        }

        #topcontrol:hover {
            color: #fff;
            background: #18ba9b;
            -webkit-transition: all 0.3s ease-in-out;
            -moz-transition: all 0.3s ease-in-out;
            -o-transition: all 0.3s ease-in-out;
            transition: all 0.3s ease-in-out;
        }

        /* ä¾§æ å¯¼èˆª */
        .sideBox {
            padding: 10px;
            height: 220px;
            background: #fff;
            margin-bottom: 10px;
            overflow: hidden;
        }

        .sideBox .hd {
            height: 30px;
            line-height: 30px;
            background: #f60;
            padding: 0 10px;
            text-align: center;
            overflow: hidden;
        }

        .sideBox .hd .more {
            color: #fff;
        }

        .sideBox .hd h3 span {
            font-weight: bold;
            font-size: 14px;
            color: #fff;
        }

        .sideBox .bd {
            padding: 5px 0 0;
        }

        #sideMenu .bd li {
            margin-bottom: 2px;
            height: 30px;
            line-height: 30px;
            text-align: center;
            overflow: hidden;
        }

        #sideMenu .bd li a {
            display: block;
            background: #EAE6DD;
        }

        #sideMenu .bd li a:hover {
            background: #D5CFBF;
        }

        /* åˆ—è¡¨é¡µ */
        #mainBox {
            margin-bottom: 10px;
            padding: 10px;
            background: #fff;
            overflow: hidden;
        }

        #mainBox .mHd {
            border-bottom: 2px solid #09c;
            height: 30px;
            line-height: 30px;
        }

        #mainBox .mHd h3 {
            display: initial;
            *display: inline;
            zoom: 1;
            padding: 0 15px;
            background: #09c;
            color: #fff;
        }

        #mainBox .mHd h3 span {
            color: #fff;
            font-size: 14px;
            font-weight: bold;
        }

        #mainBox .path {
            float: right;
        }

        /* ä½ç½®å¯¼èˆª */
        .path {
            height: 30px;
            line-height: 30px;
            padding-left: 10px;
        }

        .path a, .path span {
            margin: 0 5px;
        }

        /* æ–‡ç« åˆ—è¡¨ */
        .newsList {
            padding: 10px;
            text-align: left;
        }

        .newsList li {
            background: url("../images/share/point.png") no-repeat 2px 14px;
            padding-left: 10px;
            height: 30px;
            line-height: 30px;
        }

        .newsList li a {
            display: inline-block;
            *display: inline;
            zoom: 1;
            font-size: 14px;
        }

        .newsList li .date {
            float: right;
            color: #999;
        }

        .newsList li.split {
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px dotted #ddd;
            height: 0px;
            line-height: 0px;
            overflow: hidden;
        }

        /* é€šç”¨å¸¦å›¾ç‰‡çš„ä¿¡æ¯åˆ—è¡¨_æ™®é€šå¼ */
        .picList {
            padding: 10px;
            text-align: left;
        }

        .picList li {
            margin: 0 5px;
            height: 190px;
        }

        h3.break {
            font-size: 16px;
            display: block;
            white-space: nowrap;
            word-wrap: normal;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        h3.break > a {
            text-decoration: none;
        }

    </style>
</head>
<body>
<div class="navbar-wrapper">
    <div class="container">
        <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand" href="index.html" style="font-size:32px;">å°šç­¹ç½‘-åˆ›æ„äº§å“ä¼—ç­¹å¹³å°</a>
                </div>
                <div id="navbar" class="navbar-collapse collapse" style="float:right;">
                    <ul class="nav navbar-nav navbar-right">
                        <!--                        <li><a href="login.html">ç™»å½•</a></li>-->
                        <!--                        <li><a href="reg.html">æ³¨å†Œ</a></li>-->
                        <li><a th:href="@{/auth/member/to/login/page}">ç™»å½•</a></li>
                        <li><a th:href="@{/auth/member/to/reg/page}">æ³¨å†Œ</a></li>
                        <li><a>|</a></li>
                        <li><a href="admin-login.html">ç®¡ç†å‘˜å…¥å£</a></li>
                    </ul>
                </div>
            </div>
        </nav>
    </div>
</div>


<!-- Carousel
================================================== -->
<div id="myCarousel" class="carousel slide" data-ride="carousel">
    <!-- Indicators -->
    <ol class="carousel-indicators">
        <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
        <li data-target="#myCarousel" data-slide-to="1"></li>
        <li data-target="#myCarousel" data-slide-to="2"></li>
    </ol>
    <div class="carousel-inner" role="listbox">
        <div class="item active" onclick="window.location.href='project.html'" style="cursor:pointer;">
            <img src="img/carousel-1.jpg" alt="First slide">
        </div>
        <div class="item" onclick="window.location.href='project.html'" style="cursor:pointer;">
            <img src="img/carousel-2.jpg" alt="Second slide">
        </div>
        <div class="item" onclick="window.location.href='project.html'" style="cursor:pointer;">
            <img src="img/carousel-3.jpg" alt="Third slide">
        </div>
    </div>
    <a class="left carousel-control" href="#myCarousel" role="button" data-slide="prev">
        <span class="glyphicon glyphicon-chevron-left"></span>
        <span class="sr-only">Previous</span>
    </a>
    <a class="right carousel-control" href="#myCarousel" role="button" data-slide="next">
        <span class="glyphicon glyphicon-chevron-right"></span>
        <span class="sr-only">Next</span>
    </a>
</div><!-- /.carousel -->


<!-- Marketing messaging and featurettes
================================================== -->
<!-- Wrap the rest of the page in another container to center all the content. -->

<div class="container marketing">

    <!-- Three columns of text below the carousel -->
    <div class="row">
        <div class="col-lg-4">
            <img class="img-circle" src="img/p1.jpg" alt="Generic placeholder image"
                 style="width: 140px; height: 140px;">
            <h2>æ™ºèƒ½é«˜æ¸…ç›‘æ§æœºå™¨äºº</h2>
            <p>å¯çˆ±çš„é€ å‹ï¼Œæ‘„åƒå®‰é˜²è¿œç¨‹äº’è”çš„å…¨èƒ½è®¾è®¡ï¼Œè®©ä½ éšæ—¶éšåœ°å®ˆæŠ¤æ‚¨çš„å®¶äººï¼Œé™ªä¼´ä½ çš„ç”Ÿæ´»ã€‚</p>
            <p><a class="btn btn-default" href="project.html" role="button">é¡¹ç›®è¯¦æƒ… &raquo;</a></p>
        </div><!-- /.col-lg-4 -->
        <div class="col-lg-4">
            <img class="img-circle" src="img/p2.jpg" alt="Generic placeholder image"
                 style="width: 140px; height: 140px;">
            <h2>NEOKAæ™ºèƒ½æ‰‹ç¯</h2>
            <p>è¦è¿åŠ¨æ›´è¦å®‰å…¨ï¼Œè¿™æ¬¾ã€åä¸ºâ€œè¶èˆâ€çš„NEOKA-V9100æ™ºèƒ½è¿åŠ¨æ‰‹ç¯ä¸ºâ€œå®‰å…¨è¿åŠ¨è€Œç”Ÿâ€ã€‚</p>
            <p><a class="btn btn-default" href="project.html" role="button">é¡¹ç›®è¯¦æƒ… &raquo;</a></p>
        </div><!-- /.col-lg-4 -->
        <div class="col-lg-4">
            <img class="img-circle" src="img/p3.png" alt="Generic placeholder image"
                 style="width: 140px; height: 140px;">
            <h2>é©±èšŠæ‰£</h2>
            <p>éšå¤„ä½¿ç”¨çš„é©±èšŠçº½æ‰£ï¼Œ<br>è§£å†³å¤å­£èšŠè™«é—®é¢˜ã€‚</p>
            <p><a class="btn btn-default" href="project.html" role="button">é¡¹ç›®è¯¦æƒ… &raquo;</a></p>
        </div><!-- /.col-lg-4 -->
    </div><!-- /.row -->

    <div th:if="${#lists.isEmpty(portal_data)}">è¯¥åˆ†ç±»ä¸‹è¿˜æ²¡æœ‰ä»»ä½•çš„é¡¹ç›®</div>
    <div th:unless="${#lists.isEmpty(portal_data)}">
        <div th:each="type : ${portal_data}" class="container">
            <div class="row clearfix">
                <div class="col-md-12 column">
                    <div class="box ui-draggable">
                        <div class="mHd" style="">
                            <div class="path">
                                <a href="projects.html">æ›´å¤š...</a>
                            </div>
                            <h3>
                                <label th:text="${type.name}">ç§‘æŠ€</label>
                                <small th:text="${type.remark}" style="color:#FFF;">å¼€å¯æ™ºæ…§æœªæ¥</small>
                            </h3>
                        </div>
                        <div class="mBd" style="padding-top:10px;">
                            <div class="row">
                                <div th:if="${#lists.isEmpty(type.portalProjectVO)}">è¯¥åˆ†ç±»ä¸‹è¿˜æ²¡æœ‰ä»»ä½•çš„é¡¹ç›®</div>
                                <div th:unless="${#lists.isEmpty(type.portalProjectVO)}">
                                    <div th:each="project : ${type.portalProjectVO}" class="col-md-3">
                                        <div class="thumbnail">
                                            <img alt="300x200" th:src="${project.headerPicturePath}"
                                                 src="img/product-1.jpg"/>
                                            <div class="caption">
                                                <h3 class="break">
                                                    <!--                                                    <a th:href="@{${session.zuulPath}+'/portal/show/project/detail/'+${project.projectId}}"-->
                                                    <a th:href="@{{zuulPath}/project/get/project/detail/{projectId}(projectId=${project.projectId}, zuulPath=${session.zuulPath})}"
                                                       th:text="${project.projectName}">æ´»æ€§å¯Œæ°¢å‡€æ°´ç›´é¥®æœº</a>
                                                </h3>
                                                <p>
                                                <div style="float:left;">
                                                    <i class="glyphicon glyphicon-screenshot" title="ç›®æ ‡é‡‘é¢"></i>
                                                    $<span th:text="${project.money}">20,000</span>
                                                </div>
                                                <div style="float:right;">
                                                    <i title="æˆªè‡³æ—¥æœŸ" class="glyphicon glyphicon-calendar"></i>
                                                    <span th:text="${project.deployDate}">2017-20-20</span>
                                                </div>
                                                </p>
                                                <br>
                                                <div class="progress" style="margin-bottom: 4px;">
                                                    <div class="progress-bar progress-bar-success" role="progressbar"
                                                         th:aria-valuenow="${project.percentage}" aria-valuemin="0"
                                                         aria-valuemax="100"
                                                         th:style="'width: ' + ${project.percentage} + '%'">
                                                        <span th:text="${project.percentage} + '%'">40%</span>
                                                    </div>
                                                </div>
                                                <div><span style="float:right;">
                                                    <i class="glyphicon glyphicon-star-empty"></i>
                                                </span>
                                                    <span>
                                                        <i class="glyphicon glyphicon-user" title="æ”¯æŒäººæ•°"></i>
                                                    <span th:text="${project.supporter}">12345</span>
                                                </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>
    <!-- FOOTER -->
    <div class="container">
        <div class="row clearfix">
            <div class="col-md-12 column">
                <div id="footer">
                    <div class="footerNav">
                        <a rel="nofollow" href="http://www.atguigu.com">å…³äºæˆ‘ä»¬</a> | <a rel="nofollow"
                                                                                      href="http://www.atguigu.com">æœåŠ¡æ¡æ¬¾</a>
                        | <a rel="nofollow" href="http://www.atguigu.com">å…è´£å£°æ˜</a> | <a rel="nofollow"
                                                                                        href="http://www.atguigu.com">ç½‘ç«™åœ°å›¾</a>
                        | <a rel="nofollow" href="http://www.atguigu.com">è”ç³»æˆ‘ä»¬</a>
                    </div>
                    <div class="copyRight">
                        Copyright ?2017-2017atguigu.com ç‰ˆæƒæ‰€æœ‰
                    </div>
                </div>

            </div>
        </div>
    </div>

</div><!-- /.container -->
</body>
</html>
```



#### 2.3.6 è°ƒç”¨ `mysql` æš´éœ²çš„æ¥å£æ‹¿åˆ°æ•°æ®å­˜å…¥åˆ°æ¨¡å‹ ã€`project` å·¥ç¨‹ã€‘

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662346333525-b2facdbf-382a-4cfc-ab43-fca139a5d46b.png)

```java
    /**
     * é¦–é¡µ > é¡¹ç›®è¯¦æƒ…é¡µé¢
     *
     * @param projectId
     * @return
     */
    @RequestMapping("/get/project/detail/{projectId}")
    public String getProjectDetail(@PathVariable("projectId") Integer projectId, Model model) {
        ResultEntity<DetailProjectVO> resultEntity = mySQLRemoteService.getDetailProjectVORemote(projectId);

        if(ResultEntity.SUCCESS.equals(resultEntity.getResult())) {
            DetailProjectVO detailProjectVO = resultEntity.getData();
            model.addAttribute("detailProjectVO", detailProjectVO);
        }

        return "project-show-detail";
    }
```



#### 2.3.7 æ–°å»º `project-show-detail.html` ä¸­æ˜¾ç¤ºæ¨¡å‹ä¸­çš„æ•°æ®ã€`project` å·¥ç¨‹ã€‘

```html
<!DOCTYPE html>
<html lang="zh-CN" xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <base th:href="@{/}"/>
    <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <link rel="stylesheet" href="css/theme.css">
    <script src="jquery/jquery-2.1.1.min.js"></script>
    <script src="bootstrap/js/bootstrap.min.js"></script>
    <script src="script/docs.min.js"></script>
    <script src="script/back-to-top.js"></script>
    <script>
        $(function () {
            $(".prjtip img").css("cursor", "pointer");
            $(".prjtip img").click(function () {
                window.location.href = 'project.html';
            });
        })
    </script>
    <style>
        #footer {
            padding: 15px 0;
            background: #fff;
            border-top: 1px solid #ddd;
            text-align: center;
        }

        #topcontrol {
            color: #fff;
            z-index: 99;
            width: 30px;
            height: 30px;
            font-size: 20px;
            background: #222;
            position: relative;
            right: 14px !important;
            bottom: 11px !important;
            border-radius: 3px !important;
        }

        #topcontrol:after {
            /*top: -2px;*/
            left: 8.5px;
            content: "\f106";
            position: absolute;
            text-align: center;
            font-family: FontAwesome;
        }

        #topcontrol:hover {
            color: #fff;
            background: #18ba9b;
            -webkit-transition: all 0.3s ease-in-out;
            -moz-transition: all 0.3s ease-in-out;
            -o-transition: all 0.3s ease-in-out;
            transition: all 0.3s ease-in-out;
        }

        .nav-tabs > li.active > a, .nav-tabs > li.active > a:focus, .nav-tabs > li.active > a:hover {
            border-bottom-color: #ddd;
        }

        .nav-tabs > li > a {
            border-radius: 0;
        }
    </style>
</head>
<body>
<div class="navbar-wrapper">
    <div class="container">
        <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand" href="#" style="font-size: 32px;">å°šç­¹ç½‘-åˆ›æ„äº§å“ä¼—ç­¹å¹³å°</a>
                </div>
                <div id="navbar" class="navbar-collapse collapse"
                     style="float: right;">
                    <ul class="nav navbar-nav">
                        <li class="dropdown"><a href="#" class="dropdown-toggle"
                                                data-toggle="dropdown"><i class="glyphicon glyphicon-user"></i>
                            [[${session.loginMember.username}]]<span class="caret"></span></a>
                            <ul class="dropdown-menu" role="menu">
                                <li><a href="member.html"><i class="glyphicon glyphicon-scale"></i> ä¼šå‘˜ä¸­å¿ƒ</a></li>
                                <li><a href="#"><i class="glyphicon glyphicon-comment"></i>
                                    æ¶ˆæ¯</a></li>
                                <li class="divider"></li>
                                <li><a th:href="@{/auth/member/logout}"><i
                                        class="glyphicon glyphicon-off"></i> é€€å‡ºç³»ç»Ÿ</a></li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    </div>
</div>

<div class="container theme-showcase" role="main">

    <div class="container">
        <div class="row clearfix">
            <div class="col-md-12 column">
                <nav class="navbar navbar-default" role="navigation">
                    <div class="collapse navbar-collapse"
                         id="bs-example-navbar-collapse-1">
                        <ul class="nav navbar-nav">
                            <li><a rel="nofollow" href="index.html"><i
                                    class="glyphicon glyphicon-home"></i> ä¼—ç­¹é¦–é¡µ</a></li>
                            <li><a rel="nofollow" href="projects.html"><i
                                    class="glyphicon glyphicon-th-large"></i> ä¼—ç­¹é¡¹ç›®</a></li>
                            <li><a rel="nofollow" href="start.html"><i
                                    class="glyphicon glyphicon-edit"></i> å‘èµ·ä¼—ç­¹</a></li>
                            <li><a rel="nofollow" href="minecrowdfunding.html"><i
                                    class="glyphicon glyphicon-user"></i> æˆ‘çš„ä¼—ç­¹</a></li>
                        </ul>
                    </div>
                </nav>
            </div>
        </div>
    </div>

    <div th:if="${#arrays.isEmpty(detailProjectVO)}">æŸ¥è¯¢é¡¹ç›®è¯¦æƒ…ä¿¡æ¯å¤±è´¥ï¼</div>
    <div th:unless="${#arrays.isEmpty(detailProjectVO)}">
        <div class="container">
            <div class="row clearfix">
                <div class="col-md-12 column">
                    <div class="jumbotron nofollow" style="padding-top: 10px;">
                        <h3 th:text="${detailProjectVO.projectName}">é…·é©°è§¦æ§é¾™å¤´ï¼Œæ™ºäº«å¨æˆ¿é»‘ç§‘æŠ€</h3>
                        <div style="float: left; width: 70%;" th:text="${detailProjectVO.projectDesc}">
                            æ™ºèƒ½æ—¶ä»£ï¼Œé…·é©°è§¦æ§å¨æˆ¿é¾™å¤´ï¼Œè®©ç…®å¦‡è§£æ”¾åŒæ‰‹ï¼Œè§¦å‘æ›´å¤šçƒ¹é¥ªçµæ„Ÿï¼Œè®©ç¾å‘³ä¿¡æ‰‹æ‹ˆæ¥ã€‚
                        </div>
                        <div style="float: right;">
                            <button type="button" class="btn btn-default">
                                <i style="color: #f60" class="glyphicon glyphicon-heart"></i>
                                å…³æ³¨[[${detailProjectVO.followerCount}]]
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="container">
            <div class="row clearfix">
                <div class="col-md-12 column">
                    <div class="row clearfix">
                        <div class="col-md-8 column" th:if="${#lists.isEmpty(detailProjectVO.detailPicturePathList)}">
                            åŠ è½½è¯¦æƒ…ä¿¡æ¯å¤±è´¥
                        </div>
                        <div class="col-md-8 column" th:unless="${#lists.isEmpty(detailProjectVO.detailPicturePathList)}">
                            <img alt="140x140" width="740" src="img/product_detail_head.jpg"
                                 th:src="${detailProjectVO.headerPicturePath}"/>
                            <img alt="140x140" width="740" src="img/product_detail_body.jpg"
                                 th:each="detailPicturePath : ${detailProjectVO.detailPicturePathList}"
                                 th:src="${detailPicturePath}"/>
                        </div>
                        <div class="col-md-4 column">
                            <div class="panel panel-default" style="border-radius: 0px;">
                                <div class="panel-heading"
                                     style="background-color: #fff; border-color: #fff;">
										<span class="label label-success"><i
                                                class="glyphicon glyphicon-tag"></i> [[${detailProjectVO.statusText}]]</span>
                                </div>
                                <div class="panel-body">
                                    <h3>å·²ç­¹èµ„é‡‘ï¼šï¿¥[[${detailProjectVO.supportMoney}]]</h3>
                                    <p>
                                        <span>ç›®æ ‡é‡‘é¢ ï¼š [[${detailProjectVO.money}]]</span><span style="float: right;">è¾¾æˆ
												ï¼š [[${detailProjectVO.percentage}]]%</span>
                                    </p>
                                    <div class="progress"
                                         style="height: 10px; margin-bottom: 5px;">
                                        <div class="progress-bar progress-bar-success"
                                             role="progressbar" aria-valuenow="[[${detailProjectVO.percentage}]]"
                                             aria-valuemin="0"
                                             aria-valuemax="100" style="width: 60%;"
                                             th:style="'width: '+${detailProjectVO.percentage}+'%;'"></div>
                                    </div>
                                    <p>å‰©ä½™ [[${detailProjectVO.lastDay}]] å¤©</p>
                                    <div>
                                        <p>
                                            <span>å·²æœ‰[[${detailProjectVO.supporterCount}]]äººæ”¯æŒè¯¥é¡¹ç›®</span>
                                        </p>
                                        <button type="button"
                                                class="btn  btn-warning btn-lg btn-block"
                                                data-toggle="modal" data-target="#myModal">ç«‹å³æ”¯æŒ
                                        </button>
                                    </div>
                                </div>
                                <div class="panel-footer"
                                     style="background-color: #fff; border-top: 1px solid #ddd; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px;">
                                    <div class="container-fluid">
                                        <div class="row clearfix">
                                            <div class="col-md-3 column" style="padding: 0;">
                                                <img alt="140x140" src="img/services-box2.jpg"
                                                     data-holder-rendered="true"
                                                     style="width: 80px; height: 80px;">
                                            </div>
                                            <div class="col-md-9 column">
                                                <div class="">
                                                    <h4>
                                                        <b>ç¦å»ºçœå—å®‰å¨å«</b> <span
                                                            style="float: right; font-size: 12px;"
                                                            class="label label-success">å·²è®¤è¯</span>
                                                    </h4>
                                                    <p style="font-size: 12px">
                                                        é…·é©°æ˜¯ä¸€å®¶å¹´è½»çš„å¨å«ç§‘æŠ€å…¬å¸ï¼Œæˆ‘ä»¬æœ‰ä¸€æ”¯æœæ°”è“¬å‹ƒï¼Œæœ‰æ¿€æƒ…ã€æœ‰æƒ³æ³•ã€æ•¢å®è·µçš„å›¢é˜Ÿã€‚</p>
                                                    <p style="font-size: 12px">å®¢æœç”µè¯:0595-86218855</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div th:if="${#lists.isEmpty(detailProjectVO.detailReturnVOList)}">æ²¡æœ‰åŠ è½½åˆ°é¡¹ç›®å›æŠ¥ä¿¡æ¯</div>
                            <div th:unless="${#lists.isEmpty(detailProjectVO.detailReturnVOList)}">
                                <div th:each="return : ${detailProjectVO.detailReturnVOList}"
                                     class="panel panel-default" style="border-radius: 0px;">
                                    <div class="panel-heading">
                                        <h3>
                                            ï¿¥[[${return.supportMoney}]]
                                            <span th:if="${return.signalPurchase == 0}"
                                                  style="float: right; font-size: 12px;">æ— é™é¢ï¼Œ447ä½æ”¯æŒè€…</span>
                                            <span th:if="${return.signalPurchase == 1}"
                                                  style="float: right; font-size: 12px;">é™é¢[[${return.purchase}]]ä½ï¼Œå‰©ä½™1966ä½</span>
                                        </h3>
                                    </div>
                                    <div class="panel-body">
                                        <p th:if="${return.freight == 0}">é…é€è´¹ç”¨ï¼šåŒ…é‚®</p>
                                        <p th:if="${return.freight > 0}">é…é€è´¹ç”¨ï¼š[[${return.freight}]]</p>
                                        <p>é¢„è®¡å‘æ”¾æ—¶é—´ï¼šé¡¹ç›®ç­¹æ¬¾æˆåŠŸåçš„[[${return.returnDate}]]å¤©å†…</p>
                                        <a th:href="@{{zuulPath}/order/confirm/return/info/{projectId}/{returnId}(zuulPath=${session.zuulPath}, projectId=${detailProjectVO.projectId}, returnId=${return.returnId})}"
                                           class="btn btn-warning btn-lg">æ”¯æŒ</a>
                                        <br>
                                        <br>
                                        <p th:text="${return.content}">
                                            æ„Ÿè°¢æ‚¨çš„æ”¯æŒï¼Œåœ¨ä¼—ç­¹å¼€å§‹åï¼Œæ‚¨å°†ä»¥79å…ƒçš„ä¼˜æƒ ä»·æ ¼è·å¾—â€œé‡è§å½©è™¹?â€æ™ºèƒ½æ’åº§ä¸€ä»¶ï¼ˆå‚è€ƒä»·208å…ƒï¼‰ã€‚</p>
                                    </div>
                                </div>
                            </div>
                            <div class=" panel panel-default" style="border-radius: 0px;">
                                <div class="panel-heading">
                                    <h3>é£é™©æç¤º</h3>
                                </div>
                                <div class="panel-body">
                                    <p>
                                        1.ä¼—ç­¹å¹¶éå•†å“äº¤æ˜“ï¼Œå­˜åœ¨ä¸€å®šé£é™©ã€‚æ”¯æŒè€…æ ¹æ®è‡ªå·±çš„åˆ¤æ–­é€‰æ‹©ã€æ”¯æŒä¼—ç­¹é¡¹ç›®ï¼Œä¸å‘èµ·äººå…±åŒå®ç°æ¢¦æƒ³å¹¶è·å¾—å‘èµ·äººæ‰¿è¯ºçš„å›æŠ¥ã€‚<br>
                                        2.ä¼—ç­¹å¹³å°ä»…æä¾›å¹³å°ç½‘ç»œç©ºé—´åŠæŠ€æœ¯æ”¯æŒç­‰ä¸­ä»‹æœåŠ¡ï¼Œä¼—ç­¹ä»…å­˜åœ¨äºå‘èµ·äººå’Œæ”¯æŒè€…ä¹‹é—´ï¼Œä½¿ç”¨ä¼—ç­¹å¹³å°äº§ç”Ÿçš„æ³•å¾‹åæœç”±å‘èµ·äººä¸æ”¯æŒè€…è‡ªè¡Œæ‰¿æ‹…ã€‚<br>
                                        3.æœ¬é¡¹ç›®å¿…é¡»åœ¨2017-06-09ä¹‹å‰è¾¾åˆ°ï¿¥10000.00
                                        çš„ç›®æ ‡æ‰ç®—æˆåŠŸï¼Œå¦åˆ™å·²ç»æ”¯æŒçš„è®¢å•å°†å–æ¶ˆã€‚è®¢å•å–æ¶ˆæˆ–å‹Ÿé›†å¤±è´¥çš„ï¼Œæ‚¨æ”¯æŒçš„é‡‘é¢å°†åŸæ”¯ä»˜è·¯å¾„é€€å›ã€‚<br>
                                        4.è¯·åœ¨æ”¯æŒé¡¹ç›®å15åˆ†é’Ÿå†…ä»˜æ¬¾ï¼Œå¦åˆ™æ‚¨çš„æ”¯æŒè¯·æ±‚ä¼šè¢«è‡ªåŠ¨å…³é—­ã€‚<br>
                                        5.ä¼—ç­¹æˆåŠŸåç”±å‘èµ·äººç»Ÿä¸€è¿›è¡Œå‘è´§ï¼Œå”®åæœåŠ¡ç”±å‘èµ·äººç»Ÿä¸€æä¾›ï¼›å¦‚æœå‘ç”Ÿå‘èµ·äººæ— æ³•å‘æ”¾å›æŠ¥ã€å»¶è¿Ÿå‘æ”¾å›æŠ¥ã€ä¸æä¾›å›æŠ¥åç»­æœåŠ¡ç­‰æƒ…å†µï¼Œæ‚¨éœ€è¦ç›´æ¥å’Œå‘èµ·äººåå•†è§£å†³ã€‚<br>
                                        6.å¦‚æ‚¨ä¸åŒæ„ä¸Šè¿°é£é™©æç¤ºå†…å®¹ï¼Œæ‚¨æœ‰æƒé€‰æ‹©ä¸æ”¯æŒï¼›ä¸€æ—¦é€‰æ‹©æ”¯æŒï¼Œè§†ä¸ºæ‚¨å·²ç¡®è®¤å¹¶åŒæ„ä»¥ä¸Šæç¤ºå†…å®¹ã€‚
                                    </p>
                                </div>
                            </div>

                            <div>
                                <h2>ä¸ºä½ æ¨è</h2>
                                <hr>
                            </div>
                            <div class="prjtip panel panel-default"
                                 style="border-radius: 0px;">
                                <div class="panel-body">
                                    <img src="img/product-3.png" width="100%" height="100%">
                                </div>
                            </div>

                            <div class="prjtip panel panel-default"
                                 style="border-radius: 0px;">
                                <div class="panel-body">
                                    <img src="img/product-4.jpg" width="100%" height="100%">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="container" style="margin-top: 20px;">
        <div class="row clearfix">
            <div class="col-md-12 column">
                <div id="footer">
                    <div class="footerNav">
                        <a rel="nofollow" href="http://www.atguigu.com">å…³äºæˆ‘ä»¬</a> | <a
                            rel="nofollow" href="http://www.atguigu.com">æœåŠ¡æ¡æ¬¾</a> | <a
                            rel="nofollow" href="http://www.atguigu.com">å…è´£å£°æ˜</a> | <a
                            rel="nofollow" href="http://www.atguigu.com">ç½‘ç«™åœ°å›¾</a> | <a
                            rel="nofollow" href="http://www.atguigu.com">è”ç³»æˆ‘ä»¬</a>
                    </div>
                    <div class="copyRight">Copyright ?2010-2014atguigu.com ç‰ˆæƒæ‰€æœ‰
                    </div>
                </div>

            </div>
        </div>
    </div>

</div>
<!-- /container -->


<div class="modal fade" id="myModal" tabindex="-1" role="dialog"
     aria-labelledby="myModalLabel">
    <div class="modal-dialog " style="width: 960px; height: 400px;"
         role="document">
        <div class="modal-content" data-spy="scroll"
             data-target="#myScrollspy">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"
                        aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title" id="myModalLabel">é€‰æ‹©æ”¯æŒé¡¹</h4>
            </div>
            <div class="modal-body">
                <div class="container-fluid">
                    <div class="row clearfix">
                        <div class="col-sm-3 col-md-3 column" id="myScrollspy">
                            <ul class="nav nav-tabs nav-stacked">
                                <li class="active"><a href="#section-1">ï¿¥1.00</a></li>
                                <li class="active"><a href="#section-2">ï¿¥149.00</a></li>
                                <li class="active"><a href="#section-3">ï¿¥249.00</a></li>
                                <li class="active"><a href="#section-4">ï¿¥549.00</a></li>
                                <li class="active"><a href="#section-5">ï¿¥1999.00</a></li>
                            </ul>
                        </div>
                        <div id="navList" class="col-sm-9 col-md-9 column"
                             style="height: 400px; overflow-y: auto;">
                            <h2 id="section-1" style="border-bottom: 1px dashed #ddd;">
                                <span style="font-size: 20px; font-weight: bold;">ï¿¥1.00</span><span
                                    style="font-size: 12px; margin-left: 60px;">æ— é™é¢ï¼Œ223ä½æ”¯æŒè€…</span>
                            </h2>
                            <p>é…é€è´¹ç”¨ï¼šå…¨å›½åŒ…é‚®</p>
                            <p>é¢„è®¡å‘æ”¾æ—¶é—´ï¼šé¡¹ç›®ç­¹æ¬¾æˆåŠŸåçš„30å¤©å†…</p>
                            <button type="button" class="btn  btn-warning btn-lg "
                                    onclick="window.location.href='pay-step-1.html'">æ”¯æŒ
                            </button>
                            <br>
                            <br>
                            <p>æ¯æ»¡1750äººæŠ½å–ä¸€å°æ´»æ€§å¯Œæ°¢å‡€æ°´ç›´é¥®æœºï¼Œè‡³å°‘æŠ½å–ä¸€å°ã€‚æŠ½å–åé¢ï¼ˆå°æ•°ç‚¹åä¸€ä½å››èˆäº”å…¥ï¼‰=å‚ä¸äººæ•°Ã·1750äººï¼Œç”±è‹å®å®˜æ–¹æŠ½å–ã€‚</p>
                            <hr>
                            <h2 id="section-2" style="border-bottom: 1px dashed #ddd;">
                                <span style="font-size: 20px; font-weight: bold;">ï¿¥149.00</span><span
                                    style="font-size: 12px; margin-left: 60px;">æ— é™é¢ï¼Œ223ä½æ”¯æŒè€…</span>
                            </h2>
                            <p>é…é€è´¹ç”¨ï¼šå…¨å›½åŒ…é‚®</p>
                            <p>é¢„è®¡å‘æ”¾æ—¶é—´ï¼šé¡¹ç›®ç­¹æ¬¾æˆåŠŸåçš„30å¤©å†…</p>
                            <button type="button" class="btn  btn-warning btn-lg "
                                    onclick="window.location.href='pay-step-1.html'">æ”¯æŒ
                            </button>
                            <br>
                            <br>
                            <p>æ¯æ»¡1750äººæŠ½å–ä¸€å°æ´»æ€§å¯Œæ°¢å‡€æ°´ç›´é¥®æœºï¼Œè‡³å°‘æŠ½å–ä¸€å°ã€‚æŠ½å–åé¢ï¼ˆå°æ•°ç‚¹åä¸€ä½å››èˆäº”å…¥ï¼‰=å‚ä¸äººæ•°Ã·1750äººï¼Œç”±è‹å®å®˜æ–¹æŠ½å–ã€‚</p>
                            <hr>
                            <h2 id="section-3" style="border-bottom: 1px dashed #ddd;">
                                <span style="font-size: 20px; font-weight: bold;">ï¿¥249.00</span><span
                                    style="font-size: 12px; margin-left: 60px;">æ— é™é¢ï¼Œ223ä½æ”¯æŒè€…</span>
                            </h2>
                            <p>é…é€è´¹ç”¨ï¼šå…¨å›½åŒ…é‚®</p>
                            <p>é¢„è®¡å‘æ”¾æ—¶é—´ï¼šé¡¹ç›®ç­¹æ¬¾æˆåŠŸåçš„30å¤©å†…</p>
                            <button type="button" class="btn  btn-warning btn-lg "
                                    onclick="window.location.href='pay-step-1.html'">æ”¯æŒ
                            </button>
                            <br>
                            <br>
                            <p>æ¯æ»¡1750äººæŠ½å–ä¸€å°æ´»æ€§å¯Œæ°¢å‡€æ°´ç›´é¥®æœºï¼Œè‡³å°‘æŠ½å–ä¸€å°ã€‚æŠ½å–åé¢ï¼ˆå°æ•°ç‚¹åä¸€ä½å››èˆäº”å…¥ï¼‰=å‚ä¸äººæ•°Ã·1750äººï¼Œç”±è‹å®å®˜æ–¹æŠ½å–ã€‚</p>
                            <hr>
                            <h2 id="section-4" style="border-bottom: 1px dashed #ddd;">
                                <span style="font-size: 20px; font-weight: bold;">ï¿¥549.00</span><span
                                    style="font-size: 12px; margin-left: 60px;">æ— é™é¢ï¼Œ223ä½æ”¯æŒè€…</span>
                            </h2>
                            <p>é…é€è´¹ç”¨ï¼šå…¨å›½åŒ…é‚®</p>
                            <p>é¢„è®¡å‘æ”¾æ—¶é—´ï¼šé¡¹ç›®ç­¹æ¬¾æˆåŠŸåçš„30å¤©å†…</p>
                            <button type="button" class="btn  btn-warning btn-lg "
                                    onclick="window.location.href='pay-step-1.html'">æ”¯æŒ
                            </button>
                            <br>
                            <br>
                            <p>æ¯æ»¡1750äººæŠ½å–ä¸€å°æ´»æ€§å¯Œæ°¢å‡€æ°´ç›´é¥®æœºï¼Œè‡³å°‘æŠ½å–ä¸€å°ã€‚æŠ½å–åé¢ï¼ˆå°æ•°ç‚¹åä¸€ä½å››èˆäº”å…¥ï¼‰=å‚ä¸äººæ•°Ã·1750äººï¼Œç”±è‹å®å®˜æ–¹æŠ½å–ã€‚</p>
                            <hr>
                            <h2 id="section-5" style="border-bottom: 1px dashed #ddd;">
                                <span style="font-size: 20px; font-weight: bold;">ï¿¥1999.00</span><span
                                    style="font-size: 12px; margin-left: 60px;">æ— é™é¢ï¼Œ223ä½æ”¯æŒè€…</span>
                            </h2>
                            <p>é…é€è´¹ç”¨ï¼šå…¨å›½åŒ…é‚®</p>
                            <p>é¢„è®¡å‘æ”¾æ—¶é—´ï¼šé¡¹ç›®ç­¹æ¬¾æˆåŠŸåçš„30å¤©å†…</p>
                            <button type="button" class="btn  btn-warning btn-lg "
                                    onclick="window.location.href='pay-step-1.html'">æ”¯æŒ
                            </button>
                            <br>
                            <br>
                            <p>æ¯æ»¡1750äººæŠ½å–ä¸€å°æ´»æ€§å¯Œæ°¢å‡€æ°´ç›´é¥®æœºï¼Œè‡³å°‘æŠ½å–ä¸€å°ã€‚æŠ½å–åé¢ï¼ˆå°æ•°ç‚¹åä¸€ä½å››èˆäº”å…¥ï¼‰=å‚ä¸äººæ•°Ã·1750äººï¼Œç”±è‹å®å®˜æ–¹æŠ½å–ã€‚</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</div>


</body>
</html>
```


# äºŒåäºŒ å‰å°-æ”¯ä»˜æ¡ˆä¾‹
```
git checkout -b 22.0.0_pay_demo
```

![img](https://cdn.nlark.com/yuque/0/2022/jpeg/12811585/1662449474458-a1c597b3-a9cd-4215-b264-5e89ebbfacc5.jpeg)

## 1. æ”¯ä»˜å®å¼€æ”¾å¹³å°

- é¦–é¡µ: https://open.alipay.com/
- æ–‡æ¡£æŒ‡å¼•: https://opendocs.alipay.com/open/01bxlm



## 2. ç”µè„‘ç½‘ç«™æ”¯ä»˜

![img](https://cdn.nlark.com/yuque/0/2022/jpeg/12811585/1662449638305-0ef9c0e4-1416-4358-886c-040c627dab29.jpeg)

### 2.1 æ€»ä½“æ­¥éª¤å‚è€ƒ

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662442908428-8b1c84f5-0153-45a6-b66f-4e450a349321.png)



### 2.2 åº”ç”¨

- å¼€å‘å·¥ç¨‹ä¸­ä½¿ç”¨å¼€å‘å¹³å°æä¾›çš„æ²™ç®±ç¯å¢ƒè¿›è¡Œè°ƒè¯•, æ²™ç®±ç¯å¢ƒä¸­çš„åº”ç”¨å·²ç»åˆ›å»ºå¥½äº†, ä¸éœ€è¦æ‰§è¡Œåˆ›å»ºæµç¨‹
- åŠŸèƒ½å¼€å‘å®Œæˆ, é¡¹ç›®ä¸Šçº¿æ—¶å†åˆ›å»ºåº”ç”¨

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662443523631-60789be5-53ec-4382-ac49-56f8f0c9c6e5.png)



### 2.3 åŠ å¯†

#### 2.3.1 å¯¹ç§°åŠ å¯†

- æ˜æ–‡ -> åŠ å¯† -> å¯†æ–‡

    - å¯†æ–‡ -> è§£å¯† -> æ˜æ–‡

- å¦‚æœçŸ¥é“å¯†æ–‡å¯ä»¥åæ¨æ˜æ–‡



#### 2.3.2 éå¯¹ç§°åŠ å¯†

å¯†ç å­¦

- å…¬é’¥åŠ å¯†ç§é’¥è§£å¯†/ç§é’¥åŠ å¯†å…¬é’¥è§£å¯†

    - ç”¨å…¬é’¥åŠ å¯†çš„ä¸èƒ½ç”¨å…¬é’¥åœ¨è§£å¯†
    - ç”¨ç§é’¥åŠ å¯†çš„ä¹Ÿä¸èƒ½ç”¨ç§é’¥å†è§£å¯†

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662444328243-9d61a568-a1f8-49ea-9486-9face050f87e.png)

- å…¬é’¥ç”Ÿæˆçš„å¯†æ–‡, ç”¨ç§é’¥å»è§£å¯†



#### 2.3.3 è°ƒç”¨æ”¯ä»˜å®æ¥å£æ—¶ä½¿ç”¨çš„ç§˜é’¥

- å•†æˆ·å’Œæ”¯ä»˜å®éƒ½è¦æä¾›å…¬é’¥å’Œç§é’¥

    - å•†æˆ·éœ€è¦è°ƒç”¨æ”¯ä»˜å®æ¥å£
    - æ”¯ä»˜å®ä¹Ÿéœ€è¦è°ƒç”¨å•†æˆ·æ¥å£

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662444764985-c75edd6c-739e-4749-a14d-82d0bcb6a535.png)

- åœ¨æ”¯ä»˜å®å¼€æ”¾å¹³å°çš„åº”ç”¨ä¸­è®¾ç½®å•†æˆ·å…¬é’¥
- åœ¨æ”¯ä»˜å®å¼€æ”¾å¹³å°çš„åº”ç”¨ä¸­è·å–æ”¯ä»˜å®çš„å…¬é’¥



- åœ¨æˆ‘ä»¬è°ƒç”¨æ”¯ä»˜å®æ¥å£çš„ç¨‹åºä¸­è®¾ç½®

    - æ”¯ä»˜å®å…¬é’¥
    - å•†æˆ·çš„ç§é’¥



#### 2.3.4 ç”Ÿæˆç§˜é’¥å·¥å…·

- https://opendocs.alipay.com/open/02nlga

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662445179524-2175d7b3-e462-4095-9de4-c1f036f6a914.png)

- å¼€å‘è€…å¯é€šè¿‡å¦‚ä¸‹å·¥å…·ç”Ÿæˆ **å…¬ã€ç§é’¥å¯¹** æˆ– **CSR æ–‡ä»¶**ï¼ˆç”¨äºç”³è¯·è¯ä¹¦ï¼‰ã€‚

    - WINDOWS: https://ideservice.alipay.com/ide/getPluginUrl.htm?clientType=assistant&platform=win&channelType=WEB
    - MAC: https://ideservice.alipay.com/ide/getPluginUrl.htm?clientType=assistant&platform=mac&channelType=WEB



##### 2.3.5 ç”Ÿæˆå•†æˆ·ç§˜é’¥

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662445501348-481d0e3a-8765-424c-bb26-97d4644ba15d.png)

- ç§é’¥

```latex
MIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQDFEqMLulY2vw9PZX3XCdleB6ri6I6+0eTBQM5gqLafaibUdEc7LwyPaFBQD5ScsRcgDP13g4h/LeUMMwtkb/0wmiKs75piCxELxiT1erGvFLm2wZK7GtXHizjDyUWxtLOVOCWj7ZvoJt/gCTmKeCSaaAVdxLuXsolZVZfml7OifwribATsvLKSGeMcSp4KX32bdQkPnpkR0J9RBAS6Yw1/mYmCiEeFgX7lMfeKhwiAEWrKup6cibJLwZ7GX1WyDfmrWQ0Z5SwSBvdo3VGAqNqoPUwggM7d0uOdYRN179jAMcQtGApg+xCQY7IaKSjLd307ZH/0ofja+1dpZhpgaKG/AgMBAAECggEAR1w3RADmRQ6sCZDzn1FGr4DRRTb2sWwpjDzePiv5bQIwK1ArluezgZ5BLqxloNOTTxzFD2jGnV7OCLvXDThsExRNKBfe7E+bjYrjSSxzeLVlhiLT8gKGlKn6FRMltHJ9cLQTFSfuA4NIH8TXXCejAXJXNxwM3aJdj8apqWsXNehs90HCP8urTkSeLsUMiU8Iee/OgwTL6xdwUEh7xFS+eWnIGxhJeJPScq+XTKKevcRPVmPJopTwjhTv61cp3i/IkaXBmRizbfI9tOO6R1EqBvWGj6b0b3+tog15Go0nCv/GRsAU1shTF23cGIRkB5O2fZsAvNcCXQ8GnoSnqBnbUQKBgQD9nqWZMTnpPgGJHGlSiM/dErjB0tb8serdl2wceXkLCf9PJAg15x5HdZL8T+AdED+fC5UH82AH9mFUqDitcyRBCl5WinC2Sr/IEFLl6e8fO1fSp50zG3bqkiLZIN1gqlEFkWwfDy7L7d4LKbtUer7iW9inOyMvCfGhEOLVsDAjaQKBgQDG7CEFLgWbNlgD1cCHnxSbnYUjXB1Dz07HvJVvtFMrRGA//aUpRDuM48U7+UT245dbw5nKwsQp3/Ky0aqLO/M9DW8kC4qMH5ExBDspgOtGmDac8Jqj66cjpZ955zryzaVxOR+Iu7rsTEwo0UpzdDnOm2VUy1Gu7CHTdJ9K5NN+5wKBgQDdsXrhsRUFHE1tU+eA3NSOU5oq2ylQFBnQf1digJBdJO0GeeGvdIqUPmMwqIWoAhcK6K3qGES+URD9VlrMy1RKgky6ayNhRW/k6tf734RFkbMQEbIpBX3qR7msgLzijZ5rNpYDhFsMqa2ppl34157Z8R0t+VSk/pU3jLIrxmod2QKBgHhBGXkrKEJ7qNuwpfKXDftBT9JfhmWO9r4y2FguODUo4dLtgKIg2KtEquClwbZLQh48ckWsVrBF7U+DBsmjVVmsPGsa+wfYsYpjV2ywvgrwS9u2bJX6CRG4t18XlYBhJ8n50YF0k/zz5vqqA4smUSgAs1J+k4Pexlgx4XaCPQUzAoGBAI/NuQpFHXueJucmSww83cEF6zf79ikFbIK5OfHVkxWaYB/EcNZNRi1MFSl+uHP3tPTT/520VMkPnO4EinviWA23roSKHQIB6XlUiOeHOkKqpnA49ivI/Gj5PqRRXSfDcqMc6HCrMVQFmV61l1gZ8jdOpp4R3GcojiE53X3P7+b0
```

- å…¬é’¥

```plain
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAxRKjC7pWNr8PT2V91wnZXgeq4uiOvtHkwUDOYKi2n2om1HRHOy8Mj2hQUA+UnLEXIAz9d4OIfy3lDDMLZG/9MJoirO+aYgsRC8Yk9XqxrxS5tsGSuxrVx4s4w8lFsbSzlTglo+2b6Cbf4Ak5ingkmmgFXcS7l7KJWVWX5pezon8K4mwE7LyykhnjHEqeCl99m3UJD56ZEdCfUQQEumMNf5mJgohHhYF+5TH3iocIgBFqyrqenImyS8Gexl9Vsg35q1kNGeUsEgb3aN1RgKjaqD1MIIDO3dLjnWETde/YwDHELRgKYPsQkGOyGikoy3d9O2R/9KH42vtXaWYaYGihvwIDAQAB
```



### 2.4 æ”¯ä»˜æµç¨‹

- https://opendocs.alipay.com/open/270/105899

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662445860622-a16346bc-653a-4619-bd7f-9a366a50d180.png)

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662445878102-9a80ebfb-7453-407c-ba1e-87e201fc07f6.png)



## 3. å†…ç½‘ç©¿é€

![img](https://cdn.nlark.com/yuque/0/2022/jpeg/12811585/1662449637333-6f471537-585f-46b9-90e3-4c43f7bf4fad.jpeg)

### 3.1 ä¸Šç½‘çš„å¸¸è§„æ–¹å¼

- åœ¨å†…ç½‘ä¸­è®¿é—®å¤–ç½‘

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662446432888-24ee4252-07f6-482d-bb5d-5aefeb7f1c34.png)



### 3.2 é¡¹ç›®å‘å¸ƒçš„å¸¸è§„æ–¹å¼

- å…ˆåœ¨å†…ç½‘ç¯å¢ƒä¸­å®Œæˆå¼€å‘, åœ¨éƒ¨ç½²åˆ°ä½äºå¤–ç½‘çš„ç”ŸæˆæœåŠ¡å™¨ä¸Š

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662446785204-8c5ff3ac-2f63-41ab-89df-e8c5191c6d08.png)



### 3.3 ç°åœ¨é¢ä¸´çš„ç‰¹æ®Šæƒ…å†µ

- æˆ‘ä»¬ç°åœ¨åœ¨å†…ç½‘å¼€å‘ç¯å¢ƒä¸‹, éœ€è¦è®©æ”¯ä»˜å®æ¥è°ƒç”¨å†…ç½‘ä¸­çš„é¡¹ç›®
- å¦‚æœä¸ç”¨ç‰¹æ®Šçš„å¤„ç†è¿™ç§æƒ…å†µæ˜¯è®¿é—®ä¸åˆ°å†…ç½‘çš„



### 3.4 å†…ç½‘ç©¿é€

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662447088258-42f22d42-4393-4d4d-9d65-24a1727cb981.png)



### 3.5 å†…ç½‘ç©¿é€å·¥å…· `natapp`

- https://natapp.cn/

#### 3.5.1 ä¸‹è½½å®¢æˆ·ç«¯å·¥å…·

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662447678360-d303a2eb-ce0b-44cc-bd4d-d09f0d6f0d53.png)

- mac 64: [ğŸ“natapp_darwin_amd64_2_3_9.zip](https://www.yuque.com/attachments/yuque/0/2022/zip/12811585/1662447992127-8d532e1a-a7ea-478a-82fe-875f7ed3e3bc.zip)
- mac åˆ¤æ–­64è¿˜æ˜¯32: ç»ˆç«¯: `uname -a`æ˜¾ç¤º `X86_**64**` å°±æ˜¯64



#### 3.5.2 æ³¨å†Œè´­ä¹°éš§é“

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662447611040-8c7f48a1-3492-44ed-99f8-5ece5bf6607d.png)

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662450198769-b4d531f8-44e5-447f-bd2f-869033d6722e.png)



#### 3.5.3 `Mac` ç”¨æˆ·ä½¿ç”¨ `natapp`

- è§£å‹å¾—åˆ° `natapp` æ–‡ä»¶
- é…ç½®æ–‡ä»¶ `config.ini`, é…ç½® `authtoken` -> åœ¨æˆ‘çš„æ¸ é“ä¸­

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662450305789-444a1db8-61d6-4e05-a112-fb6164600c35.png)

```shell
#å°†æœ¬æ–‡ä»¶æ”¾ç½®äºnatappåŒçº§ç›®å½• ç¨‹åºå°†è¯»å– [default] æ®µ
#åœ¨å‘½ä»¤è¡Œå‚æ•°æ¨¡å¼å¦‚ natapp -authtoken=xxx ç­‰ç›¸åŒå‚æ•°å°†ä¼šè¦†ç›–æ‰æ­¤é…ç½®
#å‘½ä»¤è¡Œå‚æ•° -config= å¯ä»¥æŒ‡å®šä»»æ„config.iniæ–‡ä»¶
[default]
authtoken=                      #å¯¹åº”ä¸€æ¡éš§é“çš„authtoken
clienttoken=                    #å¯¹åº”å®¢æˆ·ç«¯çš„clienttoken,å°†ä¼šå¿½ç•¥authtoken,è‹¥æ— è¯·ç•™ç©º,
log=none                        #log æ—¥å¿—æ–‡ä»¶,å¯æŒ‡å®šæœ¬åœ°æ–‡ä»¶, none=ä¸åšè®°å½•,stdout=ç›´æ¥å±å¹•è¾“å‡º ,é»˜è®¤ä¸ºnone
loglevel=ERROR                  #æ—¥å¿—ç­‰çº§ DEBUG, INFO, WARNING, ERROR é»˜è®¤ä¸º DEBUG
http_proxy=                     #ä»£ç†è®¾ç½® å¦‚ http://10.123.10.10:3128 éä»£ç†ä¸Šç½‘ç”¨æˆ·è¯·åŠ¡å¿…ç•™ç©º
```

æ­¤å¤„ä¸ºè¯­é›€åŠ å¯†æ–‡æœ¬å¡ç‰‡ï¼Œç‚¹å‡»é“¾æ¥æŸ¥çœ‹ï¼šhttps://www.yuque.com/lingchen-bf1rc/hoahc6/lt8vyw#Kaaa1

- åœ¨`Linux/Mac` ä¸‹ éœ€è¦å…ˆç»™æ‰§è¡Œæƒé™

```bash
chmod a+x natapp
```

- ç„¶åå†è¿è¡Œ

```bash
./natapp
```



#### 3.5.4 æµ‹è¯•

1. å®‰è£… `nginx`

```bash
brew install ngixn
```



1. ä¿®æ”¹ `nginx.conf`, å°†ç«¯å£æ”¹ä¸º `80`

```bash
vi /usr/local/etc/nginx/nginx.conf
```



1. é‡å¯ nginx

```bash
brew services restart nginx
```

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662450035067-01b88d46-7eb7-4cd8-8dcc-95388e877af6.png)



1. å¯åŠ¨ natapp

```bash
./natapp
```

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662450058435-1dd4cb01-063b-4459-9877-44ce9a22cc5c.png)

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662450072123-e30158f1-3388-4e3b-b24b-00e855cb43f4.png)





## 4. æ²™ç®±ç¯å¢ƒ

### 4.1 è¿›å…¥æ²™ç®±ç¯å¢ƒ

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662454969504-60be2a35-7b79-4a21-b373-fc579dd30835.png)



### 4.2 æ²™ç®±åº”ç”¨

- å¯ç”¨å…¬é’¥æ¨¡å¼: è‡ªåŠ¨ç”Ÿæˆåº”ç”¨å…¬é’¥/ç§é’¥å’Œæ”¯ä»˜å®å…¬é’¥

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662458519142-0840e618-bbf3-4a33-97e0-fc693f1299cb.png)

- æŸ¥çœ‹

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662467822180-3731f25a-5197-46a4-95eb-87ab6015515c.png)



### 4.3 æ²™ç®±æµ‹è¯• APP

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662471711403-aa5ab977-c315-4809-9fc9-1fa77c30b2ae.png)



## 5. ç”µè„‘ç½‘ç«™æ”¯ä»˜ Demo

### 5.1 ä¸‹è½½ Demo

- `Demo` é™„ä»¶: [ğŸ“alipay.trade.page.pay-JAVA-UTF-8.zip](https://www.yuque.com/attachments/yuque/0/2022/zip/12811585/1662450537769-30d5c266-56ab-4ad9-aa85-90c9b5c9dd4d.zip)
- https://opendocs.alipay.com/open/270/106291

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662450489249-93d9f947-10ba-48ec-b5b3-49fa1ff4d569.png)



## 6. ä½¿ç”¨ `Eclipse` å¯¼å…¥ `Demo`

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662454632236-cdcfc73a-4f4d-4784-b442-11dc4cbfda8c.png)

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662454610801-8b9e060a-013c-4139-a6e2-bc8cd9f35848.png)



## 7. ä½¿ç”¨ `Idea` æ‰“å¼€æ”¯ä»˜æ¡ˆä¾‹ `Demo`

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662474766428-4101e3ef-7176-4e2b-8dea-e50b01367037.png)

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662474756975-144f7439-720f-4de4-bd14-3ef85576d887.png)

### 7.1 é…ç½®ä¾èµ– `command + ;`

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662453269136-19a0a4b6-b89b-4d32-9a06-cfda6f35799e.png)

1. å»æ‰çº¢è‰²ä¾èµ–
2. æ·»åŠ ä¾èµ–åŒ…

- ç‚¹å‡» `+` å·, é€‰æ‹©

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662453380538-812876f6-5ff2-4b03-a9e8-a015410315da.png)

- åŠ å…¥ä¾èµ–, ä¸€ä¸ªä¸€ä¸ªé€‰æ‹©

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662469931753-3e02820b-e92b-4586-be5a-8313b8a107f9.png)\![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662469942955-2b647dfc-b65c-4176-9a00-f578990285f8.png)

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662475321209-76fd20e1-044c-427a-82ea-a5fd8ad2e7d9.png)



### 7.2 é…ç½® `Web` å’Œ `Tamcat Server`

1. æ·»åŠ  `Web`

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662470234078-d004f779-c85d-4b3f-886f-c78f3888d7b7.png)



1. å‡å» Web.xml

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662470301375-680b2b0c-374f-4222-8d5a-9bc9070dba57.png)



1. ä¿®æ”¹ `web` ç›®å½•

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662470323751-ea3ed674-ecd3-4161-ad60-1405cf4efb80.png)



1. ç‚¹å‡» `Create Artifact`

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662470347334-3c685cd1-c9b8-4b84-892f-f1f5abf83da6.png)



1. å³é”®æ·»åŠ 

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662470399143-a35eb462-2811-4a46-adc2-eb7ca3774778.png)

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662470443570-c66a2994-6391-4c1a-ae66-81afd560e6ac.png)

- è®°å¾—ç‚¹å‡» `Apply`

1. æ‰“å¼€è¿è¡Œé…ç½®

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662470484680-0d2eaa47-7657-4d1a-bda2-637d8bd0ffbd.png)



1. æ·»åŠ  `Tomcat Server`

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662470738432-319a8d4b-55e3-4be7-8b7c-f92bb8d506e6.png)



1. å°† `Artifact` æ·»åŠ è¿›å…¥

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662470609797-1e26eb7b-74e9-476b-840e-65e8b8c81043.png)



### 7.3 ä¿®æ”¹é…ç½®æ–‡ä»¶

- å°†æ–‡ä»¶æ ¼å¼æ”¹ä¸º `GBK` å†æ”¹ä¸º `UTF-8`

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662453146503-32e333bc-c062-4533-a948-179021144b72.png)

```java
package com.alipay.config;

import java.io.FileWriter;
import java.io.IOException;

/* *
 *ç±»åï¼šAlipayConfig
 *åŠŸèƒ½ï¼šåŸºç¡€é…ç½®ç±»
 *è¯¦ç»†ï¼šè®¾ç½®å¸æˆ·æœ‰å…³ä¿¡æ¯åŠè¿”å›è·¯å¾„
 *ä¿®æ”¹æ—¥æœŸï¼š2017-04-05
 *è¯´æ˜ï¼š
 *ä»¥ä¸‹ä»£ç åªæ˜¯ä¸ºäº†æ–¹ä¾¿å•†æˆ·æµ‹è¯•è€Œæä¾›çš„æ ·ä¾‹ä»£ç ï¼Œå•†æˆ·å¯ä»¥æ ¹æ®è‡ªå·±ç½‘ç«™çš„éœ€è¦ï¼ŒæŒ‰ç…§æŠ€æœ¯æ–‡æ¡£ç¼–å†™,å¹¶éä¸€å®šè¦ä½¿ç”¨è¯¥ä»£ç ã€‚
 *è¯¥ä»£ç ä»…ä¾›å­¦ä¹ å’Œç ”ç©¶æ”¯ä»˜å®æ¥å£ä½¿ç”¨ï¼Œåªæ˜¯æä¾›ä¸€ä¸ªå‚è€ƒã€‚
 */

public class AlipayConfig {

//â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“è¯·åœ¨è¿™é‡Œé…ç½®æ‚¨çš„åŸºæœ¬ä¿¡æ¯â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“

    // åº”ç”¨ID,æ‚¨çš„APPIDï¼Œæ”¶æ¬¾è´¦å·æ—¢æ˜¯æ‚¨çš„APPIDå¯¹åº”æ”¯ä»˜å®è´¦å·
    // ä½¿ç”¨æ²™ç®±ç¯å¢ƒçš„ APPID
    public static String app_id = "2016100100642012";

    // å•†æˆ·ç§é’¥ï¼Œæ‚¨çš„PKCS8æ ¼å¼RSA2ç§é’¥
    public static String merchant_private_key = "MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQCSW8OKd+By+Ea7UP9yCbWtlhvr7QvgAfiG9joMwbZ+Zma2/YMOWaAPD6NowrnaNaNd9gWZB/qJ1oe5QAXUi4bi/J1n+1+T1giRSaFtpkfDeRBvKmTiSyYCeGk7aeT0FWODWQB7ZnPD9R6KCeJCVhzN2YmurNFHftiM1fFcRHUNb5Daw0m7xKrOebQwMIk7K3at5a/Yd5nMUcOqoUOKTXMjxXSW6CnFXMCirPhg/e5aAMD+GiOUOIKx/DTtnZjVBv5UF0MJ7Xg1/wtrkHi4k3ZPLwJdMjv4UOH9377BbGFkyc0/0PJPhG69TqyyOInUCDNDyhzaYpH423GhlJy4uywrAgMBAAECggEAenw/jp+6gJ1VnKgxz/9eQ3Lv1SdiG8uqcVCZzllD4E7UwWoyhwzszg35ZNAqd/sRyK3/i03JGBgpKBjziCho74gYN5CBMZkbPHQRnFFfl7C210H0ggoAOmsJLob17GwGB0OyCpP4aFO4hi+1Ymzs2D2pYz0QPDRlCKB3yQ8louKjlykGSWwo58zwm935BHvv//JijHGbMbqDJGMfj/ogjhDP0txE7ZBiO9sEc1RjZ5Csg/81H8XSXCGyMowTX+I2M2ys59HMiuZFLM3pG5/UfOkqGKEJcv/ymsKILgL5h2XvLIFbgUqG4WMmHAX+moApnqmnkOtvSnE1u9hnBIkE+QKBgQDuerisalgfDlJ4wn3A7yQyX4cbT3ozLmqo/FZrlrd/ZJ/HgFrGBiEjaSxWRUxVUBGOgyQszOCzvhPySJjW6Y+xcai1MpC0z9fnvbpFM5GVVKUDIIA//O8+Ukd7wZyW20jebeFNk9I/kTAHs751wSJ8x60OET34r+ESk6aV+9xMDQKBgQCdHHK2XKgbUb+LtM0BUDq4KzPWW3/XYMrKpazDjwB+z2XWJSzch4nXyEa/8QAnUI3Atyn0fK1BmfyvFFtHpQtUpMUKtsswz9+RLwFrFrMspl3POlQEaU32fzl/RL7mybZyt71Mqcgq41DAtrVcyXWhgU1x6XrHcCxwZ0LROsDzFwKBgEolLbWteqhtM4cIMUEDGSXwPXloRH4VOGRB0DyzJ2ocRvEoHxDiZvszf+1yrkD4G/1LGLw1FsfLmTgDCkIHa/2ncOSlTAhrdp0+h+NsHR9oqcVHHZjHczrVKhR4Jc9hbk55q0sLYpsQ8PX0FItX+PkCu/NbuQDQ7hFwhqKrI9shAoGADU9LqIdQ9n+Gap92fpX9Y3zFd3No8SYSB/jhGfATaqrHRc0Ab+5Ljyw4UipoiOwaFiluNHgbdWNGNM7UrM0emJ0c1DuIGyqBFhuVUy0pIK83Y0bdt0H0iN1eUZnRUlvkSPOn5ca8XmXDgY/47VNj07rQhMXy0NJ/8UXOM0t27SECgYEAxERMjSKIjJ4VRcVcroBzdXZ2O3Pj9r1BLkyY8qKmptYvA+yinVWvvVzwjoHqLoqEkVZMq2ixrLYt7sl3esfGyUIdxjXUI1cbvCOpbDe7f0kJxvXyldC5Lrtama5gdJE36JFGbWrf2PRg4in1sizMjyY8G/SDMS0MNKpzos4pASQ=";

    // æ”¯ä»˜å®å…¬é’¥,æŸ¥çœ‹åœ°å€ï¼šhttps://openhome.alipay.com/platform/keyManage.htm å¯¹åº”APPIDä¸‹çš„æ”¯ä»˜å®å…¬é’¥ã€‚
    public static String alipay_public_key = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAoauF73gbBsJVQkFK/gmmVOWzYevEJZyPozl9L/49MvZKgo9oVOniBIJZq3+/ve6UZUKxLhKGFekP7mCsqMP3J+dr/a12gcVeBX8mu8J6ArwJnQ+pNsbZl9/dlpaob7qEGPd4gCZyr4J31ejpHrFJZBrUeHMtp3bo41YlMa7EKq4eoI8o8nm8yLFedtmtE5/LlY1uj3W0n6ZTGMjGfAOBQSICeoEJZPH+9u/NkLC/2FhRNNMwEAyp0xYQ3AjlX93GFL5F/1nc56oXDzpcIVzBXW+RP8Of1ISwFiXw6qF/P+zXLUNFmjDh03bJrdHoYuvS/Xygs53gwLYFIF+Qdo1KBwIDAQAB";

    // æœåŠ¡å™¨å¼‚æ­¥é€šçŸ¥é¡µé¢è·¯å¾„  éœ€http://æ ¼å¼çš„å®Œæ•´è·¯å¾„ï¼Œä¸èƒ½åŠ ?id=123è¿™ç±»è‡ªå®šä¹‰å‚æ•°ï¼Œå¿…é¡»å¤–ç½‘å¯ä»¥æ­£å¸¸è®¿é—®
    // å·¥ç¨‹å…¬ç½‘è®¿é—®åœ°å€é¦–é¡µå†…ç½‘ç©¿é€å®¢æˆ·ç«¯æä¾›çš„åŸŸå
    public static String notify_url = "http://xsxpge.natappfree.cc/alipay_trade_page_pay_JAVA_UTF_8_Web_exploded//notify_url.jsp";

    // é¡µé¢è·³è½¬åŒæ­¥é€šçŸ¥é¡µé¢è·¯å¾„ éœ€http://æ ¼å¼çš„å®Œæ•´è·¯å¾„ï¼Œä¸èƒ½åŠ ?id=123è¿™ç±»è‡ªå®šä¹‰å‚æ•°ï¼Œå¿…é¡»å¤–ç½‘å¯ä»¥æ­£å¸¸è®¿é—®
    // å·¥ç¨‹å…¬ç½‘è®¿é—®åœ°å€é¦–é¡µå†…ç½‘ç©¿é€å®¢æˆ·ç«¯æä¾›çš„åŸŸå
    public static String return_url = "http://xsxpge.natappfree.cc/alipay_trade_page_pay_JAVA_UTF_8_Web_exploded//return_url.jsp";

    // ç­¾åæ–¹å¼
    public static String sign_type = "RSA2";

    // å­—ç¬¦ç¼–ç æ ¼å¼
    public static String charset = "utf-8";

    // æ”¯ä»˜å®ç½‘å…³ï¼ˆæ­£å¼ç¯å¢ƒï¼‰
    /// public static String gatewayUrl = "https://openapi.alipay.com/gateway.do";

    // æ”¯ä»˜å®ç½‘å…³ï¼ˆæ²™ç®±ç¯å¢ƒï¼‰
    public static String gatewayUrl = "https://openapi.alipaydev.com/gateway.do";

    // æ—¥å¿—è·¯å¾„ï¼ˆwinï¼‰
    // public static String log_path = "C:\\";

    // æ—¥å¿—è·¯å¾„ï¼ˆmacï¼‰
    public static String log_path = "/Users/chenjianglin/Desktop/";

//â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘è¯·åœ¨è¿™é‡Œé…ç½®æ‚¨çš„åŸºæœ¬ä¿¡æ¯â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘

    /**
     * å†™æ—¥å¿—ï¼Œæ–¹ä¾¿æµ‹è¯•ï¼ˆçœ‹ç½‘ç«™éœ€æ±‚ï¼Œä¹Ÿå¯ä»¥æ”¹æˆæŠŠè®°å½•å­˜å…¥æ•°æ®åº“ï¼‰
     * @param sWord è¦å†™å…¥æ—¥å¿—é‡Œçš„æ–‡æœ¬å†…å®¹
     */
    public static void logResult(String sWord) {
        FileWriter writer = null;
        try {
            writer = new FileWriter(log_path + "alipay_log_" + System.currentTimeMillis()+".txt");
            writer.write(sWord);
        } catch (Exception e) {
            e.printStackTrace();
        } finally {
            if (writer != null) {
                try {
                    writer.close();
                } catch (IOException e) {
                    e.printStackTrace();
                }
            }
        }
    }
}
```



### 7.4 å¯åŠ¨ `Tomcat`

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662470792565-1bcf0af3-aa68-4aaa-a3a8-91d06181a5f6.png)



### 7.5 æµ‹è¯•

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662475072176-b48c558d-30de-4783-8624-6e1aa38a5135.png)

- ç‚¹å‡»ä»˜æ¬¾

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662475191740-b3c1aafc-f482-4832-9f2e-1c889e776eeb.png)

- æ‰«ç ä»˜æ¬¾

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662475244057-c8bedc91-7ad7-4531-986c-3f06c8b1ba7f.png)

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662475250302-1617b55a-5102-412d-a0b3-efd065ae10e0.png)

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662475256993-041d2b26-8f41-42e0-814f-763be06c3ea2.png)



# äºŒåä¸‰ å‰å°-è®¢å•

```
git checkout -b 23.0.0_order
```

![img](https://cdn.nlark.com/yuque/0/2022/jpeg/12811585/1662716619135-86e08dfc-6ffa-490a-a766-ca4864b3cfc8.jpeg)

## 1. æ­å»º `order` å¼€å‘ç¯å¢ƒ

### 1.1 è¿½åŠ ä»£ç  `pom.xml`

```xml
    <dependencies>
        <dependency>
            <groupId>com.atguigu.crowd</groupId>
            <artifactId>atcrowdfunding17-member-api</artifactId>
            <version>1.0-SNAPSHOT</version>
        </dependency>
        <!-- å¯¼å…¥é…ç½®æ–‡ä»¶å¤„ç†å™¨, é…ç½®æ–‡ä»¶è¿›è¡Œç»‘å®š -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-configuration-processor</artifactId>
            <optional>true</optional>
        </dependency>
        <!-- å¯¹å¤–æš´éœ²æœåŠ¡ -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-web</artifactId>
        </dependency>
        <!-- æ•´åˆè§†å›¾ -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-thymeleaf</artifactId>
        </dependency>
        <!-- ä½œä¸ºå®¢æˆ·ç«¯è®¿é—® Eureka æ³¨å†Œä¸­å¿ƒ -->
        <dependency>
            <groupId>org.springframework.cloud</groupId>
            <artifactId>spring-cloud-starter-netflix-eureka-client</artifactId>
        </dependency>
        <!-- SpringBoot æµ‹è¯• -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-test</artifactId>
            <scope>test</scope>
        </dependency>
        <!-- å¼•å…¥ SpringBoot & Redis åœºæ™¯ -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-data-redis</artifactId>
        </dependency>
        <!-- å¼•å…¥ SpringBoot & SpringSession åœºæ™¯ -->
        <dependency>
            <groupId>org.springframework.session</groupId>
            <artifactId>spring-session-data-redis</artifactId>
        </dependency>
    </dependencies>

    <build>
        <plugins>
            <!-- è¿™ä¸ªæ’ä»¶å°† SpringBoot åº”ç”¨æ‰“åŒ…æˆä¸€ä¸ªå¯æ‰§è¡Œçš„ jar åŒ… -->
            <plugin>
                <groupId>org.springframework.boot</groupId>
                <artifactId>spring-boot-maven-plugin</artifactId>
                <executions>
                    <execution>
                        <goals>
                            <goal>repackage</goal>
                        </goals>
                    </execution>
                </executions>
            </plugin>
        </plugins>
    </build>
```



### 1.2 æ–°å»º `application.yml` é…ç½®æ–‡ä»¶

```yaml
server:
  port: 6000

spring:
  application:
    name: atguigu-crowd-order
  session:
    store-type: redis

eureka:
  client:
    service-url:
      defaultZone: http://localhost:1000/eureka

ribbon:
  # 10ç§’ - å¤„ç†è¯·æ±‚çš„è¶…æ—¶æ—¶é—´ï¼Œé»˜è®¤ä¸º5ç§’
  ReadTimeout: 10000
  # 10ç§’ - è¿æ¥å»ºç«‹çš„è¶…æ—¶æ—¶é•¿ï¼Œé»˜è®¤5ç§’
  ConnectTimeout: 10000
```



### 1.3 æ–°å»º `CrowdMainClass` ä¸»å¯åŠ¨ç±»

```java
package com.atguigu.crowd;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.cloud.openfeign.EnableFeignClients;

/**
 * @author é™ˆæ±Ÿæ—
 * @date 2022/9/7 17:13
 */
@EnableFeignClients
@SpringBootApplication
public class CrowdMainClass {

    public static void main(String[] args) {
        SpringApplication.run(CrowdMainClass.class, args);
    }

}
```



## 2. é…ç½® `zuul`

### 2.1 è¿½åŠ è·¯ç”±è§„åˆ™ `application.yml`

```yaml
zuul:
	routes:
  	crowd-order:
    	service-id: atguigu-crowd-order
    	path: /order/**
```



## 3. å»ºæ¨¡

### 3.1 ç»“æ„

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662543066363-188b6583-7953-4033-80eb-a03843aa127b.png)

-  ä¸åŠ å¤–é”®



### 3.2 ç‰©ç†å»ºæ¨¡

```plsql
SET NAMES utf8mb4;
SET FOREIGN_KEY_CHECKS = 0;

-- ----------------------------
-- Table structure for t_order
-- ----------------------------
DROP TABLE IF EXISTS `t_order`;
CREATE TABLE `t_order` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `address_id` varchar(255) DEFAULT NULL COMMENT 'æ”¶è´§åœ°å€è¡¨ä¸»é”®',
  `order_name` varchar(255) DEFAULT NULL COMMENT 'è®¢å•å·',
  `pay_order_num` varchar(255) DEFAULT NULL COMMENT 'æ”¯ä»˜å®æµæ°´å•å·',
  `order_amount` double(10, 5) DEFAULT NULL COMMENT 'è®¢å•é‡‘é¢',
  `invoice` varchar(255) DEFAULT NULL COMMENT 'æ˜¯å¦å¼€å‘ç¥¨ [{0: ä¸å¼€å‘ç¥¨}, {1: å¼€å‘ç¥¨}]',
  `invoice_title` varchar(255) DEFAULT NULL COMMENT 'å‘ç¥¨æŠ¬å¤´',
  `order_remark` varchar(255) DEFAULT NULL COMMENT 'è®¢å•å¤‡æ³¨',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='è®¢å•è¡¨';

-- ----------------------------
-- Records of t_order
-- ----------------------------
BEGIN;
COMMIT;

SET FOREIGN_KEY_CHECKS = 1;

SET NAMES utf8mb4;
SET FOREIGN_KEY_CHECKS = 0;

-- ----------------------------
-- Table structure for t_address
-- ----------------------------
DROP TABLE IF EXISTS `t_address`;
CREATE TABLE `t_address` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `receive_name` varchar(255) DEFAULT NULL COMMENT 'æ”¶ä»¶äºº',
  `phone_num` varchar(255) DEFAULT NULL COMMENT 'æ‰‹æœºå·',
  `address` varchar(255) DEFAULT NULL COMMENT 'åœ°å€',
  `member_id` varchar(255) DEFAULT NULL COMMENT 'ä¼šå‘˜è¡¨ä¸»é”®',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='æ”¶è´§åœ°å€è¡¨';

-- ----------------------------
-- Records of t_address
-- ----------------------------
BEGIN;
COMMIT;

SET FOREIGN_KEY_CHECKS = 1;

SET NAMES utf8mb4;
SET FOREIGN_KEY_CHECKS = 0;

-- ----------------------------
-- Table structure for t_order_project
-- ----------------------------
DROP TABLE IF EXISTS `t_order_project`;
CREATE TABLE `t_order_project` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `project_name` varchar(255) DEFAULT NULL COMMENT 'é¡¹ç›®åç§°',
  `launch_name` varchar(255) DEFAULT NULL COMMENT 'å‘èµ·äºº',
  `return_content` varchar(255) DEFAULT NULL COMMENT 'å›æŠ¥å†…å®¹',
  `return_count` int(11) DEFAULT NULL COMMENT 'å›æŠ¥æ•°é‡',
  `support_price` int(11) DEFAULT NULL COMMENT 'æ”¯æŒå•ä»·',
  `freight` int(11) DEFAULT NULL COMMENT 'é…é€è´¹ç”¨',
  `order_id` varchar(255) DEFAULT NULL COMMENT 'è®¢å•è¡¨ä¸»é”®',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='é¡¹ç›®ä¿¡æ¯è¡¨';

-- ----------------------------
-- Records of t_order_project
-- ----------------------------
BEGIN;
COMMIT;

SET FOREIGN_KEY_CHECKS = 1;
```



#### 3.2.1 è®¢å•è¡¨

```plsql
SET NAMES utf8mb4;
SET FOREIGN_KEY_CHECKS = 0;

-- ----------------------------
-- Table structure for t_order
-- ----------------------------
DROP TABLE IF EXISTS `t_order`;
CREATE TABLE `t_order` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `address_id` varchar(255) DEFAULT NULL COMMENT 'æ”¶è´§åœ°å€è¡¨ä¸»é”®',
  `order_name` varchar(255) DEFAULT NULL COMMENT 'è®¢å•å·',
  `pay_order_num` varchar(255) DEFAULT NULL COMMENT 'æ”¯ä»˜å®æµæ°´å•å·',
  `order_amount` double(10, 5) DEFAULT NULL COMMENT 'è®¢å•é‡‘é¢',
  `invoice` varchar(255) DEFAULT NULL COMMENT 'æ˜¯å¦å¼€å‘ç¥¨ [{0: ä¸å¼€å‘ç¥¨}, {1: å¼€å‘ç¥¨}]',
  `invoice_title` varchar(255) DEFAULT NULL COMMENT 'å‘ç¥¨æŠ¬å¤´',
  `order_remark` varchar(255) DEFAULT NULL COMMENT 'è®¢å•å¤‡æ³¨',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='è®¢å•è¡¨';

-- ----------------------------
-- Records of t_order
-- ----------------------------
BEGIN;
COMMIT;

SET FOREIGN_KEY_CHECKS = 1;
```



#### 3.2.2 æ”¶è´§åœ°å€è¡¨

```plsql
SET NAMES utf8mb4;
SET FOREIGN_KEY_CHECKS = 0;

-- ----------------------------
-- Table structure for t_address
-- ----------------------------
DROP TABLE IF EXISTS `t_address`;
CREATE TABLE `t_address` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `receive_name` varchar(255) DEFAULT NULL COMMENT 'æ”¶ä»¶äºº',
  `phone_num` varchar(255) DEFAULT NULL COMMENT 'æ‰‹æœºå·',
  `address` varchar(255) DEFAULT NULL COMMENT 'åœ°å€',
  `member_id` varchar(255) DEFAULT NULL COMMENT 'ä¼šå‘˜è¡¨ä¸»é”®',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='æ”¶è´§åœ°å€è¡¨';

-- ----------------------------
-- Records of t_address
-- ----------------------------
BEGIN;
COMMIT;

SET FOREIGN_KEY_CHECKS = 1;
```



#### 3.2.3 é¡¹ç›®ä¿¡æ¯è¡¨

```plsql
SET NAMES utf8mb4;
SET FOREIGN_KEY_CHECKS = 0;

-- ----------------------------
-- Table structure for t_order_project
-- ----------------------------
DROP TABLE IF EXISTS `t_order_project`;
CREATE TABLE `t_order_project` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `project_name` varchar(255) DEFAULT NULL COMMENT 'é¡¹ç›®åç§°',
  `launch_name` varchar(255) DEFAULT NULL COMMENT 'å‘èµ·äºº',
  `return_content` varchar(255) DEFAULT NULL COMMENT 'å›æŠ¥å†…å®¹',
  `return_count` int(11) DEFAULT NULL COMMENT 'å›æŠ¥æ•°é‡',
  `support_price` int(11) DEFAULT NULL COMMENT 'æ”¯æŒå•ä»·',
  `freight` int(11) DEFAULT NULL COMMENT 'é…é€è´¹ç”¨',
  `order_id` varchar(255) DEFAULT NULL COMMENT 'è®¢å•è¡¨ä¸»é”®',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='é¡¹ç›®ä¿¡æ¯è¡¨';

-- ----------------------------
-- Records of t_order_project
-- ----------------------------
BEGIN;
COMMIT;

SET FOREIGN_KEY_CHECKS = 1;
```



## 4. ç”Ÿæˆå®ä½“ç±», é€†å‘å·¥ç¨‹ã€reverseã€‘å·¥ç¨‹

### 4.1 è¿½åŠ é…ç½®

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662547661391-94d7cc3f-cc5b-48d2-b2ec-b2d4f7b419f1.png)

```xml
<table tableName="t_order" domainObjectName="OrderPO"/>
<table tableName="t_address" domainObjectName="AddressPO"/>
<table tableName="t_order_project" domainObjectName="OrderProjectPO"/>
```



### 4.2 å°†ç”Ÿæˆçš„æ–‡ä»¶ç§»åŠ¨åˆ°å¯¹åº”çš„ä½ç½®

- å®ä½“ç±»è®°å¾—åŠ æ³¨è§£

```java
@NoArgsConstructor
@AllArgsConstructor
@Data
```

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662547628215-176ca0cc-f3d7-4757-8c1a-2853f9a6e613.png)

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662547639422-494b0ad3-79ab-4b11-a498-15fde8a2f1da.png)



## 5. ç›®æ ‡1: ç¡®è®¤å›æŠ¥å†…å®¹

### 5.1 æ€è·¯

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662548296095-35379c7b-4f67-49b5-bbce-da689cc1e92a.png)



### 5.2 æ“ä½œèµ·ç‚¹

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662548805196-18dc8521-1d13-477c-a7c5-f8e2804135e0.png)

- å…³é”®ä»£ç 

```html
<a th:href="@{{zuulPath}/order/confirm/return/info/{returnId}(zuulPath=${session.zuulPath}, returnId=${return.returnId})}"
                                           class="btn btn-warning btn-lg">æ”¯æŒ</a>
```



### 5.3 æ–°å»º `OrderProjectVO`

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662550297381-3e7f04fd-e86c-41a3-a803-eb1676a05f70.png)

```java
package com.atguigu.crowd.entity.vo;

import lombok.AllArgsConstructor;
import lombok.Data;
import lombok.NoArgsConstructor;

import java.io.Serializable;

/**
 * @author é™ˆæ±Ÿæ—
 * @date 2022/9/7 19:09
 */
@NoArgsConstructor
@AllArgsConstructor
@Data
public class OrderProjectVO implements Serializable {

    private static final long serialVersionUID = 1L;

    private Integer id;

    /**
     * é¡¹ç›®åç§°
     */
    private String projectName;

    /**
     * å‘èµ·äºº
     */
    private String launchName;

    /**
     * å›æŠ¥å†…å®¹
     */
    private String returnContent;

    /**
     * å›æŠ¥æ•°é‡
     */
    private Integer returnCount;

    /**
     * æ”¯æŒå•ä»·
     */
    private Integer supportPrice;

    /**
     * é…é€è´¹ç”¨
     */
    private Integer freight;

    /**
     * è®¢å•è¡¨ä¸»é”®
     */
    private String orderId;

    /**
     * æ˜¯å¦è®¾ç½®å•ç¬”é™è´­
     */
    private Integer signalPurchase;

    /**
     * å…·ä½“é™è´­æ•°é‡
     */
    private Integer purchase;

}
```



### 5.4 æ–°å»º `OderHandler`

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662550385549-c5cab60c-31bc-4b67-a64b-345335402bd5.png)

```java
package com.atguigu.crowd.handler;

import com.atguigu.crowd.api.MySQLRemoteService;
import com.atguigu.crowd.entity.vo.OrderProjectVO;
import com.atguigu.crowd.util.ResultEntity;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RequestMapping;

import javax.servlet.http.HttpSession;

/**
 * @author é™ˆæ±Ÿæ—
 * @date 2022/9/7 19:32
 */
@Controller
public class OderHandler {

    @Autowired
    private MySQLRemoteService mySQLRemoteService;

    /**
     * é¦–é¡µ -> é¡¹ç›®è¯¦æƒ…ï¼ˆç‚¹å‡»æ”¯æŒï¼‰ -> æ˜¾ç¤ºå›æŠ¥ç¡®è®¤ä¿¡æ¯
     *
     * @param returnId 
     * @param session  
     * @return {@link String}
     */
    @RequestMapping("/confirm/return/info/{returnId}")
    public String showReturnConfirmInfo(@PathVariable("returnId") Integer returnId,
                                        HttpSession session) {
        // æŸ¥è¯¢æ•°æ®
        ResultEntity<OrderProjectVO> resultEntity = mySQLRemoteService.getOrderProjectVORemote(returnId);

        // åˆ¤æ–­æŸ¥è¯¢ç»“æœ
        if (ResultEntity.SUCCESS.equals(resultEntity.getResult())) {
            OrderProjectVO orderProjectVO = resultEntity.getData();

            // ä¸ºäº†èƒ½å¤Ÿåœ¨åç»­æ“ä½œä¸­ä¿å­˜ orderProjectVO æ•°æ®, å­˜å…¥ Session åŸŸä¸­
            session.setAttribute("orderProjectVO", orderProjectVO);
        }

        return "confirm_return";
    }

}
```



### 5.5 è¿½åŠ æ¥å£ ã€`api` å·¥ç¨‹ã€‘

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662551959570-982a8924-388f-40d0-9ad9-2ee5bfb5515b.png)

```java
    /**
     * è·å–è®¢å•é¡¹ç›®
     *
     * @param returnId å›æŠ¥id
     * @return {@link ResultEntity}<{@link OrderProjectVO}>
     */
    @RequestMapping("/get/order/project/vo/remote/{returnId}")
    ResultEntity<OrderProjectVO> getOrderProjectVORemote(@PathVariable("returnId") Integer returnId);
```



### 5.6 å®Œæˆæ¥å£ã€`mysql` å·¥ç¨‹ã€‘

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662553043452-43062c10-507c-467b-a42a-8b89c887e654.png)

- æ–°å»º `OrderProviderHandler`

```java
package com.atguigu.crowd.handler;

import com.atguigu.crowd.entity.vo.OrderProjectVO;
import com.atguigu.crowd.service.api.OrderService;
import com.atguigu.crowd.util.ResultEntity;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

/**
 * @author é™ˆæ±Ÿæ—
 * @date 2022/9/7 20:15
 */
@RestController
public class OrderProviderHandler {

    @Autowired
    private OrderService orderService;

    @RequestMapping("/get/order/project/vo/remote/{returnId}")
    ResultEntity<OrderProjectVO> getOrderProjectVORemote(@PathVariable("returnId") Integer returnId) {
        try {
            OrderProjectVO orderProjectVO = orderService.getOrderProjectVO(returnId);
            return ResultEntity.successWithData(orderProjectVO);
        } catch (Exception e) {
            e.printStackTrace();
            return ResultEntity.failed(e.getMessage());
        }
    }

}
```



- æ–°å»º `OrderService`

```java
package com.atguigu.crowd.service.api;

import com.atguigu.crowd.entity.vo.OrderProjectVO;
import com.atguigu.crowd.util.ResultEntity;

/**
 * @author é™ˆæ±Ÿæ—
 * @date 2022/9/7 20:16
 */
public interface OrderService {

    /**
     * è·å–è®¢å•é¡¹ç›®è§†å›¾å¯¹è±¡
     *
     * @param returnId  å›æŠ¥id
     * @return {@link ResultEntity}<{@link OrderProjectVO}>
     */
    OrderProjectVO getOrderProjectVO(Integer returnId);

}
```



- æ–°å»º `OrderServiceImpl`

```java
package com.atguigu.crowd.service.impl;

import com.atguigu.crowd.entity.vo.OrderProjectVO;
import com.atguigu.crowd.mapper.AddressPOMapper;
import com.atguigu.crowd.mapper.OrderPOMapper;
import com.atguigu.crowd.mapper.OrderProjectPOMapper;
import com.atguigu.crowd.service.api.OrderService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

/**
 * @author é™ˆæ±Ÿæ—
 * @date 2022/9/7 20:17
 */
@Service
@Transactional(readOnly = true)
public class OrderServiceImpl implements OrderService {

    @Autowired
    private OrderProjectPOMapper orderProjectPOMapper;

    @Autowired
    private OrderPOMapper orderPOMapper;

    @Autowired
    private AddressPOMapper addressPOMapper;

    @Override
    public OrderProjectVO getOrderProjectVO(Integer returnId) {
        return orderProjectPOMapper.selectOrderProjectVO(returnId);
    }

}
```



- è¿½åŠ 

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662555210086-192721d6-1c1d-44d1-9428-3820736cd5d6.png)

```java
    /**
     * æŸ¥è¯¢è®¢å•é¡¹ç›®è§†å›¾å¯¹è±¡
     *
     * @param returnId å›æŠ¥id
     * @return {@link OrderProjectVO}
     */
    OrderProjectVO selectOrderProjectVO(Integer returnId);
```

- è¿½åŠ 

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662555252602-de1f0e6a-646b-4cd5-800e-6c5cbefe1d26.png)

```xml
  <select id="selectOrderProjectVO" resultType="com.atguigu.crowd.entity.vo.OrderProjectVO">
    select distinct project_name          projectName,
                    content               returnContent,
                    description_simple    launchName,
                    t_return.supportmoney supportPrice,
                    freight,
                    count                 returnCount,
                    signalpurchase        signalPurchase,
                    purchase
    from t_return
           left join t_project on t_return.projectid = t_project.id
           left join t_member_launch_info on t_project.memberid = t_member_launch_info.memberid
    where t_return.id = #{returnId}
  </select>
```



### 5.7 é¡µé¢æ˜¾ç¤º

#### 5.7.1 æ–°å»º `confirm_return.html`

```html
<!DOCTYPE html>
<html lang="zh-CN" xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <base th:href="@{/}"/>
    <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <link rel="stylesheet" href="css/theme.css">
    <script src="jquery/jquery-2.1.1.min.js"></script>
    <script src="bootstrap/js/bootstrap.min.js"></script>
    <script src="script/docs.min.js"></script>
    <script src="script/back-to-top.js"></script>
    <script type="text/javascript">
        var signalPurchase = [[${session.orderProjectVO.signalPurchase}]];
        var purchase = [[${session.orderProjectVO.purchase}]];

        $(function () {
            $('#myTab a').click(function (e) {
                e.preventDefault()
                $(this).tab('show')
            });

            $("#returnCountInput").change(function () {
                var returnCount = $.trim($(this).val());

                if (returnCount == null || returnCount == "") {
                    alert("è¯·è¾“å…¥æœ‰æ•ˆæ•°æ®ï¼");

                    $(this).val(this.defaultValue);

                    return;
                }

                if (signalPurchase == 1 && returnCount > purchase) {
                    alert("ä¸èƒ½è¶…è¿‡é™è´­æ•°é‡ï¼");
                    return;
                }

                var supportPrice = [[${session.orderProjectVO.supportPrice}]];

                $("#totalAmount").text("ï¿¥" + (supportPrice * returnCount));
            });

            $("#submitBtn").click(function () {
                var returnCount = $("#returnCountInput").val();
                window.location.href = "order/confirm/order/" + returnCount;
            });
        })
    </script>
    <style>
        #footer {
            padding: 15px 0;
            background: #fff;
            border-top: 1px solid #ddd;
            text-align: center;
        }

        #topcontrol {
            color: #fff;
            z-index: 99;
            width: 30px;
            height: 30px;
            font-size: 20px;
            background: #222;
            position: relative;
            right: 14px !important;
            bottom: 11px !important;
            border-radius: 3px !important;
        }

        #topcontrol:after {
            /*top: -2px;*/
            left: 8.5px;
            content: "\f106";
            position: absolute;
            text-align: center;
            font-family: FontAwesome;
        }

        #topcontrol:hover {
            color: #fff;
            background: #18ba9b;
            -webkit-transition: all 0.3s ease-in-out;
            -moz-transition: all 0.3s ease-in-out;
            -o-transition: all 0.3s ease-in-out;
            transition: all 0.3s ease-in-out;
        }

        .label-type, .label-status, .label-order {
            background-color: #fff;
            color: #f60;
            padding: 5px;
            border: 1px #f60 solid;
        }

        #typeList :not (:first-child ) {
            margin-top: 20px;
        }

        .label-txt {
            margin: 10px 10px;
            border: 1px solid #ddd;
            padding: 4px;
            font-size: 14px;
        }

        .panel {
            border-radius: 0;
        }

        .progress-bar-default {
            background-color: #ddd;
        }
    </style>
</head>
<body>
<div class="navbar-wrapper">
    <div class="container">
        <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand" href="index.html" style="font-size: 32px;">å°šç­¹ç½‘-åˆ›æ„äº§å“ä¼—ç­¹å¹³å°</a>
                </div>
                <div id="navbar" class="navbar-collapse collapse"
                     style="float: right;">
                    <ul class="nav navbar-nav">
                        <li class="dropdown"><a href="#" class="dropdown-toggle"
                                                data-toggle="dropdown"><i class="glyphicon glyphicon-user"></i>
                            [[${session.loginMember.username}]]<span class="caret"></span></a>
                            <ul class="dropdown-menu" role="menu">
                                <li><a href="member.html"><i
                                        class="glyphicon glyphicon-scale"></i> ä¼šå‘˜ä¸­å¿ƒ</a></li>
                                <li><a href="#"><i class="glyphicon glyphicon-comment"></i>
                                    æ¶ˆæ¯</a></li>
                                <li class="divider"></li>
                                <li><a th:href="@{/auth/member/logout}"><i
                                        class="glyphicon glyphicon-off"></i> é€€å‡ºç³»ç»Ÿ</a></li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    </div>
</div>

<div class="container theme-showcase" role="main">

    <div class="container">
        <div class="row clearfix">
            <div class="col-md-12 column">
                <div class="panel panel-default">
                    <div class="panel-heading" style="text-align: center;">
                        <div class="container-fluid">
                            <div class="row clearfix">
                                <div class="col-md-3 column">
                                    <div class="progress"
                                         style="height: 50px; border-radius: 0; position: absolute; width: 75%; right: 49px;">
                                        <div class="progress-bar progress-bar-success"
                                             role="progressbar" aria-valuenow="60" aria-valuemin="0"
                                             aria-valuemax="100" style="width: 100%; height: 50px;">
                                            <div style="font-size: 16px; margin-top: 15px;">1.
                                                ç¡®è®¤å›æŠ¥å†…å®¹
                                            </div>
                                        </div>
                                    </div>
                                    <div
                                            style="right: 0; border: 10px solid #ddd; border-left-color: #88b7d5; border-width: 25px; position: absolute; border-left-color: rgba(92, 184, 92, 1); border-top-color: rgba(92, 184, 92, 0); border-bottom-color: rgba(92, 184, 92, 0); border-right-color: rgba(92, 184, 92, 0);">
                                    </div>
                                </div>
                                <div class="col-md-3 column">
                                    <div class="progress"
                                         style="height: 50px; border-radius: 0; position: absolute; width: 75%; right: 49px;">
                                        <div class="progress-bar progress-bar-default"
                                             role="progressbar" aria-valuenow="60" aria-valuemin="0"
                                             aria-valuemax="100" style="width: 100%; height: 50px;">
                                            <div style="font-size: 16px; margin-top: 15px;">2.
                                                ç¡®è®¤è®¢å•
                                            </div>
                                        </div>
                                    </div>
                                    <div
                                            style="right: 0; border: 10px solid #ddd; border-left-color: #88b7d5; border-width: 25px; position: absolute; border-left-color: rgba(221, 221, 221, 1); border-top-color: rgba(221, 221, 221, 0); border-bottom-color: rgba(221, 221, 221, 0); border-right-color: rgba(221, 221, 221, 0);">
                                    </div>
                                </div>
                                <div class="col-md-3 column">
                                    <div class="progress"
                                         style="height: 50px; border-radius: 0; position: absolute; width: 75%; right: 49px;">
                                        <div class="progress-bar progress-bar-default"
                                             role="progressbar" aria-valuenow="60" aria-valuemin="0"
                                             aria-valuemax="100" style="width: 100%; height: 50px;">
                                            <div style="font-size: 16px; margin-top: 15px;">3. ä»˜æ¬¾</div>
                                        </div>
                                    </div>
                                    <div
                                            style="right: 0; border: 10px solid #ddd; border-left-color: #88b7d5; border-width: 25px; position: absolute; border-left-color: rgba(221, 221, 221, 1); border-top-color: rgba(221, 221, 221, 0); border-bottom-color: rgba(221, 221, 221, 0); border-right-color: rgba(221, 221, 221, 0);">
                                    </div>
                                </div>
                                <div class="col-md-3 column">
                                    <div class="progress" style="height: 50px; border-radius: 0;">
                                        <div class="progress-bar progress-bar-default"
                                             role="progressbar" aria-valuenow="60" aria-valuemin="0"
                                             aria-valuemax="100" style="width: 100%; height: 50px;">
                                            <div style="font-size: 16px; margin-top: 15px;">4. å®Œæˆ</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="panel-body">
                        <div class="container-fluid">
                            <div class="row clearfix">
                                <div class="col-md-12 column">
                                    <blockquote
                                            style="border-left: 5px solid #f60; color: #f60; padding: 0 0 0 20px;">
                                        <b> è¯·ç¡®è®¤æ‚¨æ‰€é€‰æ‹©çš„å›æŠ¥é¡¹ä¿¡æ¯å’Œè´­ä¹°æ•°é‡ </b>
                                    </blockquote>
                                </div>
                                <div class="col-md-12 column">
                                    <table class="table table-bordered"
                                           style="text-align: center;">
                                        <thead>
                                        <tr style="background-color: #ddd;">
                                            <td>é¡¹ç›®åç§°</td>
                                            <td>å‘èµ·äºº</td>
                                            <td width="300">å›æŠ¥å†…å®¹</td>
                                            <td width="80">å›æŠ¥æ•°é‡</td>
                                            <td>æ”¯æŒå•ä»·</td>
                                            <td>é…é€è´¹ç”¨</td>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr>
                                            <td th:text="${session.orderProjectVO.projectName}">æ´»æ€§å¯Œæ°¢å‡€æ°´ç›´é¥®æœº</td>
                                            <td th:text="${session.orderProjectVO.launchName}">æ·±åœ³å¸‚åšå®æ°¸é“ç”µå­å•†åŠ¡æœ‰é™å…¬å¸</td>
                                            <td th:text="${session.orderProjectVO.returnContent}">
                                                æ¯æ»¡1750äººæŠ½å–ä¸€å°æ´»æ€§å¯Œæ°¢å‡€æ°´ç›´é¥®æœºï¼Œè‡³å°‘æŠ½å–ä¸€å°ã€‚æŠ½å–åé¢ï¼ˆå°æ•°ç‚¹åä¸€ä½å››èˆäº”å…¥ï¼‰=å‚ä¸äººæ•°Ã·1750äººï¼Œç”±è‹å®å®˜æ–¹æŠ½å–ã€‚
                                            </td>
                                            <td><input id="returnCountInput" type="text" class="form-control"
                                                       style="width: 60px;"
                                                       th:value="${session.orderProjectVO.returnCount}"></td>
                                            <td style="color: #F60" th:text="${session.orderProjectVO.supportPrice}">ï¿¥
                                                1.00
                                            </td>
                                            <td th:if="${session.orderProjectVO.freight == 0}">å…è¿è´¹</td>
                                            <td th:if="${session.orderProjectVO.freight != 0}"
                                                th:text="${session.orderProjectVO.freight}">å…è¿è´¹
                                            </td>
                                        </tr>
                                        </tbody>
                                    </table>
                                    <div style="float: right;">
                                        <p>
                                            æ€»ä»·(å«è¿è´¹)ï¼š<span id="totalAmount" style="font-size: 16px; color: #F60;">ï¿¥[[${session.orderProjectVO.returnCount * session.orderProjectVO.supportPrice}]]</span>
                                        </p>
                                        <button id="submitBtn" type="button" class="btn btn-warning btn-lg"
                                                style="float: right;">
                                            <i class="glyphicon glyphicon-credit-card"></i> å»ç»“ç®—
                                        </button>
                                    </div>
                                </div>

                                <div class="container">
                                    <div class="row clearfix">
                                        <div class="col-md-12 column">
                                            <blockquote>
                                                <p>
                                                    <i class="glyphicon glyphicon-info-sign"
                                                       style="color: #2a6496;"></i> æç¤º
                                                </p>
                                                <br> <span style="font-size: 12px;">1.ä¼—ç­¹å¹¶éå•†å“äº¤æ˜“ï¼Œå­˜åœ¨ä¸€å®šé£é™©ã€‚æ”¯æŒè€…æ ¹æ®è‡ªå·±çš„åˆ¤æ–­é€‰æ‹©ã€æ”¯æŒä¼—ç­¹é¡¹ç›®ï¼Œä¸å‘èµ·äººå…±åŒå®ç°æ¢¦æƒ³å¹¶è·å¾—å‘èµ·äººæ‰¿è¯ºçš„å›æŠ¥ã€‚<br>
														2.ä¼—ç­¹å¹³å°ä»…æä¾›å¹³å°ç½‘ç»œç©ºé—´åŠæŠ€æœ¯æ”¯æŒç­‰ä¸­ä»‹æœåŠ¡ï¼Œä¼—ç­¹ä»…å­˜åœ¨äºå‘èµ·äººå’Œæ”¯æŒè€…ä¹‹é—´ï¼Œä½¿ç”¨ä¼—ç­¹å¹³å°äº§ç”Ÿçš„æ³•å¾‹åæœç”±å‘èµ·äººä¸æ”¯æŒè€…è‡ªè¡Œæ‰¿æ‹…ã€‚<br>
														3.æœ¬é¡¹ç›®å¿…é¡»åœ¨2017-06-04ä¹‹å‰è¾¾åˆ° ï¿¥1000000.00
														çš„ç›®æ ‡æ‰ç®—æˆåŠŸï¼Œå¦åˆ™å·²ç»æ”¯æŒçš„è®¢å•å°†å–æ¶ˆã€‚è®¢å•å–æ¶ˆæˆ–å‹Ÿé›†å¤±è´¥çš„ï¼Œæ‚¨æ”¯æŒçš„é‡‘é¢å°†åŸæ”¯ä»˜è·¯å¾„é€€å›ã€‚<br>
														4.è¯·åœ¨æ”¯æŒé¡¹ç›®å15åˆ†é’Ÿå†…ä»˜æ¬¾ï¼Œå¦åˆ™æ‚¨çš„æ”¯æŒè¯·æ±‚ä¼šè¢«è‡ªåŠ¨å…³é—­ã€‚<br>
														5.ä¼—ç­¹æˆåŠŸåç”±å‘èµ·äººç»Ÿä¸€è¿›è¡Œå‘è´§ï¼Œå”®åæœåŠ¡ç”±å‘èµ·äººç»Ÿä¸€æä¾›ï¼›å¦‚æœå‘ç”Ÿå‘èµ·äººæ— æ³•å‘æ”¾å›æŠ¥ã€å»¶è¿Ÿå‘æ”¾å›æŠ¥ã€ä¸æä¾›å›æŠ¥åç»­æœåŠ¡ç­‰æƒ…å†µï¼Œæ‚¨éœ€è¦ç›´æ¥å’Œå‘èµ·äººåå•†è§£å†³ã€‚<br>
														6.å¦‚æ‚¨ä¸åŒæ„ä¸Šè¿°é£é™©æç¤ºå†…å®¹ï¼Œæ‚¨æœ‰æƒé€‰æ‹©ä¸æ”¯æŒï¼›ä¸€æ—¦é€‰æ‹©æ”¯æŒï¼Œè§†ä¸ºæ‚¨å·²ç¡®è®¤å¹¶åŒæ„ä»¥ä¸Šæç¤ºå†…å®¹ã€‚
													</span>
                                            </blockquote>
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="container" style="margin-top: 20px;">
        <div class="row clearfix">
            <div class="col-md-12 column">
                <div id="footer">
                    <div class="footerNav">
                        <a rel="nofollow" href="http://www.atguigu.com">å…³äºæˆ‘ä»¬</a> | <a
                            rel="nofollow" href="http://www.atguigu.com">æœåŠ¡æ¡æ¬¾</a> | <a
                            rel="nofollow" href="http://www.atguigu.com">å…è´£å£°æ˜</a> | <a
                            rel="nofollow" href="http://www.atguigu.com">ç½‘ç«™åœ°å›¾</a> | <a
                            rel="nofollow" href="http://www.atguigu.com">è”ç³»æˆ‘ä»¬</a>
                    </div>
                    <div class="copyRight">Copyright ?2010-2014atguigu.com ç‰ˆæƒæ‰€æœ‰
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>
<!-- /container -->

</body>
</html>
```



## 6. ç›®æ ‡2: ç¡®è®¤è®¢å•

### 6.1 æ€è·¯

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662561009155-9bd03ed2-f0ea-455d-a066-8513ae91741c.png)



### 6.2 æ–°å»º `AddressVO`ã€`entity` å·¥ç¨‹ã€‘

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662561152423-6cf43cbc-cf4d-40b3-8dc3-a6b9698506f1.png)

```java
package com.atguigu.crowd.entity.vo;

import lombok.AllArgsConstructor;
import lombok.Data;
import lombok.NoArgsConstructor;

import java.io.Serializable;

/**
 * @author é™ˆæ±Ÿæ—
 * @date 2022/9/7 22:30
 */
@NoArgsConstructor
@AllArgsConstructor
@Data
public class AddressVO implements Serializable {

    private static final long serialVersionUID = 1L;

    private Integer id;

    /**
     * æ”¶ä»¶äºº
     */
    private String receiveName;

    /**
     * æ‰‹æœºå·
     */
    private String phoneNum;

    /**
     * åœ°å€
     */
    private String address;

    /**
     * ä¼šå‘˜è¡¨ä¸»é”®
     */
    private String memberId;

}
```



### 6.3 è¿½åŠ ä»£ç , Session åŸŸåˆå¹¶å›æŠ¥æ•°é‡ã€`order` å·¥ç¨‹ã€‘

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662561216453-e3af2e6d-4d60-4a1b-9166-d46084db65f5.png)

```java
    /**
     * é¦–é¡µ -> é¡¹ç›®è¯¦æƒ…ï¼ˆç‚¹å‡»æ”¯æŒï¼‰ -> æ˜¾ç¤ºå›æŠ¥ç¡®è®¤ä¿¡æ¯ -> æ˜¾ç¤ºè¿”å›ç¡®è®¤ä¿¡æ¯
     *
     * @param returnCount å›æŠ¥æ•°é‡
     * @param session
     * @return {@link String}
     */
    @RequestMapping("/confirm/order/{returnCount}")
    public String showReturnOrderInfo(@PathVariable("returnCount") Integer returnCount,
                                      HttpSession session) {
        // 1. æŠŠæ¥æ”¶åˆ°çš„å›æŠ¥æ•°é‡åˆå¹¶åˆ° Session åŸŸ
        OrderProjectVO orderProjectVO = (OrderProjectVO) session.getAttribute("orderProjectVO");
        orderProjectVO.setReturnCount(returnCount);
        session.setAttribute("orderProjectVO", orderProjectVO);

        // 2. è·å–å½“å‰å·²ç™»å½•ç”¨æˆ·çš„ id
        MemberLoginVO memberLoginVO = (MemberLoginVO) session.getAttribute(CrowdConstant.ATTR_NAME_LOGIN_MEMBER);
        Integer memberId = memberLoginVO.getId();

        // /3.æŸ¥è¯¢ç›®å‰çš„æ”¶è´§åœ°å€æ•°æ®
        ResultEntity<List<AddressVO>> resultEntity = mySQLRemoteService.getAddressVOListRemote(memberId);
        if (ResultEntity.SUCCESS.equals(resultEntity.getResult())) {
            List<AddressVO> addressVOList = resultEntity.getData();
            session.setAttribute("addressVOList", addressVOList);
        }

        return "confirm_order";
    }
```



### 6.4 æ–°å»º confirm_order.html

```html
<!DOCTYPE html>
<html lang="zh-CN" xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <base th:href="@{/}"/>
    <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <link rel="stylesheet" href="css/theme.css">
    <script src="jquery/jquery-2.1.1.min.js"></script>
    <script src="bootstrap/js/bootstrap.min.js"></script>
    <script src="script/docs.min.js"></script>
    <script src="script/back-to-top.js"></script>
    <script type="text/javascript" src="layer/layer.js"></script>
    <script type="text/javascript">
        $(function () {
            $("#payButton").click(function () {
                // 1.æ”¶é›†æ‰€æœ‰è¦æäº¤çš„è¡¨å•é¡¹çš„æ•°æ®
                var addressId = $("[name=addressId]:checked").val();
                var invoice = $("[name=invoiceRadio]:checked").val();
                var invoiceTitle = $.trim($("[name=invoiceTitle]").val());
                var remark = $.trim($("[name=remark]").val());

                // 2.å°†ä¸Šé¢æ”¶é›†åˆ°çš„è¡¨å•æ•°æ®å¡«å……åˆ°ç©ºè¡¨å•ä¸­å¹¶æäº¤
                $("#summaryForm")
                    .append("<input type='hidden' name='addressId' value='" + addressId + "'/>")
                    .append("<input type='hidden' name='invoice' value='" + invoice + "'/>")
                    .append("<input type='hidden' name='invoiceTitle' value='" + invoiceTitle + "'/>")
                    .append("<input type='hidden' name='orderRemark' value='" + remark + "'/>")
                    .submit();
            });

            $("#knowRoleCheckBox").click(function () {
                var currentStatus = this.checked;
                if (currentStatus) {
                    $("#payButton").prop("disabled", "");
                } else {
                    $("#payButton").prop("disabled", "disabled");
                }
            });

            $('#myTab a').click(function (e) {
                e.preventDefault()
                $(this).tab('show')
            })
        })
    </script>
    <style>
        #footer {
            padding: 15px 0;
            background: #fff;
            border-top: 1px solid #ddd;
            text-align: center;
        }

        #topcontrol {
            color: #fff;
            z-index: 99;
            width: 30px;
            height: 30px;
            font-size: 20px;
            background: #222;
            position: relative;
            right: 14px !important;
            bottom: 11px !important;
            border-radius: 3px !important;
        }

        #topcontrol:after {
            /*top: -2px;*/
            left: 8.5px;
            content: "\f106";
            position: absolute;
            text-align: center;
            font-family: FontAwesome;
        }

        #topcontrol:hover {
            color: #fff;
            background: #18ba9b;
            -webkit-transition: all 0.3s ease-in-out;
            -moz-transition: all 0.3s ease-in-out;
            -o-transition: all 0.3s ease-in-out;
            transition: all 0.3s ease-in-out;
        }

        .label-type, .label-status, .label-order {
            background-color: #fff;
            color: #f60;
            padding: 5px;
            border: 1px #f60 solid;
        }

        #typeList :not (:first-child ) {
            margin-top: 20px;
        }

        .label-txt {
            margin: 10px 10px;
            border: 1px solid #ddd;
            padding: 4px;
            font-size: 14px;
        }

        .panel {
            border-radius: 0;
        }

        .progress-bar-default {
            background-color: #ddd;
        }
    </style>
</head>
<body>
<div class="navbar-wrapper">
    <div class="container">
        <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand" href="index.html" style="font-size: 32px;">å°šç­¹ç½‘-åˆ›æ„äº§å“ä¼—ç­¹å¹³å°</a>
                </div>
                <div id="navbar" class="navbar-collapse collapse"
                     style="float: right;">
                    <ul class="nav navbar-nav">
                        <li class="dropdown"><a href="#" class="dropdown-toggle"
                                                data-toggle="dropdown"><i class="glyphicon glyphicon-user"></i>
                            [[${session.loginMember.username}]]<span class="caret"></span></a>
                            <ul class="dropdown-menu" role="menu">
                                <li><a href="member.html"><i
                                        class="glyphicon glyphicon-scale"></i> ä¼šå‘˜ä¸­å¿ƒ</a></li>
                                <li><a href="#"><i class="glyphicon glyphicon-comment"></i>
                                    æ¶ˆæ¯</a></li>
                                <li class="divider"></li>
                                <li><a th:href="@{/auth/member/logout}"><i
                                        class="glyphicon glyphicon-off"></i> é€€å‡ºç³»ç»Ÿ</a></li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    </div>
</div>

<div class="container theme-showcase" role="main">

    <div class="container">
        <div class="row clearfix">
            <div class="col-md-12 column">
                <div class="panel panel-default">
                    <div class="panel-heading" style="text-align: center;">
                        <div class="container-fluid">
                            <div class="row clearfix">
                                <div class="col-md-3 column">
                                    <div class="progress"
                                         style="height: 50px; border-radius: 0; position: absolute; width: 75%; right: 49px;">
                                        <div class="progress-bar progress-bar-default"
                                             role="progressbar" aria-valuenow="60" aria-valuemin="0"
                                             aria-valuemax="100" style="width: 100%; height: 50px;">
                                            <div style="font-size: 16px; margin-top: 15px;">1.
                                                ç¡®è®¤å›æŠ¥å†…å®¹
                                            </div>
                                        </div>
                                    </div>
                                    <div
                                            style="right: 0; border: 10px solid #ddd; border-left-color: #88b7d5; border-width: 25px; position: absolute; border-left-color: rgba(221, 221, 221, 1); border-top-color: rgba(221, 221, 221, 0); border-bottom-color: rgba(221, 221, 221, 0); border-right-color: rgba(221, 221, 221, 0);">
                                    </div>
                                </div>
                                <div class="col-md-3 column">
                                    <div class="progress"
                                         style="height: 50px; border-radius: 0; position: absolute; width: 75%; right: 49px;">
                                        <div class="progress-bar progress-bar-success"
                                             role="progressbar" aria-valuenow="60" aria-valuemin="0"
                                             aria-valuemax="100" style="width: 100%; height: 50px;">
                                            <div style="font-size: 16px; margin-top: 15px;">2.
                                                ç¡®è®¤è®¢å•
                                            </div>
                                        </div>
                                    </div>
                                    <div
                                            style="right: 0; border: 10px solid #ddd; border-left-color: #88b7d5; border-width: 25px; position: absolute; border-left-color: rgba(92, 184, 92, 1); border-top-color: rgba(92, 184, 92, 0); border-bottom-color: rgba(92, 184, 92, 0); border-right-color: rgba(92, 184, 92, 0);">
                                    </div>
                                </div>
                                <div class="col-md-3 column">
                                    <div class="progress"
                                         style="height: 50px; border-radius: 0; position: absolute; width: 75%; right: 49px;">
                                        <div class="progress-bar progress-bar-default"
                                             role="progressbar" aria-valuenow="60" aria-valuemin="0"
                                             aria-valuemax="100" style="width: 100%; height: 50px;">
                                            <div style="font-size: 16px; margin-top: 15px;">3. ä»˜æ¬¾</div>
                                        </div>
                                    </div>
                                    <div
                                            style="right: 0; border: 10px solid #ddd; border-left-color: #88b7d5; border-width: 25px; position: absolute; border-left-color: rgba(221, 221, 221, 1); border-top-color: rgba(221, 221, 221, 0); border-bottom-color: rgba(221, 221, 221, 0); border-right-color: rgba(221, 221, 221, 0);">
                                    </div>
                                </div>
                                <div class="col-md-3 column">
                                    <div class="progress" style="height: 50px; border-radius: 0;">
                                        <div class="progress-bar progress-bar-default"
                                             role="progressbar" aria-valuenow="60" aria-valuemin="0"
                                             aria-valuemax="100" style="width: 100%; height: 50px;">
                                            <div style="font-size: 16px; margin-top: 15px;">4. å®Œæˆ</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="panel-body">
                        <div class="container-fluid">
                            <div class="row clearfix">
                                <div class="col-md-12 column">
                                    <div class="alert alert-warning alert-dismissable"
                                         style="color: red;">
                                        <button type="button" class="close" data-dismiss="alert"
                                                aria-hidden="true">Ã—
                                        </button>
                                        <i class="glyphicon glyphicon-info-sign"></i>
                                        <strong>è¯·åœ¨ä¸‹å•å15åˆ†é’Ÿå†…ä»˜æ¬¾ï¼Œå¦åˆ™æ‚¨çš„è®¢å•ä¼šè¢«è‡ªåŠ¨å…³é—­ã€‚</strong>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="address" class="container-fluid">
                            <div class="row clearfix">
                                <div class="col-md-12 column">
                                    <blockquote
                                            style="border-left: 5px solid #f60; color: #f60; padding: 0 0 0 20px;">
                                        <b> æ”¶è´§åœ°å€ </b>
                                    </blockquote>
                                </div>
                                <div class="col-md-12 column" style="padding: 0 120px;">
                                    <div th:if="${#lists.isEmpty(session.addressVOList)}">å°šæœªåˆ›å»ºæ”¶è´§åœ°å€</div>
                                    <div th:unless="${#lists.isEmpty(session.addressVOList)}" id="showAddress">
                                        <div th:each="address : ${session.addressVOList}" class="radio">
                                            <label> <input type="radio" name="addressId" th:value="${address.id}"
                                                           id="optionsRadios1"/> [[${address.receiveName}]]
                                                [[${address.phoneNum}]] [[${address.address}]]
                                            </label>
                                        </div>
                                    </div>
                                    <div class="radio">
                                        <label> <input type="radio" name="optionsRadios"
                                                       id="optionsRadios2" value="option2"> æ–°åœ°å€
                                        </label>
                                    </div>
                                    <div
                                            style="border: 10px solid #f60; border-bottom-color: #eceeef; border-width: 10px; width: 20px; margin-left: 20px; margin-top: -20px; border-left-color: rgba(221, 221, 221, 0); border-top-color: rgba(221, 221, 221, 0); border-right-color: rgba(221, 221, 221, 0);"></div>
                                    <div class="panel panel-default"
                                         style="border-style: dashed; background-color: #eceeef">
                                        <div class="panel-body">
                                            <div class="col-md-12 column">
                                                <form action="order/save/address" method="post" class="form-horizontal">
                                                    <input type="hidden" name="memberId"
                                                           th:value="${session.loginMember.id}"/>
                                                    <div class="form-group">
                                                        <label class="col-sm-2 control-label">æ”¶è´§äººï¼ˆ*ï¼‰</label>
                                                        <div class="col-sm-10">
                                                            <input type="text" name="receiveName" class="form-control"
                                                                 value="æ”¶è´§äºº" style="width: 200px;" placeholder="å§“åï¼šxxxx">
                                                        </div>
                                                    </div>
                                                    <div class="form-group">
                                                        <label class="col-sm-2 control-label">æ‰‹æœºï¼ˆ*ï¼‰</label>
                                                        <div class="col-sm-10">
                                                            <input class="form-control" name="phoneNum" type="text"
                                                                   style="width: 200px;"
                                                                  value="18512341234" placeholder="è¯·å¡«å†™11ä½æ‰‹æœºå·ç "/>
                                                        </div>
                                                    </div>
                                                    <div class="form-group">
                                                        <label class="col-sm-2 control-label">åœ°å€ï¼ˆ*ï¼‰</label>
                                                        <div class="col-sm-10">
                                                            <input class="form-control" name="address" type="text"
                                                                   style="width: 400px;"
                                                                  value="æ”¶è´§åœ°å€" placeholder="è¯·å¡«å†™æ”¶è´§åœ°å€"/>
                                                        </div>
                                                    </div>
                                                    <div class="form-group">
                                                        <label class="col-sm-2 control-label"></label>
                                                        <div class="col-sm-10">
                                                            <button id="saveAddress" type="button"
                                                                    class="btn btn-primary">ç¡®è®¤é…é€ä¿¡æ¯
                                                            </button>
                                                        </div>
                                                    </div>
                                                </form>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="container-fluid">
                            <div class="row clearfix">
                                <div class="col-md-12 column">
                                    <blockquote
                                            style="border-left: 5px solid #f60; color: #f60; padding: 0 0 0 20px;">
                                        <b> å‘ç¥¨ä¿¡æ¯ </b>
                                    </blockquote>
                                </div>
                                <div class="col-md-12 column" style="padding: 0 120px;">
                                    <div class="radio">
                                        <label> <input type="radio" name="invoiceRadio"
                                                       id="optionsRadios3" value="0" checked> æ— éœ€å‘ç¥¨
                                        </label>
                                    </div>
                                    <div class="radio">
                                        <label> <input type="radio" name="invoiceRadio"
                                                       id="optionsRadios4" value="1"> éœ€è¦å‘ç¥¨
                                        </label>
                                    </div>
                                    <div
                                            style="border: 10px solid #f60; border-bottom-color: #eceeef; border-width: 10px; width: 20px; margin-left: 20px; margin-top: -20px; border-left-color: rgba(221, 221, 221, 0); border-top-color: rgba(221, 221, 221, 0); border-right-color: rgba(221, 221, 221, 0);"></div>
                                    <div class="panel panel-default"
                                         style="border-style: dashed; background-color: #eceeef">
                                        <div class="panel-body">
                                            <div class="col-md-12 column">
                                                <form class="form-horizontal">
                                                    <div class="form-group">
                                                        <label class="col-sm-2 control-label">å‘ç¥¨æŠ¬å¤´ï¼ˆ*ï¼‰</label>
                                                        <div class="col-sm-10">
                                                            <input type="text" name="invoiceTitle" class="form-control"
                                                                   style="width: 200px;" placeholder="ä¸ªäºº">
                                                        </div>
                                                    </div>
                                                </form>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="container-fluid">
                            <div class="row clearfix">
                                <div class="col-md-12 column">
                                    <blockquote
                                            style="border-left: 5px solid #f60; color: #f60; padding: 0 0 0 20px;">
                                        <b> é¡¹ç›®ä¿¡æ¯ <a style="font-size: 12px;"
                                                    href="pay-step-1.html">ä¿®æ”¹æ•°é‡</a>
                                        </b>
                                    </blockquote>
                                </div>
                                <div class="col-md-12 column">
                                    <table class="table table-bordered"
                                           style="text-align: center;">
                                        <thead>
                                        <tr style="background-color: #ddd;">
                                            <td>é¡¹ç›®åç§°</td>
                                            <td>å‘èµ·äºº</td>
                                            <td width="300">å›æŠ¥å†…å®¹</td>
                                            <td width="80">å›æŠ¥æ•°é‡</td>
                                            <td>æ”¯æŒå•ä»·</td>
                                            <td>é…é€è´¹ç”¨</td>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr>
                                            <td th:text="${session.orderProjectVO.projectName}">æ´»æ€§å¯Œæ°¢å‡€æ°´ç›´é¥®æœº</td>
                                            <td th:text="${session.orderProjectVO.launchName}">æ·±åœ³å¸‚åšå®æ°¸é“ç”µå­å•†åŠ¡æœ‰é™å…¬å¸</td>
                                            <td th:text="${session.orderProjectVO.returnContent}">
                                                æ¯æ»¡1750äººæŠ½å–ä¸€å°æ´»æ€§å¯Œæ°¢å‡€æ°´ç›´é¥®æœºï¼Œè‡³å°‘æŠ½å–ä¸€å°ã€‚æŠ½å–åé¢ï¼ˆå°æ•°ç‚¹åä¸€ä½å››èˆäº”å…¥ï¼‰=å‚ä¸äººæ•°Ã·1750äººï¼Œç”±è‹å®å®˜æ–¹æŠ½å–ã€‚
                                            </td>
                                            <td th:text="${session.orderProjectVO.returnCount}">55</td>
                                            <td style="color: #F60" th:text="${session.orderProjectVO.supportPrice}">ï¿¥
                                                1.00
                                            </td>
                                            <td th:if="${session.orderProjectVO.freight == 0}">å…è¿è´¹</td>
                                            <td th:if="${session.orderProjectVO.freight != 0}"
                                                th:text="${session.orderProjectVO.freight}">å…è¿è´¹
                                            </td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <div class="col-md-12 column">
                                    <div class="form-group">
                                        <label class="col-sm-2 control-label">å¤‡æ³¨</label>
                                        <div class="col-sm-10">
												<textarea class="form-control" name="remark" rows="1"
                                                          placeholder="å¡«å†™å…³äºå›æŠ¥æˆ–å‘èµ·äººå¸Œæœ›æ‚¨å¤‡æ³¨çš„ä¿¡æ¯"></textarea>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-12 column">
                                    <blockquote
                                            style="border-left: 5px solid #f60; color: #f60; padding: 0 0 0 20px;">
                                        <b> è´¦å• </b>
                                    </blockquote>
                                </div>

                                <div class="col-md-12 column">
                                    <div class="alert alert-warning alert-dismissable"
                                         style="text-align: right; border: 2px solid #ffc287;">
                                        <ul style="list-style: none;">
                                            <li style="margin-top: 10px;">æ”¯æŒé‡‘é¢ï¼š<span
                                                    style="color: red;">ï¿¥[[${session.orderProjectVO.returnCount * session.orderProjectVO.supportPrice}]]</span>
                                            </li>
                                            <li style="margin-top: 10px;">é…é€è´¹ç”¨ï¼š<span
                                                    style="color: red;">ï¿¥[[${session.orderProjectVO.freight}]]</span>
                                            </li>
                                            <li style="margin-top: 10px; margin-bottom: 10px;"><h2>
                                                æ”¯ä»˜æ€»é‡‘é¢ï¼š<span style="color: red;">ï¿¥[[${session.orderProjectVO.returnCount * session.orderProjectVO.supportPrice+session.orderProjectVO.freight}]]</span>
                                            </h2></li>
                                            <li
                                                    style="margin-top: 10px; padding: 5px; border: 1px solid #F00; display: initial; background: #FFF;">
                                                <i class="glyphicon glyphicon-info-sign"></i> <strong>æ‚¨éœ€è¦å…ˆ
                                                <a href="#address">è®¾ç½®é…é€ä¿¡æ¯</a> ,å†æäº¤è®¢å•
                                            </strong>
                                            </li>
                                            <li style="margin-top: 10px;">
                                                è¯·åœ¨ä¸‹å•å15åˆ†é’Ÿå†…ä»˜æ¬¾ï¼Œå¦åˆ™æ‚¨çš„è®¢å•ä¼šè¢«è‡ªåŠ¨å…³é—­ã€‚
                                            </li>
                                            <li style="margin-top: 10px;">
                                                <button id="payButton" disabled="disabled" type="button"
                                                        class="btn btn-warning btn-lg">
                                                    <i class="glyphicon glyphicon-credit-card"></i> ç«‹å³ä»˜æ¬¾
                                                </button>
                                            </li>
                                            <li style="margin-top: 10px;">
                                                <div class="checkbox">
                                                    <label>
                                                        <input id="knowRoleCheckBox" type="checkbox">æˆ‘å·²äº†è§£é£é™©å’Œè§„åˆ™
                                                    </label>
                                                </div>
                                            </li>
                                        </ul>


                                    </div>
                                </div>
                                <div class="container">
                                    <div class="row clearfix">
                                        <div class="col-md-12 column">
                                            <blockquote>
                                                <p>
                                                    <i class="glyphicon glyphicon-info-sign"
                                                       style="color: #2a6496;"></i> æç¤º
                                                </p>
                                                <br> <span style="font-size: 12px;">1.ä¼—ç­¹å¹¶éå•†å“äº¤æ˜“ï¼Œå­˜åœ¨ä¸€å®šé£é™©ã€‚æ”¯æŒè€…æ ¹æ®è‡ªå·±çš„åˆ¤æ–­é€‰æ‹©ã€æ”¯æŒä¼—ç­¹é¡¹ç›®ï¼Œä¸å‘èµ·äººå…±åŒå®ç°æ¢¦æƒ³å¹¶è·å¾—å‘èµ·äººæ‰¿è¯ºçš„å›æŠ¥ã€‚<br>
														2.ä¼—ç­¹å¹³å°ä»…æä¾›å¹³å°ç½‘ç»œç©ºé—´åŠæŠ€æœ¯æ”¯æŒç­‰ä¸­ä»‹æœåŠ¡ï¼Œä¼—ç­¹ä»…å­˜åœ¨äºå‘èµ·äººå’Œæ”¯æŒè€…ä¹‹é—´ï¼Œä½¿ç”¨ä¼—ç­¹å¹³å°äº§ç”Ÿçš„æ³•å¾‹åæœç”±å‘èµ·äººä¸æ”¯æŒè€…è‡ªè¡Œæ‰¿æ‹…ã€‚<br>
														3.æœ¬é¡¹ç›®å¿…é¡»åœ¨2017-06-04ä¹‹å‰è¾¾åˆ° ï¿¥1000000.00
														çš„ç›®æ ‡æ‰ç®—æˆåŠŸï¼Œå¦åˆ™å·²ç»æ”¯æŒçš„è®¢å•å°†å–æ¶ˆã€‚è®¢å•å–æ¶ˆæˆ–å‹Ÿé›†å¤±è´¥çš„ï¼Œæ‚¨æ”¯æŒçš„é‡‘é¢å°†åŸæ”¯ä»˜è·¯å¾„é€€å›ã€‚<br>
														4.è¯·åœ¨æ”¯æŒé¡¹ç›®å15åˆ†é’Ÿå†…ä»˜æ¬¾ï¼Œå¦åˆ™æ‚¨çš„æ”¯æŒè¯·æ±‚ä¼šè¢«è‡ªåŠ¨å…³é—­ã€‚<br>
														5.ä¼—ç­¹æˆåŠŸåç”±å‘èµ·äººç»Ÿä¸€è¿›è¡Œå‘è´§ï¼Œå”®åæœåŠ¡ç”±å‘èµ·äººç»Ÿä¸€æä¾›ï¼›å¦‚æœå‘ç”Ÿå‘èµ·äººæ— æ³•å‘æ”¾å›æŠ¥ã€å»¶è¿Ÿå‘æ”¾å›æŠ¥ã€ä¸æä¾›å›æŠ¥åç»­æœåŠ¡ç­‰æƒ…å†µï¼Œæ‚¨éœ€è¦ç›´æ¥å’Œå‘èµ·äººåå•†è§£å†³ã€‚<br>
														6.å¦‚æ‚¨ä¸åŒæ„ä¸Šè¿°é£é™©æç¤ºå†…å®¹ï¼Œæ‚¨æœ‰æƒé€‰æ‹©ä¸æ”¯æŒï¼›ä¸€æ—¦é€‰æ‹©æ”¯æŒï¼Œè§†ä¸ºæ‚¨å·²ç¡®è®¤å¹¶åŒæ„ä»¥ä¸Šæç¤ºå†…å®¹ã€‚
													</span>
                                            </blockquote>
                                        </div>
                                    </div>
                                </div>


                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <div class="container" style="margin-top: 20px;">
        <div class="row clearfix">
            <div class="col-md-12 column">
                <div id="footer">
                    <div class="footerNav">
                        <a rel="nofollow" href="http://www.atguigu.com">å…³äºæˆ‘ä»¬</a> | <a
                            rel="nofollow" href="http://www.atguigu.com">æœåŠ¡æ¡æ¬¾</a> | <a
                            rel="nofollow" href="http://www.atguigu.com">å…è´£å£°æ˜</a> | <a
                            rel="nofollow" href="http://www.atguigu.com">ç½‘ç«™åœ°å›¾</a> | <a
                            rel="nofollow" href="http://www.atguigu.com">è”ç³»æˆ‘ä»¬</a>
                    </div>
                    <div class="copyRight">Copyright ?2010-2014atguigu.com ç‰ˆæƒæ‰€æœ‰
                    </div>
                </div>

            </div>
        </div>
    </div>

</div>
<!-- /container -->

<!-- ä¸ºäº†æ”¶é›†å½“å‰é¡µé¢ä¸­çš„æ‰€æœ‰æ•°æ®ï¼Œæ„é€ ç©ºè¡¨å• -->
<form id="summaryForm" action="pay/generate/order" method="post"></form>


</body>
</html>
```



### 6.5 è¿½åŠ ä»£ç : è·å–ç”¨æˆ·çš„æ”¶è´§åœ°å€ã€`api` å·¥ç¨‹ã€‘

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662562892028-2183653b-7154-4518-84c6-998da8c9aa4f.png)

```java
    /**
     * è·å–ç”¨æˆ·çš„æ”¶è´§åœ°å€
     *
     * @param memberId
     * @return {@link ResultEntity}<{@link List}<{@link AddressVO}>>
     */
    @RequestMapping("/get/address/vo/list/remote")
    ResultEntity<List<AddressVO>> getAddressVOListRemote(@RequestParam("memberId") Integer memberId);
```

### 6.6 è¿½åŠ ä»£ç ã€`mysql` å·¥ç¨‹ã€‘

- `OrderProviderHandler`

```java
    @RequestMapping("/get/address/vo/list/remote")
    ResultEntity<List<AddressVO>> getAddressVOListRemote(@RequestParam("memberId") Integer memberId) {
        try {
            List<AddressVO> addressVOList = orderService.getAddressVOList(memberId);
            return ResultEntity.successWithData(addressVOList);
        } catch (Exception e) {
            e.printStackTrace();
            return ResultEntity.failed(e.getMessage());
        }
    }
```

- `OrderService`

```java
    /**
     * è·å–ç”¨æˆ·çš„æ”¶è´§åœ°å€
     *
     * @param memberId
     * @return {@link List}<{@link AddressVO}>
     */
    List<AddressVO> getAddressVOList(Integer memberId);
```

- `OrderServiceImpl`

```java
    @Override
    public List<AddressVO> getAddressVOList(Integer memberId) {
        return addressPOMapper.selectAddressVOList(memberId);
    }
```

- `AddressPOMapper`

```java
    /**
     * æŸ¥è¯¢ç”¨æˆ·çš„æ”¶è´§åœ°å€
     *
     * @param memberId æˆå‘˜èº«ä»½
     * @return {@link List}<{@link AddressVO}>
     */
    List<AddressVO> selectAddressVOList(Integer memberId);
```

- `AddressPOMapper.xml`

```xml
    <select id="selectAddressVOList" resultType="com.atguigu.crowd.entity.vo.AddressVO">
        select receive_name receiveName,
               phone_num    phoneNum,
               address,
               member_id    memberId
        from t_address
        where member_id = #{memberId}
    </select>
```



### 6.7 æ–°å¢æ”¶è´§åœ°å€

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662653951804-f60903ed-f607-4c3c-9664-fd0430fb4448.png)

#### 6.7.1 æ€è·¯

![img](https://cdn.nlark.com/yuque/__puml/20f231eeed4e4ef7ca78d3b85052e27c.svg)



#### 6.7.2 å‘èµ·è¯·æ±‚

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662718145479-737590ba-b02b-4c80-ae66-3789d7ec0f84.png)

```javascript
$(function () {
	$("#saveAddress").click(function () {
	    // æ”¶é›†æ‰€æœ‰è¦æäº¤çš„è¡¨å•é¡¹çš„æ•°æ®
	    var memberId = $("[name=memberId]").val();
	    var receiveName = $.trim($("[name=receiveName]").val());
	    var phoneNum = $.trim($("[name=phoneNum]").val());
	    var address = $.trim($("[name=address]").val());
	
	    // å‘èµ·è¯·æ±‚
	    $.ajax({
	        url: "order/save/address",
	        type: "post",
	        data: JSON.stringify({
	            memberId,
	            receiveName,
	            phoneNum,
	            address
	        }),
	        contentType: "application/json;charset=UTF-8",
	        dataType: "json",
	        success: function (response) {
	            var result = response.result;
	            if ("SUCCESS" === result) {
	                var address = response.data;
	                $("#showAddress").append(`
	                            <div class="radio">
	                                <label> <input type="radio" name="addressId" value="${address.id}"
	                                               id="optionsRadios1"/> ${address.receiveName}
	                                    ${address.phoneNum} ${address.address}
	                                </label>
	                            </div>`);
	                layer.msg("æ–°å¢æ”¶è´§åœ°å€æˆåŠŸ!")
	            }
	
	            if ("FAILED" === result) {
	                layer.msg("ä¿å­˜æ”¶è´§åœ°å€å¤±è´¥, è¯·é‡è¯•")
	            }
	        },
	        error: function (response) {
	            layer.msg(response.status + " " + response.statusText);
	        }
	    })
	})
})
```



#### 6.7.3 `OrderHandler` è¿œç¨‹è°ƒç”¨æ¥å£

- è¿½åŠ ä»£ç 

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662686297761-87d3e1ee-490c-4165-adb2-7df78815d7c8.png)

```java
    /**
     * é¦–é¡µ -> é¡¹ç›®è¯¦æƒ…ï¼ˆç‚¹å‡»æ”¯æŒï¼‰ -> æ˜¾ç¤ºå›æŠ¥ç¡®è®¤ä¿¡æ¯ -> æ˜¾ç¤ºè¿”å›ç¡®è®¤ä¿¡æ¯ï¼ˆæ”¶è´§åœ°å€, ç‚¹å‡»ç¡®è®¤é…é€ä¿¡æ¯ï¼‰
     *
     * @param addressVO
     * @return {@link ResultEntity}<{@link AddressVO}>
     */
    @ResponseBody
    @RequestMapping("/save/address")
    public ResultEntity<AddressVO> saveAddressPO(@RequestBody AddressVO addressVO) {
        // åˆ›å»ºä¸€ä¸ªæŒä¹…åŒ–å¯¹è±¡
        AddressPO addressPO = new AddressPO();
        // å¤åˆ¶å±æ€§
        BeanUtils.copyProperties(addressVO, addressPO);
        // ä¿å­˜
        ResultEntity<AddressPO> resultEntity = mySQLRemoteService.saveAddressPORemote(addressPO);
        if (ResultEntity.SUCCESS.equals(resultEntity.getResult())) {
            // æ‰§è¡ŒæˆåŠŸï¼Œ å¤åˆ¶æŒä¹…åŒ–å¯¹è±¡ç»™è§†å›¾å¯¹è±¡å¹¶è¿”å›
            // ä¿å­˜æˆåŠŸä¼šæœ‰ä¸€ä¸ª id å€¼, æ‰€ä»¥è¦å¤åˆ¶
            BeanUtils.copyProperties(addressPO, addressVO);
            return ResultEntity.successWithData(addressVO);
        } else {
            return ResultEntity.failed(resultEntity.getMessage());
        }
    }
```

- å£°æ˜æ¥å£ã€`api` å·¥ç¨‹ã€‘

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662686380607-2f83f269-e077-4c81-a453-f3c9ed239d99.png)

```java
    /**
     * ä¿å­˜æ”¶è´§åœ°å€
     *
     * @param addressPO
     * @return {@link ResultEntity}<{@link AddressPO}>
     */
    @RequestMapping("/save/address/po/remote")
    ResultEntity<AddressPO> saveAddressPORemote(@RequestBody AddressPO addressPO);
```



#### 6.7.4 `OrderProviderHandler`: ä¿å­˜æ”¶è´§åœ°å€ã€`mysql` å·¥ç¨‹ã€‘

- è¿½åŠ ä»£ç 

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662686461999-4ab4e2de-111d-4e8b-89db-644e6923517c.png)

```java
    public ResultEntity<AddressPO> saveAddressPORemote(@RequestBody AddressPO addressPO){
        try {
            orderService.saveAddressPO(addressPO);
            return ResultEntity.successWithData(addressPO);
        } catch (Exception e) {
            e.printStackTrace();
            return ResultEntity.failed(e.getMessage());
        }
    }
```

- å£°æ˜æ¥å£

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662686573478-d385fc7a-051a-40d1-9aa0-9b97121b8564.png)

```java
    /**
     * ä¿å­˜æ”¶è´§åœ°å€
     *
     * @param addressPO
     */
    void saveAddressPO(AddressPO addressPO);
```



- å®ç°æ¥å£

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662686585965-b70d3114-00f5-4bb5-89ba-67c20d345747.png)

```java
    @Transactional(propagation = Propagation.REQUIRES_NEW, rollbackFor = Exception.class)
    @Override
    public void saveAddressPO(AddressPO addressPO) {
        addressPOMapper.insert(addressPO);
    }
```



- `Mapper` æ¥å£

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662686622385-198b3dfa-42e2-4d2a-a01d-6c296b6b4e7e.png)

```java
    int insert(AddressPO record);
```



- `SQL`

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662686655986-8ceffabc-9055-4a55-9c66-d9b33211f843.png)

```xml
    <insert id="insert" useGeneratedKeys="true" keyProperty="id" parameterType="com.atguigu.crowd.entity.po.AddressPO">
        insert into t_address (id, receive_name, phone_num,
                               address, member_id)
        values (#{id,jdbcType=INTEGER}, #{receiveName,jdbcType=VARCHAR}, #{phoneNum,jdbcType=VARCHAR},
                #{address,jdbcType=VARCHAR}, #{memberId,jdbcType=VARCHAR})
    </insert>
```



#### 6.7.5 å¯ç”¨æœåŠ¡ç†”æ–­æœºåˆ¶ã€`mysql` å·¥ç¨‹ã€‘

1.  è¿½åŠ ä¾èµ–

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662718738763-9300205b-e4bb-4e5e-874c-95a6eb44c849.png)

```xml
<!-- æ•´åˆ Hystrix -->
<dependency>
    <groupId>org.springframework.cloud</groupId>
    <artifactId>spring-cloud-starter-netflix-hystrix</artifactId>
</dependency>
```

1. å¼€å¯æ–­è·¯å™¨åŠŸèƒ½

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662691525085-fe909800-81e8-46f2-80d7-f10320de7572.png)

```java
package com.atguigu.crowd;

import org.mybatis.spring.annotation.MapperScan;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.cloud.client.circuitbreaker.EnableCircuitBreaker;

/**
 * `@EnableCircuitBreaker`: å¼€å¯æ–­è·¯å™¨åŠŸèƒ½
 * 
 * @author é™ˆæ±Ÿæ—
 * @date 2022/8/19 05:02
 */
@EnableCircuitBreaker
@MapperScan("com.atguigu.crowd.mapper")
@SpringBootApplication
public class CrowdMainClass {

    public static void main(String[] args) {
        SpringApplication.run(CrowdMainClass.class, args);
    }

}
```

1. ä¿®æ”¹ä»£ç : `OrderProviderHandler`: ä¿å­˜æ”¶è´§åœ°å€ã€`mysql` å·¥ç¨‹ã€‘

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662718761183-ec26bf7c-ef7c-4475-8cd1-696cb8ccf842.png)

```java
    @HystrixCommand(fallbackMethod = "saveAddressPORemoteBackup")
    @RequestMapping("/save/address/po/remote")
    public ResultEntity<AddressPO> saveAddressPORemote(@RequestBody AddressPO addressPO){
        try {
            orderService.saveAddressPO(addressPO);
            return ResultEntity.successWithData(addressPO);
        } catch (Exception e) {
            e.printStackTrace();
            return ResultEntity.failed(e.getMessage());
        }
    }

    public ResultEntity<AddressPO> saveAddressPORemoteBackup(@RequestBody AddressPO addressPO){
        return ResultEntity.failed(CrowdConstant.MESSAGE_HYSTRIX_BACKUP);
    }
```



1. è¿½åŠ ä»£ç 

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662719594241-07dd2a12-45d6-4f73-a7d4-a348dce6f13d.png)

```java
public static final String MESSAGE_HYSTRIX_BACKUP = "ç†”æ–­æœºåˆ¶ç”Ÿæ•ˆ: æ–¹æ³•æ‰§è¡Œå‡ºç°é—®é¢˜";
```



#### 6.7.6 å¯ç”¨æœåŠ¡é™çº§æœºåˆ¶

1. è¿½åŠ ä¾èµ–ã€`api` å·¥ç¨‹ã€‘

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662718779775-38d70866-f9e6-4283-b44f-c3384aa6a84e.png)

```xml
<!-- æ•´åˆ Hystrix -->
<dependency>
    <groupId>org.springframework.cloud</groupId>
    <artifactId>spring-cloud-starter-netflix-hystrix</artifactId>
</dependency>
```

1. æ–°å»º `MySQLFallBackFactory`ã€`api` å·¥ç¨‹ã€‘

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662692962241-c85ce7d3-04e9-4c4b-ba83-5b0f9148a7e4.png)

```java
package com.atguigu.crowd.factory;

import com.atguigu.crowd.api.MySQLRemoteService;
import com.atguigu.crowd.entity.po.AddressPO;
import com.atguigu.crowd.entity.po.MemberPO;
import com.atguigu.crowd.entity.vo.*;
import com.atguigu.crowd.util.ResultEntity;
import feign.hystrix.FallbackFactory;
import org.springframework.stereotype.Component;

import java.util.List;

/**
 * @author é™ˆæ±Ÿæ—
 * @date 2022/9/9 11:06
 */
@Component
public class MySQLFallBackFactory implements FallbackFactory<MySQLRemoteService> {

    @Override
    public MySQLRemoteService create(Throwable cause) {
        return new MySQLRemoteService() {
            @Override
            public ResultEntity<MemberPO> getMemberPOByLoginAcctRemote(String loginacct) {
                return ResultEntity.failed("é™çº§æœºåˆ¶ç”Ÿæ•ˆ: " + cause.getMessage());
            }

            @Override
            public ResultEntity<String> saveMember(MemberPO memberPO) {
                return ResultEntity.failed("é™çº§æœºåˆ¶ç”Ÿæ•ˆ: " + cause.getMessage());
            }

            @Override
            public ResultEntity<String> saveProjectVORemote(ProjectVO projectVO, Integer memberId) {
                return ResultEntity.failed("é™çº§æœºåˆ¶ç”Ÿæ•ˆ: " + cause.getMessage());
            }

            @Override
            public ResultEntity<List<PortalTypeVO>> getPortalTypeProjectDataRemote() {
                return ResultEntity.failed("é™çº§æœºåˆ¶ç”Ÿæ•ˆ: " + cause.getMessage());
            }

            @Override
            public ResultEntity<DetailProjectVO> getDetailProjectVORemote(Integer projectId) {
                return ResultEntity.failed("é™çº§æœºåˆ¶ç”Ÿæ•ˆ: " + cause.getMessage());
            }

            @Override
            public ResultEntity<OrderProjectVO> getOrderProjectVORemote(Integer returnId) {
                return ResultEntity.failed("é™çº§æœºåˆ¶ç”Ÿæ•ˆ: " + cause.getMessage());
            }

            @Override
            public ResultEntity<List<AddressVO>> getAddressVOListRemote(Integer memberId) {
                return ResultEntity.failed("é™çº§æœºåˆ¶ç”Ÿæ•ˆ: " + cause.getMessage());
            }

            @Override
            public ResultEntity<AddressPO> saveAddressPORemote(AddressPO addressPO) {
                return ResultEntity.failed("é™çº§æœºåˆ¶ç”Ÿæ•ˆ: " + cause.getMessage());
            }
        };
    }

}
```

1. è¿½åŠ ä»£ç 

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662697390110-649a2213-7b76-4326-a030-e17fbd8fe77d.png)

```java
@FeignClient(value = "atguigu-crowd-mysql", fallbackFactory = MySQLFallBackFactory.class)
public interface MySQLRemoteService {
}
```

1. è¿½åŠ é…ç½®ã€`order` å·¥ç¨‹ã€‘

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662693132577-8c51e8b3-ee98-4364-8cb4-4d5d34b6dc62.png)

```yaml
feign:
  hystrix:
    # ä½¿ç”¨ Hystrix æ–­è·¯å™¨
    enabled: true
```





## 7. `Hystrix` æ‰©å±•

### 7.1 æœåŠ¡ç†”æ–­æœºåˆ¶

#### 7.1.1 `MemberProviderHandler` çš„

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662699339886-b92b88d6-edc1-450a-b97c-c8739db548cb.png)

```java
package com.atguigu.crowd.handler;

import com.atguigu.crowd.constant.CrowdConstant;
import com.atguigu.crowd.entity.po.MemberPO;
import com.atguigu.crowd.service.api.MemberService;
import com.atguigu.crowd.util.ResultEntity;
import com.netflix.hystrix.contrib.javanica.annotation.HystrixCommand;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.dao.DuplicateKeyException;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RestController;

/**
 * @author é™ˆæ±Ÿæ—
 * @date 2022/8/19 09:11
 */
@RestController
public class MemberProviderHandler {

    @Autowired
    private MemberService memberService;

    @HystrixCommand(fallbackMethod = "getMemberPOByLoginAcctRemoteBackup")
    @RequestMapping("/get/memberpo/login/acct/remote")
    public ResultEntity<MemberPO> getMemberPOByLoginAcctRemote(@RequestParam("loginacct") String loginacct) {
        try {
            // è°ƒç”¨æœ¬åœ° Service å®ŒæˆæŸ¥è¯¢
            MemberPO memberPO = memberService.getMemberPOByLoginAcct(loginacct);
            // å¦‚æœæ²¡æœ‰æŠ›å¼‚å¸¸, é‚£ä¹ˆå°±è¿”å›æˆåŠŸçš„ç»“æœ
            return ResultEntity.successWithData(memberPO);
        } catch (Exception e) {
            // å¦‚æœæ•è·åˆ°å¼‚å¸¸åˆ™è¿”å›å¤±è´¥çš„ç»“æœ
            return ResultEntity.failed(e.getMessage());
        }
    }

    public ResultEntity<MemberPO> getMemberPOByLoginAcctRemoteBackup(@RequestParam("loginacct") String loginacct) {
        return ResultEntity.failed(CrowdConstant.MESSAGE_HYSTRIX_BACKUP);
    }

    /**
     * ä¿å­˜
     *
     * @param memberPO ä¼šå‘˜å®ä½“ç±»
     * @return
     */
    @HystrixCommand(fallbackMethod = "saveMemberBackup")
    @RequestMapping("/save/member/remote")
    public ResultEntity<String> saveMember(@RequestBody MemberPO memberPO) {
        try {
            memberService.saveMember(memberPO);
            return ResultEntity.successWithoutData();
        } catch (Exception e) {
            if (e instanceof DuplicateKeyException) {
                return ResultEntity.failed(CrowdConstant.MESSAGE_LOGIN_ACCT_ALREADY_IN_USE);
            }

            return ResultEntity.failed(e.getMessage());
        }
    }

    public ResultEntity<String> saveMemberBackup(@RequestBody MemberPO memberPO) {
        return ResultEntity.failed(CrowdConstant.MESSAGE_HYSTRIX_BACKUP);
    }

}
```



#### 7.1.2 `OrderProviderHandler`çš„

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662718672237-46ea1f3d-b676-4c79-a0fa-e90ecb60e2d6.png)

```java
package com.atguigu.crowd.handler;

import com.atguigu.crowd.constant.CrowdConstant;
import com.atguigu.crowd.entity.po.AddressPO;
import com.atguigu.crowd.entity.vo.AddressVO;
import com.atguigu.crowd.entity.vo.OrderProjectVO;
import com.atguigu.crowd.service.api.OrderService;
import com.atguigu.crowd.util.ResultEntity;
import com.netflix.hystrix.contrib.javanica.annotation.HystrixCommand;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.*;

import java.util.List;

/**
 * @author é™ˆæ±Ÿæ—
 * @date 2022/9/7 20:15
 */
@RestController
public class OrderProviderHandler {

    @Autowired
    private OrderService orderService;

    @HystrixCommand(fallbackMethod = "getOrderProjectVORemoteBackup")
    @RequestMapping("/get/order/project/vo/remote/{returnId}")
    ResultEntity<OrderProjectVO> getOrderProjectVORemote(@PathVariable("returnId") Integer returnId) {
        try {
            OrderProjectVO orderProjectVO = orderService.getOrderProjectVO(returnId);
            return ResultEntity.successWithData(orderProjectVO);
        } catch (Exception e) {
            e.printStackTrace();
            return ResultEntity.failed(e.getMessage());
        }
    }

    ResultEntity<OrderProjectVO> getOrderProjectVORemoteBackup(@PathVariable("returnId") Integer returnId) {
        return ResultEntity.failed(CrowdConstant.MESSAGE_HYSTRIX_BACKUP);
    }

    @HystrixCommand(fallbackMethod = "getAddressVOListRemoteBackup")
    @RequestMapping("/get/address/vo/list/remote")
    ResultEntity<List<AddressVO>> getAddressVOListRemote(@RequestParam("memberId") Integer memberId) {
        try {
            List<AddressVO> addressVOList = orderService.getAddressVOList(memberId);
            return ResultEntity.successWithData(addressVOList);
        } catch (Exception e) {
            e.printStackTrace();
            return ResultEntity.failed(e.getMessage());
        }
    }

    ResultEntity<List<AddressVO>> getAddressVOListRemoteBackup(@RequestParam("memberId") Integer memberId) {
        return ResultEntity.failed(CrowdConstant.MESSAGE_HYSTRIX_BACKUP);
    }

    @HystrixCommand(fallbackMethod = "saveAddressPORemoteBackup")
    @RequestMapping("/save/address/po/remote")
    public ResultEntity<AddressPO> saveAddressPORemote(@RequestBody AddressPO addressPO){
        try {
            orderService.saveAddressPO(addressPO);
            return ResultEntity.successWithData(addressPO);
        } catch (Exception e) {
            e.printStackTrace();
            return ResultEntity.failed(e.getMessage());
        }
    }

    public ResultEntity<AddressPO> saveAddressPORemoteBackup(@RequestBody AddressPO addressPO){
        return ResultEntity.failed(CrowdConstant.MESSAGE_HYSTRIX_BACKUP);
    }

}
```



#### 7.1.3 `ProjectProviderHandler` çš„

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662718681948-b86b8d83-45c9-4222-a39e-642c0caaa778.png)

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662699360510-d8849288-0cb0-4251-9492-2855b3cf966f.png)

```java
package com.atguigu.crowd.handler;

import com.atguigu.crowd.constant.CrowdConstant;
import com.atguigu.crowd.entity.vo.DetailProjectVO;
import com.atguigu.crowd.entity.vo.PortalTypeVO;
import com.atguigu.crowd.entity.vo.ProjectVO;
import com.atguigu.crowd.service.api.ProjectService;
import com.atguigu.crowd.util.ResultEntity;
import com.netflix.hystrix.contrib.javanica.annotation.HystrixCommand;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.*;

import java.util.List;

/**
 * @author é™ˆæ±Ÿæ—
 * @date 2022/8/31 11:49
 */
@RestController
public class ProjectProviderHandler {

    @Autowired
    private ProjectService projectService;

    /**
     * ä¿å­˜ä¼šå‘˜å‘èµ·çš„ä¼—ç­¹ä¿¡æ¯
     *
     * @param projectVO ä¼—ç­¹ä¿¡æ¯
     * @param memberId  ä¼šå‘˜ id
     * @return
     */
    @HystrixCommand(fallbackMethod = "saveProjectVORemoteBackup")
    @RequestMapping("/save/project/vo/remote")
    public ResultEntity<String> saveProjectVORemote(@RequestBody ProjectVO projectVO, @RequestParam("memberId") Integer memberId) {
        try {
            projectService.saveProject(projectVO, memberId);
            return ResultEntity.successWithoutData();
        } catch (Exception e) {
            e.printStackTrace();
            return ResultEntity.failed(e.getMessage());
        }
    }

    public ResultEntity<String> saveProjectVORemoteBackup(@RequestBody ProjectVO projectVO, @RequestParam("memberId") Integer memberId) {
        return ResultEntity.failed(CrowdConstant.MESSAGE_HYSTRIX_BACKUP);
    }

    @HystrixCommand(fallbackMethod = "getPortalTypeProjectDataRemoteBackup")
    @RequestMapping("/get/portal/type/project/data/remote")
    public ResultEntity<List<PortalTypeVO>> getPortalTypeProjectDataRemote() {

        try {
            List<PortalTypeVO> portalTypeVOList = projectService.getPortalTypeVO();
            return ResultEntity.successWithData(portalTypeVOList);
        } catch (Exception e) {
            return ResultEntity.failed(e.getMessage());
        }

    }

    public ResultEntity<List<PortalTypeVO>> getPortalTypeProjectDataRemoteBackup() {
        return ResultEntity.failed(CrowdConstant.MESSAGE_HYSTRIX_BACKUP);
    }

    @HystrixCommand(fallbackMethod = "getDetailProjectVORemoteBackup")
    @RequestMapping("/get/project/detail/remote/{projectId}")
    ResultEntity<DetailProjectVO> getDetailProjectVORemote(@PathVariable("projectId") Integer projectId) {

        try {
            DetailProjectVO detailProjectVOById = projectService.getDetailProjectVO(projectId);
            return ResultEntity.successWithData(detailProjectVOById);
        } catch (Exception e) {
            e.printStackTrace();
            return ResultEntity.failed(e.getMessage());
        }

    }

    ResultEntity<DetailProjectVO> getDetailProjectVORemoteBackup(@PathVariable("projectId") Integer projectId) {
        return ResultEntity.failed(CrowdConstant.MESSAGE_HYSTRIX_BACKUP);
    }

}
```



#### 7.1.4 `redis` å·¥ç¨‹æ•´åˆ `Hystrix`

1. è¿½åŠ ä¾èµ–

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662719291623-43379379-828f-4cd3-92c9-f71836d00a35.png)

```xml
<!-- æ•´åˆ Hystrix -->
<dependency>
    <groupId>org.springframework.cloud</groupId>
    <artifactId>spring-cloud-starter-netflix-hystrix</artifactId>
</dependency>
```

1. å¼€å¯æ–­è·¯å™¨ï¼Œ ä¿®æ”¹ `CrowdMainClass`

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662719277517-e5ffa535-d816-4353-abe6-d150f6ffb48b.png)

```java
package com.atguigu.crowd;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.cloud.client.circuitbreaker.EnableCircuitBreaker;

/**
 * `@EnableCircuitBreaker`: å¼€å¯æ–­è·¯å™¨åŠŸèƒ½
 *
 * @author é™ˆæ±Ÿæ—
 * @date 2022/8/19 11:05
 */
@EnableCircuitBreaker
@SpringBootApplication
public class CrowdMainClass {

    public static void main(String[] args) {
        SpringApplication.run(CrowdMainClass.class, args);
    }

}
```



1. ä¿®æ”¹ `RedisHandler`

```java
package com.atguigu.crowd.handler;

import com.atguigu.crowd.constant.CrowdConstant;
import com.atguigu.crowd.util.ResultEntity;
import com.netflix.hystrix.contrib.javanica.annotation.HystrixCommand;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.data.redis.core.StringRedisTemplate;
import org.springframework.data.redis.core.ValueOperations;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RestController;

import java.util.concurrent.TimeUnit;

/**
 * @author é™ˆæ±Ÿæ—
 * @date 2022/8/28 21:39
 */
@RestController
public class RedisHandler {

    @Autowired
    private StringRedisTemplate redisTemplate;

    /**
     * ä¿å­˜
     *
     * @param key
     * @param value
     * @return
     */
    @HystrixCommand(fallbackMethod = "setRedisKeyValueRemoteBackup")
    @RequestMapping("/set/redis/key/value/remote")
    public ResultEntity<String> setRedisKeyValueRemote(
            @RequestParam("key") String key,
            @RequestParam("value") String value) {
        try {
            ValueOperations<String, String> operations = redisTemplate.opsForValue();
            operations.set(key, value);

            return ResultEntity.successWithoutData();
        } catch (Exception e) {
            return ResultEntity.failed(e.getMessage());
        }
    }

    public ResultEntity<String> setRedisKeyValueRemoteBackup(
            @RequestParam("key") String key,
            @RequestParam("value") String value) {
        return ResultEntity.failed(CrowdConstant.MESSAGE_HYSTRIX_BACKUP);
    }

    /**
     * è®¾ç½®å¸¦è¶…æ—¶æ—¶é—´çš„
     *
     * @param key
     * @param value
     * @param time     æ—¶é—´
     * @param timeUnit æ—¶é—´å•ä½
     * @return
     */
    @HystrixCommand(fallbackMethod = "setRedisKeyValueRemoteWithTimeoutBackup")
    @RequestMapping("/set/redis/key/value/remote/with/timeout")
    public ResultEntity<String> setRedisKeyValueRemoteWithTimeout(
            @RequestParam("key") String key,
            @RequestParam("value") String value,
            @RequestParam("time") long time,
            @RequestParam("timeUnit") TimeUnit timeUnit) {
        try {
            ValueOperations<String, String> operations = redisTemplate.opsForValue();
            operations.set(key, value, time, timeUnit);

            return ResultEntity.successWithoutData();
        } catch (Exception e) {
            return ResultEntity.failed(e.getMessage());
        }
    }

    public ResultEntity<String> setRedisKeyValueRemoteWithTimeoutBackup(
            @RequestParam("key") String key,
            @RequestParam("value") String value,
            @RequestParam("time") long time,
            @RequestParam("timeUnit") TimeUnit timeUnit) {
        return ResultEntity.failed(CrowdConstant.MESSAGE_HYSTRIX_BACKUP);
    }
    
    /**
     * æ ¹æ® Key è·å–
     *
     * @param key
     * @return
     */
    @HystrixCommand(fallbackMethod = "getRedisKeyValueByKeyBackup")
    @RequestMapping("get/redis/key/value/by/key")
    public ResultEntity<String> getRedisKeyValueByKey(@RequestParam("key") String key) {
        try {
            ValueOperations<String, String> operations = redisTemplate.opsForValue();
            String value = operations.get(key);

            return ResultEntity.successWithData(value);
        } catch (Exception e) {
            return ResultEntity.failed(e.getMessage());
        }
    }

    public ResultEntity<String> getRedisKeyValueByKeyBackup(@RequestParam("key") String key) {
        return ResultEntity.failed(CrowdConstant.MESSAGE_HYSTRIX_BACKUP);
    }

    /**
     * æ ¹æ® Key åˆ é™¤
     *
     * @param key
     * @return
     */
    @HystrixCommand(fallbackMethod = "removeRedisKeyRemoteBackup")
    @RequestMapping("remove/redis/key/remote")
    public ResultEntity<String> removeRedisKeyRemote(@RequestParam("key") String key) {
        try {
            redisTemplate.delete(key);

            return ResultEntity.successWithoutData();
        } catch (Exception e) {
            return ResultEntity.failed(e.getMessage());
        }
    }

    public ResultEntity<String> removeRedisKeyRemoteBackup(@RequestParam("key") String key) {
        return ResultEntity.failed(CrowdConstant.MESSAGE_HYSTRIX_BACKUP);
    }
    
}
```



### 7.2 æœåŠ¡é™çº§æœºåˆ¶

1. è¿½åŠ é…ç½®ã€`auth` å·¥ç¨‹ã€‘å’Œã€`project`å·¥ç¨‹ã€‘

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662699530657-7a4b9f12-a3ee-4ad8-9dd5-3765d0f9bfb6.png)

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662699553501-c6d5e3f2-a7c2-492b-b27c-6ea48cf9ed73.png)

```yaml
feign:
  hystrix:
    # ä½¿ç”¨ Hystrix æ–­è·¯å™¨
    enabled: true
```



#### 7.2.1 æ–°å»º `RedisFallBackFactory`

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662698451200-749d530a-fa0d-4d24-bd8f-7cdcb781ca03.png)

```java
package com.atguigu.crowd.factory;

import com.atguigu.crowd.api.RedisRemoteService;
import com.atguigu.crowd.util.ResultEntity;
import feign.hystrix.FallbackFactory;
import org.springframework.stereotype.Component;

import java.util.concurrent.TimeUnit;

/**
 * @author é™ˆæ±Ÿæ—
 * @date 2022/9/9 12:39
 */
@Component
public class RedisFallBackFactory implements FallbackFactory<RedisRemoteService> {

    @Override
    public RedisRemoteService create(Throwable cause) {
        return new RedisRemoteService() {
            @Override
            public ResultEntity<String> setRedisKeyValueRemote(String key, String value) {
                return ResultEntity.failed("é™çº§æœºåˆ¶ç”Ÿæ•ˆ: " + cause.getMessage());
            }

            @Override
            public ResultEntity<String> setRedisKeyValueRemoteWithTimeout(String key, String value, long time, TimeUnit timeUnit) {
                return ResultEntity.failed("é™çº§æœºåˆ¶ç”Ÿæ•ˆ: " + cause.getMessage());
            }

            @Override
            public ResultEntity<String> getRedisKeyValueByKey(String key) {
                return ResultEntity.failed("é™çº§æœºåˆ¶ç”Ÿæ•ˆ: " + cause.getMessage());
            }

            @Override
            public ResultEntity<String> removeRedisKeyRemote(String key) {
                return ResultEntity.failed("é™çº§æœºåˆ¶ç”Ÿæ•ˆ: " + cause.getMessage());
            }
        };
    }

}
```

#### 7.2.2 ä½¿ç”¨ `RedisFallBackFactory`

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662698516382-b079754d-2271-4154-8bf3-7f63473fa7c6.png)

```java
@FeignClient(value = "atguigu-crowd-redis", fallbackFactory = RedisFallBackFactory.class)
public interface RedisRemoteService {
}
```


# äºŒåå›› å‰å°-æ”¯ä»˜

```
git checkout -b 24.0.0_pay
```



## 1. æ€è·¯

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662729509855-c54a3688-fe84-4b43-895e-27d5b4a73153.png)

## 2. æ“ä½œä¸€: æ­å»º `pay` å·¥ç¨‹ç¯å¢ƒ

### 2.1 è¿½åŠ ä¾èµ–å’Œæ’ä»¶

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662798182722-a79cc241-2cab-4342-95cf-14f8f09f3657.png)

```xml
    <dependencies>
        <!-- æ”¯ä»˜å® Alipay SDK -->
        <dependency>
            <groupId>com.alipay.sdk</groupId>
            <artifactId>alipay-sdk-java</artifactId>
            <version>4.33.39.ALL</version>
        </dependency>
        <dependency>
            <groupId>com.atguigu.crowd</groupId>
            <artifactId>atcrowdfunding17-member-api</artifactId>
            <version>1.0-SNAPSHOT</version>
        </dependency>
        <!-- å¯¼å…¥é…ç½®æ–‡ä»¶å¤„ç†å™¨, é…ç½®æ–‡ä»¶è¿›è¡Œç»‘å®š -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-configuration-processor</artifactId>
            <optional>true</optional>
        </dependency>
        <!-- å¯¹å¤–æš´éœ²æœåŠ¡ -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-web</artifactId>
        </dependency>
        <!-- æ•´åˆè§†å›¾ -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-thymeleaf</artifactId>
        </dependency>
        <!-- ä½œä¸ºå®¢æˆ·ç«¯è®¿é—® Eureka æ³¨å†Œä¸­å¿ƒ -->
        <dependency>
            <groupId>org.springframework.cloud</groupId>
            <artifactId>spring-cloud-starter-netflix-eureka-client</artifactId>
        </dependency>
        <!-- SpringBoot æµ‹è¯• -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-test</artifactId>
            <scope>test</scope>
        </dependency>
        <!-- å¼•å…¥ SpringBoot & Redis åœºæ™¯ -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-data-redis</artifactId>
        </dependency>
        <!-- å¼•å…¥ SpringBoot & SpringSession åœºæ™¯ -->
        <dependency>
            <groupId>org.springframework.session</groupId>
            <artifactId>spring-session-data-redis</artifactId>
        </dependency>
    </dependencies>

    <build>
        <plugins>
            <!-- è¿™ä¸ªæ’ä»¶å°† SpringBoot åº”ç”¨æ‰“åŒ…æˆä¸€ä¸ªå¯æ‰§è¡Œçš„ jar åŒ… -->
            <plugin>
                <groupId>org.springframework.boot</groupId>
                <artifactId>spring-boot-maven-plugin</artifactId>
                <executions>
                    <execution>
                        <goals>
                            <goal>repackage</goal>
                        </goals>
                    </execution>
                </executions>
            </plugin>
        </plugins>
    </build>
```



### 2.2 æ–°å»º `CrowdMainClass`

```java
package com.atguigu.crowd;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.cloud.openfeign.EnableFeignClients;

/**
 * @author é™ˆæ±Ÿæ—
 * @date 2022/9/10 16:23
 */
@EnableFeignClients
@SpringBootApplication
public class CrowdMainClass {

    public static void main(String[] args) {
        SpringApplication.run(CrowdMainClass.class, args);
    }

}
```

### 2.3 æ–°å»º `PayProperties`

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662814685128-fc0fc509-2249-4700-8348-0660eaa8440a.png)

```java
package com.atguigu.crowd.config;

import lombok.AllArgsConstructor;
import lombok.Data;
import lombok.NoArgsConstructor;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.stereotype.Component;

/**
 * @author é™ˆæ±Ÿæ—
 * @date 2022/9/10 17:42
 */
@NoArgsConstructor
@AllArgsConstructor
@Data
@Component
@ConfigurationProperties(prefix = "ali.pay")
public class PayProperties {

    /**
     * æ”¯ä»˜å®å…¬é’¥
     */
    private String alipayPublicKey;

    /**
     * åº”ç”¨ ID
     */
    private String appId;

    /**
     * å­—ç¬¦ç¼–ç æ ¼å¼
     */
    private String charset;

    /**
     * æ”¯ä»˜å®ç½‘å…³ï¼ˆæ²™ç®±ç¯å¢ƒï¼‰
     */
    private String gatewayUrl;

    /**
     * å•†æˆ·ç§é’¥
     */
    private String merchantPrivateKey;

    /**
     * æ”¯ä»˜å®æœåŠ¡å™¨ä¸»åŠ¨é€šçŸ¥å•†æˆ·æœåŠ¡å™¨é‡ŒæŒ‡å®šçš„é¡µé¢ http/https è·¯å¾„
     * äº¤æ˜“æˆåŠŸåï¼Œæ”¯ä»˜å®é€šè¿‡ post è¯·æ±‚ notifyUrlï¼ˆå•†æˆ·å…¥å‚ä¼ å…¥ï¼‰ï¼Œè¿”å›å¼‚æ­¥é€šçŸ¥å‚æ•°ã€‚
     */
    private String notifyUrl;

    /**
     * ç”¨æˆ·ç¡®è®¤æ”¯ä»˜åï¼Œæ”¯ä»˜å®é€šè¿‡ get è¯·æ±‚ returnUrlï¼ˆå•†æˆ·å…¥å‚ä¼ å…¥ï¼‰ï¼Œè¿”å›åŒæ­¥è¿”å›å‚æ•°ã€‚
     */
    private String returnUrl;

    /**
     * ç­¾åæ–¹å¼
     */
    private String signType;

}
```



### 2.4 æ–°å»º `application.yml`

```yaml
server:
  port: 7000

spring:
  application:
    name: atguigu-crowd-pay
  session:
    store-type: redis

eureka:
  client:
    service-url:
      defaultZone: http://localhost:1000/eureka

ribbon:
  # 10ç§’ - å¤„ç†è¯·æ±‚çš„è¶…æ—¶æ—¶é—´ï¼Œé»˜è®¤ä¸º5ç§’
  ReadTimeout: 10000
  # 10ç§’ - è¿æ¥å»ºç«‹çš„è¶…æ—¶æ—¶é•¿ï¼Œé»˜è®¤5ç§’
  ConnectTimeout: 10000

feign:
  hystrix:
    # ä½¿ç”¨ Hystrix æ–­è·¯å™¨
    enabled: true

ali:
  pay:
    alipay-public-key: MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAoauF73gbBsJVQkFK/gmmVOWzYevEJZyPozl9L/49MvZKgo9oVOniBIJZq3+/ve6UZUKxLhKGFekP7mCsqMP3J+dr/a12gcVeBX8mu8J6ArwJnQ+pNsbZl9/dlpaob7qEGPd4gCZyr4J31ejpHrFJZBrUeHMtp3bo41YlMa7EKq4eoI8o8nm8yLFedtmtE5/LlY1uj3W0n6ZTGMjGfAOBQSICeoEJZPH+9u/NkLC/2FhRNNMwEAyp0xYQ3AjlX93GFL5F/1nc56oXDzpcIVzBXW+RP8Of1ISwFiXw6qF/P+zXLUNFmjDh03bJrdHoYuvS/Xygs53gwLYFIF+Qdo1KBwIDAQAB
    app-id: 2016100100642012
    charset: utf-8
    gateway-url: https://openapi.alipaydev.com/gateway.do
    merchant-private-key: MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQCSW8OKd+By+Ea7UP9yCbWtlhvr7QvgAfiG9joMwbZ+Zma2/YMOWaAPD6NowrnaNaNd9gWZB/qJ1oe5QAXUi4bi/J1n+1+T1giRSaFtpkfDeRBvKmTiSyYCeGk7aeT0FWODWQB7ZnPD9R6KCeJCVhzN2YmurNFHftiM1fFcRHUNb5Daw0m7xKrOebQwMIk7K3at5a/Yd5nMUcOqoUOKTXMjxXSW6CnFXMCirPhg/e5aAMD+GiOUOIKx/DTtnZjVBv5UF0MJ7Xg1/wtrkHi4k3ZPLwJdMjv4UOH9377BbGFkyc0/0PJPhG69TqyyOInUCDNDyhzaYpH423GhlJy4uywrAgMBAAECggEAenw/jp+6gJ1VnKgxz/9eQ3Lv1SdiG8uqcVCZzllD4E7UwWoyhwzszg35ZNAqd/sRyK3/i03JGBgpKBjziCho74gYN5CBMZkbPHQRnFFfl7C210H0ggoAOmsJLob17GwGB0OyCpP4aFO4hi+1Ymzs2D2pYz0QPDRlCKB3yQ8louKjlykGSWwo58zwm935BHvv//JijHGbMbqDJGMfj/ogjhDP0txE7ZBiO9sEc1RjZ5Csg/81H8XSXCGyMowTX+I2M2ys59HMiuZFLM3pG5/UfOkqGKEJcv/ymsKILgL5h2XvLIFbgUqG4WMmHAX+moApnqmnkOtvSnE1u9hnBIkE+QKBgQDuerisalgfDlJ4wn3A7yQyX4cbT3ozLmqo/FZrlrd/ZJ/HgFrGBiEjaSxWRUxVUBGOgyQszOCzvhPySJjW6Y+xcai1MpC0z9fnvbpFM5GVVKUDIIA//O8+Ukd7wZyW20jebeFNk9I/kTAHs751wSJ8x60OET34r+ESk6aV+9xMDQKBgQCdHHK2XKgbUb+LtM0BUDq4KzPWW3/XYMrKpazDjwB+z2XWJSzch4nXyEa/8QAnUI3Atyn0fK1BmfyvFFtHpQtUpMUKtsswz9+RLwFrFrMspl3POlQEaU32fzl/RL7mybZyt71Mqcgq41DAtrVcyXWhgU1x6XrHcCxwZ0LROsDzFwKBgEolLbWteqhtM4cIMUEDGSXwPXloRH4VOGRB0DyzJ2ocRvEoHxDiZvszf+1yrkD4G/1LGLw1FsfLmTgDCkIHa/2ncOSlTAhrdp0+h+NsHR9oqcVHHZjHczrVKhR4Jc9hbk55q0sLYpsQ8PX0FItX+PkCu/NbuQDQ7hFwhqKrI9shAoGADU9LqIdQ9n+Gap92fpX9Y3zFd3No8SYSB/jhGfATaqrHRc0Ab+5Ljyw4UipoiOwaFiluNHgbdWNGNM7UrM0emJ0c1DuIGyqBFhuVUy0pIK83Y0bdt0H0iN1eUZnRUlvkSPOn5ca8XmXDgY/47VNj07rQhMXy0NJ/8UXOM0t27SECgYEAxERMjSKIjJ4VRcVcroBzdXZ2O3Pj9r1BLkyY8qKmptYvA+yinVWvvVzwjoHqLoqEkVZMq2ixrLYt7sl3esfGyUIdxjXUI1cbvCOpbDe7f0kJxvXyldC5Lrtama5gdJE36JFGbWrf2PRg4in1sizMjyY8G/SDMS0MNKpzos4pASQ=
    notify-url: http://175.178.174.83/pay/notify
    return-url: http://175.178.174.83/pay/return
    sign-type: RSA2
```



### 2.5 æ–°å»º `OrderVO`ã€`entity` å·¥ç¨‹ã€‘

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662806372988-36a00d46-3771-4e0f-9e2c-63e009937995.png)

```java
package com.atguigu.crowd.entity.vo;

import lombok.AllArgsConstructor;
import lombok.Data;
import lombok.NoArgsConstructor;

import java.io.Serializable;

/**
 * @author é™ˆæ±Ÿæ—
 * @date 2022/9/10 16:14
 */
@NoArgsConstructor
@AllArgsConstructor
@Data
public class OrderVO implements Serializable {

    private static final long serialVersionUID = 1L;

    private Integer id;

    /**
     * æ”¶è´§åœ°å€è¡¨ä¸»é”®
     */
    private String addressId;

    /**
     * è®¢å•å·
     */
    private String orderName;

    /**
     * æ”¯ä»˜å®æµæ°´å•å·
     */
    private String payOrderNum;

    /**
     * è®¢å•é‡‘é¢
     */
    private Double orderAmount;

    /**
     * æ˜¯å¦å¼€å‘ç¥¨ [{0: ä¸å¼€å‘ç¥¨}, {1: å¼€å‘ç¥¨}]
     */
    private String invoice;

    /**
     * å‘ç¥¨æŠ¬å¤´
     */
    private String invoiceTitle;

    /**
     * è®¢å•å¤‡æ³¨
     */
    private String orderRemark;

    private OrderProjectVO orderProjectVO;

}
```



### 2.6 è¿½åŠ è·¯ç”±è§„åˆ™ã€`zuul`å·¥ç¨‹ã€‘

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662806357066-136c3a1b-33e6-4716-96ae-0bc091735ddf.png)

```yaml
zuul:
  routes:
    crowd-pay:
      service-id: atguigu-crowd-pay
      path: /pay/**
```



## 3. æ“ä½œäºŒ: æäº¤è®¢å•è¡¨å•

### 3.1 æäº¤è¡¨å• <å…³é”®ä»£ç >

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662797951303-17c4a519-451b-446c-b60a-cf5cf50bfdc8.png)

```javascript
$("#payButton").click(function () {
    // 1.æ”¶é›†æ‰€æœ‰è¦æäº¤çš„è¡¨å•é¡¹çš„æ•°æ®
    var addressId = $("[name=addressId]:checked").val();
    var invoice = $("[name=invoiceRadio]:checked").val();
    var invoiceTitle = $.trim($("[name=invoiceTitle]").val());
    var remark = $.trim($("[name=remark]").val());

    // 2.å°†ä¸Šé¢æ”¶é›†åˆ°çš„è¡¨å•æ•°æ®å¡«å……åˆ°ç©ºè¡¨å•ä¸­å¹¶æäº¤
    $("#summaryForm")
        .append("<input type='hidden' name='addressId' value='" + addressId + "'/>")
        .append("<input type='hidden' name='invoice' value='" + invoice + "'/>")
        .append("<input type='hidden' name='invoiceTitle' value='" + invoiceTitle + "'/>")
        .append("<input type='hidden' name='orderRemark' value='" + remark + "'/>")
        .submit();
});
<!-- ä¸ºäº†æ”¶é›†å½“å‰é¡µé¢ä¸­çš„æ‰€æœ‰æ•°æ®ï¼Œæ„é€ ç©ºè¡¨å• -->
<form id="summaryForm" action="pay/generate/order" method="post"></form>
```



### 3.2 è°ƒç”¨æ”¯ä»˜æ¥å£

#### 3.2.1 æ–°å»º `PayHandler`

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662806449103-5f18e8a5-c419-41b2-8a38-b8d2e8486ad3.png)

```java
package com.atguigu.crowd.handler;

import com.alipay.api.AlipayApiException;
import com.alipay.api.AlipayClient;
import com.alipay.api.DefaultAlipayClient;
import com.alipay.api.request.AlipayTradePagePayRequest;
import com.atguigu.crowd.config.PayProperties;
import com.atguigu.crowd.entity.vo.OrderProjectVO;
import com.atguigu.crowd.entity.vo.OrderVO;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.ResponseBody;

import javax.servlet.http.HttpSession;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.UUID;

/**
 * @author é™ˆæ±Ÿæ—
 * @date 2022/9/10 16:23
 */
@Controller
public class PayHandler {

    @Autowired
    private PayProperties payProperties;
    
    /**
     * ç”Ÿæˆè®¢å•, è°ƒç”¨æ”¯ä»˜å®æ”¯ä»˜
     *
     * @param session
     * @param orderVO
     * @return {@link String}
     * @throws AlipayApiException
     */
    @ResponseBody
    @RequestMapping("/generate/order")
    public String generateOrder(HttpSession session, OrderVO orderVO) throws AlipayApiException {
        // 1. ä» Session åŸŸè·å– OrderProjectVO å¯¹è±¡
        OrderProjectVO orderProjectVO = (OrderProjectVO) session.getAttribute("orderProjectVO");

        // 2. å°† orderProjectVO å¯¹è±¡å’Œ orderVO å¯¹è±¡ç»„è£…åˆ°ä¸€èµ·
        orderVO.setOrderProjectVO(orderProjectVO);

        // 3. ç”Ÿæˆè®¢å•å·å¹¶è®¾ç½®åˆ° orderVO å¯¹è±¡ä¸­
        // æ ¹æ®å½“å‰æ—¥æœŸæ—¶é—´ç”Ÿæˆå­—ç¬¦ä¸²
        String time = new SimpleDateFormat("yyyyMMddHHmmss").format(new Date());

        // ä½¿ç”¨ UUID ç”Ÿæˆç”¨æˆ· ID éƒ¨åˆ†
        String user = UUID.randomUUID().toString().replace("-", "").toUpperCase();

        // ç»„è£…
        String orderNum = time + user;

        // è®¾ç½®åˆ° OrderVO å¯¹è±¡ä¸­
        orderVO.setOrderName(orderNum);

        // 4. è®¡ç®—è®¢å•æ€»é‡‘é¢è®¾ç½®åˆ° orderVO å¯¹è±¡ä¸­
        Double orderAmount = (double) (orderProjectVO.getSupportPrice() * orderProjectVO.getReturnCount() + orderProjectVO.getFreight());
        orderVO.setOrderAmount(orderAmount);

        // å°† OrderVO å¯¹è±¡å­˜å…¥ Session åŸŸ
        session.setAttribute("orderVO", orderVO);

        // 5. è°ƒç”¨æ”¯ä»˜è¯·æ±‚
        return sendRequestToAliPay(orderNum, orderAmount, orderProjectVO.getProjectName(), orderProjectVO.getReturnContent());
    }

    /**
     * é˜¿é‡Œæ”¯ä»˜å‘é€è¯·æ±‚
     *
     * @param outTradeNo  å•†æˆ·è®¢å•å·ï¼Œå•†æˆ·ç½‘ç«™è®¢å•ç³»ç»Ÿä¸­å”¯ä¸€è®¢å•å·ï¼Œå¿…å¡«
     * @param totalAmount ä»˜æ¬¾é‡‘é¢ï¼Œå¿…å¡«
     * @param subject     è®¢å•åç§°ï¼Œå¿…å¡«
     * @param body        å•†å“æè¿°ï¼Œå¯ç©º
     * @throws AlipayApiException æ”¯ä»˜å®apiä¾‹å¤–
     */
    private String sendRequestToAliPay(
            String outTradeNo,
            Double totalAmount,
            String subject,
            String body
    ) throws AlipayApiException {
        //è·å¾—åˆå§‹åŒ–çš„AlipayClient
        AlipayClient alipayClient = new DefaultAlipayClient(payProperties.getGatewayUrl(), payProperties.getAppId(), payProperties.getMerchantPrivateKey(), "json", payProperties.getCharset(), payProperties.getAlipayPublicKey(), payProperties.getSignType());

        //è®¾ç½®è¯·æ±‚å‚æ•°
        AlipayTradePagePayRequest alipayRequest = new AlipayTradePagePayRequest();
        alipayRequest.setReturnUrl(payProperties.getReturnUrl());
        alipayRequest.setNotifyUrl(payProperties.getNotifyUrl());

        alipayRequest.setBizContent("{\"out_trade_no\":\"" + outTradeNo + "\","
                + "\"total_amount\":\"" + totalAmount + "\","
                + "\"subject\":\"" + subject + "\","
                + "\"body\":\"" + body + "\","
                + "\"product_code\":\"FAST_INSTANT_TRADE_PAY\"}");

        //è‹¥æƒ³ç»™BizContentå¢åŠ å…¶ä»–å¯é€‰è¯·æ±‚å‚æ•°ï¼Œä»¥å¢åŠ è‡ªå®šä¹‰è¶…æ—¶æ—¶é—´å‚æ•°timeout_expressæ¥ä¸¾ä¾‹è¯´æ˜
        //alipayRequest.setBizContent("{\"out_trade_no\":\""+ out_trade_no +"\","
        //		+ "\"total_amount\":\""+ total_amount +"\","
        //		+ "\"subject\":\""+ subject +"\","
        //		+ "\"body\":\""+ body +"\","
        //		+ "\"timeout_express\":\"10m\","
        //		+ "\"product_code\":\"FAST_INSTANT_TRADE_PAY\"}");
        //è¯·æ±‚å‚æ•°å¯æŸ¥é˜…ã€ç”µè„‘ç½‘ç«™æ”¯ä»˜çš„APIæ–‡æ¡£-alipay.trade.page.pay-è¯·æ±‚å‚æ•°ã€‘ç« èŠ‚

        //è¯·æ±‚
        return alipayClient.pageExecute(alipayRequest).getBody();
    }

}
```



#### 3.2.2 `out_trade_no`ï¼ˆå•†æˆ·è®¢å•å·ï¼‰å‚æ•°è¯´æ˜

| **æè¿°** | **è¯´æ˜**                                                     |
| -------- | ------------------------------------------------------------ |
| å‚æ•°è¯´æ˜ | å•†å®¶è®¢å•å·ã€‚å•†æˆ·è‡ªå®šä¹‰ç”Ÿæˆï¼Œä¸€ä¸ª `out_trade_no` å¯¹åº”ä¸€ä¸ª `trade_no`ï¼ˆæ”¯ä»˜å®äº¤æ˜“å·ï¼‰ã€‚ |
| å‘½åè¦æ±‚ | 64ä¸ªå­—ç¬¦ä»¥å†…ã€‚å¯ä»¥åŒ…å«å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ã€‚éœ€ä¿è¯åœ¨å•†æˆ·ç«¯ä¸é‡å¤ã€‚ |
| æ³¨æ„äº‹é¡¹ | è¯¥å‚æ•°ä¸ºå•†æˆ·å¯¹æ¥æ”¯ä»˜å®æ”¯ä»˜æ¥å£å®šä¹‰ä¼ å€¼çš„å‚æ•°ï¼Œéœ€ä¿è¯è¯¥å‚æ•°ä¸é‡å¤ï¼Œæ‰€ä»¥ä¸èƒ½ä½¿ç”¨åŒä¸€ä¸ªè®¢å•å·å»è¯·æ±‚æ¥å£ã€‚ |

- æ ¼å¼è®¾è®¡: `å½“å‰æ—¶é—´ï¼ˆå¹´æœˆæ—¥å°æ—¶åˆ†ç§’ï¼‰+ ç”¨æˆ·ID`

- - æ—¶é—´æ ¼å¼: `yyyyMMddHHmmss`ï¼ˆ14ä½ï¼‰
- ç”¨æˆ·ID: é€šè¿‡ `UUID` ç”Ÿæˆï¼ˆ32ä½ï¼‰



## 4. æ“ä½œä¸‰: `returnUrl`æ–¹æ³•

### 4.1 è¿½åŠ ä»£ç 

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662806708454-27edc086-d60f-46f1-aa38-d31a58b3e282.png)

```java
    @ResponseBody
    @RequestMapping("/return")
    public String returnUrlMethod(HttpServletRequest request, HttpSession session) throws
            UnsupportedEncodingException, AlipayApiException {
        //è·å–æ”¯ä»˜å®GETè¿‡æ¥åé¦ˆä¿¡æ¯
        Map<String, String> params = new HashMap<>();
        Map<String, String[]> requestParams = request.getParameterMap();
        for (Iterator<String> iter = requestParams.keySet().iterator(); iter.hasNext(); ) {
            String name = iter.next();
            String[] values = requestParams.get(name);
            String valueStr = "";
            for (int i = 0; i < values.length; i++) {
                valueStr = (i == values.length - 1) ? valueStr + values[i]
                        : valueStr + values[i] + ",";
            }

            //ä¹±ç è§£å†³ï¼Œè¿™æ®µä»£ç åœ¨å‡ºç°ä¹±ç æ—¶ä½¿ç”¨
            valueStr = new String(valueStr.getBytes("ISO-8859-1"), "utf-8");
            params.put(name, valueStr);
        }

        //è°ƒç”¨SDKéªŒè¯ç­¾å
        boolean signVerified = AlipaySignature.rsaCheckV1(
                params,
                payProperties.getAlipayPublicKey(),
                payProperties.getCharset(),
                payProperties.getSignType());

        //â€”â€”è¯·åœ¨è¿™é‡Œç¼–å†™æ‚¨çš„ç¨‹åºï¼ˆä»¥ä¸‹ä»£ç ä»…ä½œå‚è€ƒï¼‰â€”â€”
        if (signVerified) {
            //å•†æˆ·è®¢å•å·
            String orderName = new String(request.getParameter("out_trade_no").getBytes("ISO-8859-1"), "UTF-8");
            //æ”¯ä»˜å®äº¤æ˜“å·
            String payOrderNum = new String(request.getParameter("trade_no").getBytes("ISO-8859-1"), "UTF-8");
            //ä»˜æ¬¾é‡‘é¢
            String orderAmount = new String(request.getParameter("total_amount").getBytes("ISO-8859-1"), "UTF-8");

            // ä¿å­˜åˆ°æ•°æ®åº“
            // ......
            return "trade_no:" + orderName + "<br/>out_trade_no:" + payOrderNum + "<br/>total_amount:" + orderAmount;
        } else {
            // é¡µé¢æ˜¾ç¤ºä¿¡æ¯: éªŒç­¾å¤±è´¥
            return "éªŒç­¾å¤±è´¥";
        }

    }
```



## 5. æ“ä½œå››: `notifyUrl`æ–¹æ³•

### 5.1 è¿½åŠ ä»£ç 

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662806708454-27edc086-d60f-46f1-aa38-d31a58b3e282.png)

```java
    @RequestMapping("/notify")
    public void notifyUrlMethod(HttpServletRequest request) throws UnsupportedEncodingException, AlipayApiException {
        //è·å–æ”¯ä»˜å®POSTè¿‡æ¥åé¦ˆä¿¡æ¯
        Map<String, String> params = new HashMap<>();
        Map<String, String[]> requestParams = request.getParameterMap();
        for (Iterator<String> iter = requestParams.keySet().iterator(); iter.hasNext(); ) {
            String name = iter.next();
            String[] values = requestParams.get(name);
            String valueStr = "";
            for (int i = 0; i < values.length; i++) {
                valueStr = (i == values.length - 1) ? valueStr + values[i]
                        : valueStr + values[i] + ",";
            }

            //ä¹±ç è§£å†³ï¼Œè¿™æ®µä»£ç åœ¨å‡ºç°ä¹±ç æ—¶ä½¿ç”¨
            valueStr = new String(valueStr.getBytes("ISO-8859-1"), "utf-8");
            params.put(name, valueStr);
        }

        //è°ƒç”¨SDKéªŒè¯ç­¾å
        boolean signVerified = AlipaySignature.rsaCheckV1(
                params,
                payProperties.getAlipayPublicKey(),
                payProperties.getCharset(),
                payProperties.getSignType());
        //â€”â€”è¯·åœ¨è¿™é‡Œç¼–å†™æ‚¨çš„ç¨‹åºï¼ˆä»¥ä¸‹ä»£ç ä»…ä½œå‚è€ƒï¼‰â€”â€”

	    /* å®é™…éªŒè¯è¿‡ç¨‹å»ºè®®å•†æˆ·åŠ¡å¿…æ·»åŠ ä»¥ä¸‹æ ¡éªŒï¼š
	    1ã€éœ€è¦éªŒè¯è¯¥é€šçŸ¥æ•°æ®ä¸­çš„out_trade_noæ˜¯å¦ä¸ºå•†æˆ·ç³»ç»Ÿä¸­åˆ›å»ºçš„è®¢å•å·ï¼Œ
	    2ã€åˆ¤æ–­total_amountæ˜¯å¦ç¡®å®ä¸ºè¯¥è®¢å•çš„å®é™…é‡‘é¢ï¼ˆå³å•†æˆ·è®¢å•åˆ›å»ºæ—¶çš„é‡‘é¢ï¼‰ï¼Œ
	    3ã€æ ¡éªŒé€šçŸ¥ä¸­çš„seller_idï¼ˆæˆ–è€…seller_email) æ˜¯å¦ä¸ºout_trade_noè¿™ç¬”å•æ®çš„å¯¹åº”çš„æ“ä½œæ–¹ï¼ˆæœ‰çš„æ—¶å€™ï¼Œä¸€ä¸ªå•†æˆ·å¯èƒ½æœ‰å¤šä¸ªseller_id/seller_emailï¼‰
	    4ã€éªŒè¯app_idæ˜¯å¦ä¸ºè¯¥å•†æˆ·æœ¬èº«ã€‚
	    */
        // éªŒè¯æˆåŠŸ
        if (signVerified) {
            // å•†æˆ·è®¢å•å·
            String out_trade_no = new String(request.getParameter("out_trade_no").getBytes("ISO-8859-1"), "UTF-8");

            // æ”¯ä»˜å®äº¤æ˜“å·
            String trade_no = new String(request.getParameter("trade_no").getBytes("ISO-8859-1"), "UTF-8");

            // äº¤æ˜“çŠ¶æ€
            String trade_status = new String(request.getParameter("trade_status").getBytes("ISO-8859-1"), "UTF-8");

            logger.info("å•†æˆ·è®¢å•å· out_trade_no=" + out_trade_no);
            logger.info("æ”¯ä»˜å®äº¤æ˜“å· trade_no=" + trade_no);
            logger.info("äº¤æ˜“çŠ¶æ€ trade_status=" + trade_status);

            // return "success";
        } else {//éªŒè¯å¤±è´¥
            logger.info("éªŒè¯å¤±è´¥");
            // return "fail";

            //è°ƒè¯•ç”¨ï¼Œå†™æ–‡æœ¬å‡½æ•°è®°å½•ç¨‹åºè¿è¡Œæƒ…å†µæ˜¯å¦æ­£å¸¸
            //String sWord = AlipaySignature.getSignCheckContentV1(params);
            //AlipayConfig.logResult(sWord);
        }
    }
```



### 5.2 è§¦å‘é€šçŸ¥ç±»å‹

| é€šçŸ¥ç±»å‹                     | æè¿°     | é»˜è®¤å¼€å¯ |
| ---------------------------- | -------- | -------- |
| `tradeStatus.TRADE_CLOSED`   | äº¤æ˜“å…³é—­ | 0        |
| `tradeStatus.TRADE_FINISHED` | äº¤æ˜“å®Œç»“ | 0        |
| `tradeStatus.TRADE_SUCCESS`  | æ”¯ä»˜æˆåŠŸ | 1        |
| `tradeStatus.WAIT_BUYER_PAY` | äº¤æ˜“åˆ›å»º | 0        |

## 6. æ“ä½œäº”: è®¢å•ä¿¡æ¯ä¿å­˜åˆ°æ•°æ®åº“

### 6.1 æ€è·¯

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662831284650-59da73a5-ae2f-4389-98a6-12f0ec8f02eb.png)



### 6.2 `return` æ–¹æ³•

```java
    @ResponseBody
    @RequestMapping("/return")
    public String returnUrlMethod(HttpServletRequest request, HttpSession session) throws
            UnsupportedEncodingException, AlipayApiException {
        // è·å–æ”¯ä»˜å®GETè¿‡æ¥åé¦ˆä¿¡æ¯
        Map<String, String> params = new HashMap<>();
        Map<String, String[]> requestParams = request.getParameterMap();
        for (Iterator<String> iter = requestParams.keySet().iterator(); iter.hasNext(); ) {
            String name = iter.next();
            String[] values = requestParams.get(name);
            String valueStr = "";
            for (int i = 0; i < values.length; i++) {
                valueStr = (i == values.length - 1) ? valueStr + values[i]
                        : valueStr + values[i] + ",";
            }

            // ä¹±ç è§£å†³ï¼Œè¿™æ®µä»£ç åœ¨å‡ºç°ä¹±ç æ—¶ä½¿ç”¨
            valueStr = new String(valueStr.getBytes("ISO-8859-1"), "utf-8");
            params.put(name, valueStr);
        }

        // è°ƒç”¨SDKéªŒè¯ç­¾å
        boolean signVerified = AlipaySignature.rsaCheckV1(
                params,
                payProperties.getAlipayPublicKey(),
                payProperties.getCharset(),
                payProperties.getSignType());

        // â€”â€”è¯·åœ¨è¿™é‡Œç¼–å†™æ‚¨çš„ç¨‹åºï¼ˆä»¥ä¸‹ä»£ç ä»…ä½œå‚è€ƒï¼‰â€”â€”
        if (signVerified) {
            // å•†æˆ·è®¢å•å·
            String orderName = new String(request.getParameter("out_trade_no").getBytes("ISO-8859-1"), "UTF-8");
            // æ”¯ä»˜å®äº¤æ˜“å·
            String payOrderNum = new String(request.getParameter("trade_no").getBytes("ISO-8859-1"), "UTF-8");
            // ä»˜æ¬¾é‡‘é¢
            String orderAmount = new String(request.getParameter("total_amount").getBytes("ISO-8859-1"), "UTF-8");

            // ä¿å­˜åˆ°æ•°æ®åº“
            OrderVO orderVO = (OrderVO)session.getAttribute("orderVO");
            // å°†æ”¯ä»˜å®åŠäº¤æ˜“å·è®¾ç½®åˆ° OrderVO ä¸­
            orderVO.setPayOrderNum(payOrderNum);

            // å‘èµ·è¯·æ±‚
            ResultEntity<String> resultEntity = mySQLRemoteService.saveOrderRemote(orderVO);
            logger.info("Order save result" + resultEntity.getResult());

            return "trade_no:" + orderName + "<br/>out_trade_no:" + payOrderNum + "<br/>total_amount:" + orderAmount;
        } else {
            // é¡µé¢æ˜¾ç¤ºä¿¡æ¯: éªŒç­¾å¤±è´¥
            return "éªŒç­¾å¤±è´¥";
        }

    }
```



### 6.3 å£°æ˜æ¥å£

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662831655752-72f5cb75-0f32-4147-b998-eca4204a2995.png)

```java
    /**
     * ä¿å­˜è®¢å•
     *
     * @param orderVO
     * @return {@link ResultEntity}<{@link String}>
     */
    @RequestMapping("/save/order/remote")
    ResultEntity<String> saveOrderRemote(@RequestBody OrderVO orderVO);
```



#### 6.3.1 å¯¹åº”çš„é™çº§æœºåˆ¶

![img](https://cdn.nlark.com/yuque/0/2022/png/12811585/1662831684904-0a10fe56-ad87-4381-a721-7592ec648c7b.png)

```java
@Override
public ResultEntity<String> saveOrderRemote(OrderVO orderVO) {
    return ResultEntity.failed("é™çº§æœºåˆ¶ç”Ÿæ•ˆ: " + cause.getMessage());
}
```



### 6.4 è¿½åŠ ä»£ç ã€`mysql` å·¥ç¨‹ã€‘

- `OrderProviderHandler`

```java
    @HystrixCommand(fallbackMethod = "saveOrderRemoteBackup")
    @RequestMapping("/save/order/remote")
    public ResultEntity<String> saveOrderRemote(@RequestBody OrderVO orderVO) {
        try {
            orderService.saveOrder(orderVO);
            return ResultEntity.successWithoutData();
        } catch (Exception e) {
            e.printStackTrace();
            return ResultEntity.failed(e.getMessage());
        }
    }

    public ResultEntity<String> saveOrderRemoteBackup(@RequestBody OrderVO orderVO) {
        return ResultEntity.failed(CrowdConstant.MESSAGE_HYSTRIX_BACKUP);
    }
```

- `OrderService`

```java
    /**
     * ä¿å­˜è®¢å•
     *
     * @param orderVO
     */
    void saveOrder(OrderVO orderVO);
```

- `OrderServiceImpl`

```java
    @Transactional(propagation = Propagation.REQUIRES_NEW, rollbackFor = Exception.class)
    @Override
    public void saveOrder(OrderVO orderVO) {
        OrderPO orderPO = new OrderPO();
        BeanUtils.copyProperties(orderVO, orderPO);

        OrderProjectPO orderProjectPO = new OrderProjectPO();
        BeanUtils.copyProperties(orderVO.getOrderProjectVO(), orderProjectPO);

        // ä¿å­˜ orderPO è‡ªåŠ¨ç”Ÿæˆçš„ä¸»é”®æ˜¯ orderProjectPO éœ€è¦çš„
        orderPOMapper.insert(orderPO);
        Integer id = orderPO.getId();
        orderProjectPO.setOrderId(id + "");

        orderProjectPOMapper.insert(orderProjectPO);
    }
```

- `OrderPOMapper.xml`

```xml
  <insert id="insert" useGeneratedKeys="true" keyProperty="id" parameterType="com.atguigu.crowd.entity.po.OrderPO" >
    insert into t_order (id, address_id, order_name, 
      pay_order_num, order_amount, invoice, 
      invoice_title, order_remark)
    values (#{id,jdbcType=INTEGER}, #{addressId,jdbcType=VARCHAR}, #{orderName,jdbcType=VARCHAR}, 
      #{payOrderNum,jdbcType=VARCHAR}, #{orderAmount,jdbcType=DOUBLE}, #{invoice,jdbcType=VARCHAR}, 
      #{invoiceTitle,jdbcType=VARCHAR}, #{orderRemark,jdbcType=VARCHAR})
  </insert>
```